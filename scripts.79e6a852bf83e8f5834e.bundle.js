if("undefined"==typeof GreenTurtle)var GreenTurtle=function(){function e(){}function t(e){this.target=e||{graph:{subjects:{},prefixes:{},terms:{}}},this.theOne="_:"+(new Date).getTime(),this.vocabulary=this.language=null,this.blankCounter=0,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"}],this.inXHTMLMode=!1,this.absURIRE=/[\w\_\-]+:\S+/,this.finishedHandlers=[],this.init()}function r(){var e=this;this.curieParser={trim:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},parse:function(t,r){"["==(t=this.trim(t)).charAt(0)&&"]"==t.charAt(t.length-1)&&(t=t.substring(1,t.length-1));var n=t.indexOf(":");if(0<=n){var i=t.substring(0,n);if(""==i)return(i=e.prefixes[""])?i+t.substring(n+1):null;if("_"==i)return"_:"+t.substring(n+1);if(a.NCNAME.test(i)&&(i=e.prefixes[i]))return i+t.substring(n+1)}return r?e.baseURI.resolve(t):t}},this.base=null,this.toString=function(e){var t;for(t in e=e?"@base <"+e+"> .\n":"",this.subjects)e+=this.subjects[t].toString(),e+="\n";return e},this.clear=function(){this.subjects={},this.prefixes={},this.terms={}},this.clear()}function n(e,t){this.graph=e,this.id=this.subject=t,this.predicates={},this.origins=[],this.types=[]}function i(e){this.predicate=this.id=e,this.objects=[]}function o(e){t.call(this,e)}function s(e,t){this._data_={owner:e,subject:t,properties:{}}}function a(e){this._data_={tripleCount:0,graph:new r},this._data_.graph.baseURI=this.parseURI(e),this._data_.baseURI=this._data_.graph.baseURI,Object.defineProperty(this,"rdfa",{value:new function(e){this.query=function(t,r){if(!t)return e.getProjections(r);var n,i=[];for(n in e._data_.graph.subjects){var o,s=e._data_.graph.subjects[n];for(o in t){var u=e._data_.graph.curieParser.parse(o,!0);if(!(u=s.predicates[u])){s=null;break}for(var l=e._data_.graph.curieParser.parse(t[o],!1),c=null,f=0;!c&&f<u.objects.length;f++)u.objects[f].value==l&&(c=u.objects[f]);if(!c){s=null;break}}s&&i.push(a.toProjection(e,s,r))}return i}}(this),writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"graph",{value:this._data_.graph,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"implementation",{value:GreenTurtle.implementation,writable:!1,configurable:!1,enumerable:!0})}function u(){this.reset(),this.onError=function(e,t){console.log(e+": "+t)}}var l={};e.SCHEME=/^[A-Za-z][A-Za-z0-9\+\-\.]*\:/,e.prototype.parseURI=function(t){var r=e.SCHEME.exec(t);if(!r)throw"Bad URI value, no scheme: "+t;return(t={spec:t}).scheme=r[0].substring(0,r[0].length-1),t.schemeSpecificPart=t.spec.substring(r[0].length),"/"==t.schemeSpecificPart.charAt(0)&&"/"==t.schemeSpecificPart.charAt(1)?this.parseGeneric(t):t.isGeneric=!1,t.normalize=function(){if(this.isGeneric&&0!=this.segments.length){if(1<this.path.length&&"/."==this.path.substring(this.path.length-2))this.path=this.path.substring(0,this.path.length-1),this.segments.splice(this.segments.length-1,1);else{var e=this.path.charAt(this.path.length-1);"/"!=e&&(e="");for(var t=0;t<this.segments.length;t++)0<t&&".."==this.segments[t]&&(this.segments.splice(t-1,2),t-=2),"."==this.segments[t]&&(this.segments.splice(t,1),t--);this.path=0==this.segments.length?"/":"/"+this.segments.join("/")+e}this.schemeSpecificPart="//"+this.authority+this.path,"undefined"!=typeof this.query&&(this.schemeSpecificPart+="?"+this.query),"undefined"!=typeof this.fragment&&(this.schemeSpecificPart+="#"+this.fragment),this.spec=this.scheme+":"+this.schemeSpecificPart}},t.resolve=function(t){if(!t)return this.spec;if("#"==t.charAt(0)){var r=this.spec.lastIndexOf("#");return 0>r?this.spec+t:this.spec.substring(0,r)+t}if(!this.isGeneric)throw"Cannot resolve uri against non-generic URI: "+this.spec;return t.indexOf(":"),"/"==t.charAt(0)?this.scheme+"://"+this.authority+t:"."==t.charAt(0)&&"/"==t.charAt(1)?"/"==this.path.charAt(this.path.length-1)?this.scheme+"://"+this.authority+this.path+t.substring(2):(r=this.path.lastIndexOf("/"),this.scheme+"://"+this.authority+this.path.substring(0,r)+t.substring(1)):e.SCHEME.test(t)?t:"?"==t.charAt(0)||"/"==this.path.charAt(this.path.length-1)?this.scheme+"://"+this.authority+this.path+t:(r=this.path.lastIndexOf("/"),this.scheme+"://"+this.authority+this.path.substring(0,r+1)+t)},t.relativeTo=function(e){if(e.scheme!=this.scheme)return this.spec;if(!this.isGeneric)throw"A non generic URI cannot be made relative: "+this.spec;if(!e.isGeneric)throw"Cannot make a relative URI against a non-generic URI: "+e.spec;if(e.authority!=this.authority)return this.spec;for(var t=0;t<this.segments.length&&t<e.segments.length;t++)if(this.segments[t]!=e.segments[t]){for(var r="",n=t;n<e.segments.length;n++)r+="../";for(n=t;n<this.segments.length;n++)r+=this.segments[n],n+1<this.segments.length&&(r+="/");return"/"==this.path.charAt(this.path.length-1)&&(r+="/"),r}if(this.segments.length==e.segments.length)return this.hash?this.hash:this.query?this.query:"";if(t<this.segments.length){for(r="",n=t;n<this.segments.length;n++)r+=this.segments[n],n+1<this.segments.length&&(r+="/");return"/"==this.path.charAt(this.path.length-1)&&(r+="/"),r}throw"Cannot calculate a relative URI for "+this.spec+" against "+e.spec},t},e.prototype.parseGeneric=function(e){if("/"!=e.schemeSpecificPart.charAt(0)||"/"!=e.schemeSpecificPart.charAt(1))throw"Generic URI values should start with '//':"+e.spec;var t=e.schemeSpecificPart.substring(2),r=t.indexOf("/");if(e.authority=0>r?t:t.substring(0,r),e.path=0>r?"":t.substring(r),0<=(t=e.path.indexOf("#"))&&(e.fragment=e.path.substring(t+1),e.path=e.path.substring(0,t)),0<=(t=e.path.indexOf("?"))&&(e.query=e.path.substring(t+1),e.path=e.path.substring(0,t)),"/"==e.path||""==e.path)e.segments=[];else for(e.segments=e.path.split(/\//),0<e.segments.length&&""==e.segments[0]&&1<e.path.length&&"/"!=e.path.charAt(1)&&e.segments.shift(),0<e.segments.length&&0<e.path.length&&"/"==e.path.charAt(e.path.length-1)&&""==e.segments[e.segments.length-1]&&1<e.path.length&&"/"!=e.path.charAt(e.path.length-2)&&e.segments.pop(),t=0;t<e.segments.length;t++){r=e.segments[t].split(/%[A-Za-z0-9][A-Za-z0-9]|[\ud800-\udfff][\ud800-\udfff]|[A-Za-z0-9\-\._~!$&'()*+,;=@:\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/);for(var n=0;n<r.length;n++)if(0<r[n].length)throw"Unecaped character "+r[n].charAt(0)+" ("+r[n].charCodeAt(0)+") in URI "+e.spec}e.isGeneric=!0},(t.prototype=new e).constructor=t,t.prototype.newBlankNode=function(){return this.blankCounter++,"_:"+this.blankCounter},t.XMLLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral",t.HTMLLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#HTML",t.PlainLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#PlainLiteral",t.objectURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#object",t.typeURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",t.nameChar="[-A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd\u10000-\uefffF.0-9\xb7\u0300-\u036f\u203f-\u2040]",t.nameStartChar="[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u0131\u0134-\u013e\u0141-\u0148\u014a-\u017e\u0180-\u01c3\u01cd-\u01f0\u01f4-\u01f5\u01fa-\u0217\u0250-\u02a8\u02bb-\u02c1\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03ce\u03d0-\u03d6\u03da\u03dc\u03de\u03e0\u03e2-\u03f3\u0401-\u040c\u040e-\u044f\u0451-\u045c\u045e-\u0481\u0490-\u04c4\u04c7-\u04c8\u04cb-\u04cc\u04d0-\u04eb\u04ee-\u04f5\u04f8-\u04f9\u0531-\u0556\u0559\u0561-\u0586\u05d0-\u05ea\u05f0-\u05f2\u0621-\u063a\u0641-\u064a\u0671-\u06b7\u06ba-\u06be\u06c0-\u06ce\u06d0-\u06d3\u06d5\u06e5-\u06e6\u0905-\u0939\u093d\u0958-\u0961\u0985-\u098c\u098f-\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09dc-\u09dd\u09df-\u09e1\u09f0-\u09f1\u0a05-\u0a0a\u0a0f-\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32-\u0a33\u0a35-\u0a36\u0a38-\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8b\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2-\u0ab3\u0ab5-\u0ab9\u0abd\u0ae0\u0b05-\u0b0c\u0b0f-\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32-\u0b33\u0b36-\u0b39\u0b3d\u0b5c-\u0b5d\u0b5f-\u0b61\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99-\u0b9a\u0b9c\u0b9e-\u0b9f\u0ba3-\u0ba4\u0ba8-\u0baa\u0bae-\u0bb5\u0bb7-\u0bb9\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c60-\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cde\u0ce0-\u0ce1\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d60-\u0d61\u0e01-\u0e2e\u0e30\u0e32-\u0e33\u0e40-\u0e45\u0e81-\u0e82\u0e84\u0e87-\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa-\u0eab\u0ead-\u0eae\u0eb0\u0eb2-\u0eb3\u0ebd\u0ec0-\u0ec4\u0f40-\u0f47\u0f49-\u0f69\u10a0-\u10c5\u10d0-\u10f6\u1100\u1102-\u1103\u1105-\u1107\u1109\u110b-\u110c\u110e-\u1112\u113c\u113e\u1140\u114c\u114e\u1150\u1154-\u1155\u1159\u115f-\u1161\u1163\u1165\u1167\u1169\u116d-\u116e\u1172-\u1173\u1175\u119e\u11a8\u11ab\u11ae-\u11af\u11b7-\u11b8\u11ba\u11bc-\u11c2\u11eb\u11f0\u11f9\u1e00-\u1e9b\u1ea0-\u1ef9\u1f00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2126\u212a-\u212b\u212e\u2180-\u2182\u3041-\u3094\u30a1-\u30fa\u3105-\u312c\uac00-\ud7a3\u4e00-\u9fa5\u3007\u3021-\u3029_]",t.NCNAME=RegExp("^"+t.nameStartChar+t.nameChar+"*$"),t.trim=function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},t.prototype.tokenize=function(e){return t.trim(e).split(/\s+/)},t.prototype.parseSafeCURIEOrCURIEOrURI=function(e,r,n){return"["==(e=t.trim(e)).charAt(0)&&"]"==e.charAt(e.length-1)?0==(e=(e=e.substring(1,e.length-1)).trim(e)).length?null:"_:"==e?this.theOne:this.parseCURIE(e,r,n):this.parseCURIEOrURI(e,r,n)},t.prototype.parseCURIE=function(e,r){var n=e.indexOf(":");if(0<=n){var i=e.substring(0,n);if(""==i)return(i=r[""])?i+e.substring(n+1):null;if("_"==i)return"_:"+e.substring(n+1);if(t.NCNAME.test(i)&&(i=r[i]))return i+e.substring(n+1)}return null},t.prototype.parseCURIEOrURI=function(e,t,r){return(t=this.parseCURIE(e,t,r))?t:this.resolveAndNormalize(r,e)},t.prototype.parsePredicate=function(e,t,r,n,i,o){return""==e?null:(e=this.parseTermOrCURIEOrAbsURI(e,t,o?null:r,n,i))&&0==e.indexOf("_:")?null:e},t.prototype.parseTermOrCURIEOrURI=function(e,r,n,i,o){return e=t.trim(e),(i=this.parseCURIE(e,i,o))||(i=n[e])?i:(i=n[i=e.toLowerCase()])?i:r&&!this.absURIRE.exec(e)?r+e:this.resolveAndNormalize(o,e)},t.prototype.parseTermOrCURIEOrAbsURI=function(e,r,n,i,o){if(e=t.trim(e),i=this.parseCURIE(e,i,o))return i;if(n){if(r&&!this.absURIRE.exec(e))return r+e;if(r=n[e])return r;if(r=n[r=e.toLowerCase()])return r}return this.absURIRE.exec(e)?this.resolveAndNormalize(o,e):null},t.prototype.resolveAndNormalize=function(e,t){var r=e.resolve(t);return(r=this.parseURI(r)).normalize(),r.spec},t.prototype.parsePrefixMappings=function(e,t){for(var r=this.tokenize(e),n=null,i=0;i<r.length;i++)":"==r[i][r[i].length-1]?n=r[i].substring(0,r[i].length-1):n&&(t[n]=this.target.baseURI?this.target.baseURI.resolve(r[i]):r[i],n=null)},t.prototype.copyMappings=function(e){var t,r={};for(t in e)r[t]=e[t];return r},t.prototype.ancestorPath=function(e){for(var t="";e&&e.nodeType!=Node.DOCUMENT_NODE;)t="/"+e.localName+t,e=e.parentNode;return t},t.prototype.setContext=function(e){"html"==e.localName&&"XHTML+RDFa 1.1"==e.getAttribute("version")?this.setXHTMLContext():"html"==e.localName||"http://www.w3.org/1999/xhtml"==e.namespaceURI?document.doctype?"-//W3C//DTD XHTML+RDFa 1.0//EN"==document.doctype.publicId&&"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd"==document.doctype.systemId?(console.log("WARNING: RDF 1.0 is not supported.  Defaulting to HTML5 mode."),this.setHTMLContext()):"-//W3C//DTD XHTML+RDFa 1.1//EN"==document.doctype.publicId&&"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-2.dtd"==document.doctype.systemId?this.setXHTMLContext():this.setHTMLContext():this.setHTMLContext():this.setXMLContext()},t.prototype.setInitialContext=function(){this.vocabulary=null,this.target.graph.prefixes={},this.target.graph.terms={},this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"}],this.target.graph.prefixes[""]="http://www.w3.org/1999/xhtml/vocab#",this.target.graph.prefixes.grddl="http://www.w3.org/2003/g/data-view#",this.target.graph.prefixes.ma="http://www.w3.org/ns/ma-ont#",this.target.graph.prefixes.owl="http://www.w3.org/2002/07/owl#",this.target.graph.prefixes.rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#",this.target.graph.prefixes.rdfa="http://www.w3.org/ns/rdfa#",this.target.graph.prefixes.rdfs="http://www.w3.org/2000/01/rdf-schema#",this.target.graph.prefixes.rif="http://www.w3.org/2007/rif#",this.target.graph.prefixes.skos="http://www.w3.org/2004/02/skos/core#",this.target.graph.prefixes.skosxl="http://www.w3.org/2008/05/skos-xl#",this.target.graph.prefixes.wdr="http://www.w3.org/2007/05/powder#",this.target.graph.prefixes.void="http://rdfs.org/ns/void#",this.target.graph.prefixes.wdrs="http://www.w3.org/2007/05/powder-s#",this.target.graph.prefixes.xhv="http://www.w3.org/1999/xhtml/vocab#",this.target.graph.prefixes.xml="http://www.w3.org/XML/1998/namespace",this.target.graph.prefixes.xsd="http://www.w3.org/2001/XMLSchema#",this.target.graph.prefixes.sd="http://www.w3.org/ns/sparql-service-description#",this.target.graph.prefixes.org="http://www.w3.org/ns/org#",this.target.graph.prefixes.gldp="http://www.w3.org/ns/people#",this.target.graph.prefixes.cnt="http://www.w3.org/2008/content#",this.target.graph.prefixes.dcat="http://www.w3.org/ns/dcat#",this.target.graph.prefixes.earl="http://www.w3.org/ns/earl#",this.target.graph.prefixes.ht="http://www.w3.org/2006/http#",this.target.graph.prefixes.ptr="http://www.w3.org/2009/pointers#",this.target.graph.prefixes.cc="http://creativecommons.org/ns#",this.target.graph.prefixes.ctag="http://commontag.org/ns#",this.target.graph.prefixes.dc="http://purl.org/dc/terms/",this.target.graph.prefixes.dcterms="http://purl.org/dc/terms/",this.target.graph.prefixes.foaf="http://xmlns.com/foaf/0.1/",this.target.graph.prefixes.gr="http://purl.org/goodrelations/v1#",this.target.graph.prefixes.ical="http://www.w3.org/2002/12/cal/icaltzd#",this.target.graph.prefixes.og="http://ogp.me/ns#",this.target.graph.prefixes.rev="http://purl.org/stuff/rev#",this.target.graph.prefixes.sioc="http://rdfs.org/sioc/ns#",this.target.graph.prefixes.v="http://rdf.data-vocabulary.org/#",this.target.graph.prefixes.vcard="http://www.w3.org/2006/vcard/ns#",this.target.graph.prefixes.schema="http://schema.org/",this.target.graph.terms.describedby="http://www.w3.org/2007/05/powder-s#describedby",this.target.graph.terms.license="http://www.w3.org/1999/xhtml/vocab#license",this.target.graph.terms.role="http://www.w3.org/1999/xhtml/vocab#role"},t.prototype.setXMLContext=function(){this.setInitialContext(),this.inHTMLMode=this.inXHTMLMode=!1},t.prototype.setHTMLContext=function(){this.setInitialContext(),this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"},{namespaceURI:null,localName:"lang"}],this.inXHTMLMode=!1,this.inHTMLMode=!0},t.prototype.setXHTMLContext=function(){this.setInitialContext(),this.inXHTMLMode=!0,this.inHTMLMode=!1,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"},{namespaceURI:null,localName:"lang"}],this.target.graph.terms.alternate="http://www.w3.org/1999/xhtml/vocab#alternate",this.target.graph.terms.appendix="http://www.w3.org/1999/xhtml/vocab#appendix",this.target.graph.terms.bookmark="http://www.w3.org/1999/xhtml/vocab#bookmark",this.target.graph.terms.cite="http://www.w3.org/1999/xhtml/vocab#cite",this.target.graph.terms.chapter="http://www.w3.org/1999/xhtml/vocab#chapter",this.target.graph.terms.contents="http://www.w3.org/1999/xhtml/vocab#contents",this.target.graph.terms.copyright="http://www.w3.org/1999/xhtml/vocab#copyright",this.target.graph.terms.first="http://www.w3.org/1999/xhtml/vocab#first",this.target.graph.terms.glossary="http://www.w3.org/1999/xhtml/vocab#glossary",this.target.graph.terms.help="http://www.w3.org/1999/xhtml/vocab#help",this.target.graph.terms.icon="http://www.w3.org/1999/xhtml/vocab#icon",this.target.graph.terms.index="http://www.w3.org/1999/xhtml/vocab#index",this.target.graph.terms.last="http://www.w3.org/1999/xhtml/vocab#last",this.target.graph.terms.license="http://www.w3.org/1999/xhtml/vocab#license",this.target.graph.terms.meta="http://www.w3.org/1999/xhtml/vocab#meta",this.target.graph.terms.next="http://www.w3.org/1999/xhtml/vocab#next",this.target.graph.terms.prev="http://www.w3.org/1999/xhtml/vocab#prev",this.target.graph.terms.previous="http://www.w3.org/1999/xhtml/vocab#previous",this.target.graph.terms.section="http://www.w3.org/1999/xhtml/vocab#section",this.target.graph.terms.stylesheet="http://www.w3.org/1999/xhtml/vocab#stylesheet",this.target.graph.terms.subsection="http://www.w3.org/1999/xhtml/vocab#subsection",this.target.graph.terms.start="http://www.w3.org/1999/xhtml/vocab#start",this.target.graph.terms.top="http://www.w3.org/1999/xhtml/vocab#top",this.target.graph.terms.up="http://www.w3.org/1999/xhtml/vocab#up",this.target.graph.terms.p3pv1="http://www.w3.org/1999/xhtml/vocab#p3pv1",this.target.graph.terms.related="http://www.w3.org/1999/xhtml/vocab#related",this.target.graph.terms.role="http://www.w3.org/1999/xhtml/vocab#role",this.target.graph.terms.transformation="http://www.w3.org/1999/xhtml/vocab#transformation"},t.prototype.init=function(){},t.prototype.newSubjectOrigin=function(){},t.prototype.addTriple=function(){},t.dateTimeTypes=[{pattern:/-?P(?:[0-9]+Y)?(?:[0-9]+M)?(?:[0-9]+D)?(?:T(?:[0-9]+H)?(?:[0-9]+M)?(?:[0-9]+(?:\.[0-9]+)?S)?)?/,type:"http://www.w3.org/2001/XMLSchema#duration"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]-[0-9][0-9]T(?:[0-1][0-9]|2[0-4]):[0-5][0-9]:[0-5][0-9](?:\.[0-9]+)?(?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#dateTime"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]-[0-9][0-9](?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#date"},{pattern:/(?:[0-1][0-9]|2[0-4]):[0-5][0-9]:[0-5][0-9](?:\.[0-9]+)?(?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#time"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]/,type:"http://www.w3.org/2001/XMLSchema#gYearMonth"},{pattern:/-?[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9]/,type:"http://www.w3.org/2001/XMLSchema#gYear"}],t.deriveDateTimeType=function(e){for(var r=0;r<t.dateTimeTypes.length;r++){var n=t.dateTimeTypes[r].pattern.exec(e);if(n&&n[0].length==e.length)return t.dateTimeTypes[r].type}return null},t.prototype.process=function(e,r){e.nodeType==Node.DOCUMENT_NODE?this.setContext(e=e.documentElement):e.parentNode.nodeType==Node.DOCUMENT_NODE&&this.setContext(e);var n=[],i=function(e){var t=e.indexOf("#");return 0<=t&&(e=e.substring(0,t)),r&&r.baseURIMap&&(e=r.baseURIMap(e)),e};for(n.push({current:e,context:this.push(null,i(e.baseURI))});0<n.length;)if((u=n.shift()).parent){if(!u.context.parent||u.context.parent.listMapping!=u.listMapping)for(var o in u.listMapping)if(0==(d=u.listMapping[o]).length)this.addTriple(u.parent,u.subject,o,{type:t.objectURI,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"});else{for(var s=[],a=0;a<d.length;a++)s.push(this.newBlankNode());for(a=0;a<s.length;a++)this.addTriple(u.parent,s[a],"http://www.w3.org/1999/02/22-rdf-syntax-ns#first",d[a]),this.addTriple(u.parent,s[a],"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest",{type:t.objectURI,value:a+1<s.length?s[a+1]:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"});this.addTriple(u.parent,u.subject,o,{type:t.objectURI,value:s[0]})}}else{s=u.current;var u,l=!1,c=null,f=null,h=null,p=(u=u.context).prefixes,d=!1,g=[],v=u.listMapping,y=!u.parent,m=u.language,b=u.vocabulary,w=this.parseURI(i(s.baseURI));for(s.item=null,(a=s.getAttributeNode("vocab"))&&(0<(a=t.trim(a.value)).length?this.addTriple(s,w.spec,"http://www.w3.org/ns/rdfa#usesVocabulary",{type:t.objectURI,value:b=a}):b=this.vocabulary),a=0;a<s.attributes.length;a++)if("x"==(_=s.attributes[a]).nodeName.charAt(0)&&0==_.nodeName.indexOf("xmlns:")){d||(p=this.copyMappings(p),d=!0);var x=_.nodeName.substring(6),_=t.trim(_.value);p[x]=this.target.baseURI?this.target.baseURI.resolve(_):_}for((a=s.getAttributeNode("prefix"))&&(d||(p=this.copyMappings(p),d=!0),this.parsePrefixMappings(a.value,p)),d=null,a=0;!d&&a<this.langAttributes.length;a++)d=s.getAttributeNodeNS(this.langAttributes[a].namespaceURI,this.langAttributes[a].localName);d&&(m=0<(a=t.trim(d.value)).length?a:null),x=s.getAttributeNode("rel"),_=s.getAttributeNode("rev");var k=s.getAttributeNode("typeof"),j=s.getAttributeNode("property"),L=s.getAttributeNode("datatype"),A=this.inHTMLMode?s.getAttributeNode("datetime"):null,I=s.getAttributeNode("content"),E=s.getAttributeNode("about"),C=s.getAttributeNode("src"),O=s.getAttributeNode("resource"),F=s.getAttributeNode("href"),S=s.getAttributeNode("inlist"),R=[];if(x){var T=this.tokenize(x.value);for(a=0;a<T.length;a++)(o=this.parsePredicate(T[a],b,u.terms,p,w,this.inHTMLMode&&null!=j))&&R.push(o)}var M=[];if(_)for(T=this.tokenize(_.value),a=0;a<T.length;a++)(o=this.parsePredicate(T[a],b,u.terms,p,w,this.inHTMLMode&&null!=j))&&M.push(o);if(!this.inHTMLMode||null==x&&null==_||null==j||(0==R.length&&(x=null),0==M.length&&(_=null)),x||_?(E&&(c=this.parseSafeCURIEOrCURIEOrURI(E.value,p,w)),k&&(h=c),c||(s.parentNode.nodeType==Node.DOCUMENT_NODE?c=i(s.baseURI):u.parentObject&&(c=i(s.parentNode.baseURI)==u.parentObject?i(s.baseURI):u.parentObject)),O&&(f=this.parseSafeCURIEOrCURIEOrURI(O.value,p,w)),f||(F?f=this.resolveAndNormalize(w,encodeURI(F.value)):C?f=this.resolveAndNormalize(w,encodeURI(C.value)):!k||E||this.inXHTMLMode&&("head"==s.localName||"body"==s.localName)||(f=this.newBlankNode())),!k||E||!this.inXHTMLMode||"head"!=s.localName&&"body"!=s.localName?k&&!E&&(h=f):h=c):!j||I||L?(E&&(c=this.parseSafeCURIEOrCURIEOrURI(E.value,p,w)),!c&&O&&(c=this.parseSafeCURIEOrCURIEOrURI(O.value,p,w)),!c&&F&&(c=this.resolveAndNormalize(w,encodeURI(F.value))),!c&&C&&(c=this.resolveAndNormalize(w,encodeURI(C.value))),c||(s.parentNode.nodeType==Node.DOCUMENT_NODE?c=i(s.baseURI):!this.inXHTMLMode&&!this.inHTMLMode||"head"!=s.localName&&"body"!=s.localName?k?c=this.newBlankNode():u.parentObject&&(c=i(s.parentNode.baseURI)==u.parentObject?i(s.baseURI):u.parentObject,j||(l=!0)):c=i(s.parentNode.baseURI)==u.parentObject?i(s.baseURI):u.parentObject),k&&(h=c)):(E&&(c=this.parseSafeCURIEOrCURIEOrURI(E.value,p,w),k&&(h=c)),c||s.parentNode.nodeType!=Node.DOCUMENT_NODE?!c&&u.parentObject&&(c=i(s.parentNode.baseURI)==u.parentObject?i(s.baseURI):u.parentObject):(c=i(s.baseURI),k&&(h=c)),k&&!h&&(O&&(h=this.parseSafeCURIEOrCURIEOrURI(O.value,p,w)),!h&&F&&(h=this.resolveAndNormalize(w,encodeURI(F.value))),!h&&C&&(h=this.resolveAndNormalize(w,encodeURI(C.value))),h||!this.inXHTMLMode&&!this.inHTMLMode||"head"!=s.localName&&"body"!=s.localName||(h=c),h||(h=this.newBlankNode()),f=h)),c&&(E||O||h)&&(a=c,k&&!E&&!O&&f&&(a=f),this.newSubjectOrigin(s,a)),h)for(T=this.tokenize(k.value),a=0;a<T.length;a++)(d=this.parseTermOrCURIEOrAbsURI(T[a],b,u.terms,p,w))&&this.addTriple(s,h,t.typeURI,{type:t.objectURI,value:d});if(c&&c!=u.parentObject&&(v={},y=!0),f){if(x&&S)for(a=0;a<R.length;a++)(d=v[R[a]])||(v[R[a]]=d=[]),d.push({type:t.objectURI,value:f});else if(x)for(a=0;a<R.length;a++)this.addTriple(s,c,R[a],{type:t.objectURI,value:f});if(_)for(a=0;a<M.length;a++)this.addTriple(s,f,M[a],{type:t.objectURI,value:c})}else{if(c&&!f&&(x||_)&&(f=this.newBlankNode()),x&&S)for(a=0;a<R.length;a++)(d=v[R[a]])||(v[o]=d=[]),g.push({predicate:R[a],list:d});else if(x)for(a=0;a<R.length;a++)g.push({predicate:R[a],forward:!0});if(_)for(a=0;a<M.length;a++)g.push({predicate:M[a],forward:!1})}if(j)for(M=R=null,L?(R=""==L.value?t.PlainLiteralURI:this.parseTermOrCURIEOrAbsURI(L.value,b,u.terms,p,w),M=A&&!I?A.value:R==t.XMLLiteralURI||R==t.HTMLLiteralURI?null:I?I.value:s.textContent):I?(R=t.PlainLiteralURI,M=I.value):A?(R=t.deriveDateTimeType(M=A.value))||(R=t.PlainLiteralURI):!x&&!_&&(O&&(M=this.parseSafeCURIEOrCURIEOrURI(O.value,p,w)),!M&&F?M=this.resolveAndNormalize(w,encodeURI(F.value)):!M&&C&&(M=this.resolveAndNormalize(w,encodeURI(C.value))),M&&(R=t.objectURI)),R||(k&&!E?(R=t.objectURI,M=h):(M=s.textContent,this.inHTMLMode&&"time"==s.localName&&(R=t.deriveDateTimeType(M)),R||(R=t.PlainLiteralURI))),T=this.tokenize(j.value),a=0;a<T.length;a++)(o=this.parsePredicate(T[a],b,u.terms,p,w))&&(S?((d=v[o])||(v[o]=d=[]),d.push(R==t.XMLLiteralURI||R==t.HTMLLiteralURI?{type:R,value:s.childNodes}:{type:R||t.PlainLiteralURI,value:M,language:m})):this.addTriple(s,c,o,R==t.XMLLiteralURI||R==t.HTMLLiteralURI?{type:R,value:s.childNodes}:{type:R||t.PlainLiteralURI,value:M,language:m}));if(c&&!l)for(a=0;a<u.incomplete.length;a++)u.incomplete[a].list?u.incomplete[a].list.push({type:t.objectURI,value:c}):u.incomplete[a].forward?this.addTriple(s,u.subject,u.incomplete[a].predicate,{type:t.objectURI,value:c}):this.addTriple(s,c,u.incomplete[a].predicate,{type:t.objectURI,value:u.subject});for(h=null,w=c,l?((h=this.push(u,u.subject)).parentObject=i(s.parentNode.baseURI)==u.parentObject?i(s.baseURI):u.parentObject,h.incomplete=u.incomplete,h.language=m,h.prefixes=p):((h=this.push(u,c)).parentObject=f||c||u.subject,h.prefixes=p,h.incomplete=g,f&&(w=f,v={},y=!0),h.listMapping=v,h.language=m),h.vocabulary=b,y&&n.unshift({parent:s,context:u,subject:w,listMapping:v}),s=s.lastChild;s;s=s.previousSibling)s.nodeType==Node.ELEMENT_NODE&&n.unshift({current:s,context:h})}for(this.inHTMLMode&&this.copyProperties(),a=0;a<this.finishedHandlers.length;a++)this.finishedHandlers[a](e)},t.prototype.copyProperties=function(){},t.prototype.push=function(e,t){return{parent:e,subject:t||(e?e.subject:null),parentObject:null,incomplete:[],listMapping:e?e.listMapping:{},language:e?e.language:this.language,prefixes:e?e.prefixes:this.target.graph.prefixes,terms:e?e.terms:this.target.graph.terms,vocabulary:e?e.vocabulary:this.vocabulary}},n.prototype.toString=function(){var e,t="_:"==this.subject.substring(0,2)?this.subject+"":"<"+this.subject+">",r=!0;for(e in this.predicates)r?r=!1:t+=";\n",t+=" "+this.predicates[e];return t+" ."},n.prototype.toObject=function(){var e,r={subject:this.subject,predicates:{}};for(e in this.predicates){var n=this.predicates[e],i={predicate:e,objects:[]};r.predicates[e]=i;for(var o=0;o<n.objects.length;o++){var s=n.objects[o];if(s.type==t.XMLLiteralURI){for(var a=new XMLSerializer,u="",l=0;l<s.value.length;l++)s.value[l].nodeType==Node.ELEMENT_NODE?u+=a.serializeToString(s.value[l]):s.value[l].nodeType==Node.TEXT_NODE&&(u+=s.value[l].nodeValue);i.objects.push({type:s.type,value:u,language:s.language})}else i.objects.push({type:s.type,value:s.value,language:s.language})}}return r},n.prototype.getValues=function(){for(var e=[],t=0;t<arguments.length;t++){var r=this.graph.curieParser.parse(arguments[t],!0);if(r=this.predicates[r])for(var n=0;n<r.objects.length;n++)e.push(r.objects[n].value)}return e},i.getPrefixMap=function(e){for(var t={};e.attributes;){for(var r=0;r<e.attributes.length;r++)if("http://www.w3.org/2000/xmlns/"==e.attributes[r].namespaceURI){var n=e.attributes[r].localName;"xmlns"==e.attributes[r].localName&&(n=""),n in t||(t[n]=e.attributes[r].nodeValue)}e=e.parentNode}return t},i.prototype.toString=function(){for(var e="<"+this.predicate+"> ",t=0;t<this.objects.length;t++)if(0<t&&(e+=", "),"http://www.w3.org/1999/02/22-rdf-syntax-ns#object"==this.objects[t].type)e="_:"==this.objects[t].value.substring(0,2)?e+this.objects[t].value:e+"<"+this.objects[t].value+">";else if("http://www.w3.org/2001/XMLSchema#integer"==this.objects[t].type||"http://www.w3.org/2001/XMLSchema#decimal"==this.objects[t].type||"http://www.w3.org/2001/XMLSchema#double"==this.objects[t].type||"http://www.w3.org/2001/XMLSchema#boolean"==this.objects[t].type)e+=this.objects[t].value;else if("http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral"==this.objects[t].type){for(var r=new XMLSerializer,n="",o=0;o<this.objects[t].value.length;o++)if(this.objects[t].value[o].nodeType==Node.ELEMENT_NODE){var s,a=i.getPrefixMap(this.objects[t].value[o]),u=[];for(s in a)u.push(s);u.sort();for(var l=this.objects[t].value[o].cloneNode(!0),c=0;c<u.length;c++)l.setAttributeNS("http://www.w3.org/2000/xmlns/",0==u[c].length?"xmlns":"xmlns:"+u[c],a[u[c]]);n+=r.serializeToString(l)}else this.objects[t].value[o].nodeType==Node.TEXT_NODE&&(n+=this.objects[t].value[o].nodeValue);e+='"""'+n.replace(/"""/,'\\"\\"\\"')+'"""^^<http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral>'}else e=0<=(r=this.objects[t].value).indexOf("\n")||0<=r.indexOf("\r")?e+'"""'+r.replace(/"""/,'\\"\\"\\"')+'"""':e+'"'+r.replace(/"/,'\\"')+'"',"http://www.w3.org/1999/02/22-rdf-syntax-ns#PlainLiteral"!=this.objects[t].type?e+="^^<"+this.objects[t].type+">":this.objects[t].language&&(e+="@"+this.objects[t].language);return e},(o.prototype=new t).constructor=t,o.prototype.getObjectSize=function(e){var t,r=0;for(t in e)e.hasOwnProperty(t)&&r++;return r},o.prototype.init=function(){this.target.tripleCount=0;var e=this;this.finishedHandlers.push(function(){for(var t in e.target.graph.subjects)0==e.getObjectSize(e.target.graph.subjects[t].predicates)&&delete e.target.graph.subjects[t]})},o.prototype.newSubjectOrigin=function(e,t){for(var r=this.newSubject(null,t),n=0;n<r.origins.length;n++)if(r.origins[n]===e)return;r.origins.push(e),e.data||Object.defineProperty(e,"data",{value:r,writable:!1,configurable:!0,enumerable:!0})},o.prototype.newSubject=function(e,t){var r=this.target.graph.subjects[t];return r||(r=new n(this.target,t),this.target.graph.subjects[t]=r),r},o.prototype.addTriple=function(e,r,n,o){var s=this.newSubject(e,r);(r=s.predicates[n])||(r=new i(n),s.predicates[n]=r);for(var a=0;a<r.objects.length;a++)if(r.objects[a].type==o.type&&r.objects[a].value==o.value)return void(r.objects[a].origin!==e&&(Array.isArray(r.objects[a].origin)||(n=[],n.push(r.objects[a].origin),r.objects[a].origin=n),r.objects[a].origin.push(e)));this.target.tripleCount++,r.objects.push(o),o.origin=e,n==t.typeURI&&s.types.push(o.value)},o.rdfaCopyPredicate="http://www.w3.org/ns/rdfa#copy",o.rdfaPatternType="http://www.w3.org/ns/rdfa#Pattern",o.prototype.copyProperties=function(){var e,r=[],n={};for(e in this.target.graph.subjects){var s=this.target.graph.subjects[e],a=s.predicates[o.rdfaCopyPredicate];if(a){r.push(e);for(var u=0;u<a.objects.length;u++)if(a.objects[u].type==t.objectURI){var l=a.objects[u].value,c=this.target.graph.subjects[l];if(c){var f=c.predicates[t.typeURI];if(f){for(var h=!1,p=0;p<f.objects.length&&!h;p++)f.objects[p].value==o.rdfaPatternType&&f.objects[p].type==t.objectURI&&(h=!0);if(h)for(var d in n[l]=!0,c.predicates)if(l=c.predicates[d],d==t.typeURI){if(1!=l.objects.length)for(p=0;p<l.objects.length;p++)l.objects[p].value!=o.rdfaPatternType&&((f=s.predicates[d])||(f=new i(d),s.predicates[d]=f),f.objects.push({type:l.objects[p].type,value:l.objects[p].value,language:l.objects[p].language,origin:l.objects[p].origin}),s.types.push(l.objects[p].value))}else for((f=s.predicates[d])||(f=new i(d),s.predicates[d]=f),p=0;p<l.objects.length;p++)f.objects.push({type:l.objects[p].type,value:l.objects[p].value,language:l.objects[p].language,origin:l.objects[p].origin})}}}}}for(u=0;u<r.length;u++)delete(s=this.target.graph.subjects[r[u]]).predicates[o.rdfaCopyPredicate];for(e in n)delete this.target.graph.subjects[e]},s.prototype.getProperties=function(){var e,t=[];for(e in this._data_.properties)t.push(e);return t},s.prototype.getSubject=function(){return this._data_.subject},s.prototype.get=function(e){return e=this._data_.owner._data_.graph.curieParser.parse(e,!0),(e=this._data_.properties[e])?e[0]:null},s.prototype.getAll=function(e){return e=this._data_.owner._data_.graph.curieParser.parse(e,!0),this._data_.properties[e]},(a.prototype=new e).constructor=a,a.nameChar="[-A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd\u10000-\uefffF.0-9\xb7\u0300-\u036f\u203f-\u2040]",a.nameStartChar="[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u0131\u0134-\u013e\u0141-\u0148\u014a-\u017e\u0180-\u01c3\u01cd-\u01f0\u01f4-\u01f5\u01fa-\u0217\u0250-\u02a8\u02bb-\u02c1\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03ce\u03d0-\u03d6\u03da\u03dc\u03de\u03e0\u03e2-\u03f3\u0401-\u040c\u040e-\u044f\u0451-\u045c\u045e-\u0481\u0490-\u04c4\u04c7-\u04c8\u04cb-\u04cc\u04d0-\u04eb\u04ee-\u04f5\u04f8-\u04f9\u0531-\u0556\u0559\u0561-\u0586\u05d0-\u05ea\u05f0-\u05f2\u0621-\u063a\u0641-\u064a\u0671-\u06b7\u06ba-\u06be\u06c0-\u06ce\u06d0-\u06d3\u06d5\u06e5-\u06e6\u0905-\u0939\u093d\u0958-\u0961\u0985-\u098c\u098f-\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09dc-\u09dd\u09df-\u09e1\u09f0-\u09f1\u0a05-\u0a0a\u0a0f-\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32-\u0a33\u0a35-\u0a36\u0a38-\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8b\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2-\u0ab3\u0ab5-\u0ab9\u0abd\u0ae0\u0b05-\u0b0c\u0b0f-\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32-\u0b33\u0b36-\u0b39\u0b3d\u0b5c-\u0b5d\u0b5f-\u0b61\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99-\u0b9a\u0b9c\u0b9e-\u0b9f\u0ba3-\u0ba4\u0ba8-\u0baa\u0bae-\u0bb5\u0bb7-\u0bb9\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c60-\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cde\u0ce0-\u0ce1\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d60-\u0d61\u0e01-\u0e2e\u0e30\u0e32-\u0e33\u0e40-\u0e45\u0e81-\u0e82\u0e84\u0e87-\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa-\u0eab\u0ead-\u0eae\u0eb0\u0eb2-\u0eb3\u0ebd\u0ec0-\u0ec4\u0f40-\u0f47\u0f49-\u0f69\u10a0-\u10c5\u10d0-\u10f6\u1100\u1102-\u1103\u1105-\u1107\u1109\u110b-\u110c\u110e-\u1112\u113c\u113e\u1140\u114c\u114e\u1150\u1154-\u1155\u1159\u115f-\u1161\u1163\u1165\u1167\u1169\u116d-\u116e\u1172-\u1173\u1175\u119e\u11a8\u11ab\u11ae-\u11af\u11b7-\u11b8\u11ba\u11bc-\u11c2\u11eb\u11f0\u11f9\u1e00-\u1e9b\u1ea0-\u1ef9\u1f00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2126\u212a-\u212b\u212e\u2180-\u2182\u3041-\u3094\u30a1-\u30fa\u3105-\u312c\uac00-\ud7a3\u4e00-\u9fa5\u3007\u3021-\u3029_]",a.NCNAME=RegExp("^"+t.nameStartChar+t.nameChar+"*$"),a.toProjection=function(e,t,r){var n,i=new s(e,t.subject);for(n in t.predicates){var o=t.predicates[n],a=[];i._data_.properties[n]=a;for(var u=0;u<o.objects.length;u++)a.push(o.objects[u].value)}if(r)for(var l in r)n=e._data_.graph.curieParser.parse(n=r[l],!0),(a=i._data_.properties[n])&&(i[l]=1==a.length?a[0]:a);return i},a.prototype.getProperties=function(e){var t,r=[];if(e){if(e=this._data_.graph.curieParser.parse(e,!0),i=this._data_.graph.subjects[e])for(var n in i.predicates)r.push(n)}else for(t in e={},this._data_.graph.subjects){var i=this._data_.graph.subjects[t];if(i)for(n in i.predicates)e[n]||(e[n]=!0,r.push(n))}return r},a.prototype.getSubjects=function(e,t){var r=[];if(e&&(e=this._data_.graph.curieParser.parse(e,!0)),e&&t){var n,i=this._data_.graph.curieParser.parse(t,!0);for(n in this._data_.graph.subjects)if(a=(a=this._data_.graph.subjects[n]).predicates[e])for(var o=0;o<a.objects.length;o++)if(a.objects[o].value==t||a.objects[o].value==i){r.push(n);break}}else if(e)for(n in this._data_.graph.subjects)(a=(a=this._data_.graph.subjects[n]).predicates[e])&&r.push(n);else if(t)for(n in i=this._data_.graph.curieParser.parse(t,!0),this._data_.graph.subjects){var s,a=this._data_.graph.subjects[n];for(s in a.predicates)if(a=n.predicates[s]){var u=null;for(o=0;!u&&o<a.objects.length;o++)a.objects[o].value!=t&&node.objects[o].value!=i||(u=a.objects[o]);if(u){r.push(n);break}}}else for(n in this._data_.graph.subjects)r.push(n);return r},a.prototype.getValueOrigins=function(e,t){var r=[],n=function(e){if(e)for(var t=0;t<e.objects.length;t++)if(Array.isArray(e.objects[t].origin))for(var n=0;n<e.objects[t].origin.length;n++)r.push({origin:e.objects[t].origin[n],value:e.objects[t].value});else r.push({origin:e.objects[t].origin,value:e.objects[t].value})};if(t&&(t=this._data_.graph.curieParser.parse(t,!0)),e){e=this._data_.graph.curieParser.parse(e,!0);var i=this._data_.graph.subjects[e];if(i)if(t)n(i.predicates[t]);else for(var o in i.predicates)n(i.predicates[o])}else if(t)for(var s in this._data_.graph.subjects)n((i=this._data_.graph.subjects[s]).predicates[t]);else for(s in this._data_.graph.subjects)for(o in(i=this._data_.graph.subjects[s]).predicates)n(i.predicates[o]);return r},a.prototype.getValues=function(e,t){var r=[];if(t&&(t=this._data_.graph.curieParser.parse(t,!0)),e){e=this._data_.graph.curieParser.parse(e,!0);var n=this._data_.graph.subjects[e];if(n)if(t){var i=n.predicates[t];if(i)for(var o=0;o<i.objects.length;o++)r.push(i.objects[o].value)}else for(var s in n.predicates)for(i=n.predicates[s],o=0;o<i.objects.length;o++)r.push(i.objects[o].value)}else if(t){for(var a in this._data_.graph.subjects)if(i=(n=this._data_.graph.subjects[a]).predicates[t])for(o=0;o<i.objects.length;o++)r.push(i.objects[o].value)}else for(a in this._data_.graph.subjects)for(s in(n=this._data_.graph.subjects[a]).predicates)for(i=n.predicates[s],o=0;o<i.objects.length;o++)r.push(i.objects[o].value);return r},Object.defineProperty(a.prototype,"prefixes",{enumerable:!0,get:function(){return Object.keys(this._data_.graph.prefixes)}}),a.prototype.setMapping=function(e,t){this._data_.graph.prefixes[e]=t},a.prototype.getMapping=function(e){return this._data_.graph.prefixes[e]},a.prototype.expand=function(e){return this._data_.graph.curieParser.parse(e,!0)},a.prototype.shorten=function(e){for(prefix in this._data_.graph.prefixes){var t=this._data_.graph.prefixes[prefix];if(0==e.indexOf(t))return prefix+":"+e.substring(t.length)}return e},a.prototype.getSubject=function(e){return e?(e=this._data_.graph.curieParser.parse(e,!0),(e=this._data_.graph.subjects[e])?e:null):null},a.prototype.getProjection=function(e,t){if(!e)return null;e=this._data_.graph.curieParser.parse(e,!0);var r=this._data_.graph.subjects[e];return r?a.toProjection(this,r,t):null},a.prototype.getProjections=function(e,t,r){e&&(e=this._data_.graph.curieParser.parse(e,!0));var n=[];if("undefined"==typeof t&&"undefined"==typeof r&&(r=e),e&&t){var i,o=this._data_.graph.curieParser.parse(t,!0);for(i in this._data_.graph.subjects){var s=this._data_.graph.subjects[i],u=s.predicates[e];if(u)for(var l=0;l<u.objects.length;l++)if(u.objects[l].value==t||u.objects[l].value==o){n.push(a.toProjection(this,s,r));break}}}else if(e)for(i in this._data_.graph.subjects)(s=this._data_.graph.subjects[i]).predicates[e]&&n.push(a.toProjection(this,s,r));else for(i in this._data_.graph.subjects)n.push(a.toProjection(this,s=this._data_.graph.subjects[i],r));return n},a.prototype.merge=function(e,r){var n=0;if(!(s=!(!r||!r.mergeBlankNodes)))for(var i in this._data_.graph.subjects)(u=/_:([0-9]+)/.exec(i))&&(u=parseInt(u[1]))>n&&(n=u);if(e){var o={},s=s?function(e){return e}:function(e){var t=o[e];return!t&&/_:([0-9]+)/.test(e)&&(o[e]=t="_:"+ ++n),t||e};for(i in e){var a=s(i),u=e[i];if(a=this._data_.graph.subjects[i=a||i])for(var l in u.predicates){var c=u.predicates[l],f=a.predicates[l];if(f)for(var h=0;h<c.objects.length;h++){for(var p=c.objects[h],d=[],g=0;g<f.objects.length;g++)p.type!=t.XMLLiteralURI||f.objects[g].type==p.type&&f.objects[g].value===p.value?(f.objects[g].type!=p.type||f.objects[g].value==p.value)&&d.push(p):d.push(p);for(g=0;g<d.length;g++)d[g].type==t.objectURI&&(d[g].value=s(d[g].value)),f.objects.push(d[g])}else for(a.predicates[l]=c,h=0;h<c.objects.length;h++)c.objects[h].type==t.objectURI&&(c.objects[h].value=s(c.objects[h].value))}else for(l in this._data_.graph.subjects[i]=u,u.subject=i,u.predicates)for(c=u.predicates[l],h=0;h<c.objects.length;h++)c.objects[h].type==t.objectURI&&(c.objects[h].value=s(c.objects[h].value))}}if(r&&r.prefixes)for(var v in r.prefixes)this._data_.graph.prefixes[v]||(this._data_.graph.prefixes[v]=r.prefixes[v])},Element.prototype.getElementsByType=function(){var e=arguments,t=this.ownerDocument.createTreeWalker(this,NodeFilter.SHOW_ELEMENT,{acceptNode:function(t){if(!t.data)return NodeFilter.FILTER_SKIP;for(var r=0;r<e.length;r++)if(0<=t.data.types.indexOf(e[r]))return NodeFilter.FILTER_ACCEPT;return NodeFilter.FILTER_SKIP}},!1),r=[];for(r.item=function(e){return this[e]};t.nextNode();)r.push(t.currentNode);return r},Element.prototype.getFirstElementByType=function(){var e=arguments,t=this.ownerDocument.createTreeWalker(this,NodeFilter.SHOW_ELEMENT,{acceptNode:function(t){if(!t.data)return NodeFilter.FILTER_SKIP;for(var r=0;r<e.length;r++)if(0<=t.data.types.indexOf(e[r]))return NodeFilter.FILTER_ACCEPT;return NodeFilter.FILTER_SKIP}},!1);return t.nextNode()?t.currentNode:null},a.attach=function(e,t){Object.defineProperty(e,"data",{value:new a(t&&t.baseURI?t.baseURI:e.nodeType==Node.DOCUMENT_NODE?e.documentElement.baseURI:e.graph.baseURI),writable:!1,configurable:!1,enumerable:!0}),e.getElementsByType=function(e){return this.getElementsByProperty("http://www.w3.org/1999/02/22-rdf-syntax-ns#type",e)},e.getElementsBySubject=function(e){var t=[];if(t.item=function(e){return this[e]},e=this.data._data_.graph.curieParser.parse(e,!0),e=this.data._data_.graph.subjects[e])for(var r=0;r<e.origins.length;r++)t.push(e.origins[r]);return t},e.getElementsByProperty=function(e,t){var r=[];r.item=function(e){return this[e]},t&&(t=this.data._data_.graph.curieParser.parse(t,!1));var n,i="undefined"==typeof t;for(n in e=this.data._data_.graph.curieParser.parse(e,!0),this.data._data_.graph.subjects){var o=this.data._data_.graph.subjects[n].predicates[e];if(o)for(var s=0;s<o.objects.length;s++)(i||o.objects[s].value==t)&&(Array.isArray(o.objects[s].origin)?r.push.apply(r,o.objects[s].origin):r.push(o.objects[s].origin))}return r},e.getElementSubject=function(e){for(var t in this.data._data_.graph.subjects)if(0<=this.data._data_.graph.subjects[t].origins.indexOf(e))return t;return null}},(u.prototype=new e).constructor=u,u.commentRE=/^#.*/,u.wsRE=/^\s+/,u.iriRE=/^\<((?:(?:[^\x00-\x20<>"{}|^`\\]|\\u[0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f]|\\U[0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f])*))\>/,u.singleQuoteLiteralRE=/^'((?:[^'\n\r\\]*|\\'|\\)*)'/,u.doubleQuoteLiteralRE=/^\"((?:[^"\n\r\\]*|\\"|\\)*)\"/,u.longDoubleQuoteLiteralRE=/^\"\"\"((?:[^"\\]*|\\"|\\|\"(?!\")|\"\"(?!\"))*)\"\"\"/,u.longSingleQuoteLiteralRE=/^'''((?:[^'\\]*|\\'|\\|'(?!')|''(?!'))*)'''/,u.typeRE=/^\^\^/,u.dotRE=/^\./,u.openSquareBracketRE=/^\[/,u.closeSquareBracketRE=/^\]/,u.prefixRE=/^((?:(?:[A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD]|[\ud800-\udfff][\ud800-\udfff])(?:(?:[A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD]|[\ud800-\udfff][\ud800-\udfff]|[_\.\-\u00B7]|[0-9]|[\u0300-\u036F]|[\u203F-\u2040])*(?:[A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD]|[\ud800-\udfff][\ud800-\udfff]|[_\-\u00B7]|[0-9]|[\u0300-\u036F]|[\u203F-\u2040]))?)?):/,u.blankNodeRE=/^(_:)/,u.localNameRE=/^((?:[A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD]|[\ud800-\udfff][\ud800-\udfff]|[_:]|[0-9]|%[0-9A-Fa-f][0-9A-Fa-f]|\\[_~\.\-!$&'()*+,;=\/?#@%])(?:(?:[A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD]|[\ud800-\udfff][\ud800-\udfff]|[_\-\.:\u00b7]|[\u0300-\u036F]|[\u203F-\u2040]|[0-9]|%[0-9A-Fa-f][0-9A-Fa-f]|\\[_~\.\-!$&'()*+,;=/?#@%])*(?:[A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD]|[\ud800-\udfff][\ud800-\udfff]|[_\-:\u00b7]|[\u0300-\u036F]|[\u203F-\u2040]|[0-9]|%[0-9A-Fa-f][0-9A-Fa-f]|\\[_~\.\-!$&'()*+,;=/?#@%]))?)/,u.langRE=/^@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)/,u.prefixIDRE=/^@prefix/,u.baseRE=/^@base/,u.sparqlPrefixRE=/^[Pp][Rr][Ee][Ff][Ii][Xx]/,u.sparqlBaseRE=/^[Bb][Aa][Ss][Ee]/,u.semicolonRE=/^;/,u.commaRE=/^,/,u.aRE=/^a/,u.openParenRE=/^\(/,u.closeParenRE=/^\)/,u.integerRE=/^([+-]?[0-9]+)/,u.decimalRE=/^([+-]?[0-9]*\.[0-9]+)/,u.doubleRE=/^([+-]?(?:[0-9]+\.[0-9]*[eE][+-]?[0-9]+|\.[0-9]+[eE][+-]?[0-9]+|[0-9]+[eE][+-]?[0-9]+))/,u.booleanRE=/^(true|false)/,u.typeURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",u.objectURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#object",u.plainLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#PlainLiteral",u.nilURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil",u.firstURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#first",u.restURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#rest",u.xsdStringURI="http://www.w3.org/2001/XMLSchema#string",u.xsdIntegerURI="http://www.w3.org/2001/XMLSchema#integer",u.xsdDecimalURI="http://www.w3.org/2001/XMLSchema#decimal",u.xsdDoubleURI="http://www.w3.org/2001/XMLSchema#double",u.xsdBooleanURI="http://www.w3.org/2001/XMLSchema#boolean",u.prototype.reset=function(){this.context=new r,this.errorCount=this.blankNodeCounter=0,this.lineNumber=1},u.dumpGraph=function(e){for(var t in e)console.log(e[t].toString())},u.prototype.newBlankNode=function(){return this.blankNodeCounter++,"_:"+this.blankNodeCounter},u.prototype._match=function(e,t){var r=e.exec(t);return r?{text:r[0],remaining:t.substring(r[0].length),values:1<r.length?r.splice(1):null}:null},u.prototype._trim=function(e){var t=null;do{(t=u.wsRE.exec(e))&&(this.lineNumber+=t[0].split(/\n/).length-1,e=e.substring(t[0].length)),(t=u.commentRE.exec(e))&&(e=e.substring(t[0].length))}while(t);return e},u.prototype.reportError=function(e){this.onError(this.lineNumber,e)},u.prototype.parse=function(e,t){for(t&&(this.context.baseURI=this.parseURI(t));0<e.length;)0<(e=this._trim(e)).length&&(e=this.parseStatement(e))},u.prototype.parseStatement=function(e){if(t=this._match(u.prefixIDRE,e)){var t,r=this._trim(t.remaining);if(!(t=this.parsePrefixName(r)))return this.reportError("Cannot parse prefix after @prefix: "+e.substring(20)+"..."),this.errorCount++,r;if(e=t.prefix,r=this._trim(t.remaining),!(t=this.parseIRIReference(r)))return this.reportError("Cannot parse IRI after @prefix: "+r.substring(20)+"..."),this.errorCount++,r;this.context.prefixes[e]=this.context.baseURI?this.context.baseURI.resolve(t.iri):t.iri;try{this.parseURI(this.context.prefixes[e])}catch(e){this.reportError(e.toString()),this.errorCount++}return r=this._trim(t.remaining),(t=this._match(u.dotRE,r))?t.remaining:(this.reportError("Missing end . for @prefix statement.  Found: "+r.substring(0,20)+"..."),this.errorCount++,r)}if(t=this._match(u.baseRE,e)){if(r=this._trim(t.remaining),!(t=this.parseIRIReference(r)))return this.reportError("Cannot parse IRI after @base: "+r.substring(0,20)+"..."),this.errorCount++,r;try{this.context.baseURI=this.parseURI(this.context.baseURI?this.context.baseURI.resolve(t.iri):t.iri)}catch(e){this.reportError(e+"; IRI: "+t.iri),this.errorCount++}return r=this._trim(t.remaining),(t=this._match(u.dotRE,r))?t.remaining:(this.reportError("Missing end . for @base statement.  Found: "+r.substring(0,20)+"..."),this.errorCount++,r)}if(t=this._match(u.sparqlPrefixRE,e)){if(r=this._trim(t.remaining),!(t=this.parsePrefixName(r)))return this.reportError("Cannot parse prefix after PREFIX: "+e.substring(0,20)+"..."),this.errorCount++,r;if(e=t.prefix,r=this._trim(t.remaining),!(t=this.parseIRIReference(r)))return this.reportError("Cannot parse IRI after PREFIX: "+r.substring(0,20)+"..."),this.errorCount++,r;this.context.prefixes[e]=this.context.baseURI?this.context.baseURI.resolve(t.iri):t.iri;try{this.parseURI(this.context.prefixes[e])}catch(e){this.reportError(e.toString()),this.errorCount++}return t.remaining}if(t=this._match(u.sparqlBaseRE,e)){if(r=this._trim(t.remaining),!(t=this.parseIRIReference(r)))return this.reportError("Cannot parse IRI after BASE: "+r.substring(0,20)+"..."),this.errorCount++,r;try{this.context.baseURI=this.parseURI(this.context.baseURI?this.context.baseURI.resolve(t.iri):t.iri)}catch(e){this.reportError(e+"; IRI: "+t.iri),this.errorCount++}return t.remaining}return e=this.parseTriples(e),e=this._trim(e),(t=this._match(u.dotRE,e))?t.remaining:(this.reportError("Missing end . triples.  Found: "+e.substring(0,20)+"..."),this.errorCount++,e)},u.prototype.parseTriples=function(e){var t=this.parseIRI(e);if(t||(t=this.parseBlankNode(e)))return this.parsePredicateObjectList(t.iri,this._trim(t.remaining));if(t=this._match(u.openParenRE,e)){e=null;var r=t.remaining,n=null;do{if(r=this._trim(r),t=this._match(u.closeParenRE,r)){r=t.remaining,n?this.addTriple(n,u.restURI,{type:u.objectURI,value:u.nilURI}):e=this.newBlankNode();break}t=this.newBlankNode(),n?this.addTriple(n,u.restURI,{type:u.objectURI,value:t}):e=t,r=this.parseObject(n=t,u.firstURI,r)}while(0<r.length);return this.parsePredicateObjectList(e,this._trim(r))}return(t=this._match(u.openSquareBracketRE,e))?(e=this.newBlankNode(),r=this._trim(t.remaining),(t=this._match(u.closeSquareBracketRE,r))?r=t.remaining:(r=this.parsePredicateObjectList(e,r),(t=this._match(u.closeSquareBracketRE,this._trim(r)))?r=t.remaining:this.reportError("Missing end square bracket ']'.")),this.parsePredicateObjectList(e,this._trim(r),!0)):t?this.parsePredicateObjectList(t.iri,this._trim(t.remaining)):(this.reportError("Terminating: Cannot parse at "+e.substring(0,20)+" ..."),this.errorCount++,"")},u.prototype.parsePredicateObjectList=function(e,t,r){var n=!0,i=null;do{var o=this.parseIRI(t);if(!o&&(o=this._match(u.aRE,t))&&(o.iri=u.typeURI),!o)return r?t:(this.reportError("Terminating: Cannot parse predicate IRI."),this.errorCount++,"");if(i=this.parseObjectList(e,o.iri,this._trim(o.remaining)),o=this._match(u.semicolonRE,this._trim(i))){do{t=this._trim(o.remaining),o=this._match(u.semicolonRE,t)}while(o);r=!0}else n=!1}while(n);return i},u.prototype.parseObjectList=function(e,t,r){var n=!0,i=null;do{i=this.parseObject(e,t,r);var o=this._match(u.commaRE,this._trim(i));o?r=this._trim(o.remaining):n=!1}while(n);return i},u.prototype.parseObject=function(e,t,r){var n=this.parseIRI(r);if(n||(n=this.parseBlankNode(r)))return this.addTriple(e,t,{type:u.objectURI,value:n.iri}),n.remaining;if(n=this._match(u.openParenRE,r)){var i=e,o=n.remaining;do{if(o=this._trim(o),n=this._match(u.closeParenRE,o))return this.addTriple(i,i==e?t:u.restURI,{type:u.objectURI,value:u.nilURI}),n.remaining;n=this.newBlankNode(),i==e?this.addTriple(e,t,{type:u.objectURI,value:n}):this.addTriple(i,u.restURI,{type:u.objectURI,value:n}),o=this.parseObject(i=n,u.firstURI,o)}while(0<o.length)}return(n=this._match(u.openSquareBracketRE,r))?(r=this.newBlankNode(),this.addTriple(e,t,{type:u.objectURI,value:r}),o=this.parsePredicateObjectList(r,this._trim(n.remaining),!0),o=this._trim(o),(n=this._match(u.closeSquareBracketRE,o))?n.remaining:(this.reportError("Missing close square bracket ']' for blank node "+r+" predicate object list"),this.errorCount++,o)):(n=this.parseLiteral(r))?(this.addTriple(e,t,{type:n.type?n.type:u.plainLiteralURI,value:n.literal,language:n.language}),n.remaining):(this.reportError("Terminating: Cannot parse literal at "+r.substring(0,20)),this.errorCount++,"")},u.prototype.parsePrefixName=function(e){return(e=this._match(u.prefixRE,e))&&(e.prefix=e.values[0]),e},u.prototype.parseIRIReference=function(e){return(e=this._match(u.iriRE,e))&&(e.iri=u.expandURI(e.values[0])),e},u.prototype.parseIRI=function(e){var t=this._match(u.iriRE,e);if(t){e=u.expandURI(t.values[0]),t.iri=this.context.baseURI?this.context.baseURI.resolve(e):e;try{this.parseURI(t.iri)}catch(e){this.reportError(e.toString()),this.errorCount++}return t}if(t=this._match(u.prefixRE,e)){var r=t.values[0];if(!(e=this.context.prefixes[r]))return this.reportError("No prefix mapping for "+r),this.errorCount++,null;if(t=this._match(u.localNameRE,r=t.remaining)){t.iri=e+u.expandName(t.values[0]);try{this.parseURI(t.iri)}catch(e){this.reportError(e.toString()),this.errorCount++}return t}return{iri:e,remaining:r}}return null},u.prototype.parseBlankNode=function(e){return(e=this._match(u.blankNodeRE,e))&&(e=this._match(u.localNameRE,e.remaining))?(e.iri="_:"+u.expandName(e.values[0]),e):null},u.prototype.parseLiteral=function(e){var t=this._match(u.longDoubleQuoteLiteralRE,e);if(t||(t=this._match(u.longSingleQuoteLiteralRE,e)),t||(t=this._match(u.singleQuoteLiteralRE,e)),t||(t=this._match(u.doubleQuoteLiteralRE,e)),t){e=null;try{e=u.expandLiteral(t.values[0])}catch(e){this.reportError(e.toString()),this.errorCount++}var r=t.remaining;if(t=this._match(u.langRE,r))return t.literal=e,t.language=t.values[0],t;if(t=this._match(u.typeRE,r)){if(t=this.parseIRI(r=t.remaining))return t.literal=e,t.type=t.iri,t;this.reportError("Missing type URI after ^^"),this.errorCount++}return{literal:e,remaining:r}}return(t=this._match(u.doubleRE,e))?(t.literal=t.values[0],t.type=u.xsdDoubleURI,t):(t=this._match(u.decimalRE,e))?(t.literal=t.values[0],t.type=u.xsdDecimalURI,t):(t=this._match(u.integerRE,e))?(t.literal=t.values[0],t.type=u.xsdIntegerURI,t):(t=this._match(u.booleanRE,e))?(t.literal=t.values[0],t.type=u.xsdBooleanURI,t):null},u.prototype.newSubject=function(e){var t=this.context.subjects[e];return t||(t=new n(this.context,e),this.context.subjects[e]=t),t},u.expandHex=function(e){for(var t=e.split(/[0-9A-Fa-f]+/),r=0;r<t.length;r++)if(0<t[r].length)throw"Bad hex in escape: "+e;if(t=parseInt(e,16),isNaN(t))throw"Bad hex in escape: "+e;return 65536>t?String.fromCharCode(t):(t=1023&(e=t-65536),String.fromCharCode(55296+(e>>10))+String.fromCharCode(t+56320))},u.escapedSequenceRE=/(\\t|\\b|\\n|\\r|\\f|\\"|\\'|\\\\|(?:\\U[0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f])|(?:\\u[0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f]))/,u.expandLiteral=function(e){e=e.split(u.escapedSequenceRE);for(var t="",r=0;r<e.length;r++)if(0!=e[r].length)if("\\t"==e[r])t+="\t";else if("\\b"==e[r])t+="\b";else if("\\n"==e[r])t+="\n";else if("\\r"==e[r])t+="\r";else if("\\f"==e[r])t+="\f";else if('\\"'==e[r])t+='"';else if("\\'"==e[r])t+="'";else if("\\\\"==e[r])t+="\\";else if(6==e[r].length&&"\\"==e[r].charAt(0)&&"u"==e[r].charAt(1))t+=u.expandHex(e[r].substring(2));else if(10==e[r].length&&"\\"==e[r].charAt(0)&&"U"==e[r].charAt(1))t+=u.expandHex(e[r].substring(2));else{var n=e[r].substring(0,2);if(2==n.length&&"\\U"==n)throw"Bad hex in \\U escape "+e[r].substring(0,10);if(2==n.length&&"\\u"==n)throw"Bad hex in \\u escape "+e[r].substring(0,6);if(0<=(n=e[r].indexOf("\\")))throw"Bad escape "+e[r].substring(n,n+2);t+=e[r]}return t},u.escapedURIRE=/((?:\\U[0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f])|(?:\\u[0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f][0-9A-Fa-f]))/,u.expandURI=function(e){e=e.split(u.escapedURIRE);for(var t="",r=0;r<e.length;r++)if(0!=e[r].length)if(6==e[r].length&&"\\"==e[r].charAt(0)&&"u"==e[r].charAt(1))t+=u.expandHex(e[r].substring(2));else if(10==e[r].length&&"\\"==e[r].charAt(0)&&"U"==e[r].charAt(1))t+=u.expandHex(e[r].substring(2));else{var n=e[r].substring(0,2);if(2==n.length&&"\\U"==n)throw"Bad hex in \\U escape "+e[r].substring(0,10);if(2==n.length&&"\\u"==n)throw"Bad hex in \\u escape "+e[r].substring(0,6);if(0<=(n=e[r].indexOf("\\")))throw"Bad escape "+e[r].substring(n,n+2);t+=e[r]}return t},u.escapedNameCharRE=/(\\[_~\.\-!$&'()*+,;=/?#@%])/,u.expandName=function(e){e=e.split(u.escapedNameCharRE);for(var t="",r=0;r<e.length;r++)0!=e[r].length&&(t="\\"==e[r].charAt(0)?t+e[r].charAt(1):t+e[r]);return t},u.prototype.addTriple=function(e,t,r){var n=(e=this.newSubject(e)).predicates[t];n||(n=new i(t),e.predicates[t]=n),n.objects.push(r),t==u.typeURI&&e.types.push(r.value)};var c={attach:function(e,t){var r=e.implementation.hasFeature;e.implementation.hasFeature=function(e,t){return"RDFaAPI"==e&&"1.1"==t||r.apply(this,arguments)};var n=!!e.data;if(e.head){var i=e.createElement("meta");i.setAttribute("name","green-turtle-rdfa-message"),e.head.appendChild(i);var s=function(){var t=e.createEvent("Event");return t.initEvent("green-turtle-rdfa-extension",!0,!0),t};i.addEventListener("green-turtle-rdfa-document",function(){var t=JSON.parse(i.getAttribute("content"));if("status"==t.type){var r=s();i.setAttribute("content",'{ "type": "status", "loaded": '+n+', "count": '+e.data._data_.tripleCount+" }"),setTimeout(function(){i.dispatchEvent(r)},1)}else if("get-subjects"==t.type){var o=e.data.getSubjects();i.setAttribute("content",'{ "type": "subjects", "subjects": '+JSON.stringify(o)+" }");var a=s();setTimeout(function(){i.dispatchEvent(a)},1)}else if("get-subject"==t.type){var u=null;if(e.data.getSubject)u=e.data.getSubject(t.subject).toObject();else{u={subject:t.subject,predicates:{}};for(var l=e.data.getProjection(t.subject),c=l.getProperties(),f=0;f<c.length;f++){var h=[];u.predicates[c[f]]={predicate:predicate,objects:h};for(var p=l.getAll(c[f]),d=0;d<p.length;d++)h.push(o[p[d]]?{type:"http://www.w3.org/1999/02/22-rdf-syntax-ns#object",value:p[d]}:{type:"http://www.w3.org/1999/02/22-rdf-syntax-ns#PlainLiteral",value:p[d]})}}i.setAttribute("content",JSON.stringify({type:"subject",subject:t.subject,triples:u}));var g=s();setTimeout(function(){i.dispatchEvent(g)},1)}},!1)}e.data?e.data._data_&&e.data._data_.graph.clear():a.attach(e,t);var u=function(){var r=new o(e.data._data_);r.finishedHandlers.push(function(){for(var r in c.processors)c.processors[r].process(e,t)}),r.finishedHandlers.push(function(e){if(e.ownerDocument){var t=e.ownerDocument.createEvent("HTMLEvents");t.initEvent("rdfa.loaded",!0,!0),e.ownerDocument.dispatchEvent(t)}}),r.process(e.documentElement,t),n=!0};"loading"==e.readyState?window.addEventListener("load",function(){u()},!1):u()},parse:function(e,t,r){var n=this.processors[t];if(!n)throw"Unsupported media type "+t;if(n=n.createParser(),r&&r.errorHandler&&(n.onError=r.errorHandler),n.parse(e,r=r?r.baseURI:null),0<n.errorCount)throw r?"Errors during parsing "+r+" of type "+t:"Errors during parsing of type "+t;return n.context},createDocumentData:function(e){return new a(e||(window?window.location.href:"about:blank"))}};return Object.defineProperty(c,"processors",{value:{},writable:!1,configurable:!1,enumerable:!0}),c.processors["text/turtle"]={createParser:function(){return new u},process:function(e,t){var r=e.nodeType==Node.DOCUMENT_NODE?e:e.ownerDocument;if(r.data){for(var n=!0,i=r.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","script"),o=0;o<i.length;o++)if("text/turtle"==i[o].getAttribute("type")){var s=this.createParser();t&&t.errorHandler&&(s.onError=t.errorHandler),s.parse(i[o].textContent,t?t.baseURI:null),0<s.errorCount?n=!1:r.data.merge(s.context.subjects,{prefixes:s.context.prefixes})}return n}}},Object.defineProperty(l,"implementation",{value:c,writable:!1,configurable:!1,enumerable:!0}),l.attach=function(e,t){c.attach(e,t)},l}();GreenTurtle.attach(document),function(){function e(){}function t(e){return e}function r(){return this}function n(){return!0}function i(e){return"function"==typeof e?e:function(){return e}}function o(e,t,r){return function(){var n=r.apply(t,arguments);return arguments.length?e:n}}function s(e){return null!=e&&!isNaN(e)}function a(e){return e.length}function u(e){return null==e}function l(e){return e.replace(/(^\s+)|(\s+$)/g,"").replace(/\s+/g," ")}function c(){}function f(t){function r(){for(var e,r=n,i=-1,o=r.length;++i<o;)(e=r[i].on)&&e.apply(this,arguments);return t}var n=[],i=new e;return r.on=function(e,r){var o,s=i.get(e);return arguments.length<2?s&&s.on:(s&&(s.on=null,n=n.slice(0,o=n.indexOf(s)).concat(n.slice(o+1)),i.remove(e)),r&&n.push(i.set(e,{on:r})),t)},r}function h(e,t){return t-(e?1+Math.floor(Math.log(e+Math.pow(10,1+Math.floor(Math.log(e)/Math.LN10)-t))/Math.LN10):1)}function p(e){return e+""}function g(e){for(var t=e.lastIndexOf("."),r=t>=0?e.substring(t):(t=e.length,""),n=[];t>0;)n.push(e.substring(t-=3,t+3));return n.reverse().join(",")+r}function v(e){return function(t){return 1-e(1-t)}}function y(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function m(e){return e}function b(e){return function(t){return Math.pow(t,e)}}function w(e){return 1-Math.cos(e*Math.PI/2)}function x(e){return Math.pow(2,10*(e-1))}function _(e){return 1-Math.sqrt(1-e*e)}function k(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function j(){d3.event.stopPropagation(),d3.event.preventDefault()}function L(){for(var e,t=d3.event;e=t.sourceEvent;)t=e;return t}function A(e){for(var t=new c,r=0,n=arguments.length;++r<n;)t[arguments[r]]=f(t);return t.of=function(r,n){return function(i){try{var o=i.sourceEvent=d3.event;i.target=e,d3.event=i,t[i.type].apply(r,n)}finally{d3.event=o}}},t}function I(e){return"transform"==e?d3.interpolateTransform:d3.interpolate}function E(e,t){return t=t-(e=+e)?1/(t-e):0,function(r){return(r-e)*t}}function C(e,t){return t=t-(e=+e)?1/(t-e):0,function(r){return Math.max(0,Math.min(1,(r-e)*t))}}function O(e,t,r){return new F(e,t,r)}function F(e,t,r){this.r=e,this.g=t,this.b=r}function S(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function R(e,t,r){var n,i,o,s=0,a=0,u=0;if(n=/([a-z]+)\((.*)\)/i.exec(e))switch(i=n[2].split(","),n[1]){case"hsl":return r(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return t(M(i[0]),M(i[1]),M(i[2]))}return(o=jr.get(e))?t(o.r,o.g,o.b):(null!=e&&"#"===e.charAt(0)&&(4===e.length?(s=e.charAt(1),s+=s,a=e.charAt(2),a+=a,u=e.charAt(3),u+=u):7===e.length&&(s=e.substring(1,3),a=e.substring(3,5),u=e.substring(5,7)),s=parseInt(s,16),a=parseInt(a,16),u=parseInt(u,16)),t(s,a,u))}function T(e,t,r){var n,i,o=Math.min(e/=255,t/=255,r/=255),s=Math.max(e,t,r),a=s-o,u=(s+o)/2;return a?(i=u<.5?a/(s+o):a/(2-s-o),n=e==s?(t-r)/a+(t<r?6:0):t==s?(r-e)/a+2:(e-t)/a+4,n*=60):i=n=0,N(n,i,u)}function M(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?Math.round(2.55*t):t}function N(e,t,r){return new D(e,t,r)}function D(e,t,r){this.h=e,this.s=t,this.l=r}function P(e,t,r){function n(e){return Math.round(255*function(e){return e>360?e-=360:e<0&&(e+=360),e<60?i+(o-i)*e/60:e<180?o:e<240?i+(o-i)*(240-e)/60:i}(e))}var i,o;return(e%=360)<0&&(e+=360),t=t<0?0:t>1?1:t,i=2*(r=r<0?0:r>1?1:r)-(o=r<=.5?r*(1+t):r+t-r*t),O(n(e+120),n(e),n(e-120))}function U(e){return lr(e,Or),e}function Q(e){return function(){return Lr(e,this)}}function B(e){return function(){return Ar(e,this)}}function W(e,t){function r(){if(t=this.classList)return t.add(e);var t=this.className,r=null!=t.baseVal,n=r?t.baseVal:t;i.lastIndex=0,i.test(n)||(n=l(n+" "+e),r?t.baseVal=n:this.className=n)}function n(){if(t=this.classList)return t.remove(e);var t=this.className,r=null!=t.baseVal,n=r?t.baseVal:t;n=l(n.replace(i," ")),r?t.baseVal=n:this.className=n}var i=new RegExp("(^|\\s+)"+d3.requote(e)+"(\\s+|$)","g");if(arguments.length<2){var o=this.node();if(s=o.classList)return s.contains(e);var s=o.className;return i.lastIndex=0,i.test(null!=s.baseVal?s.baseVal:s)}return this.each("function"==typeof t?function(){(t.apply(this,arguments)?r:n).call(this)}:t?r:n)}function q(e){return{__data__:e}}function X(e){return lr(e,Rr),e}function G(t,r,n){lr(t,Mr);var i=new e,o=d3.dispatch("start","end"),s=Qr;return t.id=r,t.time=n,t.tween=function(e,r){return arguments.length<2?i.get(e):(null==r?i.remove(e):i.set(e,r),t)},t.ease=function(e){return arguments.length?(s="function"==typeof e?e:d3.ease.apply(d3,arguments),t):s},t.each=function(e,r){return arguments.length<2?(function(e){var t=Dr,r=Qr,n=Pr,i=Ur;Dr=this.id,Qr=this.ease();for(var o=0,s=this.length;o<s;o++)for(var a=this[o],u=0,l=a.length;u<l;u++){var c=a[u];c&&(Pr=this[o][u].delay,Ur=this[o][u].duration,e.call(c=c.node,c.__data__,u,o))}return Dr=t,Qr=r,Pr=n,Ur=i,this}).call(t,e):(o.on(e,r),t)},d3.timer(function(e){return t.each(function(a,u,l){function c(e){return y.active>r?h():(y.active=r,i.forEach(function(e,t){(t=t.call(d,a,u))&&p.push(t)}),o.start.call(d,a,u),f(e)||d3.timer(f,0,n),1)}function f(e){if(y.active!==r)return h();for(var t=(e-g)/v,n=s(t),i=p.length;i>0;)p[--i].call(d,n);return t>=1?(h(),Dr=r,o.end.call(d,a,u),Dr=0,1):void 0}function h(){return--y.count||delete d.__transition__,1}var p=[],d=this,g=t[l][u].delay,v=t[l][u].duration,y=d.__transition__||(d.__transition__={active:0,count:0});++y.count,g<=e?c(e):d3.timer(c,g,n)}),1},0,n),t}function z(e,t,r){return""!=r&&Tr}function H(e,t){var r=I(e);return"function"==typeof t?function(e,n,i){var o=t.call(this,e,n);return null==o?""!=i&&Tr:i!=o&&r(i,o)}:null==t?z:(t+="",function(e,n,i){return i!=t&&r(i,t)})}function V(){for(var e,t=Date.now(),r=qr;r;)(e=t-r.then)>=r.delay&&(r.flush=r.callback(e)),r=r.next;var n=$()-t;n>24?(isFinite(n)&&(clearTimeout(Wr),Wr=setTimeout(V,n)),Br=0):(Br=1,Xr(V))}function $(){for(var e=null,t=qr,r=1/0;t;)t.flush?t=e?e.next=t.next:qr=t.next:(r=Math.min(r,t.then+t.delay),t=(e=t).next);return r}function J(e){var t=[e.a,e.b],r=[e.c,e.d],n=K(t),i=Y(t,r),o=K(function(e,t,r){return e[0]+=r*t[0],e[1]+=r*t[1],e}(r,t,-i))||0;t[0]*r[1]<r[0]*t[1]&&(t[0]*=-1,t[1]*=-1,n*=-1,i*=-1),this.rotate=(n?Math.atan2(t[1],t[0]):Math.atan2(-r[0],r[1]))*Gr,this.translate=[e.e,e.f],this.scale=[n,o],this.skew=o?Math.atan2(i,o)*Gr:0}function Y(e,t){return e[0]*t[0]+e[1]*t[1]}function K(e){var t=Math.sqrt(Y(e,e));return t&&(e[0]/=t,e[1]/=t),t}function Z(e,t){var r=e.ownerSVGElement||e;if(r.createSVGPoint){var n=r.createSVGPoint();if(zr<0&&(window.scrollX||window.scrollY)){var i=(r=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0))[0][0].getScreenCTM();zr=!i.f&&!i.e,r.remove()}return zr?(n.x=t.pageX,n.y=t.pageY):(n.x=t.clientX,n.y=t.clientY),[(n=n.matrixTransform(e.getScreenCTM().inverse())).x,n.y]}var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]}function ee(e){var t=e[0],r=e[e.length-1];return t<r?[t,r]:[r,t]}function te(e){return e.rangeExtent?e.rangeExtent():ee(e.range())}function re(e,t){var r,n=0,i=e.length-1,o=e[n],s=e[i];return s<o&&(r=n,n=i,i=r,r=o,o=s,s=r),(r=s-o)&&(t=t(r),e[n]=t.floor(o),e[i]=t.ceil(s)),e}function ne(){return Math}function ie(e,t){return d3.rebind(e,t,"range","rangeRound","interpolate","clamp")}function oe(e){return e=Math.pow(10,Math.round(Math.log(e)/Math.LN10)-1),{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}}function se(e,t){var r=ee(e),n=r[1]-r[0],i=Math.pow(10,Math.floor(Math.log(n/t)/Math.LN10)),o=t/n*i;return o<=.15?i*=10:o<=.35?i*=5:o<=.75&&(i*=2),r[0]=Math.ceil(r[0]/i)*i,r[1]=Math.floor(r[1]/i)*i+.5*i,r[2]=i,r}function ae(e,t){return d3.range.apply(d3,se(e,t))}function ue(e,t){return d3.format(",."+Math.max(0,-Math.floor(Math.log(se(e,t)[2])/Math.LN10+.01))+"f")}function le(e,t,r,n){var i=r(e[0],e[1]),o=n(t[0],t[1]);return function(e){return o(i(e))}}function ce(e,t,r,n){var i=[],o=[],s=0,a=Math.min(e.length,t.length)-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<=a;)i.push(r(e[s-1],e[s])),o.push(n(t[s-1],t[s]));return function(t){var r=d3.bisect(e,t,1,a)-1;return o[r](i[r](t))}}function fe(e){return Math.log(e<0?0:e)/Math.LN10}function he(e){return-Math.log(e>0?0:-e)/Math.LN10}function pe(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function de(e){return e.innerRadius}function ge(e){return e.outerRadius}function ve(e){return e.startAngle}function ye(e){return e.endAngle}function me(e){function t(t){function n(){c.push("M",u(e(f),l))}for(var a,c=[],f=[],h=-1,p=t.length,d=i(r),g=i(o);++h<p;)s.call(this,a=t[h],h)?f.push([+d.call(this,a,h),+g.call(this,a,h)]):f.length&&(n(),f=[]);return f.length&&n(),c.length?c.join(""):null}var r=be,o=we,s=n,a=en,u=xe,l=.7;return t.x=function(e){return arguments.length?(r=e,t):r},t.y=function(e){return arguments.length?(o=e,t):o},t.defined=function(e){return arguments.length?(s=e,t):s},t.interpolate=function(e){return arguments.length?(tn.has(e+="")||(e=en),u=tn.get(a=e),t):a},t.tension=function(e){return arguments.length?(l=e,t):l},t}function be(e){return e[0]}function we(e){return e[1]}function xe(e){for(var t=0,r=e.length,n=e[0],i=[n[0],",",n[1]];++t<r;)i.push("L",(n=e[t])[0],",",n[1]);return i.join("")}function _e(e){for(var t=0,r=e.length,n=e[0],i=[n[0],",",n[1]];++t<r;)i.push("V",(n=e[t])[1],"H",n[0]);return i.join("")}function ke(e){for(var t=0,r=e.length,n=e[0],i=[n[0],",",n[1]];++t<r;)i.push("H",(n=e[t])[0],"V",n[1]);return i.join("")}function je(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return xe(e);var r=e.length!=t.length,n="",i=e[0],o=e[1],s=t[0],a=s,u=1;if(r&&(n+="Q"+(o[0]-2*s[0]/3)+","+(o[1]-2*s[1]/3)+","+o[0]+","+o[1],i=e[1],u=2),t.length>1){o=e[u],u++,n+="C"+(i[0]+s[0])+","+(i[1]+s[1])+","+(o[0]-(a=t[1])[0])+","+(o[1]-a[1])+","+o[0]+","+o[1];for(var l=2;l<t.length;l++,u++)n+="S"+((o=e[u])[0]-(a=t[l])[0])+","+(o[1]-a[1])+","+o[0]+","+o[1]}if(r){var c=e[u];n+="Q"+(o[0]+2*a[0]/3)+","+(o[1]+2*a[1]/3)+","+c[0]+","+c[1]}return n}function Le(e,t){for(var r,n=[],i=(1-t)/2,o=e[0],s=e[1],a=1,u=e.length;++a<u;)r=o,o=s,n.push([i*((s=e[a])[0]-r[0]),i*(s[1]-r[1])]);return n}function Ae(e){if(e.length<3)return xe(e);var t=1,r=e.length,n=e[0],i=n[0],o=n[1],s=[i,i,i,(n=e[1])[0]],a=[o,o,o,n[1]],u=[i,",",o];for(Ee(u,s,a);++t<r;)n=e[t],s.shift(),s.push(n[0]),a.shift(),a.push(n[1]),Ee(u,s,a);for(t=-1;++t<2;)s.shift(),s.push(n[0]),a.shift(),a.push(n[1]),Ee(u,s,a);return u.join("")}function Ie(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Ee(e,t,r){e.push("C",Ie(rn,t),",",Ie(rn,r),",",Ie(nn,t),",",Ie(nn,r),",",Ie(on,t),",",Ie(on,r))}function Ce(e,t){return(t[1]-e[1])/(t[0]-e[0])}function Oe(e){for(var t,r,n,i=-1,o=e.length;++i<o;)n=(t=e[i])[1]+Kr,t[0]=(r=t[0])*Math.cos(n),t[1]=r*Math.sin(n);return e}function Fe(e){function t(t){function n(){v.push("M",c(e(m),p),h,f(e(y.reverse()),p),"Z")}for(var l,d,g,v=[],y=[],m=[],b=-1,w=t.length,x=i(r),_=i(s),k=r===o?function(){return d}:i(o),j=s===a?function(){return g}:i(a);++b<w;)u.call(this,l=t[b],b)?(y.push([d=+x.call(this,l,b),g=+_.call(this,l,b)]),m.push([+k.call(this,l,b),+j.call(this,l,b)])):y.length&&(n(),y=[],m=[]);return y.length&&n(),v.length?v.join(""):null}var r=be,o=be,s=0,a=we,u=n,l=en,c=xe,f=xe,h="L",p=.7;return t.x=function(e){return arguments.length?(r=o=e,t):o},t.x0=function(e){return arguments.length?(r=e,t):r},t.x1=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(s=a=e,t):a},t.y0=function(e){return arguments.length?(s=e,t):s},t.y1=function(e){return arguments.length?(a=e,t):a},t.defined=function(e){return arguments.length?(u=e,t):u},t.interpolate=function(e){return arguments.length?(tn.has(e+="")||(e=en),c=tn.get(l=e),f=c.reverse||c,h=/-closed$/.test(e)?"M":"L",t):l},t.tension=function(e){return arguments.length?(p=e,t):p},t}function Se(e){return e.source}function Re(e){return e.target}function Te(e){return e.radius}function Me(e){return[e.x,e.y]}function Ne(){return 64}function De(){return"circle"}function Pe(e){var t=Math.sqrt(e/Math.PI);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Ue(e,t){e.attr("transform",function(e){return"translate("+t(e)+",0)"})}function Qe(e,t){e.attr("transform",function(e){return"translate(0,"+t(e)+")"})}function Be(e){for(var t=e.source,r=e.target,n=function(e,t){if(e===t)return e;for(var r=We(e),n=We(t),i=r.pop(),o=n.pop(),s=null;i===o;)s=i,i=r.pop(),o=n.pop();return s}(t,r),i=[t];t!==n;)i.push(t=t.parent);for(var o=i.length;r!==n;)i.splice(o,0,r),r=r.parent;return i}function We(e){for(var t=[],r=e.parent;null!=r;)t.push(e),e=r,r=r.parent;return t.push(e),t}function qe(e){e.fixed|=2}function Xe(e){e!==pn&&(e.fixed&=1)}function Ge(){pn.fixed&=1,hn=pn=null}function ze(){pn.px=d3.event.x,pn.py=d3.event.y,hn.resume()}function He(e){return 20}function Ve(e){return 1}function $e(e){return e.x}function Je(e){return e.y}function Ye(e,t,r){e.y0=t,e.y=r}function Ke(e){return d3.range(e.length)}function Ze(e){for(var t=-1,r=e[0].length,n=[];++t<r;)n[t]=0;return n}function et(e){for(var t,r=1,n=0,i=e[0][1],o=e.length;r<o;++r)(t=e[r][1])>i&&(n=r,i=t);return n}function tt(e){return e.reduce(rt,0)}function rt(e,t){return e+t[1]}function nt(e,t){return it(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function it(e,t){for(var r=-1,n=+e[0],i=(e[1]-n)/t,o=[];++r<=t;)o[r]=i*r+n;return o}function ot(e){return[d3.min(e),d3.max(e)]}function st(e,t){return d3.rebind(e,t,"sort","children","value"),e.links=ct,e.nodes=function(t){return mn=!0,(e.nodes=e)(t)},e}function at(e){return e.children}function ut(e){return e.value}function lt(e,t){return t.value-e.value}function ct(e){return d3.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function ft(e,t){return e.value-t.value}function ht(e,t){var r=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=r,r._pack_prev=t}function pt(e,t){e._pack_next=t,t._pack_prev=e}function dt(e,t){var r=t.x-e.x,n=t.y-e.y,i=e.r+t.r;return i*i-r*r-n*n>.001}function gt(e){e._pack_next=e._pack_prev=e}function vt(e){delete e._pack_next,delete e._pack_prev}function yt(e){var t=e.children;t&&t.length?(t.forEach(yt),e.r=function(e){function t(e){a=Math.min(e.x-e.r,a),u=Math.max(e.x+e.r,u),l=Math.min(e.y-e.r,l),c=Math.max(e.y+e.r,c)}var r,n,i,o,s,a=1/0,u=-1/0,l=1/0,c=-1/0,f=e.length;if(e.forEach(gt),(r=e[0]).x=-r.r,r.y=0,t(r),f>1&&((n=e[1]).x=n.r,n.y=0,t(n),f>2)){mt(r,n,i=e[2]),t(i),ht(r,i),r._pack_prev=i,ht(i,n),n=r._pack_next;for(var h=3;h<f;h++){mt(r,n,i=e[h]);var p=0,d=1,g=1;for(o=n._pack_next;o!==n;o=o._pack_next,d++)if(dt(o,i)){p=1;break}if(1==p)for(s=r._pack_prev;s!==o._pack_prev&&!dt(s,i);s=s._pack_prev,g++);p?(d<g||d==g&&n.r<r.r?pt(r,n=o):pt(r=s,n),h--):(ht(r,i),n=i,t(i))}}var v=(a+u)/2,y=(l+c)/2,m=0;for(h=0;h<f;h++){var b=e[h];b.x-=v,b.y-=y,m=Math.max(m,b.r+Math.sqrt(b.x*b.x+b.y*b.y))}return e.forEach(vt),m}(t)):e.r=Math.sqrt(e.value)}function mt(e,t,r){var n=e.r+r.r,i=t.x-e.x,o=t.y-e.y;if(n&&(i||o)){var s=t.r+r.r,a=Math.sqrt(i*i+o*o),u=Math.max(-1,Math.min(1,(n*n+a*a-s*s)/(2*n*a))),l=Math.acos(u),c=u*(n/=a),f=Math.sin(l)*n;r.x=e.x+c*i+f*o,r.y=e.y+c*o-f*i}else r.x=e.x+n,r.y=e.y}function bt(e,t){return e.parent==t.parent?1:2}function wt(e){var t=e.children;return t&&t.length?t[0]:e._tree.thread}function xt(e){var t,r=e.children;return r&&(t=r.length)?r[t-1]:e._tree.thread}function _t(e,t){var r=e.children;if(r&&(i=r.length))for(var n,i,o=-1;++o<i;)t(n=_t(r[o],t),e)>0&&(e=n);return e}function kt(e,t){return e.x-t.x}function jt(e,t){return t.x-e.x}function Lt(e,t){return e.depth-t.depth}function At(e,t){!function e(r,n){var i=r.children;if(i&&(s=i.length))for(var o,s,a=null,u=-1;++u<s;)e(o=i[u],a),a=o;t(r,n)}(e,null)}function It(e,t,r){var n=r/((t=t._tree).number-(e=e._tree).number);e.change+=n,t.change-=n,t.shift+=r,t.prelim+=r,t.mod+=r}function Et(e,t,r){return e._tree.ancestor.parent==t.parent?e._tree.ancestor:r}function Ct(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function Ot(e,t){var r=e.x+t[3],n=e.y+t[0],i=e.dx-t[1]-t[3],o=e.dy-t[0]-t[2];return i<0&&(r+=i/2,i=0),o<0&&(n+=o/2,o=0),{x:r,y:n,dx:i,dy:o}}function Ft(e){return e.map(St).join(",")}function St(e){return/[",\n]/.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}function Rt(e,t){return function(r){return r&&e.hasOwnProperty(r.type)?e[r.type](r):t}}function Tt(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Mt(e,t){wn.hasOwnProperty(e.type)&&wn[e.type](e,t)}function Nt(e,t){for(var r=e.coordinates,n=0,i=r.length;n<i;n++)t.apply(null,r[n])}function Dt(e){return e.source}function Pt(e){return e.target}function Ut(e,t){function r(e){var t=Math.sin(g-(e*=g))/v,r=Math.sin(e)/v,n=t*a*i+r*p*c,s=t*a*o+r*p*f,l=t*u+r*d;return[Math.atan2(s,n)/bn,Math.atan2(l,Math.sqrt(n*n+s*s))/bn]}var n=e[0]*bn,i=Math.cos(n),o=Math.sin(n),s=e[1]*bn,a=Math.cos(s),u=Math.sin(s),l=t[0]*bn,c=Math.cos(l),f=Math.sin(l),h=t[1]*bn,p=Math.cos(h),d=Math.sin(h),g=r.d=Math.acos(Math.max(-1,Math.min(1,u*d+a*p*Math.cos(l-n)))),v=Math.sin(g);return r}function Qt(e,t,r,n){var i,o,s,a,u;return o=(i=n[e])[0],s=i[1],a=(i=n[t])[0],u=i[1],((i=n[r])[1]-s)*(a-o)-(u-s)*(i[0]-o)>0}function Bt(e,t,r){return(r[0]-t[0])*(e[1]-t[1])<(r[1]-t[1])*(e[0]-t[0])}function Wt(e,t,r,n){var i=e[0],o=r[0],s=e[1],a=r[1],u=t[0]-i,l=n[0]-o,c=t[1]-s,f=n[1]-a,h=(l*(s-a)-f*(i-o))/(f*u-l*c);return[i+h*u,s+h*c]}function qt(e,t){var r={list:e.map(function(e,t){return{index:t,x:e[0],y:e[1]}}).sort(function(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}),bottomSite:null},n={list:[],leftEnd:null,rightEnd:null,init:function(){n.leftEnd=n.createHalfEdge(null,"l"),n.rightEnd=n.createHalfEdge(null,"l"),n.leftEnd.r=n.rightEnd,n.rightEnd.l=n.leftEnd,n.list.unshift(n.leftEnd,n.rightEnd)},createHalfEdge:function(e,t){return{edge:e,side:t,vertex:null,l:null,r:null}},insert:function(e,t){t.l=e,t.r=e.r,e.r.l=t,e.r=t},leftBound:function(e){var t=n.leftEnd;do{t=t.r}while(t!=n.rightEnd&&i.rightOf(t,e));return t.l},del:function(e){e.l.r=e.r,e.r.l=e.l,e.edge=null},right:function(e){return e.r},left:function(e){return e.l},leftRegion:function(e){return null==e.edge?r.bottomSite:e.edge.region[e.side]},rightRegion:function(e){return null==e.edge?r.bottomSite:e.edge.region[kn[e.side]]}},i={bisect:function(e,t){var r={region:{l:e,r:t},ep:{l:null,r:null}},n=t.x-e.x,i=t.y-e.y,o=n>0?n:-n,s=i>0?i:-i;return r.c=e.x*n+e.y*i+.5*(n*n+i*i),o>s?(r.a=1,r.b=i/n,r.c/=n):(r.b=1,r.a=n/i,r.c/=i),r},intersect:function(e,t){var r=e.edge,n=t.edge;if(!r||!n||r.region.r==n.region.r)return null;var i=r.a*n.b-r.b*n.a;if(Math.abs(i)<1e-10)return null;var o,s,a=(r.c*n.b-n.c*r.b)/i,u=r.region.r,l=n.region.r;u.y<l.y||u.y==l.y&&u.x<l.x?(o=e,s=r):(o=t,s=n);var c=a>=s.region.r.x;return c&&"l"===o.side||!c&&"r"===o.side?null:{x:a,y:(n.c*r.a-r.c*n.a)/i}},rightOf:function(e,t){var r=e.edge,n=r.region.r,i=t.x>n.x;if(i&&"l"===e.side)return 1;if(!i&&"r"===e.side)return 0;if(1===r.a){var o=t.y-n.y,s=t.x-n.x,a=0,u=0;if(!i&&r.b<0||i&&r.b>=0?u=a=o>=r.b*s:(u=t.x+t.y*r.b>r.c,r.b<0&&(u=!u),u||(a=1)),!a){var l=n.x-r.region.l.x;u=r.b*(s*s-o*o)<l*o*(1+2*s/l+r.b*r.b),r.b<0&&(u=!u)}}else{var c=r.c-r.a*t.x,f=t.y-c,h=t.x-n.x,p=c-n.y;u=f*f>h*h+p*p}return"l"===e.side?u:!u},endPoint:function(e,r,n){e.ep[r]=n,e.ep[kn[r]]&&t(e)},distance:function(e,t){var r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)}},o={list:[],insert:function(e,t,r){e.vertex=t,e.ystar=t.y+r;for(var n=0,i=o.list,s=i.length;n<s;n++){var a=i[n];if(!(e.ystar>a.ystar||e.ystar==a.ystar&&t.x>a.vertex.x))break}i.splice(n,0,e)},del:function(e){for(var t=0,r=o.list,n=r.length;t<n&&r[t]!=e;++t);r.splice(t,1)},empty:function(){return 0===o.list.length},nextEvent:function(e){for(var t=0,r=o.list,n=r.length;t<n;++t)if(r[t]==e)return r[t+1];return null},min:function(){var e=o.list[0];return{x:e.vertex.x,y:e.ystar}},extractMin:function(){return o.list.shift()}};n.init(),r.bottomSite=r.list.shift();for(var s,a,u,l,c,f,h,p,d,g,v,y,m,b=r.list.shift();;)if(o.empty()||(s=o.min()),b&&(o.empty()||b.y<s.y||b.y==s.y&&b.x<s.x))a=n.leftBound(b),u=n.right(a),h=n.rightRegion(a),y=i.bisect(h,b),f=n.createHalfEdge(y,"l"),n.insert(a,f),(g=i.intersect(a,f))&&(o.del(a),o.insert(a,g,i.distance(g,b))),a=f,f=n.createHalfEdge(y,"r"),n.insert(a,f),(g=i.intersect(f,u))&&o.insert(f,g,i.distance(g,b)),b=r.list.shift();else{if(o.empty())break;a=o.extractMin(),l=n.left(a),u=n.right(a),c=n.right(u),h=n.leftRegion(a),p=n.rightRegion(u),i.endPoint(a.edge,a.side,v=a.vertex),i.endPoint(u.edge,u.side,v),n.del(a),o.del(u),n.del(u),m="l",h.y>p.y&&(d=h,h=p,p=d,m="r"),y=i.bisect(h,p),f=n.createHalfEdge(y,m),n.insert(l,f),i.endPoint(y,kn[m],v),(g=i.intersect(l,f))&&(o.del(l),o.insert(l,g,i.distance(g,h))),(g=i.intersect(f,c))&&o.insert(f,g,i.distance(g,h))}for(a=n.right(n.leftEnd);a!=n.rightEnd;a=n.right(a))t(a.edge)}function Xt(e){return{x:e[0],y:e[1]}}function Gt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function zt(e,t,r,n){for(var i,o,s=0,a=t.length,u=r.length;s<a;){if(n>=u)return-1;if(37==(i=t.charCodeAt(s++))){if(!(o=Fn[t.charAt(s++)])||(n=o(e,r,n))<0)return-1}else if(i!=r.charCodeAt(n++))return-1}return n}function Ht(e,t,r){Un.lastIndex=0;var n=Un.exec(t.substring(r,r+2));return n?(e.d=+n[0],r+=n[0].length):-1}function Vt(e,t,r){Un.lastIndex=0;var n=Un.exec(t.substring(r,r+2));return n?(e.H=+n[0],r+=n[0].length):-1}function $t(e){return e.toISOString()}function Jt(e,t,r){function n(t){var r=e(t),n=o(r,1);return t-r<n-t?r:n}function i(r){return t(r=e(new jn(r-1)),1),r}function o(e,r){return t(e=new jn(+e),r),e}function s(e,n,o){var s=i(e),a=[];if(o>1)for(;s<n;)r(s)%o||a.push(new Date(+s)),t(s,1);else for(;s<n;)a.push(new Date(+s)),t(s,1);return a}e.floor=e,e.round=n,e.ceil=i,e.offset=o,e.range=s;var a=e.utc=Yt(e);return a.floor=a,a.round=Yt(n),a.ceil=Yt(i),a.offset=Yt(o),a.range=function(e,t,r){try{jn=Gt;var n=new Gt;return n._=e,s(n,t,r)}finally{jn=Date}},e}function Yt(e){return function(t,r){try{jn=Gt;var n=new Gt;return n._=t,e(n,r)._}finally{jn=Date}}}function Kt(e,t,r){function n(t){return e(t)}return n.invert=function(t){return er(e.invert(t))},n.domain=function(t){return arguments.length?(e.domain(t),n):e.domain().map(er)},n.nice=function(e){var t=Zt(n.domain());return n.domain([e.floor(t[0]),e.ceil(t[1])])},n.ticks=function(r,i){var o=Zt(n.domain());if("function"!=typeof r){var s=(o[1]-o[0])/r,a=d3.bisect(Wn,s);if(a==Wn.length)return t.year(o,r);if(!a)return e.ticks(r).map(er);Math.log(s/Wn[a-1])<Math.log(Wn[a]/s)&&--a,i=(r=t[a])[1],r=r[0].range}return r(o[0],new Date(+o[1]+1),i)},n.tickFormat=function(){return r},n.copy=function(){return Kt(e.copy(),t,r)},d3.rebind(n,e,"range","rangeRound","interpolate","clamp")}function Zt(e){var t=e[0],r=e[e.length-1];return t<r?[t,r]:[r,t]}function er(e){return new Date(e)}function tr(e){return function(t){for(var r=e.length-1,n=e[r];!n[1](t);)n=e[--r];return n[0](t)}}function rr(e){var t=new Date(e,0,1);return t.setFullYear(e),t}function nr(e){var t=e.getFullYear(),r=rr(t);return t+(e-r)/(rr(t+1)-r)}function ir(e){var t=new Date(Date.UTC(e,0,1));return t.setUTCFullYear(e),t}function or(e){var t=e.getUTCFullYear(),r=ir(t);return t+(e-r)/(ir(t+1)-r)}Date.now||(Date.now=function(){return+new Date});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(e){var sr=CSSStyleDeclaration.prototype,ar=sr.setProperty;sr.setProperty=function(e,t,r){ar.call(this,e,t+"",r)}}d3={version:"2.9.1"};var ur=function(e){return Array.prototype.slice.call(e)};try{ur(document.documentElement.childNodes)}catch(e){ur=function(e){for(var t=-1,r=e.length,n=[];++t<r;)n.push(e[t]);return n}}var lr=[].__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)e[r]=t[r]};d3.map=function(t){var r=new e;for(var n in t)r.set(n,t[n]);return r},function(e,t){try{for(var r in t)Object.defineProperty(e.prototype,r,{value:t[r],enumerable:!1})}catch(r){e.prototype=t}}(e,{has:function(e){return cr+e in this},get:function(e){return this[cr+e]},set:function(e,t){return this[cr+e]=t},remove:function(e){return(e=cr+e)in this&&delete this[e]},keys:function(){var e=[];return this.forEach(function(t){e.push(t)}),e},values:function(){var e=[];return this.forEach(function(t,r){e.push(r)}),e},entries:function(){var e=[];return this.forEach(function(t,r){e.push({key:t,value:r})}),e},forEach:function(e){for(var t in this)t.charCodeAt(0)===fr&&e.call(this,t.substring(1),this[t])}});var cr="\0",fr=cr.charCodeAt(0);d3.functor=i,d3.rebind=function(e,t){for(var r,n=1,i=arguments.length;++n<i;)e[r=arguments[n]]=o(e,t,t[r]);return e},d3.ascending=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},d3.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},d3.mean=function(e,t){var r,n=e.length,i=0,o=-1,a=0;if(1===arguments.length)for(;++o<n;)s(r=e[o])&&(i+=(r-i)/++a);else for(;++o<n;)s(r=t.call(e,e[o],o))&&(i+=(r-i)/++a);return a?i:void 0},d3.median=function(e,t){return arguments.length>1&&(e=e.map(t)),(e=e.filter(s)).length?d3.quantile(e.sort(d3.ascending),.5):void 0},d3.min=function(e,t){var r,n,i=-1,o=e.length;if(1===arguments.length){for(;++i<o&&(null==(r=e[i])||r!=r);)r=void 0;for(;++i<o;)null!=(n=e[i])&&r>n&&(r=n)}else{for(;++i<o&&(null==(r=t.call(e,e[i],i))||r!=r);)r=void 0;for(;++i<o;)null!=(n=t.call(e,e[i],i))&&r>n&&(r=n)}return r},d3.max=function(e,t){var r,n,i=-1,o=e.length;if(1===arguments.length){for(;++i<o&&(null==(r=e[i])||r!=r);)r=void 0;for(;++i<o;)null!=(n=e[i])&&n>r&&(r=n)}else{for(;++i<o&&(null==(r=t.call(e,e[i],i))||r!=r);)r=void 0;for(;++i<o;)null!=(n=t.call(e,e[i],i))&&n>r&&(r=n)}return r},d3.extent=function(e,t){var r,n,i,o=-1,s=e.length;if(1===arguments.length){for(;++o<s&&(null==(r=i=e[o])||r!=r);)r=i=void 0;for(;++o<s;)null!=(n=e[o])&&(r>n&&(r=n),i<n&&(i=n))}else{for(;++o<s&&(null==(r=i=t.call(e,e[o],o))||r!=r);)r=void 0;for(;++o<s;)null!=(n=t.call(e,e[o],o))&&(r>n&&(r=n),i<n&&(i=n))}return[r,i]},d3.random={normal:function(e,t){return arguments.length<2&&(t=1),arguments.length<1&&(e=0),function(){var r,n,i;do{i=(r=2*Math.random()-1)*r+(n=2*Math.random()-1)*n}while(!i||i>1);return e+t*r*Math.sqrt(-2*Math.log(i)/i)}}},d3.sum=function(e,t){var r,n=0,i=e.length,o=-1;if(1===arguments.length)for(;++o<i;)isNaN(r=+e[o])||(n+=r);else for(;++o<i;)isNaN(r=+t.call(e,e[o],o))||(n+=r);return n},d3.quantile=function(e,t){var r=(e.length-1)*t+1,n=Math.floor(r),i=e[n-1],o=r-n;return o?i+o*(e[n]-i):i},d3.transpose=function(e){return d3.zip.apply(d3,e)},d3.zip=function(){if(!(n=arguments.length))return[];for(var e=-1,t=d3.min(arguments,a),r=new Array(t);++e<t;)for(var n,i=-1,o=r[e]=new Array(n);++i<n;)o[i]=arguments[i][e];return r},d3.bisector=function(e){return{left:function(t,r,n,i){for(arguments.length<3&&(n=0),arguments.length<4&&(i=t.length);n<i;){var o=n+i>>1;e.call(t,t[o],o)<r?n=o+1:i=o}return n},right:function(t,r,n,i){for(arguments.length<3&&(n=0),arguments.length<4&&(i=t.length);n<i;){var o=n+i>>1;r<e.call(t,t[o],o)?i=o:n=o+1}return n}}};var hr=d3.bisector(function(e){return e});d3.bisectLeft=hr.left,d3.bisect=d3.bisectRight=hr.right,d3.first=function(e,t){var r,n=0,i=e.length,o=e[0];for(1===arguments.length&&(t=d3.ascending);++n<i;)t.call(e,o,r=e[n])>0&&(o=r);return o},d3.last=function(e,t){var r,n=0,i=e.length,o=e[0];for(1===arguments.length&&(t=d3.ascending);++n<i;)t.call(e,o,r=e[n])<=0&&(o=r);return o},d3.nest=function(){function t(s,a){if(a>=o.length)return n?n.call(i,s):r?s.sort(r):s;for(var u,l,c,f=-1,h=s.length,p=o[a++],d=new e,g={};++f<h;)(c=d.get(u=p(l=s[f])))?c.push(l):d.set(u,[l]);return d.forEach(function(e){g[e]=t(d.get(e),a)}),g}var r,n,i={},o=[],s=[];return i.map=function(e){return t(e,0)},i.entries=function(e){return function e(t,r){if(r>=o.length)return t;var n,i=[],a=s[r++];for(n in t)i.push({key:n,values:e(t[n],r)});return a&&i.sort(function(e,t){return a(e.key,t.key)}),i}(t(e,0),0)},i.key=function(e){return o.push(e),i},i.sortKeys=function(e){return s[o.length-1]=e,i},i.sortValues=function(e){return r=e,i},i.rollup=function(e){return n=e,i},i},d3.keys=function(e){var t=[];for(var r in e)t.push(r);return t},d3.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},d3.entries=function(e){var t=[];for(var r in e)t.push({key:r,value:e[r]});return t},d3.permute=function(e,t){for(var r=[],n=-1,i=t.length;++n<i;)r[n]=e[t[n]];return r},d3.merge=function(e){return Array.prototype.concat.apply([],e)},d3.split=function(e,t){var r,n=[],i=[],o=-1,s=e.length;for(arguments.length<2&&(t=u);++o<s;)t.call(i,r=e[o],o)?i=[]:(i.length||n.push(i),i.push(r));return n},d3.range=function(e,t,r){if(arguments.length<3&&(r=1,arguments.length<2&&(t=e,e=0)),(t-e)/r==1/0)throw new Error("infinite range");var n,i=[],o=function(e){for(var t=1;e*t%1;)t*=10;return t}(Math.abs(r)),s=-1;if(e*=o,t*=o,(r*=o)<0)for(;(n=e+r*++s)>t;)i.push(n/o);else for(;(n=e+r*++s)<t;)i.push(n/o);return i},d3.requote=function(e){return e.replace(pr,"\\$&")};var pr=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)},d3.xhr=function(e,t,r){var n=new XMLHttpRequest;arguments.length<3?(r=t,t=null):t&&n.overrideMimeType&&n.overrideMimeType(t),n.open("GET",e,!0),t&&n.setRequestHeader("Accept",t),n.onreadystatechange=function(){if(4===n.readyState){var e=n.status;r(e>=200&&e<300||304===e?n:null)}},n.send(null)},d3.text=function(e,t,r){arguments.length<3&&(r=t,t=null),d3.xhr(e,t,function(e){r(e&&e.responseText)})},d3.json=function(e,t){d3.text(e,"application/json",function(e){t(e?JSON.parse(e):null)})},d3.html=function(e,t){d3.text(e,"text/html",function(e){if(null!=e){var r=document.createRange();r.selectNode(document.body),e=r.createContextualFragment(e)}t(e)})},d3.xml=function(e,t,r){arguments.length<3&&(r=t,t=null),d3.xhr(e,t,function(e){r(e&&e.responseXML)})};var dr={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:dr,qualify:function(e){var t=e.indexOf(":"),r=e;return t>=0&&(r=e.substring(0,t),e=e.substring(t+1)),dr.hasOwnProperty(r)?{space:dr[r],local:e}:e}},d3.dispatch=function(){for(var e=new c,t=-1,r=arguments.length;++t<r;)e[arguments[t]]=f(e);return e},c.prototype.on=function(e,t){var r=e.indexOf("."),n="";return r>0&&(n=e.substring(r+1),e=e.substring(0,r)),arguments.length<2?this[e].on(n):this[e].on(n,t)},d3.format=function(e){var t=gr.exec(e),r=t[1]||" ",n=t[3]||"",i=t[5],o=+t[6],s=t[7],a=t[8],u=t[9],l=1,c="",f=!1;switch(a&&(a=+a.substring(1)),i&&(r="0",s&&(o-=Math.floor((o-1)/4))),u){case"n":s=!0,u="g";break;case"%":l=100,c="%",u="f";break;case"p":l=100,c="%",u="r";break;case"d":f=!0,a=0;break;case"s":l=-1,u="r"}return"r"==u&&!a&&(u="g"),u=vr.get(u)||p,function(e){if(f&&e%1)return"";var t,h=e<0&&(e=-e)?"\u2212":n;if(l<0){var p=d3.formatPrefix(e,a);e*=p.scale,c=p.symbol}else e*=l;return e=u(e,a),i?((t=e.length+h.length)<o&&(e=new Array(o-t+1).join(r)+e),s&&(e=g(e)),e=h+e):(s&&(e=g(e)),(t=(e=h+e).length)<o&&(e=new Array(o-t+1).join(r)+e)),e+c}};var gr=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,vr=d3.map({g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return d3.round(e,t=h(e,t)).toFixed(Math.max(0,Math.min(20,t)))}}),yr=["y","z","a","f","p","n","\u03bc","m","","k","M","G","T","P","E","Z","Y"].map(function(e,t){return{scale:Math.pow(10,3*(8-t)),symbol:e}});d3.formatPrefix=function(e,t){var r=0;return e&&(e<0&&(e*=-1),t&&(e=d3.round(e,h(e,t))),r=1+Math.floor(1e-12+Math.log(e)/Math.LN10),r=Math.max(-24,Math.min(24,3*Math.floor((r<=0?r+1:r-1)/3)))),yr[8+r/3]};var mr=b(2),br=b(3),wr=function(){return m},xr=d3.map({linear:wr,poly:b,quad:function(){return mr},cubic:function(){return br},sin:function(){return w},exp:function(){return x},circle:function(){return _},elastic:function(e,t){var r;return arguments.length<2&&(t=.45),arguments.length<1?(e=1,r=t/4):r=t/(2*Math.PI)*Math.asin(1/e),function(n){return 1+e*Math.pow(2,10*-n)*Math.sin(2*(n-r)*Math.PI/t)}},back:function(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}},bounce:function(){return k}}),_r=d3.map({in:m,out:v,"in-out":y,"out-in":function(e){return y(v(e))}});d3.ease=function(e){var t=e.indexOf("-"),r=t>=0?e.substring(0,t):e,n=t>=0?e.substring(t+1):"in";return r=xr.get(r)||wr,function(e){return function(t){return t<=0?0:t>=1?1:e(t)}}((n=_r.get(n)||m)(r.apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.interpolate=function(e,t){for(var r,n=d3.interpolators.length;--n>=0&&!(r=d3.interpolators[n](e,t)););return r},d3.interpolateNumber=function(e,t){return t-=e,function(r){return e+t*r}},d3.interpolateRound=function(e,t){return t-=e,function(r){return Math.round(e+t*r)}},d3.interpolateString=function(e,t){var r,n,i,o,s,a=0,u=[],l=[];for(kr.lastIndex=0,n=0;r=kr.exec(t);++n)r.index&&u.push(t.substring(a,r.index)),l.push({i:u.length,x:r[0]}),u.push(null),a=kr.lastIndex;for(a<t.length&&u.push(t.substring(a)),n=0,o=l.length;(r=kr.exec(e))&&n<o;++n)if((s=l[n]).x==r[0]){if(s.i)if(null==u[s.i+1])for(u[s.i-1]+=s.x,u.splice(s.i,1),i=n+1;i<o;++i)l[i].i--;else for(u[s.i-1]+=s.x+u[s.i+1],u.splice(s.i,2),i=n+1;i<o;++i)l[i].i-=2;else if(null==u[s.i+1])u[s.i]=s.x;else for(u[s.i]=s.x+u[s.i+1],u.splice(s.i+1,1),i=n+1;i<o;++i)l[i].i--;l.splice(n,1),o--,n--}else s.x=d3.interpolateNumber(parseFloat(r[0]),parseFloat(s.x));for(;n<o;)s=l.pop(),null==u[s.i+1]?u[s.i]=s.x:(u[s.i]=s.x+u[s.i+1],u.splice(s.i+1,1)),o--;return 1===u.length?null==u[0]?l[0].x:function(){return t}:function(e){for(n=0;n<o;++n)u[(s=l[n]).i]=s.x(e);return u.join("")}},d3.interpolateTransform=function(e,t){var r,n=[],i=[],o=d3.transform(e),s=d3.transform(t),a=o.translate,u=s.translate,l=o.rotate,c=s.rotate,f=o.skew,h=s.skew,p=o.scale,d=s.scale;return a[0]!=u[0]||a[1]!=u[1]?(n.push("translate(",null,",",null,")"),i.push({i:1,x:d3.interpolateNumber(a[0],u[0])},{i:3,x:d3.interpolateNumber(a[1],u[1])})):n.push(u[0]||u[1]?"translate("+u+")":""),l!=c?i.push({i:n.push(n.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(l,c)}):c&&n.push(n.pop()+"rotate("+c+")"),f!=h?i.push({i:n.push(n.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(f,h)}):h&&n.push(n.pop()+"skewX("+h+")"),p[0]!=d[0]||p[1]!=d[1]?(r=n.push(n.pop()+"scale(",null,",",null,")"),i.push({i:r-4,x:d3.interpolateNumber(p[0],d[0])},{i:r-2,x:d3.interpolateNumber(p[1],d[1])})):(1!=d[0]||1!=d[1])&&n.push(n.pop()+"scale("+d+")"),r=i.length,function(e){for(var t,o=-1;++o<r;)n[(t=i[o]).i]=t.x(e);return n.join("")}},d3.interpolateRgb=function(e,t){e=d3.rgb(e),t=d3.rgb(t);var r=e.r,n=e.g,i=e.b,o=t.r-r,s=t.g-n,a=t.b-i;return function(e){return"#"+S(Math.round(r+o*e))+S(Math.round(n+s*e))+S(Math.round(i+a*e))}},d3.interpolateHsl=function(e,t){e=d3.hsl(e),t=d3.hsl(t);var r=e.h,n=e.s,i=e.l,o=t.h-r,s=t.s-n,a=t.l-i;return function(e){return P(r+o*e,n+s*e,i+a*e).toString()}},d3.interpolateArray=function(e,t){var r,n=[],i=[],o=e.length,s=t.length,a=Math.min(e.length,t.length);for(r=0;r<a;++r)n.push(d3.interpolate(e[r],t[r]));for(;r<o;++r)i[r]=e[r];for(;r<s;++r)i[r]=t[r];return function(e){for(r=0;r<a;++r)i[r]=n[r](e);return i}},d3.interpolateObject=function(e,t){var r,n={},i={};for(r in e)r in t?n[r]=I(r)(e[r],t[r]):i[r]=e[r];for(r in t)r in e||(i[r]=t[r]);return function(e){for(r in n)i[r]=n[r](e);return i}};var kr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(e,t){return t instanceof Array&&d3.interpolateArray(e,t)},function(e,t){return("string"==typeof e||"string"==typeof t)&&d3.interpolateString(e+"",t+"")},function(e,t){return("string"==typeof t?jr.has(t)||/^(#|rgb\(|hsl\()/.test(t):t instanceof F||t instanceof D)&&d3.interpolateRgb(e,t)},function(e,t){return!isNaN(e=+e)&&!isNaN(t=+t)&&d3.interpolateNumber(e,t)}],d3.rgb=function(e,t,r){return 1===arguments.length?e instanceof F?O(e.r,e.g,e.b):R(""+e,O,P):O(~~e,~~t,~~r)},F.prototype.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,r=this.g,n=this.b,i=30;return t||r||n?(t&&t<i&&(t=i),r&&r<i&&(r=i),n&&n<i&&(n=i),O(Math.min(255,Math.floor(t/e)),Math.min(255,Math.floor(r/e)),Math.min(255,Math.floor(n/e)))):O(i,i,i)},F.prototype.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),O(Math.floor(e*this.r),Math.floor(e*this.g),Math.floor(e*this.b))},F.prototype.hsl=function(){return T(this.r,this.g,this.b)},F.prototype.toString=function(){return"#"+S(this.r)+S(this.g)+S(this.b)};var jr=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});jr.forEach(function(e,t){jr.set(e,R(t,O,P))}),d3.hsl=function(e,t,r){return 1===arguments.length?e instanceof D?N(e.h,e.s,e.l):R(""+e,T,N):N(+e,+t,+r)},D.prototype.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),N(this.h,this.s,this.l/e)},D.prototype.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),N(this.h,this.s,e*this.l)},D.prototype.rgb=function(){return P(this.h,this.s,this.l)},D.prototype.toString=function(){return this.rgb().toString()};var Lr=function(e,t){return t.querySelector(e)},Ar=function(e,t){return t.querySelectorAll(e)},Ir=document.documentElement,Er=Ir.matchesSelector||Ir.webkitMatchesSelector||Ir.mozMatchesSelector||Ir.msMatchesSelector||Ir.oMatchesSelector,Cr=function(e,t){return Er.call(e,t)};"function"==typeof Sizzle&&(Lr=function(e,t){return Sizzle(e,t)[0]},Ar=function(e,t){return Sizzle.uniqueSort(Sizzle(e,t))},Cr=Sizzle.matchesSelector);var Or=[];d3.selection=function(){return Sr},d3.selection.prototype=Or,Or.select=function(e){var t,r,n,i,o=[];"function"!=typeof e&&(e=Q(e));for(var s=-1,a=this.length;++s<a;){o.push(t=[]),t.parentNode=(n=this[s]).parentNode;for(var u=-1,l=n.length;++u<l;)(i=n[u])?(t.push(r=e.call(i,i.__data__,u)),r&&"__data__"in i&&(r.__data__=i.__data__)):t.push(null)}return U(o)},Or.selectAll=function(e){var t,r,n=[];"function"!=typeof e&&(e=B(e));for(var i=-1,o=this.length;++i<o;)for(var s=this[i],a=-1,u=s.length;++a<u;)(r=s[a])&&(n.push(t=ur(e.call(r,r.__data__,a))),t.parentNode=r);return U(n)},Or.attr=function(e,t){if(e=d3.ns.qualify(e),arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each(null==t?e.local?function(){this.removeAttributeNS(e.space,e.local)}:function(){this.removeAttribute(e)}:"function"==typeof t?e.local?function(){var r=t.apply(this,arguments);null==r?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}:function(){var r=t.apply(this,arguments);null==r?this.removeAttribute(e):this.setAttribute(e,r)}:e.local?function(){this.setAttributeNS(e.space,e.local,t)}:function(){this.setAttribute(e,t)})},Or.classed=function(e,t){var r=e.split(Fr),n=r.length,i=-1;if(arguments.length>1){for(;++i<n;)W.call(this,r[i],t);return this}for(;++i<n;)if(!W.call(this,r[i]))return!1;return!0};var Fr=/\s+/g;Or.style=function(e,t,r){return arguments.length<3&&(r=""),arguments.length<2?window.getComputedStyle(this.node(),null).getPropertyValue(e):this.each(null==t?function(){this.style.removeProperty(e)}:"function"==typeof t?function(){var n=t.apply(this,arguments);null==n?this.style.removeProperty(e):this.style.setProperty(e,n,r)}:function(){this.style.setProperty(e,t,r)})},Or.property=function(e,t){return arguments.length<2?this.node()[e]:this.each(null==t?function(){delete this[e]}:"function"==typeof t?function(){var r=t.apply(this,arguments);null==r?delete this[e]:this[e]=r}:function(){this[e]=t})},Or.text=function(e){return arguments.length<1?this.node().textContent:this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e})},Or.html=function(e){return arguments.length<1?this.node().innerHTML:this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e})},Or.append=function(e){return e=d3.ns.qualify(e),this.select(e.local?function(){return this.appendChild(document.createElementNS(e.space,e.local))}:function(){return this.appendChild(document.createElementNS(this.namespaceURI,e))})},Or.insert=function(e,t){return e=d3.ns.qualify(e),this.select(e.local?function(){return this.insertBefore(document.createElementNS(e.space,e.local),Lr(t,this))}:function(){return this.insertBefore(document.createElementNS(this.namespaceURI,e),Lr(t,this))})},Or.remove=function(){return this.each(function(){var e=this.parentNode;e&&e.removeChild(this)})},Or.data=function(t,r){function n(t,n){var i,o,s,a=t.length,f=n.length,h=Math.min(a,f),p=Math.max(a,f),d=[],g=[],v=[];if(r){var y,m=new e,b=[],w=n.length;for(i=-1;++i<a;)y=r.call(o=t[i],o.__data__,i),m.has(y)?v[w++]=o:m.set(y,o),b.push(y);for(i=-1;++i<f;)y=r.call(n,s=n[i],i),m.has(y)?(d[i]=o=m.get(y),o.__data__=s,g[i]=v[i]=null):(g[i]=q(s),d[i]=v[i]=null),m.remove(y);for(i=-1;++i<a;)m.has(b[i])&&(v[i]=t[i])}else{for(i=-1;++i<h;)s=n[i],(o=t[i])?(o.__data__=s,d[i]=o,g[i]=v[i]=null):(g[i]=q(s),d[i]=v[i]=null);for(;i<f;++i)g[i]=q(n[i]),d[i]=v[i]=null;for(;i<p;++i)v[i]=t[i],g[i]=d[i]=null}g.update=d,g.parentNode=d.parentNode=v.parentNode=t.parentNode,u.push(g),l.push(d),c.push(v)}var i,o,s=-1,a=this.length;if(!arguments.length){for(t=new Array(a=(i=this[0]).length);++s<a;)(o=i[s])&&(t[s]=o.__data__);return t}var u=X([]),l=U([]),c=U([]);if("function"==typeof t)for(;++s<a;)n(i=this[s],t.call(i,i.parentNode.__data__,s));else for(;++s<a;)n(i=this[s],t);return l.enter=function(){return u},l.exit=function(){return c},l},Or.datum=Or.map=function(e){return arguments.length<1?this.property("__data__"):this.property("__data__",e)},Or.filter=function(e){var t,r,n,i=[];"function"!=typeof e&&(e=function(e){return function(){return Cr(this,e)}}(e));for(var o=0,s=this.length;o<s;o++){i.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var a=0,u=r.length;a<u;a++)(n=r[a])&&e.call(n,n.__data__,a)&&t.push(n)}return U(i)},Or.order=function(){for(var e=-1,t=this.length;++e<t;)for(var r,n=this[e],i=n.length-1,o=n[i];--i>=0;)(r=n[i])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},Or.sort=function(e){e=(function(e){return arguments.length||(e=d3.ascending),function(t,r){return e(t&&t.__data__,r&&r.__data__)}}).apply(this,arguments);for(var t=-1,r=this.length;++t<r;)this[t].sort(e);return this.order()},Or.on=function(e,t,r){arguments.length<3&&(r=!1);var n="__on"+e,i=e.indexOf(".");return i>0&&(e=e.substring(0,i)),arguments.length<2?(i=this.node()[n])&&i._:this.each(function(i,o){function s(e){var r=d3.event;d3.event=e;try{t.call(a,a.__data__,o)}finally{d3.event=r}}var a=this,u=a[n];u&&(a.removeEventListener(e,u,u.$),delete a[n]),t&&(a.addEventListener(e,a[n]=s,s.$=r),s._=t)})},Or.each=function(e){for(var t=-1,r=this.length;++t<r;)for(var n=this[t],i=-1,o=n.length;++i<o;){var s=n[i];s&&e.call(s,s.__data__,i,t)}return this},Or.call=function(e){return e.apply(this,(arguments[0]=this,arguments)),this},Or.empty=function(){return!this.node()},Or.node=function(e){for(var t=0,r=this.length;t<r;t++)for(var n=this[t],i=0,o=n.length;i<o;i++){var s=n[i];if(s)return s}return null},Or.transition=function(){for(var e,t,r=[],n=-1,i=this.length;++n<i;){r.push(e=[]);for(var o=this[n],s=-1,a=o.length;++s<a;)e.push((t=o[s])?{node:t,delay:Pr,duration:Ur}:null)}return G(r,Dr||++Nr,Date.now())};var Sr=U([[document]]);Sr[0].parentNode=Ir,d3.select=function(e){return"string"==typeof e?Sr.select(e):U([[e]])},d3.selectAll=function(e){return"string"==typeof e?Sr.selectAll(e):U([ur(e)])};var Rr=[];d3.selection.enter=X,d3.selection.enter.prototype=Rr,Rr.append=Or.append,Rr.insert=Or.insert,Rr.empty=Or.empty,Rr.node=Or.node,Rr.select=function(e){for(var t,r,n,i,o,s=[],a=-1,u=this.length;++a<u;){n=(i=this[a]).update,s.push(t=[]),t.parentNode=i.parentNode;for(var l=-1,c=i.length;++l<c;)(o=i[l])?(t.push(n[l]=r=e.call(i.parentNode,o.__data__,l)),r.__data__=o.__data__):t.push(null)}return U(s)};var Tr={},Mr=[],Nr=0,Dr=0,Pr=0,Ur=250,Qr=d3.ease("cubic-in-out");Mr.call=Or.call,d3.transition=function(e){return arguments.length?Dr?e.transition():e:Sr.transition()},d3.transition.prototype=Mr,Mr.select=function(e){var t,r,n,i=[];"function"!=typeof e&&(e=Q(e));for(var o=-1,s=this.length;++o<s;){i.push(t=[]);for(var a=this[o],u=-1,l=a.length;++u<l;)(n=a[u])&&(r=e.call(n.node,n.node.__data__,u))?("__data__"in n.node&&(r.__data__=n.node.__data__),t.push({node:r,delay:n.delay,duration:n.duration})):t.push(null)}return G(i,this.id,this.time).ease(this.ease())},Mr.selectAll=function(e){var t,r,n,i=[];"function"!=typeof e&&(e=B(e));for(var o=-1,s=this.length;++o<s;)for(var a=this[o],u=-1,l=a.length;++u<l;)if(n=a[u]){r=e.call(n.node,n.node.__data__,u),i.push(t=[]);for(var c=-1,f=r.length;++c<f;)t.push({node:r[c],delay:n.delay,duration:n.duration})}return G(i,this.id,this.time).ease(this.ease())},Mr.attr=function(e,t){return this.attrTween(e,H(e,t))},Mr.attrTween=function(e,t){var r=d3.ns.qualify(e);return this.tween("attr."+e,r.local?function(e,n){var i=t.call(this,e,n,this.getAttributeNS(r.space,r.local));return i===Tr?(this.removeAttributeNS(r.space,r.local),null):i&&function(e){this.setAttributeNS(r.space,r.local,i(e))}}:function(e,n){var i=t.call(this,e,n,this.getAttribute(r));return i===Tr?(this.removeAttribute(r),null):i&&function(e){this.setAttribute(r,i(e))}})},Mr.style=function(e,t,r){return arguments.length<3&&(r=""),this.styleTween(e,H(e,t),r)},Mr.styleTween=function(e,t,r){return arguments.length<3&&(r=""),this.tween("style."+e,function(n,i){var o=t.call(this,n,i,window.getComputedStyle(this,null).getPropertyValue(e));return o===Tr?(this.style.removeProperty(e),null):o&&function(t){this.style.setProperty(e,o(t),r)}})},Mr.text=function(e){return this.tween("text",function(t,r){this.textContent="function"==typeof e?e.call(this,t,r):e})},Mr.remove=function(){return this.each("end.transition",function(){var e;!this.__transition__&&(e=this.parentNode)&&e.removeChild(this)})},Mr.delay=function(e){var t=this;return t.each("function"==typeof e?function(r,n,i){t[i][n].delay=0|e.apply(this,arguments)}:(e|=0,function(r,n,i){t[i][n].delay=e}))},Mr.duration=function(e){var t=this;return t.each("function"==typeof e?function(r,n,i){t[i][n].duration=Math.max(1,0|e.apply(this,arguments))}:(e=Math.max(1,0|e),function(r,n,i){t[i][n].duration=e}))},Mr.transition=function(){return this.select(r)};var Br,Wr,qr=null;d3.timer=function(e,t,r){var n=!1,i=qr;if(arguments.length<3){if(arguments.length<2)t=0;else if(!isFinite(t))return;r=Date.now()}for(;i;){if(i.callback===e){i.then=r,i.delay=t,n=!0;break}i=i.next}n||(qr={callback:e,then:r,delay:t,next:qr}),Br||(Wr=clearTimeout(Wr),Br=1,Xr(V))},d3.timer.flush=function(){for(var e=Date.now(),t=qr;t;)t.delay||(t.flush=t.callback(e-t.then)),t=t.next;$()};var Xr=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,17)};d3.transform=function(e){var t=document.createElementNS(d3.ns.prefix.svg,"g"),r={a:1,b:0,c:0,d:1,e:0,f:0};return(d3.transform=function(e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate();return new J(n?n.matrix:r)})(e)},J.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Gr=180/Math.PI;d3.mouse=function(e){return Z(e,L())};var zr=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(e,t){return arguments.length<2&&(t=L().touches),t?ur(t).map(function(t){var r=Z(e,t);return r.identifier=t.identifier,r}):[]},d3.scale={},d3.scale.linear=function(){return function e(t,r,n,i){function o(){var e=Math.min(t.length,r.length)>2?ce:le,o=i?C:E;return a=e(t,r,o,n),u=e(r,t,o,d3.interpolate),s}function s(e){return a(e)}var a,u;return s.invert=function(e){return u(e)},s.domain=function(e){return arguments.length?(t=e.map(Number),o()):t},s.range=function(e){return arguments.length?(r=e,o()):r},s.rangeRound=function(e){return s.range(e).interpolate(d3.interpolateRound)},s.clamp=function(e){return arguments.length?(i=e,o()):i},s.interpolate=function(e){return arguments.length?(n=e,o()):n},s.ticks=function(e){return ae(t,e)},s.tickFormat=function(e){return ue(t,e)},s.nice=function(){return re(t,oe),o()},s.copy=function(){return e(t,r,n,i)},o()}([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return function e(t,r){function n(e){return t(r(e))}var i=r.pow;return n.invert=function(e){return i(t.invert(e))},n.domain=function(e){return arguments.length?(i=(r=e[0]<0?he:fe).pow,t.domain(e.map(r)),n):t.domain().map(i)},n.nice=function(){return t.domain(re(t.domain(),ne)),n},n.ticks=function(){var e=ee(t.domain()),n=[];if(e.every(isFinite)){var o=Math.floor(e[0]),s=Math.ceil(e[1]),a=i(e[0]),u=i(e[1]);if(r===he)for(n.push(i(o));o++<s;)for(var l=9;l>0;l--)n.push(i(o)*l);else{for(;o<s;o++)for(l=1;l<10;l++)n.push(i(o)*l);n.push(i(o))}for(o=0;n[o]<a;o++);for(s=n.length;n[s-1]>u;s--);n=n.slice(o,s)}return n},n.tickFormat=function(e,t){if(arguments.length<2&&(t=Hr),arguments.length<1)return t;var o,s=e/n.ticks().length,a=r===he?(o=-1e-12,Math.floor):(o=1e-12,Math.ceil);return function(e){return e/i(a(r(e)+o))<s?t(e):""}},n.copy=function(){return e(t.copy(),r)},ie(n,t)}(d3.scale.linear(),fe)};var Hr=d3.format(".0e");fe.pow=function(e){return Math.pow(10,e)},he.pow=function(e){return-Math.pow(10,-e)},d3.scale.pow=function(){return function e(t,r){function n(e){return t(i(e))}var i=pe(r),o=pe(1/r);return n.invert=function(e){return o(t.invert(e))},n.domain=function(e){return arguments.length?(t.domain(e.map(i)),n):t.domain().map(o)},n.ticks=function(e){return ae(n.domain(),e)},n.tickFormat=function(e){return ue(n.domain(),e)},n.nice=function(){return n.domain(re(n.domain(),oe))},n.exponent=function(e){if(!arguments.length)return r;var t=n.domain();return i=pe(r=e),o=pe(1/r),n.domain(t)},n.copy=function(){return e(t.copy(),r)},ie(n,t)}(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return function t(r,n){function i(e){return a[((s.get(e)||s.set(e,r.push(e)))-1)%a.length]}function o(e,t){return d3.range(r.length).map(function(r){return e+t*r})}var s,a,u;return i.domain=function(t){if(!arguments.length)return r;r=[],s=new e;for(var o,a=-1,u=t.length;++a<u;)s.has(o=t[a])||s.set(o,r.push(o));return i[n.t](n.x,n.p)},i.range=function(e){return arguments.length?(a=e,u=0,n={t:"range",x:e},i):a},i.rangePoints=function(e,t){arguments.length<2&&(t=0);var s=e[0],l=e[1],c=(l-s)/(r.length-1+t);return a=o(r.length<2?(s+l)/2:s+c*t/2,c),u=0,n={t:"rangePoints",x:e,p:t},i},i.rangeBands=function(e,t){arguments.length<2&&(t=0);var s=e[1]<e[0],l=e[s-0],c=(e[1-s]-l)/(r.length+t);return a=o(l+c*t,c),s&&a.reverse(),u=c*(1-t),n={t:"rangeBands",x:e,p:t},i},i.rangeRoundBands=function(e,t){arguments.length<2&&(t=0);var s=e[1]<e[0],l=e[s-0],c=e[1-s],f=Math.floor((c-l)/(r.length+t));return a=o(l+Math.round((c-l-(r.length-t)*f)/2),f),s&&a.reverse(),u=Math.round(f*(1-t)),n={t:"rangeRoundBands",x:e,p:t},i},i.rangeBand=function(){return u},i.rangeExtent=function(){return ee(n.x)},i.copy=function(){return t(r,n)},i.domain(r)}([],{t:"range",x:[]})},d3.scale.category10=function(){return d3.scale.ordinal().range(Vr)},d3.scale.category20=function(){return d3.scale.ordinal().range($r)},d3.scale.category20b=function(){return d3.scale.ordinal().range(Jr)},d3.scale.category20c=function(){return d3.scale.ordinal().range(Yr)};var Vr=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],$r=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],Jr=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],Yr=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return function e(t,r){function n(){var e=0,n=r.length;for(o=[];++e<n;)o[e-1]=d3.quantile(t,e/n);return i}function i(e){return isNaN(e=+e)?NaN:r[d3.bisect(o,e)]}var o;return i.domain=function(e){return arguments.length?(t=e.filter(function(e){return!isNaN(e)}).sort(d3.ascending),n()):t},i.range=function(e){return arguments.length?(r=e,n()):r},i.quantiles=function(){return o},i.copy=function(){return e(t,r)},n()}([],[])},d3.scale.quantize=function(){return function e(t,r,n){function i(e){return n[Math.max(0,Math.min(a,Math.floor(s*(e-t))))]}function o(){return s=n.length/(r-t),a=n.length-1,i}var s,a;return i.domain=function(e){return arguments.length?(t=+e[0],r=+e[e.length-1],o()):[t,r]},i.range=function(e){return arguments.length?(n=e,o()):n},i.copy=function(){return e(t,r,n)},o()}(0,1,[0,1])},d3.scale.identity=function(){return function e(t){function r(e){return+e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=e.map(r),r):t},r.ticks=function(e){return ae(t,e)},r.tickFormat=function(e){return ue(t,e)},r.copy=function(){return e(t)},r}([0,1])},d3.svg={},d3.svg.arc=function(){function e(){var e=t.apply(this,arguments),i=r.apply(this,arguments),s=n.apply(this,arguments)+Kr,a=o.apply(this,arguments)+Kr,u=(a<s&&(u=s,s=a,a=u),a-s),l=u<Math.PI?"0":"1",c=Math.cos(s),f=Math.sin(s),h=Math.cos(a),p=Math.sin(a);return u>=Zr?e?"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+-e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z":e?"M"+i*c+","+i*f+"A"+i+","+i+" 0 "+l+",1 "+i*h+","+i*p+"L"+e*h+","+e*p+"A"+e+","+e+" 0 "+l+",0 "+e*c+","+e*f+"Z":"M"+i*c+","+i*f+"A"+i+","+i+" 0 "+l+",1 "+i*h+","+i*p+"L0,0Z"}var t=de,r=ge,n=ve,o=ye;return e.innerRadius=function(r){return arguments.length?(t=i(r),e):t},e.outerRadius=function(t){return arguments.length?(r=i(t),e):r},e.startAngle=function(t){return arguments.length?(n=i(t),e):n},e.endAngle=function(t){return arguments.length?(o=i(t),e):o},e.centroid=function(){var e=(t.apply(this,arguments)+r.apply(this,arguments))/2,i=(n.apply(this,arguments)+o.apply(this,arguments))/2+Kr;return[Math.cos(i)*e,Math.sin(i)*e]},e};var Kr=-Math.PI/2,Zr=2*Math.PI-1e-6;d3.svg.line=function(){return me(t)};var en="linear",tn=d3.map({linear:xe,"step-before":_e,"step-after":ke,basis:Ae,"basis-open":function(e){if(e.length<4)return xe(e);for(var t,r=[],n=-1,i=e.length,o=[0],s=[0];++n<3;)o.push((t=e[n])[0]),s.push(t[1]);for(r.push(Ie(on,o)+","+Ie(on,s)),--n;++n<i;)t=e[n],o.shift(),o.push(t[0]),s.shift(),s.push(t[1]),Ee(r,o,s);return r.join("")},"basis-closed":function(e){for(var t,r,n=-1,i=e.length,o=i+4,s=[],a=[];++n<4;)s.push((r=e[n%i])[0]),a.push(r[1]);for(t=[Ie(on,s),",",Ie(on,a)],--n;++n<o;)r=e[n%i],s.shift(),s.push(r[0]),a.shift(),a.push(r[1]),Ee(t,s,a);return t.join("")},bundle:function(e,t){for(var r,n,i=e.length-1,o=e[0][0],s=e[0][1],a=e[i][0]-o,u=e[i][1]-s,l=-1;++l<=i;)(r=e[l])[0]=t*r[0]+(1-t)*(o+(n=l/i)*a),r[1]=t*r[1]+(1-t)*(s+n*u);return Ae(e)},cardinal:function(e,t,r){return e.length<3?xe(e):e[0]+je(e,Le(e,t))},"cardinal-open":function(e,t){return e.length<4?xe(e):e[1]+je(e.slice(1,e.length-1),Le(e,t))},"cardinal-closed":function(e,t){return e.length<3?xe(e):e[0]+je((e.push(e[0]),e),Le([e[e.length-2]].concat(e,[e[1]]),t))},monotone:function(e){return e.length<3?xe(e):e[0]+je(e,function(e){for(var t,r,n,i,o=[],s=function(e){for(var t=0,r=e.length-1,n=[],i=e[0],o=e[1],s=n[0]=Ce(i,o);++t<r;)n[t]=s+(s=Ce(i=o,o=e[t+1]));return n[t]=s,n}(e),a=-1,u=e.length-1;++a<u;)t=Ce(e[a],e[a+1]),Math.abs(t)<1e-6?s[a]=s[a+1]=0:(i=(r=s[a]/t)*r+(n=s[a+1]/t)*n)>9&&(i=3*t/Math.sqrt(i),s[a]=i*r,s[a+1]=i*n);for(a=-1;++a<=u;)i=(e[Math.min(u,a+1)][0]-e[Math.max(0,a-1)][0])/(6*(1+s[a]*s[a])),o.push([i||0,s[a]*i||0]);return o}(e))}}),rn=[0,2/3,1/3,0],nn=[0,1/3,2/3,0],on=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var e=me(Oe);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},_e.reverse=ke,ke.reverse=_e,d3.svg.area=function(){return Fe(Object)},d3.svg.area.radial=function(){var e=Fe(Oe);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},d3.svg.chord=function(){function e(e,i){var a=t(this,o,e,i),u=t(this,s,e,i);return"M"+a.p0+r(a.r,a.p1,a.a1-a.a0)+(a.a0==u.a0&&a.a1==u.a1?n(0,0,0,a.p0):n(0,0,0,u.p0)+r(u.r,u.p1,u.a1-u.a0)+n(0,0,0,a.p0))+"Z"}function t(e,t,r,n){var i=t.call(e,r,n),o=a.call(e,i,n),s=u.call(e,i,n)+Kr,c=l.call(e,i,n)+Kr;return{r:o,a0:s,a1:c,p0:[o*Math.cos(s),o*Math.sin(s)],p1:[o*Math.cos(c),o*Math.sin(c)]}}function r(e,t,r){return"A"+e+","+e+" 0 "+ +(r>Math.PI)+",1 "+t}function n(e,t,r,n){return"Q 0,0 "+n}var o=Se,s=Re,a=Te,u=ve,l=ye;return e.radius=function(t){return arguments.length?(a=i(t),e):a},e.source=function(t){return arguments.length?(o=i(t),e):o},e.target=function(t){return arguments.length?(s=i(t),e):s},e.startAngle=function(t){return arguments.length?(u=i(t),e):u},e.endAngle=function(t){return arguments.length?(l=i(t),e):l},e},d3.svg.diagonal=function(){function e(e,i){var o=t.call(this,e,i),s=r.call(this,e,i),a=(o.y+s.y)/2,u=[o,{x:o.x,y:a},{x:s.x,y:a},s];return"M"+(u=u.map(n))[0]+"C"+u[1]+" "+u[2]+" "+u[3]}var t=Se,r=Re,n=Me;return e.source=function(r){return arguments.length?(t=i(r),e):t},e.target=function(t){return arguments.length?(r=i(t),e):r},e.projection=function(t){return arguments.length?(n=t,e):n},e},d3.svg.diagonal.radial=function(){var e=d3.svg.diagonal(),t=Me,r=e.projection;return e.projection=function(e){return arguments.length?r(function(e){return function(){var t=e.apply(this,arguments),r=t[0],n=t[1]+Kr;return[r*Math.cos(n),r*Math.sin(n)]}}(t=e)):t},e},d3.svg.mouse=d3.mouse,d3.svg.touches=d3.touches,d3.svg.symbol=function(){function e(e,n){return(sn.get(t.call(this,e,n))||Pe)(r.call(this,e,n))}var t=De,r=Ne;return e.type=function(r){return arguments.length?(t=i(r),e):t},e.size=function(t){return arguments.length?(r=i(t),e):r},e};var sn=d3.map({circle:Pe,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*un)),r=t*un;return"M0,"+-t+"L"+r+",0 0,"+t+" "+-r+",0Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/an),r=t*an/2;return"M0,"+r+"L"+t+","+-r+" "+-t+","+-r+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/an),r=t*an/2;return"M0,"+-r+"L"+t+","+r+" "+-t+","+r+"Z"}});d3.svg.symbolTypes=sn.keys();var an=Math.sqrt(3),un=Math.tan(30*Math.PI/180);d3.svg.axis=function(){function e(e){e.each(function(){var e,f=d3.select(this),h=null==l?r.ticks?r.ticks.apply(r,u):r.domain():l,p=null==t?r.tickFormat?r.tickFormat.apply(r,u):String:t,d=function(e,t,r){if(n=[],r&&t.length>1){for(var n,i,o,s=ee(e.domain()),a=-1,u=t.length,l=(t[1]-t[0])/++r;++a<u;)for(i=r;--i>0;)(o=+t[a]-i*l)>=s[0]&&n.push(o);for(--a,i=0;++i<r&&(o=+t[a]+i*l)<s[1];)n.push(o)}return n}(r,h,c),g=f.selectAll(".minor").data(d,String),v=g.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),y=d3.transition(g.exit()).style("opacity",1e-6).remove(),m=d3.transition(g).style("opacity",1),b=f.selectAll("g").data(h,String),w=b.enter().insert("g","path").style("opacity",1e-6),x=d3.transition(b.exit()).style("opacity",1e-6).remove(),_=d3.transition(b).style("opacity",1),k=te(r),j=f.selectAll(".domain").data([0]),L=(j.enter().append("path").attr("class","domain"),d3.transition(j)),A=r.copy(),I=this.__chart__||A;switch(this.__chart__=A,w.append("line").attr("class","tick"),w.append("text"),_.select("text").text(p),n){case"bottom":e=Ue,v.attr("y2",o),m.attr("x2",0).attr("y2",o),w.select("line").attr("y2",i),w.select("text").attr("y",Math.max(i,0)+a),_.select("line").attr("x2",0).attr("y2",i),_.select("text").attr("x",0).attr("y",Math.max(i,0)+a).attr("dy",".71em").attr("text-anchor","middle"),L.attr("d","M"+k[0]+","+s+"V0H"+k[1]+"V"+s);break;case"top":e=Ue,v.attr("y2",-o),m.attr("x2",0).attr("y2",-o),w.select("line").attr("y2",-i),w.select("text").attr("y",-(Math.max(i,0)+a)),_.select("line").attr("x2",0).attr("y2",-i),_.select("text").attr("x",0).attr("y",-(Math.max(i,0)+a)).attr("dy","0em").attr("text-anchor","middle"),L.attr("d","M"+k[0]+","+-s+"V0H"+k[1]+"V"+-s);break;case"left":e=Qe,v.attr("x2",-o),m.attr("x2",-o).attr("y2",0),w.select("line").attr("x2",-i),w.select("text").attr("x",-(Math.max(i,0)+a)),_.select("line").attr("x2",-i).attr("y2",0),_.select("text").attr("x",-(Math.max(i,0)+a)).attr("y",0).attr("dy",".32em").attr("text-anchor","end"),L.attr("d","M"+-s+","+k[0]+"H0V"+k[1]+"H"+-s);break;case"right":e=Qe,v.attr("x2",o),m.attr("x2",o).attr("y2",0),w.select("line").attr("x2",i),w.select("text").attr("x",Math.max(i,0)+a),_.select("line").attr("x2",i).attr("y2",0),_.select("text").attr("x",Math.max(i,0)+a).attr("y",0).attr("dy",".32em").attr("text-anchor","start"),L.attr("d","M"+s+","+k[0]+"H0V"+k[1]+"H"+s)}if(r.ticks)w.call(e,I),_.call(e,A),x.call(e,A),v.call(e,I),m.call(e,A),y.call(e,A);else{var E=A.rangeBand()/2,C=function(e){return A(e)+E};w.call(e,C),_.call(e,C)}})}var t,r=d3.scale.linear(),n="bottom",i=6,o=6,s=6,a=3,u=[10],l=null,c=0;return e.scale=function(t){return arguments.length?(r=t,e):r},e.orient=function(t){return arguments.length?(n=t,e):n},e.ticks=function(){return arguments.length?(u=arguments,e):u},e.tickValues=function(t){return arguments.length?(l=t,e):l},e.tickFormat=function(r){return arguments.length?(t=r,e):t},e.tickSize=function(t,r,n){if(!arguments.length)return i;var a=arguments.length-1;return i=+t,o=a>1?+r:i,s=a>0?+arguments[a]:i,e},e.tickPadding=function(t){return arguments.length?(a=+t,e):a},e.tickSubdivide=function(t){return arguments.length?(c=+t,e):c},e},d3.svg.brush=function(){function e(o){o.each(function(){var o,s=d3.select(this),c=s.selectAll(".background").data([0]),f=s.selectAll(".extent").data([0]),h=s.selectAll(".resize").data(l,String);s.style("pointer-events","all").on("mousedown.brush",i).on("touchstart.brush",i),c.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),f.enter().append("rect").attr("class","extent").style("cursor","move"),h.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return ln[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),h.style("display",e.empty()?"none":null),h.exit().remove(),a&&(o=te(a),c.attr("x",o[0]).attr("width",o[1]-o[0]),r(s)),u&&(o=te(u),c.attr("y",o[0]).attr("height",o[1]-o[0]),n(s)),t(s)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+c[+/e$/.test(e)][0]+","+c[+/^s/.test(e)][1]+")"})}function r(e){e.select(".extent").attr("x",c[0][0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1][0]-c[0][0])}function n(e){e.select(".extent").attr("y",c[0][1]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",c[1][1]-c[0][1])}function i(){function i(){var e=d3.event.changedTouches;return e?d3.touches(g,e)[0]:d3.mouse(g)}function l(){var e=i(),o=!1;d&&(e[0]+=d[0],e[1]+=d[1]),_||(d3.event.altKey?(p||(p=[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2]),k[0]=c[+(e[0]<p[0])][0],k[1]=c[+(e[1]<p[1])][1]):p=null),w&&f(e,a,0)&&(r(m),o=!0),x&&f(e,u,1)&&(n(m),o=!0),o&&(t(m),y({type:"brush",mode:_?"move":"resize"}))}function f(e,t,r){var n,i,s=te(t),a=s[0],u=s[1],l=k[r],f=c[1][r]-c[0][r];if(_&&(a-=l,u-=f+l),n=Math.max(a,Math.min(u,e[r])),_?i=(n+=l)+f:(p&&(l=Math.max(a,Math.min(u,2*p[r]-n))),l<n?(i=n,n=l):i=l),c[0][r]!==n||c[1][r]!==i)return o=null,c[0][r]=n,c[1][r]=i,!0}function h(){l(),m.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),d3.select("body").style("cursor",null),L.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),y({type:"brushend"}),j()}var p,d,g=this,v=d3.select(d3.event.target),y=s.of(g,arguments),m=d3.select(g),b=v.datum(),w=!/^(n|s)$/.test(b)&&a,x=!/^(e|w)$/.test(b)&&u,_=v.classed("extent"),k=i(),L=d3.select(window).on("mousemove.brush",l).on("mouseup.brush",h).on("touchmove.brush",l).on("touchend.brush",h).on("keydown.brush",function(){32==d3.event.keyCode&&(_||(p=null,k[0]-=c[1][0],k[1]-=c[1][1],_=2),j())}).on("keyup.brush",function(){32==d3.event.keyCode&&2==_&&(k[0]+=c[1][0],k[1]+=c[1][1],_=0,j())});if(_)k[0]=c[0][0]-k[0],k[1]=c[0][1]-k[1];else if(b){var A=+/w$/.test(b),I=+/^n/.test(b);d=[c[1-A][0]-k[0],c[1-I][1]-k[1]],k[0]=c[A][0],k[1]=c[I][1]}else d3.event.altKey&&(p=k.slice());m.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",v.style("cursor")),y({type:"brushstart"}),l(),j()}var o,s=A(e,"brushstart","brush","brushend"),a=null,u=null,l=cn[0],c=[[0,0],[0,0]];return e.x=function(t){return arguments.length?(l=cn[!(a=t)<<1|!u],e):a},e.y=function(t){return arguments.length?(l=cn[!a<<1|!(u=t)],e):u},e.extent=function(t){var r,n,i,s,l;return arguments.length?(o=[[0,0],[0,0]],a&&(r=t[0],n=t[1],u&&(r=r[0],n=n[0]),o[0][0]=r,o[1][0]=n,a.invert&&(r=a(r),n=a(n)),n<r&&(l=r,r=n,n=l),c[0][0]=0|r,c[1][0]=0|n),u&&(i=t[0],s=t[1],a&&(i=i[1],s=s[1]),o[0][1]=i,o[1][1]=s,u.invert&&(i=u(i),s=u(s)),s<i&&(l=i,i=s,s=l),c[0][1]=0|i,c[1][1]=0|s),e):(t=o||c,a&&(r=t[0][0],n=t[1][0],o||(r=c[0][0],n=c[1][0],a.invert&&(r=a.invert(r),n=a.invert(n)),n<r&&(l=r,r=n,n=l))),u&&(i=t[0][1],s=t[1][1],o||(i=c[0][1],s=c[1][1],u.invert&&(i=u.invert(i),s=u.invert(s)),s<i&&(l=i,i=s,s=l))),a&&u?[[r,i],[n,s]]:a?[r,n]:u&&[i,s])},e.clear=function(){return o=null,c[0][0]=c[0][1]=c[1][0]=c[1][1]=0,e},e.empty=function(){return a&&c[0][0]===c[1][0]||u&&c[0][1]===c[1][1]},d3.rebind(e,s,"on")};var ln={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},cn=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];d3.behavior={},d3.behavior.drag=function(){function e(){this.on("mousedown.drag",t).on("touchstart.drag",t)}function t(){function e(){var e=a.parentNode,t=d3.event.changedTouches;return t?d3.touches(e,t)[0]:d3.mouse(e)}function t(){if(!a.parentNode)return i();var t=e(),r=t[0]-c[0],n=t[1]-c[1];f|=r|n,c=t,j(),u({type:"drag",x:t[0]+s[0],y:t[1]+s[1],dx:r,dy:n})}function i(){u({type:"dragend"}),f&&(j(),d3.event.target===l&&h.on("click.drag",o,!0)),h.on("mousemove.drag",null).on("touchmove.drag",null).on("mouseup.drag",null).on("touchend.drag",null)}function o(){j(),h.on("click.drag",null)}var s,a=this,u=r.of(a,arguments),l=d3.event.target,c=e(),f=0,h=d3.select(window).on("mousemove.drag",t).on("touchmove.drag",t).on("mouseup.drag",i,!0).on("touchend.drag",i,!0);s=n?[(s=n.apply(a,arguments)).x-c[0],s.y-c[1]]:[0,0],j(),u({type:"dragstart"})}var r=A(e,"drag","dragstart","dragend"),n=null;return e.origin=function(t){return arguments.length?(n=t,e):n},d3.rebind(e,r,"on")},d3.behavior.zoom=function(){function e(){this.on("mousedown.zoom",s).on("mousewheel.zoom",a).on("mousemove.zoom",u).on("DOMMouseScroll.zoom",a).on("dblclick.zoom",l).on("touchstart.zoom",c).on("touchmove.zoom",f).on("touchend.zoom",c)}function t(e){return[(e[0]-b[0])/w,(e[1]-b[1])/w]}function r(e){return[e[0]*w+b[0],e[1]*w+b[1]]}function n(e){w=Math.max(x[0],Math.min(x[1],e))}function i(e,t){t=r(t),b[0]+=e[0]-t[0],b[1]+=e[1]-t[1]}function o(e){g&&g.domain(d.range().map(function(e){return(e-b[0])/w}).map(d.invert)),y&&y.domain(v.range().map(function(e){return(e-b[1])/w}).map(v.invert)),d3.event.preventDefault(),e({type:"zoom",scale:w,translate:b})}function s(){function e(){j(),u.on("click.zoom",null)}var r=this,n=_.of(r,arguments),s=d3.event.target,a=0,u=d3.select(window).on("mousemove.zoom",function(){a=1,i(d3.mouse(r),l),o(n)}).on("mouseup.zoom",function(){a&&j(),u.on("mousemove.zoom",null).on("mouseup.zoom",null),a&&d3.event.target===s&&u.on("click.zoom",e,!0)}),l=t(d3.mouse(r));window.focus(),j()}function a(){h||(h=t(d3.mouse(this))),n(Math.pow(2,.002*function(){fn||(fn=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode);var e,t=d3.event;try{fn.scrollTop=1e3,fn.dispatchEvent(t),e=1e3-fn.scrollTop}catch(r){e=t.wheelDelta||5*-t.detail}return e}())*w),i(d3.mouse(this),h),o(_.of(this,arguments))}function u(){h=null}function l(){var e=d3.mouse(this),r=t(e);n(d3.event.shiftKey?w/2:2*w),i(e,r),o(_.of(this,arguments))}function c(){var e=d3.touches(this),r=Date.now();if(p=w,h={},e.forEach(function(e){h[e.identifier]=t(e)}),j(),1===e.length&&r-m<500){var s=e[0],a=t(e[0]);n(2*w),i(s,a),o(_.of(this,arguments))}m=r}function f(){var e=d3.touches(this),t=e[0],r=h[t.identifier];if(s=e[1]){var s,a=h[s.identifier];t=[(t[0]+s[0])/2,(t[1]+s[1])/2],r=[(r[0]+a[0])/2,(r[1]+a[1])/2],n(d3.event.scale*p)}i(t,r),o(_.of(this,arguments))}var h,p,d,g,v,y,m,b=[0,0],w=1,x=dn,_=A(e,"zoom");return e.translate=function(t){return arguments.length?(b=t.map(Number),e):b},e.scale=function(t){return arguments.length?(w=+t,e):w},e.scaleExtent=function(t){return arguments.length?(x=null==t?dn:t.map(Number),e):x},e.x=function(t){return arguments.length?(g=t,d=t.copy(),e):g},e.y=function(t){return arguments.length?(y=t,v=t.copy(),e):y},d3.rebind(e,_,"on")};var fn,hn,pn,dn=[0,1/0];d3.layout={},d3.layout.bundle=function(){return function(e){for(var t=[],r=-1,n=e.length;++r<n;)t.push(Be(e[r]));return t}},d3.layout.chord=function(){function e(){var e,l,f,h,p,d={},g=[],v=d3.range(o),y=[];for(r=[],n=[],e=0,h=-1;++h<o;){for(l=0,p=-1;++p<o;)l+=i[h][p];g.push(l),y.push(d3.range(o)),e+=l}for(s&&v.sort(function(e,t){return s(g[e],g[t])}),a&&y.forEach(function(e,t){e.sort(function(e,r){return a(i[t][e],i[t][r])})}),e=(2*Math.PI-c*o)/e,l=0,h=-1;++h<o;){for(f=l,p=-1;++p<o;){var m=v[h],b=y[m][p],w=i[m][b],x=l,_=l+=w*e;d[m+"-"+b]={index:m,subindex:b,startAngle:x,endAngle:_,value:w}}n[m]={index:m,startAngle:f,endAngle:l,value:(l-f)/e},l+=c}for(h=-1;++h<o;)for(p=h-1;++p<o;){var k=d[h+"-"+p],j=d[p+"-"+h];(k.value||j.value)&&r.push(k.value<j.value?{source:j,target:k}:{source:k,target:j})}u&&t()}function t(){r.sort(function(e,t){return u((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var r,n,i,o,s,a,u,l={},c=0;return l.matrix=function(e){return arguments.length?(o=(i=e)&&i.length,r=n=null,l):i},l.padding=function(e){return arguments.length?(c=e,r=n=null,l):c},l.sortGroups=function(e){return arguments.length?(s=e,r=n=null,l):s},l.sortSubgroups=function(e){return arguments.length?(a=e,r=null,l):a},l.sortChords=function(e){return arguments.length?(u=e,r&&t(),l):u},l.chords=function(){return r||e(),r},l.groups=function(){return n||e(),n},l},d3.layout.force=function(){function e(e){return function(t,r,n,i,o){if(t.point!==e){var s,a=t.cx-e.x,u=t.cy-e.y,l=1/Math.sqrt(a*a+u*u);if((i-r)*l<y)return e.px-=a*(s=t.charge*l*l),e.py-=u*s,!0;t.point&&isFinite(l)&&(e.px-=a*(s=t.pointCharge*l*l),e.py-=u*s)}return!t.charge}}function r(e){qe(pn=e),hn=l}var n,o,s,a,u,l={},c=d3.dispatch("start","tick","end"),f=[1,1],h=.9,p=He,d=Ve,g=-30,v=.1,y=.8,m=[],b=[];return l.tick=function(){if((o*=.99)<.005)return c.end({type:"end",alpha:o=0}),!0;var t,r,n,i,l,p,d,y,w,x=m.length,_=b.length;for(r=0;r<_;++r)(p=(y=(l=(n=b[r]).target).x-(i=n.source).x)*y+(w=l.y-i.y)*w)&&(w*=p=o*a[r]*((p=Math.sqrt(p))-s[r])/p,l.x-=(y*=p)*(d=i.weight/(l.weight+i.weight)),l.y-=w*d,i.x+=y*(d=1-d),i.y+=w*d);if((d=o*v)&&(y=f[0]/2,w=f[1]/2,r=-1,d))for(;++r<x;)(n=m[r]).x+=(y-n.x)*d,n.y+=(w-n.y)*d;if(g)for(function e(t,r,n){var i=0,o=0;if(t.charge=0,!t.leaf)for(var s,a=t.nodes,u=a.length,l=-1;++l<u;)null!=(s=a[l])&&(e(s,r,n),t.charge+=s.charge,i+=s.charge*s.cx,o+=s.charge*s.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var c=r*n[t.point.index];t.charge+=t.pointCharge=c,i+=c*t.point.x,o+=c*t.point.y}t.cx=i/t.charge,t.cy=o/t.charge}(t=d3.geom.quadtree(m),o,u),r=-1;++r<x;)(n=m[r]).fixed||t.visit(e(n));for(r=-1;++r<x;)(n=m[r]).fixed?(n.x=n.px,n.y=n.py):(n.x-=(n.px-(n.px=n.x))*h,n.y-=(n.py-(n.py=n.y))*h);c.tick({type:"tick",alpha:o})},l.nodes=function(e){return arguments.length?(m=e,l):m},l.links=function(e){return arguments.length?(b=e,l):b},l.size=function(e){return arguments.length?(f=e,l):f},l.linkDistance=function(e){return arguments.length?(p=i(e),l):p},l.distance=l.linkDistance,l.linkStrength=function(e){return arguments.length?(d=i(e),l):d},l.friction=function(e){return arguments.length?(h=e,l):h},l.charge=function(e){return arguments.length?(g="function"==typeof e?e:+e,l):g},l.gravity=function(e){return arguments.length?(v=e,l):v},l.theta=function(e){return arguments.length?(y=e,l):y},l.alpha=function(e){return arguments.length?(o?o=e>0?e:0:e>0&&(c.start({type:"start",alpha:o=e}),d3.timer(l.tick)),l):o},l.start=function(){function e(e,r){for(var n,i=t(),o=-1,s=i.length;++o<s;)if(!isNaN(n=i[o][e]))return n;return Math.random()*r}function t(){if(!i){for(i=[],n=0;n<c;++n)i[n]=[];for(n=0;n<h;++n){var e=b[n];i[e.source.index].push(e.target),i[e.target.index].push(e.source)}}return i[r]}var r,n,i,o,c=m.length,h=b.length,v=f[0],y=f[1];for(r=0;r<c;++r)(o=m[r]).index=r,o.weight=0;for(s=[],a=[],r=0;r<h;++r)"number"==typeof(o=b[r]).source&&(o.source=m[o.source]),"number"==typeof o.target&&(o.target=m[o.target]),s[r]=p.call(this,o,r),a[r]=d.call(this,o,r),++o.source.weight,++o.target.weight;for(r=0;r<c;++r)o=m[r],isNaN(o.x)&&(o.x=e("x",v)),isNaN(o.y)&&(o.y=e("y",y)),isNaN(o.px)&&(o.px=o.x),isNaN(o.py)&&(o.py=o.y);if(u=[],"function"==typeof g)for(r=0;r<c;++r)u[r]=+g.call(this,m[r],r);else for(r=0;r<c;++r)u[r]=g;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){n||(n=d3.behavior.drag().origin(t).on("dragstart",r).on("drag",ze).on("dragend",Ge)),this.on("mouseover.force",qe).on("mouseout.force",Xe).call(n)},d3.rebind(l,c,"on")},d3.layout.partition=function(){function e(e,n){var i=t.call(this,e,n);return function e(t,r,n,i){var o=t.children;if(t.x=r,t.y=t.depth*i,t.dx=n,t.dy=i,o&&(s=o.length)){var s,a,u,l=-1;for(n=t.value?n/t.value:0;++l<s;)e(a=o[l],r,u=a.value*n,i),r+=u}}(i[0],0,r[0],r[1]/function e(t){var r=t.children,n=0;if(r&&(i=r.length))for(var i,o=-1;++o<i;)n=Math.max(n,e(r[o]));return 1+n}(i[0])),i}var t=d3.layout.hierarchy(),r=[1,1];return e.size=function(t){return arguments.length?(r=t,e):r},st(e,t)},d3.layout.pie=function(){function e(o,s){var a=o.map(function(r,n){return+t.call(e,r,n)}),u=+("function"==typeof n?n.apply(this,arguments):n),l=(("function"==typeof i?i.apply(this,arguments):i)-n)/d3.sum(a),c=d3.range(o.length);null!=r&&c.sort(r===gn?function(e,t){return a[t]-a[e]}:function(e,t){return r(o[e],o[t])});var f=[];return c.forEach(function(e){f[e]={data:o[e],value:d=a[e],startAngle:u,endAngle:u+=d*l}}),f}var t=Number,r=gn,n=0,i=2*Math.PI;return e.value=function(r){return arguments.length?(t=r,e):t},e.sort=function(t){return arguments.length?(r=t,e):r},e.startAngle=function(t){return arguments.length?(n=t,e):n},e.endAngle=function(t){return arguments.length?(i=t,e):i},e};var gn={};d3.layout.stack=function(){function e(t,u){var l=t.map(function(t,n){return r.call(e,t,n)}),c=l.map(function(t,r){return t.map(function(t,r){return[s.call(e,t,r),a.call(e,t,r)]})}),f=n.call(e,c,u);l=d3.permute(l,f),c=d3.permute(c,f);var h,p,d,g=i.call(e,c,u),v=l.length,y=l[0].length;for(p=0;p<y;++p)for(o.call(e,l[0][p],d=g[p],c[0][p][1]),h=1;h<v;++h)o.call(e,l[h][p],d+=c[h-1][p][1],c[h][p][1]);return t}var r=t,n=Ke,i=Ze,o=Ye,s=$e,a=Je;return e.values=function(t){return arguments.length?(r=t,e):r},e.order=function(t){return arguments.length?(n="function"==typeof t?t:vn.get(t)||Ke,e):n},e.offset=function(t){return arguments.length?(i="function"==typeof t?t:yn.get(t)||Ze,e):i},e.x=function(t){return arguments.length?(s=t,e):s},e.y=function(t){return arguments.length?(a=t,e):a},e.out=function(t){return arguments.length?(o=t,e):o},e};var vn=d3.map({"inside-out":function(e){var t,r,n=e.length,i=e.map(et),o=e.map(tt),s=d3.range(n).sort(function(e,t){return i[e]-i[t]}),a=0,u=0,l=[],c=[];for(t=0;t<n;++t)r=s[t],a<u?(a+=o[r],l.push(r)):(u+=o[r],c.push(r));return c.reverse().concat(l)},reverse:function(e){return d3.range(e.length).reverse()},default:Ke}),yn=d3.map({silhouette:function(e){var t,r,n,i=e.length,o=e[0].length,s=[],a=0,u=[];for(r=0;r<o;++r){for(t=0,n=0;t<i;t++)n+=e[t][r][1];n>a&&(a=n),s.push(n)}for(r=0;r<o;++r)u[r]=(a-s[r])/2;return u},wiggle:function(e){var t,r,n,i,o,s,a,u,l,c=e.length,f=e[0],h=f.length,p=[];for(p[0]=u=l=0,r=1;r<h;++r){for(t=0,i=0;t<c;++t)i+=e[t][r][1];for(t=0,o=0,a=f[r][0]-f[r-1][0];t<c;++t){for(n=0,s=(e[t][r][1]-e[t][r-1][1])/(2*a);n<t;++n)s+=(e[n][r][1]-e[n][r-1][1])/a;o+=s*e[t][r][1]}p[r]=u-=i?o/i*a:0,u<l&&(l=u)}for(r=0;r<h;++r)p[r]-=l;return p},expand:function(e){var t,r,n,i=e.length,o=e[0].length,s=1/i,a=[];for(r=0;r<o;++r){for(t=0,n=0;t<i;t++)n+=e[t][r][1];if(n)for(t=0;t<i;t++)e[t][r][1]/=n;else for(t=0;t<i;t++)e[t][r][1]=s}for(r=0;r<o;++r)a[r]=0;return a},zero:Ze});d3.layout.histogram=function(){function e(e,i){for(var s,a,u=[],l=e.map(r,this),c=n.call(this,l,i),f=o.call(this,c,l,i),h=(i=-1,l.length),p=f.length-1,d=t?1:1/h;++i<p;)(s=u[i]=[]).dx=f[i+1]-(s.x=f[i]),s.y=0;if(p>0)for(i=-1;++i<h;)(a=l[i])>=c[0]&&a<=c[1]&&((s=u[d3.bisect(f,a,1,p)-1]).y+=d,s.push(e[i]));return u}var t=!0,r=Number,n=ot,o=nt;return e.value=function(t){return arguments.length?(r=t,e):r},e.range=function(t){return arguments.length?(n=i(t),e):n},e.bins=function(t){return arguments.length?(o="number"==typeof t?function(e){return it(e,t)}:i(t),e):o},e.frequency=function(r){return arguments.length?(t=!!r,e):t},e},d3.layout.hierarchy=function(){function e(o,s,a){var u=n.call(t,o,s),l=mn?o:{data:o};if(l.depth=s,a.push(l),u&&(c=u.length)){for(var c,f=-1,h=l.children=[],p=0,g=s+1;++f<c;)d=e(u[f],g,a),d.parent=l,h.push(d),p+=d.value;r&&h.sort(r),i&&(l.value=p)}else i&&(l.value=+i.call(t,o,s)||0);return l}function t(t){var r=[];return e(t,0,r),r}var r=lt,n=at,i=ut;return t.sort=function(e){return arguments.length?(r=e,t):r},t.children=function(e){return arguments.length?(n=e,t):n},t.value=function(e){return arguments.length?(i=e,t):i},t.revalue=function(e){return function e(r,n){var o=r.children,s=0;if(o&&(a=o.length))for(var a,u=-1,l=n+1;++u<a;)s+=e(o[u],l);else i&&(s=+i.call(t,mn?r:r.data,n)||0);return i&&(r.value=s),s}(e,0),e},t};var mn=!1;d3.layout.pack=function(){function e(e,n){var i=t.call(this,e,n),o=i[0];o.x=0,o.y=0,yt(o);var s=r[0],a=r[1];return function e(t,r,n,i){var o=t.children;if(t.x=r+=i*t.x,t.y=n+=i*t.y,t.r*=i,o)for(var s=-1,a=o.length;++s<a;)e(o[s],r,n,i)}(o,s/2,a/2,1/Math.max(2*o.r/s,2*o.r/a)),i}var t=d3.layout.hierarchy().sort(ft),r=[1,1];return e.size=function(t){return arguments.length?(r=t,e):r},st(e,t)},d3.layout.cluster=function(){function e(e,i){var o,s=t.call(this,e,i),a=s[0],u=0;At(a,function(e){var t=e.children;t&&t.length?(e.x=function(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}(t),e.y=1+d3.max(t,function(e){return e.y})):(e.x=o?u+=r(e,o):0,e.y=0,o=e)});var l=function e(t){var r=t.children;return r&&r.length?e(r[0]):t}(a),c=function e(t){var r,n=t.children;return n&&(r=n.length)?e(n[r-1]):t}(a),f=l.x-r(l,c)/2,h=c.x+r(c,l)/2;return At(a,function(e){e.x=(e.x-f)/(h-f)*n[0],e.y=(1-(a.y?e.y/a.y:1))*n[1]}),s}var t=d3.layout.hierarchy().sort(null).value(null),r=bt,n=[1,1];return e.separation=function(t){return arguments.length?(r=t,e):r},e.size=function(t){return arguments.length?(n=t,e):n},st(e,t)},d3.layout.tree=function(){function e(e,i){function o(e,t,n){if(t){for(var i,o=e,s=e,a=t,u=e.parent.children[0],l=o._tree.mod,c=s._tree.mod,f=a._tree.mod,h=u._tree.mod;a=xt(a),o=wt(o),a&&o;)u=wt(u),(s=xt(s))._tree.ancestor=e,(i=a._tree.prelim+f-o._tree.prelim-l+r(a,o))>0&&(It(Et(a,e,n),e,i),l+=i,c+=i),f+=a._tree.mod,l+=o._tree.mod,h+=u._tree.mod,c+=s._tree.mod;a&&!xt(s)&&(s._tree.thread=a,s._tree.mod+=f-c),o&&!wt(u)&&(u._tree.thread=o,u._tree.mod+=l-h,n=e)}return n}var s=t.call(this,e,i),a=s[0];At(a,function(e,t){e._tree={ancestor:e,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}}),function e(t,n){var i=t.children,s=t._tree;if(i&&(a=i.length)){for(var a,u,l,c=i[0],f=c,h=-1;++h<a;)e(l=i[h],u),f=o(l,u,f),u=l;!function(e){for(var t,r=0,n=0,i=e.children,o=i.length;--o>=0;)(t=i[o]._tree).prelim+=r,t.mod+=r,r+=t.shift+(n+=t.change)}(t);var p=.5*(c._tree.prelim+l._tree.prelim);n?(s.prelim=n._tree.prelim+r(t,n),s.mod=s.prelim-p):s.prelim=p}else n&&(s.prelim=n._tree.prelim+r(t,n))}(a),function e(t,r){t.x=t._tree.prelim+r;var n=t.children;if(n&&(i=n.length)){var i,o=-1;for(r+=t._tree.mod;++o<i;)e(n[o],r)}}(a,-a._tree.prelim);var u=_t(a,jt),l=_t(a,kt),c=_t(a,Lt),f=u.x-r(u,l)/2,h=l.x+r(l,u)/2,p=c.depth||1;return At(a,function(e){e.x=(e.x-f)/(h-f)*n[0],e.y=e.depth/p*n[1],delete e._tree}),s}var t=d3.layout.hierarchy().sort(null).value(null),r=bt,n=[1,1];return e.separation=function(t){return arguments.length?(r=t,e):r},e.size=function(t){return arguments.length?(n=t,e):n},st(e,t)},d3.layout.treemap=function(){function e(e,t){for(var r,n,i=-1,o=e.length;++i<o;)n=(r=e[i]).value*(t<0?0:t),r.area=isNaN(n)||n<=0?0:n}function t(r){var o=r.children;if(o&&o.length){var s,a,u,l=f(r),c=[],h=o.slice(),p=1/0,d=Math.min(l.dx,l.dy);for(e(h,l.dx*l.dy/r.value),c.area=0;(u=h.length)>0;)c.push(s=h[u-1]),c.area+=s.area,(a=n(c,d))<=p?(h.pop(),p=a):(c.area-=c.pop().area,i(c,d,l,!1),d=Math.min(l.dx,l.dy),c.length=c.area=0,p=1/0);c.length&&(i(c,d,l,!0),c.length=c.area=0),o.forEach(t)}}function r(t){var n=t.children;if(n&&n.length){var o,s=f(t),a=n.slice(),u=[];for(e(a,s.dx*s.dy/t.value),u.area=0;o=a.pop();)u.push(o),u.area+=o.area,null!=o.z&&(i(u,o.z?s.dx:s.dy,s,!a.length),u.length=u.area=0);n.forEach(r)}}function n(e,t){for(var r,n=e.area,i=0,o=1/0,s=-1,a=e.length;++s<a;)(r=e[s].area)&&(r<o&&(o=r),r>i&&(i=r));return t*=t,(n*=n)?Math.max(t*i*p/n,n/(t*o*p)):1/0}function i(e,t,r,n){var i,o=-1,s=e.length,a=r.x,l=r.y,c=t?u(e.area/t):0;if(t==r.dx){for((n||c>r.dy)&&(c=r.dy);++o<s;)(i=e[o]).x=a,i.y=l,i.dy=c,a+=i.dx=Math.min(r.x+r.dx-a,c?u(i.area/c):0);i.z=!0,i.dx+=r.x+r.dx-a,r.y+=c,r.dy-=c}else{for((n||c>r.dx)&&(c=r.dx);++o<s;)(i=e[o]).x=a,i.y=l,i.dx=c,l+=i.dy=Math.min(r.y+r.dy-l,c?u(i.area/c):0);i.z=!1,i.dy+=r.y+r.dy-l,r.x+=c,r.dx-=c}}function o(n){var i=s||a(n),o=i[0];return o.x=0,o.y=0,o.dx=l[0],o.dy=l[1],s&&a.revalue(o),e([o],o.dx*o.dy/o.value),(s?r:t)(o),h&&(s=i),i}var s,a=d3.layout.hierarchy(),u=Math.round,l=[1,1],c=null,f=Ct,h=!1,p=.5*(1+Math.sqrt(5));return o.size=function(e){return arguments.length?(l=e,o):l},o.padding=function(e){function t(t){return Ot(t,e)}return arguments.length?(f=null==(c=e)?Ct:"function"==(r=typeof e)?function(t){var r=e.call(o,t,t.depth);return null==r?Ct(t):Ot(t,"number"==typeof r?[r,r,r,r]:r)}:"number"===r?(e=[e,e,e,e],t):t,o):c;var r},o.round=function(e){return arguments.length?(u=e?Math.round:Number,o):u!=Number},o.sticky=function(e){return arguments.length?(h=e,s=null,o):h},o.ratio=function(e){return arguments.length?(p=e,o):p},st(o,a)},d3.csv=function(e,t){d3.text(e,"text/csv",function(e){t(e&&d3.csv.parse(e))})},d3.csv.parse=function(e){var t;return d3.csv.parseRows(e,function(e,r){if(r){for(var n={},i=-1,o=t.length;++i<o;)n[t[i]]=e[i];return n}return t=e,null})},d3.csv.parseRows=function(e,t){function r(){if(u.lastIndex>=e.length)return s;if(i)return i=!1,o;var t=u.lastIndex;if(34===e.charCodeAt(t)){for(var r=t;r++<e.length;)if(34===e.charCodeAt(r)){if(34!==e.charCodeAt(r+1))break;r++}u.lastIndex=r+2;var n=e.charCodeAt(r+1);return 13===n?(i=!0,10===e.charCodeAt(r+2)&&u.lastIndex++):10===n&&(i=!0),e.substring(t+1,r).replace(/""/g,'"')}var a=u.exec(e);return a?(i=44!==a[0].charCodeAt(0),e.substring(t,a.index)):(u.lastIndex=e.length,e.substring(t))}var n,i,o={},s={},a=[],u=/\r\n|[,\r\n]/g,l=0;for(u.lastIndex=0;(n=r())!==s;){for(var c=[];n!==o&&n!==s;)c.push(n),n=r();t&&!(c=t(c,l++))||a.push(c)}return a},d3.csv.format=function(e){return e.map(Ft).join("\n")},d3.geo={};var bn=Math.PI/180;d3.geo.azimuthal=function(){function e(e){var t,n=e[0]*bn-r,l=e[1]*bn,c=Math.cos(n),f=Math.sin(n),h=Math.cos(l),p=Math.sin(l),d="orthographic"!==s?o*p+i*h*c:null,g="stereographic"===s?1/(1+d):"gnomonic"===s?1/d:"equidistant"===s?(t=Math.acos(d))?t/Math.sin(t):0:"equalarea"===s?Math.sqrt(2/(1+d)):1;return[a*(g*h*f)+u[0],a*(g*(o*h*c-i*p))+u[1]]}var t,r,n,i,o,s="orthographic",a=200,u=[480,250];return e.invert=function(e){var t=(e[0]-u[0])/a,n=(e[1]-u[1])/a,l=Math.sqrt(t*t+n*n),c="stereographic"===s?2*Math.atan(l):"gnomonic"===s?Math.atan(l):"equidistant"===s?l:"equalarea"===s?2*Math.asin(.5*l):Math.asin(l),f=Math.sin(c),h=Math.cos(c);return[(r+Math.atan2(t*f,l*i*h+n*o*f))/bn,Math.asin(h*o-(l?n*f*i/l:0))/bn]},e.mode=function(t){return arguments.length?(s=t+"",e):s},e.origin=function(s){return arguments.length?(r=(t=s)[0]*bn,n=t[1]*bn,i=Math.cos(n),o=Math.sin(n),e):t},e.scale=function(t){return arguments.length?(a=+t,e):a},e.translate=function(t){return arguments.length?(u=[+t[0],+t[1]],e):u},e.origin([0,0])},d3.geo.albers=function(){function e(e){var t=n*(bn*e[0]-r),s=Math.sqrt(i-2*n*Math.sin(bn*e[1]))/n;return[u*s*Math.sin(t)+l[0],u*(s*Math.cos(t)-o)+l[1]]}function t(){var t=bn*a[0],u=bn*a[1],l=bn*s[1],c=Math.sin(t),f=Math.cos(t);return r=bn*s[0],n=.5*(c+Math.sin(u)),i=f*f+2*n*c,o=Math.sqrt(i-2*n*Math.sin(l))/n,e}var r,n,i,o,s=[-98,38],a=[29.5,45.5],u=1e3,l=[480,250];return e.invert=function(e){var t=(e[0]-l[0])/u,s=o+(e[1]-l[1])/u,a=Math.atan2(t,s),c=Math.sqrt(t*t+s*s);return[(r+a/n)/bn,Math.asin((i-c*c*n*n)/(2*n))/bn]},e.origin=function(e){return arguments.length?(s=[+e[0],+e[1]],t()):s},e.parallels=function(e){return arguments.length?(a=[+e[0],+e[1]],t()):a},e.scale=function(t){return arguments.length?(u=+t,e):u},e.translate=function(t){return arguments.length?(l=[+t[0],+t[1]],e):l},t()},d3.geo.albersUsa=function(){function e(e){var o=e[1];return(o>50?r:e[0]<-140?n:o<21?i:t)(e)}var t=d3.geo.albers(),r=d3.geo.albers().origin([-160,60]).parallels([55,65]),n=d3.geo.albers().origin([-160,20]).parallels([8,18]),i=d3.geo.albers().origin([-60,10]).parallels([8,18]);return e.scale=function(o){return arguments.length?(t.scale(o),r.scale(.6*o),n.scale(o),i.scale(1.5*o),e.translate(t.translate())):t.scale()},e.translate=function(o){if(!arguments.length)return t.translate();var s=t.scale()/1e3,a=o[0],u=o[1];return t.translate(o),r.translate([a-400*s,u+170*s]),n.translate([a-190*s,u+200*s]),i.translate([a+580*s,u+430*s]),e},e.scale(t.scale())},d3.geo.bonne=function(){function e(e){var a=e[0]*bn-t,u=e[1]*bn-r;if(n){var l=i+n-u,c=a*Math.cos(u)/l;a=l*Math.sin(c),u=l*Math.cos(c)-i}else a*=Math.cos(u),u*=-1;return[o*a+s[0],o*u+s[1]]}var t,r,n,i,o=200,s=[480,250];return e.invert=function(e){var r=(e[0]-s[0])/o,a=(e[1]-s[1])/o;if(n){var u=i+a,l=Math.sqrt(r*r+u*u);a=i+n-l,r=t+l*Math.atan2(r,u)/Math.cos(a)}else a*=-1,r/=Math.cos(a);return[r/bn,a/bn]},e.parallel=function(t){return arguments.length?(i=1/Math.tan(n=t*bn),e):n/bn},e.origin=function(n){return arguments.length?(t=n[0]*bn,r=n[1]*bn,e):[t/bn,r/bn]},e.scale=function(t){return arguments.length?(o=+t,e):o},e.translate=function(t){return arguments.length?(s=[+t[0],+t[1]],e):s},e.origin([0,0]).parallel(45)},d3.geo.equirectangular=function(){function e(e){return[t*(e[0]/360)+r[0],t*(-e[1]/360)+r[1]]}var t=500,r=[480,250];return e.invert=function(e){return[(e[0]-r[0])/t*360,(e[1]-r[1])/t*-360]},e.scale=function(r){return arguments.length?(t=+r,e):t},e.translate=function(t){return arguments.length?(r=[+t[0],+t[1]],e):r},e},d3.geo.mercator=function(){function e(e){var n=e[0]/360,i=-Math.log(Math.tan(Math.PI/4+e[1]*bn/2))/bn/360;return[t*n+r[0],t*Math.max(-.5,Math.min(.5,i))+r[1]]}var t=500,r=[480,250];return e.invert=function(e){return[(e[0]-r[0])/t*360,2*Math.atan(Math.exp((e[1]-r[1])/t*-360*bn))/bn-90]},e.scale=function(r){return arguments.length?(t=+r,e):t},e.translate=function(t){return arguments.length?(r=[+t[0],+t[1]],e):r},e},d3.geo.path=function(){function e(e,t){return"function"==typeof o&&(s=Tt(o.apply(this,arguments))),u(e)||null}function t(e){return a(e).join(",")}function r(e){for(var t=i(e[0]),r=0,n=e.length;++r<n;)t-=i(e[r]);return t}function n(e){for(var t=d3.geom.polygon(e[0].map(a)),r=t.area(),n=t.centroid(r<0?(r*=-1,1):-1),i=n[0],o=n[1],s=r,u=0,l=e.length;++u<l;)r=(t=d3.geom.polygon(e[u].map(a))).area(),i-=(n=t.centroid(r<0?(r*=-1,1):-1))[0],o-=n[1],s-=r;return[i,o,6*s]}function i(e){return Math.abs(d3.geom.polygon(e.map(a)).area())}var o=4.5,s=Tt(o),a=d3.geo.albersUsa(),u=Rt({FeatureCollection:function(e){for(var t=[],r=e.features,n=-1,i=r.length;++n<i;)t.push(u(r[n].geometry));return t.join("")},Feature:function(e){return u(e.geometry)},Point:function(e){return"M"+t(e.coordinates)+s},MultiPoint:function(e){for(var r=[],n=e.coordinates,i=-1,o=n.length;++i<o;)r.push("M",t(n[i]),s);return r.join("")},LineString:function(e){for(var r=["M"],n=e.coordinates,i=-1,o=n.length;++i<o;)r.push(t(n[i]),"L");return r.pop(),r.join("")},MultiLineString:function(e){for(var r,n,i,o=[],s=e.coordinates,a=-1,u=s.length;++a<u;){for(n=-1,i=(r=s[a]).length,o.push("M");++n<i;)o.push(t(r[n]),"L");o.pop()}return o.join("")},Polygon:function(e){for(var r,n,i,o=[],s=e.coordinates,a=-1,u=s.length;++a<u;)if(n=-1,(i=(r=s[a]).length-1)>0){for(o.push("M");++n<i;)o.push(t(r[n]),"L");o[o.length-1]="Z"}return o.join("")},MultiPolygon:function(e){for(var r,n,i,o,s,a,u=[],l=e.coordinates,c=-1,f=l.length;++c<f;)for(n=-1,i=(r=l[c]).length;++n<i;)if(s=-1,(a=(o=r[n]).length-1)>0){for(u.push("M");++s<a;)u.push(t(o[s]),"L");u[u.length-1]="Z"}return u.join("")},GeometryCollection:function(e){for(var t=[],r=e.geometries,n=-1,i=r.length;++n<i;)t.push(u(r[n]));return t.join("")}}),l=e.area=Rt({FeatureCollection:function(e){for(var t=0,r=e.features,n=-1,i=r.length;++n<i;)t+=l(r[n]);return t},Feature:function(e){return l(e.geometry)},Polygon:function(e){return r(e.coordinates)},MultiPolygon:function(e){for(var t=0,n=e.coordinates,i=-1,o=n.length;++i<o;)t+=r(n[i]);return t},GeometryCollection:function(e){for(var t=0,r=e.geometries,n=-1,i=r.length;++n<i;)t+=l(r[n]);return t}},0),c=e.centroid=Rt({Feature:function(e){return c(e.geometry)},Polygon:function(e){var t=n(e.coordinates);return[t[0]/t[2],t[1]/t[2]]},MultiPolygon:function(e){for(var t,r=e.coordinates,i=0,o=0,s=0,a=-1,u=r.length;++a<u;)i+=(t=n(r[a]))[0],o+=t[1],s+=t[2];return[i/s,o/s]}});return e.projection=function(t){return a=t,e},e.pointRadius=function(t){return"function"==typeof t?o=t:s=Tt(o=+t),e},e},d3.geo.bounds=function(e){var t=1/0,r=1/0,n=-1/0,i=-1/0;return Mt(e,function(e,o){e<t&&(t=e),e>n&&(n=e),o<r&&(r=o),o>i&&(i=o)}),[[t,r],[n,i]]};var wn={Feature:function(e,t){Mt(e.geometry,t)},FeatureCollection:function(e,t){for(var r=e.features,n=0,i=r.length;n<i;n++)Mt(r[n].geometry,t)},GeometryCollection:function(e,t){for(var r=e.geometries,n=0,i=r.length;n<i;n++)Mt(r[n],t)},LineString:Nt,MultiLineString:function(e,t){for(var r=e.coordinates,n=0,i=r.length;n<i;n++)for(var o=r[n],s=0,a=o.length;s<a;s++)t.apply(null,o[s])},MultiPoint:Nt,MultiPolygon:function(e,t){for(var r=e.coordinates,n=0,i=r.length;n<i;n++)for(var o=r[n][0],s=0,a=o.length;s<a;s++)t.apply(null,o[s])},Point:function(e,t){t.apply(null,e.coordinates)},Polygon:function(e,t){for(var r=e.coordinates[0],n=0,i=r.length;n<i;n++)t.apply(null,r[n])}};d3.geo.circle=function(){function e(){}function r(e){return a.distance(e)<s}function n(e){for(var t,r,n,i,o,u=-1,l=e.length,c=[];++u<l;)(o=a.distance(n=e[u]))<s?(r&&c.push(Ut(r,n)((i-s)/(i-o))),c.push(n),t=r=null):(r=n,!t&&c.length&&(c.push(Ut(c[c.length-1],r)((s-i)/(o-i))),t=r)),i=o;return r&&c.length&&(o=a.distance(n=c[0]),c.push(Ut(r,n)((i-s)/(i-o)))),function(e){for(var t,r,n,i=0,o=e.length,s=o?[e[0]]:e,u=a.source();++i<o;)for(t=0,r=(n=a.source(e[i-1])(e[i]).coordinates).length;++t<r;)s.push(n[t]);return a.source(u),s}(c)}var i=[0,0],o=89.99,s=o*bn,a=d3.geo.greatArc().target(t);e.clip=function(e){return a.source("function"==typeof i?i.apply(this,arguments):i),u(e)};var u=Rt({FeatureCollection:function(e){var r=e.features.map(u).filter(t);return r&&((e=Object.create(e)).features=r,e)},Feature:function(e){var t=u(e.geometry);return t&&((e=Object.create(e)).geometry=t,e)},Point:function(e){return r(e.coordinates)&&e},MultiPoint:function(e){var t=e.coordinates.filter(r);return t.length&&{type:e.type,coordinates:t}},LineString:function(e){var t=n(e.coordinates);return t.length&&((e=Object.create(e)).coordinates=t,e)},MultiLineString:function(e){var t=e.coordinates.map(n).filter(function(e){return e.length});return t.length&&((e=Object.create(e)).coordinates=t,e)},Polygon:function(e){var t=e.coordinates.map(n);return t[0].length&&((e=Object.create(e)).coordinates=t,e)},MultiPolygon:function(e){var t=e.coordinates.map(function(e){return e.map(n)}).filter(function(e){return e[0].length});return t.length&&((e=Object.create(e)).coordinates=t,e)},GeometryCollection:function(e){var r=e.geometries.map(u).filter(t);return r.length&&((e=Object.create(e)).geometries=r,e)}});return e.origin=function(t){return arguments.length?(i=t,e):i},e.angle=function(t){return arguments.length?(s=(o=+t)*bn,e):o},e.precision=function(t){return arguments.length?(a.precision(t),e):a.precision()},e},d3.geo.greatArc=function(){function e(){for(var e="function"==typeof t?t.apply(this,arguments):t,i="function"==typeof r?r.apply(this,arguments):r,o=Ut(e,i),s=n/o.d,a=0,u=[e];(a+=s)<1;)u.push(o(a));return u.push(i),{type:"LineString",coordinates:u}}var t=Dt,r=Pt,n=6*bn;return e.distance=function(){return Ut("function"==typeof t?t.apply(this,arguments):t,"function"==typeof r?r.apply(this,arguments):r).d},e.source=function(r){return arguments.length?(t=r,e):t},e.target=function(t){return arguments.length?(r=t,e):r},e.precision=function(t){return arguments.length?(n=t*bn,e):n/bn},e},d3.geo.greatCircle=d3.geo.circle,d3.geom={},d3.geom.contour=function(e,t){var r=t||function(e){for(var t=0,r=0;;){if(e(t,r))return[t,r];0===t?(t=r+1,r=0):(t-=1,r+=1)}}(e),n=[],i=r[0],o=r[1],s=0,a=0,u=NaN,l=NaN,c=0;do{c=0,e(i-1,o-1)&&(c+=1),e(i,o-1)&&(c+=2),e(i-1,o)&&(c+=4),e(i,o)&&(c+=8),6===c?(s=-1===l?-1:1,a=0):9===c?(s=0,a=1===u?-1:1):(s=xn[c],a=_n[c]),s!=u&&a!=l&&(n.push([i,o]),u=s,l=a),i+=s,o+=a}while(r[0]!=i||r[1]!=o);return n};var xn=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],_n=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];d3.geom.hull=function(e){if(e.length<3)return[];var t,r,n,i,o,s,a,u,l,c,f=e.length,h=f-1,p=[],d=[],g=0;for(t=1;t<f;++t)e[t][1]<e[g][1]?g=t:e[t][1]==e[g][1]&&(g=e[t][0]<e[g][0]?t:g);for(t=0;t<f;++t)t!==g&&(i=e[t][1]-e[g][1],n=e[t][0]-e[g][0],p.push({angle:Math.atan2(i,n),index:t}));for(p.sort(function(e,t){return e.angle-t.angle}),l=p[0].angle,u=p[0].index,a=0,t=1;t<h;++t)r=p[t].index,l==p[t].angle?(n=e[u][0]-e[g][0])*n+(i=e[u][1]-e[g][1])*i>=(o=e[r][0]-e[g][0])*o+(s=e[r][1]-e[g][1])*s?p[t].index=-1:(p[a].index=-1,l=p[t].angle,a=t,u=r):(l=p[t].angle,a=t,u=r);for(d.push(g),t=0,r=0;t<2;++r)-1!==p[r].index&&(d.push(p[r].index),t++);for(c=d.length;r<h;++r)if(-1!==p[r].index){for(;!Qt(d[c-2],d[c-1],p[r].index,e);)--c;d[c++]=p[r].index}var v=[];for(t=0;t<c;++t)v.push(e[d[t]]);return v},d3.geom.polygon=function(e){return e.area=function(){for(var t=0,r=e.length,n=e[r-1][0]*e[0][1],i=e[r-1][1]*e[0][0];++t<r;)n+=e[t-1][0]*e[t][1],i+=e[t-1][1]*e[t][0];return.5*(i-n)},e.centroid=function(t){var r,n,i=-1,o=e.length,s=0,a=0,u=e[o-1];for(arguments.length||(t=-1/(6*e.area()));++i<o;)s+=((r=u)[0]+(u=e[i])[0])*(n=r[0]*u[1]-u[0]*r[1]),a+=(r[1]+u[1])*n;return[s*t,a*t]},e.clip=function(t){for(var r,n,i,o,s,a,u=-1,l=e.length,c=e[l-1];++u<l;){for(r=t.slice(),t.length=0,o=e[u],s=r[(i=r.length)-1],n=-1;++n<i;)Bt(a=r[n],c,o)?(Bt(s,c,o)||t.push(Wt(s,a,c,o)),t.push(a)):Bt(s,c,o)&&t.push(Wt(s,a,c,o)),s=a;c=o}return t},e},d3.geom.voronoi=function(e){var t=e.map(function(){return[]});return qt(e,function(e){var r,n,i,o,s,a;1===e.a&&e.b>=0?(r=e.ep.r,n=e.ep.l):(r=e.ep.l,n=e.ep.r),1===e.a?(i=e.c-e.b*(s=r?r.y:-1e6),o=e.c-e.b*(a=n?n.y:1e6)):(s=e.c-e.a*(i=r?r.x:-1e6),a=e.c-e.a*(o=n?n.x:1e6));var u=[i,s],l=[o,a];t[e.region.l.index].push(u,l),t[e.region.r.index].push(u,l)}),t.map(function(t,r){var n=e[r][0],i=e[r][1];return t.forEach(function(e){e.angle=Math.atan2(e[0]-n,e[1]-i)}),t.sort(function(e,t){return e.angle-t.angle}).filter(function(e,r){return!r||e.angle-t[r-1].angle>1e-10})})};var kn={l:"r",r:"l"};d3.geom.delaunay=function(e){var t=e.map(function(){return[]}),r=[];return qt(e,function(r){t[r.region.l.index].push(e[r.region.r.index])}),t.forEach(function(t,n){var i=e[n],o=i[0],s=i[1];t.forEach(function(e){e.angle=Math.atan2(e[0]-o,e[1]-s)}),t.sort(function(e,t){return e.angle-t.angle});for(var a=0,u=t.length-1;a<u;a++)r.push([i,t[a],t[a+1]])}),r},d3.geom.quadtree=function(e,t,r,n,i){function o(e,t,r,n,i,o){if(!isNaN(t.x)&&!isNaN(t.y))if(e.leaf){var a=e.point;a?Math.abs(a.x-t.x)+Math.abs(a.y-t.y)<.01?s(e,t,r,n,i,o):(e.point=null,s(e,a,r,n,i,o),s(e,t,r,n,i,o)):e.point=t}else s(e,t,r,n,i,o)}function s(e,t,r,n,i,s){var a=.5*(r+i),u=.5*(n+s),l=t.x>=a,c=t.y>=u,f=(c<<1)+l;e.leaf=!1,e=e.nodes[f]||(e.nodes[f]={leaf:!0,nodes:[],point:null,add:function(e){o(h,e,t,r,n,i)},visit:function(e){!function e(t,r,n,i,o,s){if(!t(r,n,i,o,s)){var a=.5*(n+o),u=.5*(i+s),l=r.nodes;l[0]&&e(t,l[0],n,i,a,u),l[1]&&e(t,l[1],a,i,o,u),l[2]&&e(t,l[2],n,u,a,s),l[3]&&e(t,l[3],a,u,o,s)}}(e,h,t,r,n,i)}}),l?r=a:i=a,c?n=u:s=u,o(e,t,r,n,i,s)}var a,u=-1,l=e.length;if(l&&isNaN(e[0].x)&&(e=e.map(Xt)),arguments.length<5)if(3===arguments.length)i=n=r,r=t;else{for(t=r=1/0,n=i=-1/0;++u<l;)(a=e[u]).x<t&&(t=a.x),a.y<r&&(r=a.y),a.x>n&&(n=a.x),a.y>i&&(i=a.y);var c=n-t,f=i-r;c>f?i=r+c:n=t+f}var h={leaf:!0,nodes:[],point:null,add:function(e){o(h,e,t,r,n,i)},visit:function(e){!function e(t,r,n,i,o,s){if(!t(r,n,i,o,s)){var a=.5*(n+o),u=.5*(i+s),l=r.nodes;l[0]&&e(t,l[0],n,i,a,u),l[1]&&e(t,l[1],a,i,o,u),l[2]&&e(t,l[2],n,u,a,s),l[3]&&e(t,l[3],a,u,o,s)}}(e,h,t,r,n,i)}};return e.forEach(h.add),h},d3.time={};var jn=Date;Gt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Ln.setUTCDate.apply(this._,arguments)},setDay:function(){Ln.setUTCDay.apply(this._,arguments)},setFullYear:function(){Ln.setUTCFullYear.apply(this._,arguments)},setHours:function(){Ln.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Ln.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Ln.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Ln.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Ln.setUTCSeconds.apply(this._,arguments)},setTime:function(){Ln.setTime.apply(this._,arguments)}};var Ln=Date.prototype;d3.time.format=function(e){function t(t){for(var n,i,o=[],s=-1,a=0;++s<r;)37==e.charCodeAt(s)&&(o.push(e.substring(a,s),(i=On[n=e.charAt(++s)])?i(t):n),a=s+1);return o.push(e.substring(a,s)),o.join("")}var r=e.length;return t.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0};if(zt(r,e,t,0)!=t.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var n=new jn;return n.setFullYear(r.y,r.m,r.d),n.setHours(r.H,r.M,r.S,r.L),n},t.toString=function(){return e},t};var An=d3.format("02d"),In=d3.format("03d"),En=d3.format("04d"),Cn=d3.format("2d"),On={a:function(e){return Tn[e.getDay()].substring(0,3)},A:function(e){return Tn[e.getDay()]},b:function(e){return Pn[e.getMonth()].substring(0,3)},B:function(e){return Pn[e.getMonth()]},c:d3.time.format("%a %b %e %H:%M:%S %Y"),d:function(e){return An(e.getDate())},e:function(e){return Cn(e.getDate())},H:function(e){return An(e.getHours())},I:function(e){return An(e.getHours()%12||12)},j:function(e){return In(1+d3.time.dayOfYear(e))},L:function(e){return In(e.getMilliseconds())},m:function(e){return An(e.getMonth()+1)},M:function(e){return An(e.getMinutes())},p:function(e){return e.getHours()>=12?"PM":"AM"},S:function(e){return An(e.getSeconds())},U:function(e){return An(d3.time.sundayOfYear(e))},w:function(e){return e.getDay()},W:function(e){return An(d3.time.mondayOfYear(e))},x:d3.time.format("%m/%d/%y"),X:d3.time.format("%H:%M:%S"),y:function(e){return An(e.getFullYear()%100)},Y:function(e){return En(e.getFullYear()%1e4)},Z:function(e){var t=e.getTimezoneOffset(),r=t>0?"-":"+",n=~~(Math.abs(t)/60),i=Math.abs(t)%60;return r+An(n)+An(i)},"%":function(e){return"%"}},Fn={a:function(e,t,r){return Sn.test(t.substring(r,r+=3))?r:-1},A:function(e,t,r){Rn.lastIndex=0;var n=Rn.exec(t.substring(r,r+10));return n?r+=n[0].length:-1},b:function(e,t,r){var n=Mn.get(t.substring(r,r+=3).toLowerCase());return null==n?-1:(e.m=n,r)},B:function(e,t,r){Nn.lastIndex=0;var n=Nn.exec(t.substring(r,r+12));return n?(e.m=Dn.get(n[0].toLowerCase()),r+=n[0].length):-1},c:function(e,t,r){return zt(e,On.c.toString(),t,r)},d:Ht,e:Ht,H:Vt,I:Vt,L:function(e,t,r){Un.lastIndex=0;var n=Un.exec(t.substring(r,r+3));return n?(e.L=+n[0],r+=n[0].length):-1},m:function(e,t,r){Un.lastIndex=0;var n=Un.exec(t.substring(r,r+2));return n?(e.m=n[0]-1,r+=n[0].length):-1},M:function(e,t,r){Un.lastIndex=0;var n=Un.exec(t.substring(r,r+2));return n?(e.M=+n[0],r+=n[0].length):-1},p:function(e,t,r){var n=Qn.get(t.substring(r,r+=2).toLowerCase());return null==n?-1:(e.p=n,r)},S:function(e,t,r){Un.lastIndex=0;var n=Un.exec(t.substring(r,r+2));return n?(e.S=+n[0],r+=n[0].length):-1},x:function(e,t,r){return zt(e,On.x.toString(),t,r)},X:function(e,t,r){return zt(e,On.X.toString(),t,r)},y:function(e,t,r){Un.lastIndex=0;var n=Un.exec(t.substring(r,r+2));return n?(e.y=1e3*~~((new Date).getFullYear()/1e3)+ +n[0],r+=n[0].length):-1},Y:function(e,t,r){Un.lastIndex=0;var n=Un.exec(t.substring(r,r+4));return n?(e.y=+n[0],r+=n[0].length):-1}},Sn=/^(?:sun|mon|tue|wed|thu|fri|sat)/i,Rn=/^(?:Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday)/i,Tn=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Mn=d3.map({jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11}),Nn=/^(?:January|February|March|April|May|June|July|August|September|October|November|December)/gi,Dn=d3.map({january:0,february:1,march:2,april:3,may:4,june:5,july:6,august:7,september:8,october:9,november:10,december:11}),Pn=["January","February","March","April","May","June","July","August","September","October","November","December"],Un=/\s*\d+/,Qn=d3.map({am:0,pm:1});d3.time.format.utc=function(e){function t(e){try{var t=new(jn=Gt);return t._=e,r(t)}finally{jn=Date}}var r=d3.time.format(e);return t.parse=function(e){try{jn=Gt;var t=r.parse(e);return t&&t._}finally{jn=Date}},t.toString=r.toString,t};var Bn=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");d3.time.format.iso=Date.prototype.toISOString?$t:Bn,$t.parse=function(e){return new Date(e)},$t.toString=Bn.toString,d3.time.second=Jt(function(e){return new jn(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(e.getTime()+1e3*Math.floor(t))},function(e){return e.getSeconds()}),d3.time.seconds=d3.time.second.range,d3.time.seconds.utc=d3.time.second.utc.range,d3.time.minute=Jt(function(e){return new jn(6e4*Math.floor(e/6e4))},function(e,t){e.setTime(e.getTime()+6e4*Math.floor(t))},function(e){return e.getMinutes()}),d3.time.minutes=d3.time.minute.range,d3.time.minutes.utc=d3.time.minute.utc.range,d3.time.hour=Jt(function(e){var t=e.getTimezoneOffset()/60;return new jn(36e5*(Math.floor(e/36e5-t)+t))},function(e,t){e.setTime(e.getTime()+36e5*Math.floor(t))},function(e){return e.getHours()}),d3.time.hours=d3.time.hour.range,d3.time.hours.utc=d3.time.hour.utc.range,d3.time.day=Jt(function(e){return new jn(e.getFullYear(),e.getMonth(),e.getDate())},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),d3.time.days=d3.time.day.range,d3.time.days.utc=d3.time.day.utc.range,d3.time.dayOfYear=function(e){var t=d3.time.year(e);return Math.floor((e-t)/864e5-(e.getTimezoneOffset()-t.getTimezoneOffset())/1440)},Tn.forEach(function(e,t){e=e.toLowerCase(),t=7-t;var r=d3.time[e]=Jt(function(e){return(e=d3.time.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+7*Math.floor(t))},function(e){var r=d3.time.year(e).getDay();return Math.floor((d3.time.dayOfYear(e)+(r+t)%7)/7)-(r!==t)});d3.time[e+"s"]=r.range,d3.time[e+"s"].utc=r.utc.range,d3.time[e+"OfYear"]=function(e){var r=d3.time.year(e).getDay();return Math.floor((d3.time.dayOfYear(e)+(r+t)%7)/7)}}),d3.time.week=d3.time.sunday,d3.time.weeks=d3.time.sunday.range,d3.time.weeks.utc=d3.time.sunday.utc.range,d3.time.weekOfYear=d3.time.sundayOfYear,d3.time.month=Jt(function(e){return new jn(e.getFullYear(),e.getMonth(),1)},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),d3.time.months=d3.time.month.range,d3.time.months.utc=d3.time.month.utc.range,d3.time.year=Jt(function(e){return new jn(e.getFullYear(),0,1)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),d3.time.years=d3.time.year.range,d3.time.years.utc=d3.time.year.utc.range;var Wn=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],qn=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]],Xn=[[d3.time.format("%Y"),function(e){return!0}],[d3.time.format("%B"),function(e){return e.getMonth()}],[d3.time.format("%b %d"),function(e){return 1!=e.getDate()}],[d3.time.format("%a %d"),function(e){return e.getDay()&&1!=e.getDate()}],[d3.time.format("%I %p"),function(e){return e.getHours()}],[d3.time.format("%I:%M"),function(e){return e.getMinutes()}],[d3.time.format(":%S"),function(e){return e.getSeconds()}],[d3.time.format(".%L"),function(e){return e.getMilliseconds()}]],Gn=d3.scale.linear(),zn=tr(Xn);qn.year=function(e,t){return Gn.domain(e.map(nr)).ticks(t).map(rr)},d3.time.scale=function(){return Kt(d3.scale.linear(),qn,zn)};var Hn=qn.map(function(e){return[e[0].utc,e[1]]}),Vn=tr([[d3.time.format.utc("%Y"),function(e){return!0}],[d3.time.format.utc("%B"),function(e){return e.getUTCMonth()}],[d3.time.format.utc("%b %d"),function(e){return 1!=e.getUTCDate()}],[d3.time.format.utc("%a %d"),function(e){return e.getUTCDay()&&1!=e.getUTCDate()}],[d3.time.format.utc("%I %p"),function(e){return e.getUTCHours()}],[d3.time.format.utc("%I:%M"),function(e){return e.getUTCMinutes()}],[d3.time.format.utc(":%S"),function(e){return e.getUTCSeconds()}],[d3.time.format.utc(".%L"),function(e){return e.getUTCMilliseconds()}]]);Hn.year=function(e,t){return Gn.domain(e.map(or)).ticks(t).map(ir)},d3.time.scale.utc=function(){return Kt(d3.scale.linear(),Hn,Vn)}}(),jOWL=window.jOWL=function(e,t){return jOWL.getResource(e,t)},jOWL.version="1.0";try{console.log("...")}catch(e){console=window.console={log:function(){}}}!function($){jOWL.NS=function(e,t){if(!arguments.length)return"xmlns:"+jOWL.NS.owl.prefix+"='"+jOWL.NS.owl()+"' xmlns:"+jOWL.NS.rdf.prefix+"='"+jOWL.NS.rdf()+"' xmlns:"+jOWL.NS.rdfs.prefix+"='"+jOWL.NS.rdfs()+"' xmlns:"+jOWL.NS.xsd.prefix+" ='"+jOWL.NS.xsd()+"'";if(1!=arguments.length)jOWL.NS[e]=function(e){return e?"base"==arguments.callee.prefix?e:arguments.callee.prefix+":"+e:arguments.callee.URI},jOWL.NS[e].prefix=e,jOWL.NS[e].URI=t;else{for(var r=e.get(0).attributes,n=0;n<r.length;n++){var i=r[n].nodeName.split(":");2==i.length&&(r[n].nodeValue==jOWL.NS.owl.URI?jOWL.NS.owl.prefix=i[1]:r[n].nodeValue==jOWL.NS.rdf.URI?jOWL.NS.rdf.prefix=i[1]:r[n].nodeValue==jOWL.NS.rdfs.URI?jOWL.NS.rdfs.prefix=i[1]:r[n].nodeValue==jOWL.NS.xsd.URI?jOWL.NS.xsd.prefix=i[1]:jOWL.NS(i[1],r[n].nodeValue))}jOWL.namespace=e.xmlAttr("xml:base")||e.xmlAttr("xmlns")}};var __=jOWL.NS;__("owl","http://www.w3.org/2002/07/owl#"),__("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),__("rdfs","http://www.w3.org/2000/01/rdf-schema#"),__("xsd","http://www.w3.org/2001/XMLSchema#"),$.fn.extend({xmlAttr:function(e){var t=this[0].attributes;if(t)for(var r=0;r<t.length;r++)if(t[r].nodeName==e)return t[r].nodeValue},RDF_ID:function(e){var t=this.xmlAttr(__.rdf("ID"));return!!t&&(t=jOWL.resolveURI(t),e?t.toLowerCase()==jOWL.resolveURI(e.toString()).toLowerCase():t)},RDF_Resource:function(e){if(!this.length)return!1;var t=this.xmlAttr(__.rdf("resource"));if(!t){var r=this.get(0);switch(r.nodeName){case __.rdfs("subClassOf"):case __.owl("disjointWith"):case __.owl("allValuesFrom"):case __.owl("someValuesFrom"):t=function(e){var t=jOWL.Xpath(__.owl("Class"),e);return 1==t.length&&new jOWL.Ontology.Class(t).URI}(r);break;case __.owl("onProperty"):var n=jOWL.Xpath(__.owl("ObjectProperty"),r);0===n.length&&(n=jOWL.Xpath(__.owl("DatatypeProperty"),r)),0===n.length&&(n=jOWL.Xpath(__.owl("FunctionalProperty"),r)),t=n.xmlAttr(__.rdf("about"));break;default:return!1}}return!!t&&(t=jOWL.resolveURI(t),e?t.toLowerCase()==jOWL.resolveURI(e.toString()).toLowerCase():t)},RDF_About:function(e){var t=this.xmlAttr(__.rdf("about"));return!!t&&(t=jOWL.resolveURI(t),e?t.toLowerCase()==jOWL.resolveURI(e.toString()).toLowerCase():t)}}),document.implementation.hasFeature("XPath","3.0")&&(XMLDocument.prototype.selectNodes=function(e,t){t||(t=this);for(var r=this.createNSResolver(this.documentElement),n=this.evaluate(e,t,r,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),i=[],o=0;o<n.snapshotLength;o++)i[o]=n.snapshotItem(o);return i},Element.prototype.selectNodes=function(e){if(this.ownerDocument.selectNodes)return this.ownerDocument.selectNodes(e,this);throw"For XML Elements Only"},XMLDocument.prototype.selectSingleNode=function(e,t){t||(t=this);var r=this.selectNodes(e,t);return r.length>0?r[0]:null},Element.prototype.selectSingleNode=function(e){if(this.ownerDocument.selectSingleNode)return this.ownerDocument.selectSingleNode(e,this);throw"For XML Elements Only"}),jOWL.Xpath=function(e,t){var r=null;t&&(r=t.each?t.get(0):t);var n=r?r.selectNodes(e):jOWL.document.selectNodes(e);return $($.browser.msie?$.makeArray(n):n)},jOWL.Xpath.classes=function(e){var t=[];return jOWL.Xpath(__.rdfs("subClassOf"),e).each(function(){var e=$(this).RDF_Resource();e&&t.push(e)}),jOWL.Xpath(__.owl("intersectionOf")+"/"+__.owl("Class"),e).each(function(){var e=$(this).RDF_About();e&&t.push(e)}),t},jOWL.priv={Array:{isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},pushUnique:function(e,t){return-1===jOWL.priv.Array.getIndex(e,t)&&(e.push(t),!0)},getIndex:function(e,t){for(var r=0;r<e.length;r++)if(t==e[r])return r;return-1},unique:function(e){for(var t=[],r="",n=0;n<e.length;n++){var i=e[n];i!=r&&(t[t.length]=i),r=i}return t}}},jOWL.Literal=function(e){this.name=e},jOWL.Ontology=function(){return this instanceof arguments.callee?(this.parse(jOWL.Xpath("/"+__.rdf("RDF")+"/"+__.owl("Ontology"))),this):new jOWL.Ontology},jOWL.Ontology.Thing=function(e){this.parse(e)},jOWL.Ontology.Thing.prototype={jOWL:jOWL.version,equals:function(e){return("string"==typeof e?jOWL.resolveURI(e):e.URI)===this.URI},parse:function(e){var t;e.length&&("string"==typeof e?(t=e,e=$()):(t=e.RDF_ID()||e.RDF_About())||(t="anonymousOntologyObject",this.isAnonymous=!0),t=jOWL.resolveURI(t),this.isExternal=jOWL.isExternal(t),this.isExternal?(this.baseURI=this.isExternal[0],this.name=this.isExternal[1],this.URI=this.baseURI+this.name):(this.baseURI=jOWL.namespace,this.name=t,this.URI=this.name),this.jnode=e,this.type=e.get(0).nodeName)},annotations:function(e){return jOWL.Xpath(e,this.jnode)},description:function(){return $.map(this.annotations(__.rdfs("comment")),function(e){return $(e).text()})},terms:function(){var e=[],t=this;return jOWL.options.dictionary.addID&&"anonymousOntologyObject"!=this.name&&e.push([this.name.beautify(),this.URI,jOWL.options.defaultlocale,this.type]),this.annotations(__.rdfs("label")).each(function(){for(var r=$(this),n=r.xmlAttr("xml:lang")||jOWL.options.defaultlocale,i=r.text(),o=!1,s=0;s<e.length;s++)e[s][0].toUpperCase()==i.toUpperCase()&&e[s][2]==n&&(o=!0);o||e.push([r.text(),t.URI,n,t.type])}),e},label:function(){var e=!1;return this.annotations(__.rdfs("label")).each(function(){var t=$(this);return jOWL.options.locale?(t.xmlAttr("xml:lang")||jOWL.options.defaultlocale)==jOWL.options.locale?(e=t.text(),!1):void 0:(e=t.text(),!1)}),e||("anonymousOntologyObject"==this.name?jOWL.Manchester(this)||"anonymous Object":jOWL.options.niceClassLabels&&(this.isClass||this.isThing)?this.name.beautify():this.name)},bind:function(e){return e.text(this.label()).attr("typeof",this.type).attr("title",this.URI)}},jOWL.Ontology.prototype=jOWL.Ontology.Thing.prototype,jOWL.priv.testObjectTarget=function(e,t){if(e.isArray){for(var r=0;r<e.length;r++)if(jOWL.priv.testObjectTarget(e.get(r),t))return!0;return!1}if(e.isClass){var n=e.individuals();for(r=0;r<n.length;r++)if(n.get(r).URI==t)return!0}else if(e.URI==t)return!0;return!1},jOWL.Ontology.Individual=function(e,t){if(this.parse(e),this.type==__.owl("Thing")){var r=jOWL.Xpath(__.rdf("type"),this.jnode);if(!r.length)throw"unable to find a Class for the Individual "+this.name;this.Class=$(r[0]).RDF_Resource()}else this.Class=jOWL.resolveURI(e.get(0));this.type=__.owl("Thing"),t&&this.owlClass(t)},jOWL.Ontology.Individual.prototype=$.extend({},jOWL.Ontology.Thing.prototype,{isThing:!0,owlClass:function(e){if(!e){var t=jOWL.data(this.name,"class");return t||(t=jOWL(this.Class))&&this.owlClass(t),t}jOWL.data(this.name,"class",e)},sourceof:function(e,t,r){r=$.extend({inherited:!0,transitive:!0,ignoreGenerics:!1,ignoreClasses:!0,valuesOnly:!0},r);var n=new jOWL.Ontology.Array;return this.jnode.children().filter(function(){return this.prefix!=__.rdfs.prefix&&this.prefix!=__.rdf.prefix&&this.prefix!=__.owl.prefix}).each(function(){var i=new jOWL.Ontology.Restriction($(this)),o=!e,s=!t;if(o||(o=e.isArray?e.contains(i.property):e.URI==i.property.URI)){if(t)i.property.isObjectProperty?!(s=jOWL.priv.testObjectTarget(t,i.target))&&r.transitive&&i.property.isTransitive&&i.getTarget().sourceof(i.property,t,r).length>0&&(s=!0):s=i.property.isDatatypeProperty?i.property.assert(i.target,t):t==i.target;else if(r.transitive&&i.property.isTransitive&&!r.ignoreGenerics){var a=i.getTarget().sourceof(i.property,null,r);n.concat(a)}o&&s&&n.pushUnique(i)}}),r.inherited&&this.owlClass().sourceof(e,t,r).each(function(){if(!(r.valuesOnly&&null===this.target||this.getTarget().isClass&&r.ignoreClasses)){for(var e=!1,t=0;t<n.length;t++){var i=n.get(t);i.property.URI==this.property.URI&&(e=!0,r.ignoreGenerics||this.target!=i.target&&n.pushUnique(this))}e||n.pushUnique(this)}}),n},localRestrictions:function(e,t){return this.sourceof(e,t,{inherited:!1,transitive:!1})},valueRestrictions:function(e){return this.sourceof(null,null,{ignoreGenerics:!e,valuesOnly:!0})}}),jOWL.Ontology.Restriction=function(e){var t,r,n,i;if(this.cachedTarget=null,e.get(0).nodeName!=__.owl("Restriction"))this.property=jOWL(jOWL.resolveURI(e.get(0)),{type:"property"}),this.target=e.RDF_Resource()||e.text(),i="Individual";else{if(!(r=(t=jOWL.Xpath(__.owl("onProperty"),e)).RDF_Resource()))throw"no property found for the given owl:restriction";i=(n=t.siblings()).get(0).nodeName,this.property=jOWL(r,{type:"property"}),this.target=null}if(this.restriction={minCard:!1,maxCard:!1,some:[],all:[],value:!1},this.type=e.get(0).nodeName,this.isAnonymous=!0,this.isValueRestriction=i==__.owl("someValuesFrom")||i==__.owl("allValuesFrom")||i==__.owl("hasValue"),this.isCardinalityRestriction=i==__.owl("cardinality")||i==__.owl("maxCardinality")||i==__.owl("minCardinality"),!this.property||!i)throw"badly formed owl:restriction";switch(i){case __.owl("cardinality"):this.restriction.minCard=this.restriction.maxCard=parseInt(n.text(),10);break;case __.owl("maxCardinality"):this.restriction.maxCard=parseInt(n.text(),10);break;case __.owl("minCardinality"):this.restriction.minCard=parseInt(n.text(),10);break;case __.owl("hasValue"):var o=n.RDF_Resource();o&&(this.target=o)}if(this.property.isObjectProperty)if(this.isCardinalityRestriction&&this.property.range)this.target=this.property.range;else if(this.isValueRestriction){var s=n.RDF_Resource();"anonymousOntologyObject"==s&&(this.cachedTarget=new jOWL.Ontology.Class(jOWL.Xpath(__.owl("Class"),n))),this.target=s}return this.name=this.property.name+"#"+(this.target||this.restrtype),this},jOWL.Ontology.Restriction.prototype={jOWL:jOWL.version,isRestriction:!0,bind:function(){return null},merge:function(e){if(this.isCardinalityRestriction&&e.isValueRestriction)return this.target=e.target,!0;if(this.isValueRestriction&&e.isCardinalityRestriction)switch(e.restrtype){case __.owl("cardinality"):return this.restriction.minCard=this.restriction.maxCard=e.restriction.minCard,!0;case __.owl("minCardinality"):return this.restriction.minCard=e.restriction.minCard,!0;case __.owl("maxCardinality"):return this.restriction.maxCard=e.restriction.maxCard,!0}return!1},getTarget:function(){return this.target?this.cachedTarget?this.cachedTarget:(this.cachedTarget=this.property.isObjectProperty?jOWL(this.target):new jOWL.Literal(this.target),this.cachedTarget):jOWL("Thing")},equals:function(e){if(!e.isRestriction)return!1;if(this.property.URI==e.property.URI){if("anonymousOntologyObject"==this.target)return!1;if(this.target&&this.target===e.target)return!0}return!1}},jOWL.priv.Dt=function(e){this.settings=$.extend({base:null,pattern:null,assert:function(e){return!0},match:function(e,t){return!0}},e),this.base=jOWL.Ontology.Datatype[this.settings.base]},jOWL.priv.Dt.prototype={sanitize:function(e){return this.settings.sanitize?this.settings.sanitize(e):this.base&&this.base.sanitize?this.base.sanitize(e):void 0},assert:function(e){var t=this.sanitize(e);return void 0!==t&&(e=t),!(this.base&&!this.base.assert(e))&&!(this.settings.pattern&&!this.settings.pattern.test(e))&&this.settings.assert(e)},match:function(e,t){var r=this.sanitize(t);return void 0!==r&&(t=r),!!this.assert(t)&&!(this.base&&!this.base.match(e,t))&&this.settings.match(e,t)}},jOWL.Ontology.Datatype=function(e,t){jOWL.Ontology.Datatype[e]=new jOWL.priv.Dt(t)},jOWL.Ontology.Datatype(__.xsd()+"integer",{sanitize:function(e){return parseInt(e,10)},assert:function(e){return Math.round(e)==e},match:function(a,b){var check=parseInt(a,10);if(!isNaN(check))return check==b;for(var arr=a.split("&&"),i=0;i<arr.length;i++)arr[i]=b+arr[i];try{return eval(arr.join(" && "))}catch(e){return!1}}}),jOWL.Ontology.Datatype(__.xsd()+"positiveInteger",{base:__.xsd()+"integer",assert:function(e){return e>0}}),jOWL.Ontology.Datatype(__.xsd()+"decimal",{base:__.xsd()+"integer"}),jOWL.Ontology.Datatype(__.xsd()+"float",{base:__.xsd()+"integer"}),jOWL.Ontology.Datatype(__.xsd()+"double",{base:__.xsd()+"integer"}),jOWL.Ontology.Datatype(__.xsd()+"negativeInteger",{base:__.xsd()+"integer",assert:function(e){return e<0}}),jOWL.Ontology.Datatype(__.xsd()+"nonNegativeInteger",{base:__.xsd()+"integer",assert:function(e){return e>=0}}),jOWL.Ontology.Datatype(__.xsd()+"nonPositiveInteger",{base:__.xsd()+"integer",assert:function(e){return e<=0}}),jOWL.Ontology.Datatype(__.xsd()+"string");var URIPattern=/^([a-z0-9+.\-]+):(?:\/\/(?:((?:[a-z0-9-._~!$&'()*+,;=:]|%[0-9A-F]{2})*)@)?((?:[a-z0-9-._~!$&'()*+,;=]|%[0-9A-F]{2})*)(?::(\d*))?(\/(?:[a-z0-9-._~!$&'()*+,;=:@\/]|%[0-9A-F]{2})*)?|(\/?(?:[a-z0-9-._~!$&'()*+,;=:@]|%[0-9A-F]{2})+(?:[a-z0-9-._~!$&'()*+,;=:@\/]|%[0-9A-F]{2})*)?)(?:\?((?:[a-z0-9-._~!$&'()*+,;=:\/?@]|%[0-9A-F]{2})*))?(?:#((?:[a-z0-9-._~!$&'()*+,;=:\/?@]|%[0-9A-F]{2})*))?$/i;function _Binding(e){this.value={},this.arr=e}function SPARQL_DL_Array(e){if(this.arr=[],this.mappings={},e)for(var t=0;t<e.length;t++)e[t]&&(this.mappings[e[t]]=new jOWL.Ontology.Array)}jOWL.Ontology.Datatype(__.xsd()+"anyURI",{base:__.xsd()+"string",pattern:URIPattern}),jOWL.Ontology.Datatype(__.xsd()+"boolean",{sanitize:function(e){return"boolean"==typeof e?e:"true"==e||"false"!=e&&void 0},assert:function(e){return"boolean"==typeof e},match:function(e,t){return"false"===e&&(e=!1),"true"===e&&(e=!0),e===t}}),jOWL.Ontology.Property=function(e){var t=this.parseProperty(e);if(t)return t},jOWL.Ontology.Property.prototype=$.extend({},jOWL.Ontology.Thing.prototype,{isProperty:!0,parseProperty:function(e){if(!e||"string"==typeof e)return this.domain=this.range=null,void this.parse(e);if(jOWL.options.cacheProperties&&jOWL.indices.IDs){var t=e.RDF_ID()||e.RDF_About(),r=jOWL.index("property").get(t);if(r)return r}this.parse(e),this.domain=$(this.jnode.get(0).selectSingleNode(__.rdfs("domain"))).RDF_Resource(),this.range=$(this.jnode.get(0).selectSingleNode(__.rdfs("range"))).RDF_Resource()}}),jOWL.Ontology.DatatypeProperty=function(e){var t=this.parseProperty(e);if(t)return t;this.type==__.owl("AnnotationProperty")&&(this.range=__.xsd()+"string")},jOWL.Ontology.DatatypeProperty.prototype=$.extend({},jOWL.Ontology.Thing.prototype,jOWL.Ontology.Property.prototype,{isDatatypeProperty:!0,assert:function(e,t){var r=jOWL.Ontology.Datatype[this.range];return r?void 0===t?r.assert(e):r.match(t,e):(console.log(this.range+" datatype reasoning not implemented"),!0)}}),jOWL.Ontology.ObjectProperty=function(e){var t=this.parseProperty(e);if(t)return t;var r=this;jOWL.Xpath(__.rdf("type"),this.jnode).each(function(){$(this).RDF_Resource()==__.owl()+"TransitiveProperty"&&(r.isTransitive=!0)}),this.jnode.get(0).nodeName==__.owl("TransitiveProperty")&&(r.isTransitive=!0)},jOWL.Ontology.ObjectProperty.prototype=$.extend({},jOWL.Ontology.Thing.prototype,jOWL.Ontology.Property.prototype,{isObjectProperty:!0}),jOWL.Ontology.Class=function(e){this.parse(e)},jOWL.Xpath.restrictions=function(e){var t=new jOWL.Ontology.Array;return jOWL.Xpath(__.rdfs("subClassOf")+"/"+__.owl("Restriction"),e).add(jOWL.Xpath(__.owl("intersectionOf")+"/"+__.owl("Restriction"),e)).each(function(){t.push(new jOWL.Ontology.Restriction($(this)))}),t},jOWL.Ontology.Intersection=function(e){var t=this;this.jnode=e,this._arr=[],this.URI=this.jnode.parent().RDF_ID(),this.matches={},jOWL.Xpath(__.owl("Restriction"),e).each(function(){var e=new jOWL.Ontology.Restriction($(this));e.isValueRestriction&&t._arr.push(e)}),jOWL.Xpath(__.owl("Class"),e).each(function(){var e=$(this).RDF_About();e&&t._arr.push(jOWL(e))})},jOWL.Ontology.Intersection.prototype={isIntersection:!0,jOWL:jOWL.version,match:function(e,t,r){if(e==this.URI)return!1;if(void 0!==this.matches[e])return this.matches[e];for(var n=0;n<this._arr.length;n++){var i=this._arr[n],o=!1;if(i.isRestriction){if(r.each(function(){if(this.equals(i))return o=!0,!1}),!o)return this.matches[e]=!1,!1}else if(i.isClass){for(var s=0;s<t.length;s++){if(i.equals(t[s])){o=!0;break}if(jOWL.index("ID")[t[s]])for(var a=jOWL.Xpath.classes(jOWL.index("ID")[t[s]].jnode),u=0;u<a.length;u++)if(i.equals(a[u])){o=!0;break}}if(!o)return this.matches[e]=!1,!1}}return this.matches[e]=!0,this.matches[e]},equals:function(e){if(!e.isIntersection)return!1;for(var t=0;t<this._arr.length;t++){for(var r=!1,n=0;n<e._arr.length;n++)e._arr[n].equals(this._arr[t])&&(r=!0);if(!r)return!1}return!0}},jOWL.Ontology.Class.prototype=$.extend({},jOWL.Ontology.Thing.prototype,{isClass:!0,individuals:function(){var e=new jOWL.Ontology.Array;return new jOWL.SPARQL_DL("Type(?x, "+this.name+")").execute({async:!1,onComplete:function(t){e=t.jOWLArray("?x")}}),e},oneOf:function(){var e=new jOWL.Ontology.Array;return this.jnode.children().filter(function(){return this.tagName==__.owl("oneOf")}).children().each(function(){e.push(jOWL($(this).RDF_About()))}),e},children:function(){var e=this,t=jOWL.data(this.name,"children");if(t)return t;if(t=new jOWL.Ontology.Array,this.oneOf().length)return t;var r=this.URI;for(x in jOWL.index("ID"))if(x!==this.URI){var n=jOWL.index("ID")[x];if(n.isClass){for(var i=jOWL.Xpath.classes(n.jnode),o=0;o<i.length;o++)this.equals(i[o])&&t.push(n);var s=jOWL.Xpath.restrictions(n.jnode),a=jOWL.index("intersection")[r];a&&a.each(function(){this.match(x,i,s)&&t.push(n)})}}return jOWL.index("property").each(function(){this.domain==e.name&&jOWL.Xpath("//"+__.owl("onProperty")+"[@"+__.rdf("resource")+'="#'+this.name+'"]/parent::'+__.owl("Restriction")+"/..").filter(function(){return this.nodeName==__.owl("intersectionOf")||this.nodeName==__.rdfs("subClassOf")}).each(function(){var r=jOWL($(this.selectSingleNode("parent::"+__.owl("Class"))));t.contains(r)||r.name==e.name||void 0===r.name||t.push(r)})}),t.filter(function(){return this.hierarchy(!1),this.parents().contains(r)}),jOWL.data(this.name,"children",t),t},setParents:function(e){return jOWL.data(this.name,"parents",e),e},parents:function(){var e=this,t=jOWL.data(this.name,"parents");if(t)return t;for(var r=[],n=jOWL.Xpath.classes(this.jnode),i=0;i<n.length;i++)jOWL.priv.Array.pushUnique(r,n[i]);var o=jOWL.Xpath.restrictions(this.jnode);o.each(function(){this.property.domain&&this.property.domain!=e.name&&jOWL.priv.Array.pushUnique(r,this.property.domain)});var s=function(){this.match(e.URI,n,o)&&jOWL.priv.Array.pushUnique(r,this.URI)};if(jOWL.options.reason)for(resource in jOWL.index("intersection"))jOWL.index("intersection")[resource].each(s);return(t=new jOWL.Ontology.Array(jOWL.getXML(r),!0)).length?t.length>1&&t.filter(function(){return"Thing"!=this.name}):t.push(jOWL("Thing")),jOWL.data(this.name,"parents",t),t},ancestors:function(){return this.hierarchy(!1).flatindex},hierarchy:function(e){var t=new jOWL.Ontology.Array;return t.flatindex=new jOWL.Ontology.Array,function r(n){var i=n.parents();if(1==i.length&&i.contains(__.owl()+"Thing"))t.pushUnique(n);else{var o=jOWL.options.reason?function e(t,r){var n=!0;return r||(r={},n=!1),t.each&&t.each(function(){r[this.URI]||this.URI!=__.owl()+"Thing"&&(n&&(r[this.URI]=!0),this.parents&&e(this.parents(),r))}),r}(i):{};i.filter(function(){return!o[this.URI]}),i.each(function(){var i=t.flatindex.pushUnique(this);e&&(i.invParents||(i.invParents=new jOWL.Ontology.Array),i.invParents.pushUnique(n)),r(i)}),n.setParents(i)}}(this),t},descendants:function(e){e="number"==typeof e?e:5;var t=jOWL.data(this.name,"descendants");return t&&t.level>=e?t:((t=new jOWL.Ontology.Array).level=e,function r(n,i){if(i<=e){i++;var o=n.children();t.concat(o),o.each(function(e){r(e,i)})}}(this,1),jOWL.data(this.name,"descendants",t),t)},valueRestrictions:function(e,t){return this.sourceof(null,null,{ignoreClasses:!e})},sourceof:function(e,t,r){r=$.extend({inherited:!0,transitive:!0,ignoreGenerics:!0,ignoreClasses:!1,valuesOnly:!0},r);var n=jOWL.data(this.name,"sourceof"),i=this.jnode;n||(n=new jOWL.Ontology.Array,jOWL.Xpath(__.rdfs("subClassOf")+"/"+__.owl("Restriction"),i).add(jOWL.Xpath(__.owl("intersectionOf")+"/"+__.owl("Restriction"),i)).each(function(e,t){var r=new jOWL.Ontology.Restriction($(t)),i=!1;n.each(function(e,t){this.property.name==r.property.name&&(i=e)}),i&&i.merge(r)||n.push(r)}),jOWL.data(this.name,"sourceof",n));var o=new jOWL.Ontology.Array;return n.each(function(){var n=!e,i=!t;if(n||(n=e.isArray?e.contains(this.property):e.URI==this.property.URI),!t&&r.transitive&&this.property.isTransitive){var s=this.getTarget().sourceof(this.property,null,r);o.concat(s)}if(i||this.target||(i=!r.valuesOnly),!i){var a=this.getTarget();if(a.isClass&&r.ignoreClasses)return;!(i=jOWL.priv.testObjectTarget(t,this.target))&&r.transitive&&n&&this.property.isTransitive&&a.isThing&&a.sourceof(e,t).length&&(i=!0)}n&&i&&o.pushUnique(this)}),r.inherited?(this.parents().each(function(){this.sourceof&&this.sourceof(e,t,r).each(function(e){var t=this.getTarget(),n=!1,i=new jOWL.Ontology.Array;o.filter(function(){var o=!0;return this.property.URI==e.property.URI&&(n=!0,r.ignoreGenerics?t.isThing&&(o=this.getTarget().isThing&&e.target!=this.target,i.push(e)):e.target!=this.target&&i.push(e)),o}),n||o.push(e),o.concat(i)})}),o):o}}),jOWL.Ontology.Array=function(e,t){var r=this;this.items=[],e&&(t?$.each(e,function(){var e=this.jOWL?this:jOWL($(this));r.items.push(e)}):this.items=e),this.length=this.items.length},jOWL.Ontology.Array.prototype={jOWL:jOWL.version,isArray:!0,bind:function(e,t){return this.map(function(){var r=e?e.clone(!0):$("<span/>"),n=this.bind(r).append(document.createTextNode(" "));return t&&t.call(n,n,this),n.get(0)})},concat:function(e,t){var r=this;return e.each?e.each(function(){t?r.push(this):r.pushUnique(this)}):(r.items=r.items.concat(e.items),this.length=r.items.length),this},contains:function(e){return!!this.get(e)},each:function(e,t){var r,n,i=this,o=!1;if(t)for(r=this.items.length-1;r>=0&&!o;r--)n=i.eq(r),!1===e.call(n,n,r)&&(o=!0);else for(r=0;r<this.items.length&&!o;r++)!function(){var t=i.eq(r);!1===e.call(t,t,r)&&(o=!0)}();return this},eq:function(e){return e<0||e>this.items.length-1?null:this.items[e]},filter:function(e){var t=this;return this.each(function(r,n){e.call(r,r,n)||t.items.splice(n,1)},!0),this.length=this.items.length,this},getIndex:function(e){var t=-1;if(e.equals)this.each(function(r,n){if(this.equals&&this.equals(e))return t=n,!1});else{if("number"==typeof e)return e;var r="string"==typeof e?e:e.name,n=e.URI||r;this.each(function(e,i){this.URI?this.URI==n&&(t=i):this.name==r&&(t=i)})}return t},get:function(e){return this.eq(this.getIndex(e))},map:function(e){var t=[];return this.each(function(){t.push(e.call(this,this))}),t},push:function(e){return this.items.push(e),this.length=this.items.length,this},pushUnique:function(e){return this.get(e)||this.push(e).get(e)},toString:function(){return this.map(function(){return this.URI}).join(", ")},associative:function(){var e={};return this.each(function(){this.URI&&(e[this.URI]=this)}),e}},jOWL.options={reason:!0,locale:!1,defaultlocale:"en",dictionary:{create:!0,addID:!0},onParseError:function(e){alert("jOWL parseError: "+e)},cacheProperties:!0,niceClassLabels:!0},jOWL.document=null,jOWL.namespace=null,jOWL.indices={P:null,data:{},IDs:null,I:null,T:null,D:null,reset:function(){var e=jOWL.indices;e.data={},e.P=null,e.T=null,e.IDs=null,e.I=null,e.D=null}},jOWL.index=function(e,t){var r=jOWL.indices;switch(e){case"ID":if(null===r.IDs||t){t&&r.reset(),r.IDs={},r.T={};var n=new Date;jOWL.Xpath("//*[@"+__.rdf("ID")+"]").each(function(){var e=jOWL.getResource($(this));e&&(r.IDs[e.URI]=e,e.isThing&&(r.T[e.Class]||(r.T[e.Class]=new jOWL.Ontology.Array),r.T[e.Class].push(e)))}),jOWL.Xpath("/"+__.rdf("RDF")+"/*[@"+__.rdf("about")+"]").each(function(){var e=$(this),t=jOWL.getResource($(this));if(t)return t.isClass||t.isProperty||t.isThing?r.IDs[t.URI]?void e.children().appendTo(r.IDs[t.URI].jnode):(r.IDs[t.URI]=t,void(t.isThing&&(r.T[t.Class]||(r.T[t.Class]=new jOWL.Ontology.Array),r.T[t.Class].push(t)))):void 0}),console.log("Loaded in "+((new Date).getTime()-n.getTime())+"ms")}return r.IDs;case"Thing":return r.T;case"intersection":if(null===r.I||t){var i=new jOWL.Ontology.Array;r.I={},jOWL.Xpath("//"+__.owl("intersectionOf")).each(function(){var e=new jOWL.Ontology.Intersection($(this));if(e.URI){var t=i.get(e);t?console.log("duplicate intersection found between : (Ignoring) "+e.URI+"  and "+t.URI):(r.I[e.URI]||(r.I[e.URI]=new jOWL.Ontology.Array),i.push(e),r.I[e.URI].push(e))}})}return r.I;case"property":if(null===r.P||t){for(x in jOWL.options.cacheProperties=!1,r.P=new jOWL.Ontology.Array,r.IDs){var o=r.IDs[x];o.isProperty&&r.P.push(o)}jOWL.options.cacheProperties=!0}return r.P;case"dictionary":if(null===r.D||t)for(x in r.D=[],r.IDs){var s=r.IDs[x];r.D=r.D.concat(s.terms())}return r.D}},jOWL.data=function(e,t,r){var n=jOWL.indices.data;if(n[e]||(n[e]={}),!r)return n[e][t];n[e][t]=r},jOWL.load=function(e,t,r){var n=this;if($.browser.msie&&0===location.toString().indexOf("file")){var i=document.createElement("xml");i.validateOnParse=!1,i.src=e,i.onreadystatechange=function(){if("interactive"==i.readyState){var e=i.XMLDocument;document.body.removeChild(i),t(n.parse(e,r))}},document.body.appendChild(i)}else $.get(e,function(e){t(n.parse(e,r))})},jOWL.parse=function(e,t){if(jOWL.document=null,this.options=$.extend(jOWL.options,t),"string"==typeof e&&(e=jOWL.fromString(e)),jOWL.document=e,$.browser.msie){if(0!==e.parseError.errorCode)return jOWL.options.onParseError(e.parseError.reason),!1}else if("parsererror"==e.documentElement.nodeName)return jOWL.options.onParseError(e.documentElement.firstChild.nodeValue),!1;var r=$(e.documentElement);return jOWL.NS(r),$.browser.msie&&(jOWL.document.setProperty("SelectionLanguage","XPath"),jOWL.document.setProperty("SelectionNamespaces",__())),this.index("ID",!0),jOWL.options.cacheProperties&&this.index("property",!0),jOWL.options.dictionary.create&&jOWL.index("dictionary"),jOWL.Thing=new jOWL.Ontology.Thing($(jOWL.create(__.owl,"Class").attr(__.rdf,"about",__.owl()+"Thing").node)),jOWL.Thing.type=!1,this},jOWL.toString=function(e){return e?$.browser.msie?e.xml:(new XMLSerializer).serializeToString(e):jOWL.toString(jOWL.document)},jOWL.fromString=function(e){var t;if(document.implementation.createDocument)t=(new DOMParser).parseFromString(e,"text/xml");else if(window.ActiveXObject){var r=new ActiveXObject("Microsoft.XMLDOM");r.async="false",r.validateOnParse=!1,r.loadXML(e),t=r}return t},jOWL.isExternal=function(e){var t=jOWL.resolveURI(e,!0);return t[0]!=jOWL.namespace&&t},jOWL.resolveURI=function(e,t){if("string"!=typeof e){var r=e.jquery?e.get(0):e;return e=r.localName||r.baseName,r.namespaceURI&&(e=r.namespaceURI+e),jOWL.resolveURI(e,t)}var n=e,i=jOWL.namespace;if(0===e.indexOf("http")){var o=e.indexOf("#");o<=0&&(o=e.lastIndexOf("/")),o>0&&(i=e.substring(0,o+1),n=e.substring(o+1))}else if("#"==e.charAt(0))return e.substring(1);return t?[i,n]:i==jOWL.namespace?n:e},jOWL.getResource=function(e,t){if(!jOWL.document)throw"You must successfully load an ontology before you can find anything";if(!e)throw"No resource specified";var r,n=$.extend({},t);if("string"==typeof e){if("Thing"==(e=jOWL.resolveURI(e))||e==__.owl()+"Thing")return jOWL.Thing;if("property"==n.type&&jOWL.options.cacheProperties){var i=jOWL.index("property").get(e);if(i)return i;if(jOWL.isExternal(e))return console.log("undeclared resource: "+e),new jOWL.Ontology.Property(e)}var o=jOWL.index("ID")[e];if(!o)for(caseIns in jOWL.index("ID"))if(caseIns.toLowerCase()==e.replace(/ /g,"").toLowerCase()){o=jOWL.index("ID")[caseIns];break}return o||(jOWL.isExternal(e)?(console.log("undeclared resource: "+e),new jOWL.Ontology.Thing(e)):(console.log(e+" not found"),null))}r=e.jquery?e:$(e);var s=jOWL.type(r);return s?new s(r):null},jOWL.type=function(e){var t=e.jquery?e.get(0):e;switch(t.nodeName){case __.owl("Class"):case __.rdfs("Class"):return jOWL.Ontology.Class;case __.owl("Ontology"):return jOWL.Ontology;case __.owl("ObjectProperty"):return jOWL.Ontology.ObjectProperty;case __.owl("DatatypeProperty"):return jOWL.Ontology.DatatypeProperty;case __.owl("FunctionalProperty"):case __.rdf("Property"):return jOWL.Ontology.Property;case __.owl("InverseFunctionalProperty"):case __.owl("TransitiveProperty"):case __.owl("SymmetricProperty"):return jOWL.Ontology.ObjectProperty;case __.owl("AnnotationProperty"):return jOWL.Ontology.DatatypeProperty;default:switch(t.namespaceURI){case __.owl():return t.nodeName==__.owl("Thing")&&jOWL.Ontology.Individual;case __.rdf():case __.rdfs():return!1;default:return jOWL.Ontology.Individual}}},jOWL.getXML=function(e){var t=[];function r(e){return jOWL.index("ID")[e]||null}if("string"==typeof e){var n=r(e);n&&t.push(n)}else jOWL.priv.Array.isArray(e)&&$.each(e,function(){var e=r(this);e&&t.push(e)});return t},jOWL.create=function(e,t,r){var n=r||jOWL.document,i={attr:function(e,t,r){if($.browser.msie){var i=n.createNode(2,e(t),e());i.nodeValue=r,this.node.setAttributeNode(i)}else this.node.setAttributeNS(e(),e(t),r);return this},appendTo:function(e){return(e.node?e.node:e).appendChild(this.node),this},text:function(e,t){var r=t?n.createCDATASection(e):n.createTextNode(e);return this.node.appendChild(r),this}};return i.node=$.browser.msie?n.createNode(1,e(t),e()):n.createElementNS(e(),e(t)),i},jOWL.create.document=function(e){var t=[],r=e||window.location.href+"#";return t.push('<?xml version="1.0"?>'),t.push("<"+__.rdf("RDF")+' xml:base="'+r+'" xmlns="'+r+'" '+__()+">"),t.push("   <"+__.owl("Ontology")+" "+__.rdf("about")+'=""/>'),t.push("</"+__.rdf("RDF")+">"),jOWL.fromString(t.join("\n"))},jOWL.parseRDFa=function(e,t){var r=t.node?$("[typeof]",t.node):$("[typeof]"),n=jOWL.create.document();function i(e,t){var r=[];return $("[property="+e+"]",t).each(function(){r.push($(this).attr("content")||$(this).html())}),t.attr("property")===e&&r.push(t.attr("content")||t.html()),r}r.each(function(){var e,t=$(this);t.attr("typeof")==__.owl("Class")&&(e=function(e,t){for(var r=jOWL.create(__.owl,"Class",n).attr(__.rdf,"about",t).appendTo(n.documentElement),o=i(__.rdfs("subClassOf"),e).concat(function(e,t){var r=[];return $("[rel="+e+"]",t).each(function(){r.push($(this).attr("resource"))}),t.attr("rel")===e&&r.push(t.attr("resource")),r}(__.rdfs("subClassOf"),e)),s=0;s<o.length;s++)jOWL.create(__.rdfs,"subClassOf",n).attr(__.rdf,"resource",o[s]).appendTo(r);return r}(t,jOWL.resolveURI(t.attr("about")))),$.each(i(__.rdfs("comment"),t),function(){jOWL.create(__.rdfs,"comment",n).appendTo(e).text(this,!0)}),$.each(i(__.rdfs("label"),t),function(){jOWL.create(__.rdfs,"label",n).appendTo(e).text(this)})}),jOWL.parse(n,t),e()},jOWL.query=function(e,t){"Class"==(t=$.extend({exclude:!1},t)).filter&&(t.filter=__.owl("Class")),new jOWL.Ontology.Array;var r={},n=jOWL.index("dictionary");function i(e){var n=!1,i=0;if(t.filter)if("string"==typeof t.filter)n=t.filter==e[3];else for(i=0;i<t.filter.length;i++)t.filter[i]==e[3]&&(n=!0);else if(t.exclude)if(n=!0,"string"==typeof t.exclude)n=t.exclude!==e[3];else for(i=0;i<t.exclude.length;i++)t.exclude[i]==e[3]&&(n=!1);else n=!0;n&&(r[e[1]]||(r[e[1]]=[]),r[e[1]].push({term:e[0],locale:e[2],type:e[3]}))}for(var o=0;o<n.length;o++){var s=n[o];s[0].searchMatch(e)>-1&&(t.locale?t.locale==s[2]&&i(s):i(s))}return r},jOWL.throttle=function(e,t){t=$.extend({modify:function(e){},onComplete:function(e){},async:!0,chewsize:5,startIndex:0,timing:5},t);var r=e.jOWL?e.items:e.jquery?$.makeArray(e):e,n=t.startIndex?r.slice(startIndex):r.concat(),i=[];!function(){for(var e=t.chewsize,r=[];e>0&&n.length>0;){var o=n.shift();e--;var s=t.modify.call(o,o);s&&(i.push(s),r.push(s))}t.onUpdate&&t.onUpdate(r),n.length>0?t.async?setTimeout(arguments.callee,t.timing):arguments.callee():t.onComplete(i)}()},jOWL.SPARQL_DL_Result=function(){this.assert=void 0,this.head={},this.results=[],this.isBound=!1},jOWL.SPARQL_DL_Result.prototype={sort:function(e){if(!e)throw"parameter must be defined for sort function";this.results&&this.results.sort(function(t,r){return(t[e].name||t[e])<(r[e].name||r[e])?-1:1})},jOWLArray:function(e){if(!e)throw"parameter must be defined for jOWLArray function";for(var t=new jOWL.Ontology.Array,r=0;r<this.results.length;r++)this.results[r][e]&&t.pushUnique(this.results[r][e]);return t},filter:function(e,t){if(void 0===this.head[e])this.head[e]=t;else{var r=this;this.head[e].filter(function(){return t.contains(this)}),t.filter(function(){return r.head[e].contains(this)})}},bind:function(e){if(!this.isBound)return this.results=this.results.concat(e.arr),void(this.isBound=!0);var t=-1;for(x in e.mappings)t++;var r=[];for(x in e.mappings){var n;t&&(n=e.keyCentric(x));for(var i=this.results.length-1;i>=0;i--){var o=this.results[i][x];if(o){if(!e.mappings[x].contains(o)){this.results.splice(i,1);continue}if(t){for(var s=n[o.URI],a=0;a<s.length;a++){var u=0===a?this.results[i]:{},l=s[a];for(yK in u[x]=o,l)u[yK]=l[yK];r.push(u)}this.results.splice(i,1)}}}}this.results=this.results.concat(r)}},jOWL.SPARQL_DL_Query=function(e,t){this.parse(e),this.fill(t),this.entries=this.entries.sort(this.sort)},jOWL.SPARQL_DL_Query.prototype={parse:function(e){var t=/(\w+)[(]([^)]+)[)]/,r=e.match(/(\w+[(][^)]+[)])/g);if(r){r=jOWL.priv.Array.unique(r);for(var n=0;n<r.length;n++){var i=r[n].match(t);if(3!=i.length)return void(this.error="invalid abstract sparql-dl syntax");r[n]=[i[1],i[2].replace(/ /g,"").split(",")]}this.entries=r}else this.error="invalid abstract sparql-dl syntax"},fill:function(e){for(var t=0;t<this.entries.length;t++)for(var r=0;r<this.entries[t][1].length;r++){var n=e[this.entries[t][1][r]];if(void 0!==n)this.entries[t][1][r]=n;else if("?"!=(n=this.entries[t][1][r]).charAt(0)){if("PropertyValue"==this.entries[t][0]&&2==r){var i=n.match(/^["'](.+)["']$/);if(i&&2==i.length){this.entries[t][1][r]={test:i[1]};break}}if(this.entries[t][1][r]=jOWL(n),null===this.entries[t][1][r])return void(this.entries.error="a parameter in the query was not found")}}},sort:function(e,t){var r;if(1==e[1].length)return"PropertyValue"==t[0]?1:-1;if(1==t[1].length)return"PropertyValue"==e[0]?-1:1;var n=0;for(r=0;r<e[1].length;r++)"string"==typeof e[1][r]&&n++;var i=0;for(r=0;r<e[1].length;r++)"string"==typeof t[1][r]&&i++;return n!=i?n-i:"Type"==e[0]&&"Type"!=t[0]?-1:"Type"!=e[0]&&"Type"==t[0]?1:0}},_Binding.prototype={bind:function(e,t){return this.value[e]=t,this.arr.mappings[e]||(this.arr.mappings[e]=new jOWL.Ontology.Array),this.arr.mappings[e].push(t),this}},SPARQL_DL_Array.prototype={add:function(e){return this.arr.push(e.value),e},push:function(e,t){var r=new _Binding(this);return r.bind(e,t),this.arr.push(r.value),r},keyCentric:function(e){for(var t={},r=this.arr.length-1;r>=0;r--)this.arr[r][e]&&(t[this.arr[r][e].URI]||(t[this.arr[r][e].URI]=[]),t[this.arr[r][e].URI].push(this.arr[r]));return t},get:function(e){return this.mappings[e]?this.mappings[e]:new jOWL.Ontology.Array},getArray:function(){for(var e=this.arr.length-1;e>=0;e--){var t=this.arr[e],r=!1;for(key in t)r||(r=!this.mappings[key]||!this.mappings[key].contains(t[key]));r&&this.arr.splice(e,1)}return this}},jOWL.SPARQL_DL=function(e,t,r){if(!(this instanceof arguments.callee))return new jOWL.SPARQL_DL(e,t,r);this.parameters=$.extend({},t),this.query=new jOWL.SPARQL_DL_Query(e,this.parameters).entries,this.result=new jOWL.SPARQL_DL_Result,this.options=$.extend({onComplete:function(e){}},r)},jOWL.SPARQL_DL.prototype={error:function(e){return this.result.error=e,this.options.onComplete(this.result)},execute:function(e){var t=this;if(this.options=$.extend(this.options,e),this.query.error)return this.error(this.query.error);var r=this.result,n=0,i=$.extend({},this.options);if(i.onComplete=function(e){r=e,o(++n)},!this.query.length)return r.error="no query found or query did not parse properly",t.options.onComplete(r);function o(e){if(!(e<t.query.length)){for(var n=0;n<r.results.length;n++){var o=r.results[n];for(x in o)o[x]instanceof jOWL.Literal&&(o[x]=o[x].name)}return t.options.onComplete(r)}t.process(t.query[e],r,i)}o(n)},process:function(e,t,r){r=$.extend({chewsize:10,async:!0,onComplete:function(e){}},r);var n=e[0],i={Type:[__.owl("Thing"),__.owl("Class")],DirectType:[__.owl("Thing"),__.owl("Class")],PropertyValue:[!1,!1,!1],Class:[!1],Thing:[!1],ObjectProperty:[!1],DatatypeProperty:[!1],SubClassOf:[__.owl("Class"),__.owl("Class")],DirectSubClassOf:[__.owl("Class"),__.owl("Class")]};if(!i[n])return this.error("'"+n+"' queries are not implemented");if(i[n].length!=e[1].length)return this.error("invalid SPARQL-DL "+n+" specifications, "+i[n].length+" parameters required");for(var o=0;o<e[1].length;o++){var s=i[n][o];if(s){var a=e[1][o];if("string"!=typeof a&&a.type!=s)return this.error("Parameter "+o+" in SPARQL-DL Query for "+n+" must be of the type: "+s)}}return"DirectType"==n?(r.childDepth=0,this.fn.Type.call(this,e[1],t,r)):"DirectSubClassOf"==n?(r.childDepth=1,this.fn.SubClassOf.call(this,e[1],t,r)):this.fn[n].call(this,e[1],t,r)},fn:{SubClassOf:function(e,t,r){var n=new jOWL.SPARQL_DL.DoubleAtom(e,t.head),i=new SPARQL_DL_Array;if(n.source.isURI()&&n.target.isURI()){if(!1!==t.assert){var o=n.source.value.ancestors();t.assert=o.contains(n.target.value)}return r.onComplete(t)}return n.source.isURI()?(n.source.value.ancestors().each(function(){i.push(n.target.value,this)}),t.filter(n.target.value,i.get(n.target.value)),t.bind(i.getArray()),r.onComplete(t)):n.target.isURI()?(n.target.value.descendants(r.childDepth).each(function(){i.push(n.source.value,this)}),t.filter(n.source.value,i.get(n.source.value)),t.bind(i.getArray()),r.onComplete(t)):this.error("Unsupported SubClassOf query")},Type:function(e,t,r){var n=new jOWL.SPARQL_DL.DoubleAtom(e,t.head);function i(e){if(!c[this.URI]){var t=o.push(n.source.value,this);a&&t.bind(n.target.value,e),c[this.URI]=!0}}if(n.source.isURI()&&n.target.isURI())return jOWL.SPARQL_DL.priv.assert(t,function(){var e=n.source.value.owlClass();return e.URI==n.target.value.URI||function e(t,r){var n=t.parents(),i=!1;return n.contains(r)?i=!0:n.each(function(){this!=jOWL.Thing&&!i&&e(this,r)&&(i=!0)}),i}(e,n.target.value)},r.onComplete);if(n.source.getURIs()&&!n.target.getURIs()){var o=new SPARQL_DL_Array,s=!n.source.isURI(),a=!n.target.isURI();return n.source.getURIs().each(function(){var e;a&&(e=o.push(n.target.value,this.owlClass())),s&&(a?e.bind(n.source.value,this):o.push(n.source.value,this))}),s&&t.filter(n.source.value,o.get(n.source.value)),a&&t.filter(n.target.value,o.get(n.target.value)),t.bind(o.getArray()),r.onComplete(t)}if(n.target.getURIs()){a=!n.target.isURI();var u=n.target.getURIs(),l={},c={};for(x in o=new SPARQL_DL_Array,u.each(function(){if(!l[this.URI]){var e=this.oneOf(),t=this;e.length?e.each(function(){i.call(this,t)}):this.descendants(r.childDepth).each(function(){l[this.URI]=!0}),l[this.URI]=!0}}),l){var f=jOWL.index("Thing")[x];if(f){var h=jOWL.index("ID")[x];r.onUpdate&&r.onUpdate(f),f.each(function(){i.call(this,h)})}}return t.filter(n.source.value,o.get(n.source.value)),t.bind(o.getArray()),r.onComplete(t)}return this.error("Unsupported Type query")},Thing:function(e,t,r){jOWL.SPARQL_DL.priv.IDQuery(e[0],"isThing",t,r)},Class:function(e,t,r){console.log("cl"),jOWL.SPARQL_DL.priv.IDQuery(e[0],"isClass",t,r)},ObjectProperty:function(e,t,r){jOWL.SPARQL_DL.priv.PropertyQuery(e[0],jOWL.index("property").items,"isObjectProperty",t,r)},DatatypeProperty:function(e,t,r){jOWL.SPARQL_DL.priv.PropertyQuery(e[0],jOWL.index("property").items,"isDatatypeProperty",t,r)},PropertyValue:function(e,t,r){var n=new jOWL.SPARQL_DL.TripleAtom(e,t.head);if(n.source.isURI()&&n.property.isURI()&&n.target.isURI())return!1!==t.assert&&jOWL.SPARQL_DL.priv.PropertyValuegetSourceInfo(n.source.value,n.property.value,n.target.value,t,{assert:!0}),r.onComplete(t);if(n.source.getURIs()){var i=!!n.target.isVar()&&n.target.value,o=!!n.property.isVar()&&n.property.value,s=!!n.source.isVar()&&n.source.value;return jOWL.SPARQL_DL.priv.PropertyValuegetSourceInfo(n.source.getURIs(),n.property.getURIs(),n.target.getURIs(),t,{filterTarget:i,filterProperty:o,filterSource:s}),r.onComplete(t)}jOWL.SPARQL_DL.priv.IDQuery(n.source.value,["isClass","isThing"],t,r)}}},jOWL.SPARQL_DL.priv={assert:function(e,t,r){!1!==e.assert&&(e.assert=t()),r(e)},PropertyValuegetSourceInfo:function(e,t,r,n,i){if(!e.isArray)return jOWL.SPARQL_DL.priv.PropertyValuegetSourceInfo(new jOWL.Ontology.Array([e]),t,r,n,i);var o=new SPARQL_DL_Array([(i=$.extend({},i)).filterSource,i.filterProperty,i.filterTarget]),s=!1;if(e.each(function(){var e=this;if(r&&r.isArray&&1==r.length){var n=r.get(0).test;n&&(r=n)}var a=e.sourceof(t,r);if(i.assert)a.length>0&&(s=!0);else if(a.length)return a.each(function(){var t=new _Binding(o);if(i.filterSource&&(t.bind(i.filterSource,e),!i.filterProperty&&!i.filterTarget))return o.add(t),!1;i.filterProperty&&t.bind(i.filterProperty,this.property),i.filterTarget&&t.bind(i.filterTarget,this.getTarget()),o.add(t)}),!0}),i.assert)return n.assert=s,n.assert;i.filterSource&&n.filter(i.filterSource,o.get(i.filterSource)),i.filterProperty&&n.filter(i.filterProperty,o.get(i.filterProperty)),i.filterTarget&&n.filter(i.filterTarget,o.get(i.filterTarget)),n.bind(o.getArray())},hasClassID:function(e,t){if("[object Array]"===Object.prototype.toString.call(t)){for(var r=0;r<t.length;r++)if(e[t])return!0}else if(e[t])return!0;return!1},IDQuery:function(e,t,r,n){var i=new jOWL.SPARQL_DL.Atom(e,r.head);if(i.isURI())return jOWL.SPARQL_DL.priv.assert(r,function(){return jOWL.SPARQL_DL.priv.hasClassID(i.getURIs().get(0),t)},n.onComplete);var o=new SPARQL_DL_Array;for(x in jOWL.index("ID")){var s=jOWL.index("ID")[x];jOWL.SPARQL_DL.priv.hasClassID(s,t)&&o.push(e,s)}r.filter(e,o.get(e)),r.bind(o.getArray()),n.onComplete(r)},PropertyQuery:function(e,t,r,n,i){var o=new jOWL.SPARQL_DL.Atom(e,n.head);if(o.isURI())return jOWL.SPARQL_DL.priv.assert(n,function(){return jOWL.SPARQL_DL.priv.hasClassID(o.getURIs().get(0),r)},i.onComplete);var s=new SPARQL_DL_Array;new jOWL.throttle(t,$.extend({},i,{modify:function(t){return t.jOWL||(t=jOWL(t)),jOWL.SPARQL_DL.priv.hasClassID(t,r)&&s.push(e,t),!1},onComplete:function(){n.filter(e,s.get(e)),n.bind(s.getArray()),i.onComplete(n)}}))}},jOWL.SPARQL_DL.TripleAtom=function(e,t){this.source=new jOWL.SPARQL_DL.Atom(e[0],t),this.property=new jOWL.SPARQL_DL.Atom(e[1],t),this.target=new jOWL.SPARQL_DL.Atom(e[2],t)},jOWL.SPARQL_DL.DoubleAtom=function(e,t){this.source=new jOWL.SPARQL_DL.Atom(e[0],t),this.target=new jOWL.SPARQL_DL.Atom(e[1],t)},jOWL.SPARQL_DL.Atom=function(e,t){this.value=e,this.type=0,"string"==typeof e?0===e.indexOf("?")?(this.type=this.VAR,t&&t[e]&&(this.mappings=t[e])):this.type=this.LITERAL:this.type=this.URI},jOWL.SPARQL_DL.Atom.prototype={URI:1,LITERAL:2,VAR:3,getURIs:function(){return this.isURI()?new jOWL.Ontology.Array([this.value]):this.mappings},isVar:function(){return this.type==this.VAR},isLiteral:function(){return this.type==this.LITERAL},isURI:function(){return this.type==this.URI}},jOWL.getURLParameters=function(){var e=window.location.href.split("?",2),t={};if(1==e.length)return{};for(var r=e[1].split("&"),n=0;n<r.length;n++){var i=r[n].split("=");2==i.length&&(t[i[0]]=i[1])}return t},jOWL.permalink=function(e){if(e){if(!e.URI)return!1;var t=window.location.href.split("?",2);if(window.location.search&&(t=t[0]),e.isClass)return t+"?owlClass="+escape(e.URI)}else{var r=jOWL.getURLParameters();if(r.owlClass)return jOWL(unescape(r.owlClass))}return!1},jOWL.Manchester=function(e){var t=[];if(e.isClass){var r=e.oneOf().map(function(){return this.label()});r.length&&t.push("{ "+r.join(", ")+" }")}return t.join(", ")}}(jQuery),String.prototype.searchMatch=function(e,t){if(this.search(new RegExp(e,"i"))>-1)return 1;for(var r=0,n=e.match(new RegExp("\\w+","ig")),i=0;i<n.length;i++)this.search(n[i])>-1&&r++;return r==n.length?0:-1},String.prototype.beautify=function(){var e=new RegExp("([a-z0-9])([A-Z])","g"),t=new RegExp("([A-Z])([A-Z0-9])([a-z])","g"),r=new RegExp("_","g");return this.replace(e,"$1 $2").replace(t,"$1 $2$3").replace(r," ")},function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.rdfstore=e()}}(function(){return function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw Error("Cannot find module '"+s+"'")}u=r[s]={exports:{}},t[s][0].call(u.exports,function(e){return i(t[s][1][e]||e)},u,u.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){!function(){function e(e){this.message=e}var t="undefined"!=typeof r?r:this;(e.prototype=Error()).name="InvalidCharacterError",t.btoa||(t.btoa=function(t){for(var r,n,i=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";t.charAt(0|i)||(o="=",i%1);s+=o.charAt(63&r>>8-i%1*8)){if(255<(n=t.charCodeAt(i+=.75)))throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");r=r<<8|n}return s}),t.atob||(t.atob=function(t){if(1==(t=t.replace(/=+$/,"")).length%4)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,i=0,o=0,s="";n=t.charAt(o++);~n&&(r=i%4?64*r+n:n,i++%4)?s+=String.fromCharCode(255&r>>(-2*i&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return s})}()},{}],2:[function(e,t,r){!function(e){function t(e){return 43===(e=e.charCodeAt(0))?62:47===e?63:48>e?-1:58>e?e-48+52:91>e?e-65:123>e?e-97+26:void 0}var r="undefined"!=typeof Uint8Array?Uint8Array:Array;e.toByteArray=function(e){function n(e){u[l++]=e}var i,o,s,a,u;if(0<e.length%4)throw Error("Invalid string. Length must be a multiple of 4");a="="===e.charAt((i=e.length)-2)?2:"="===e.charAt(i-1)?1:0,u=new r(3*e.length/4-a),o=0<a?e.length-4:e.length;var l=0;for(i=0;i<o;i+=4)n((16711680&(s=t(e.charAt(i))<<18|t(e.charAt(i+1))<<12|t(e.charAt(i+2))<<6|t(e.charAt(i+3))))>>16),n((65280&s)>>8),n(255&s);return 2===a?n(255&(s=t(e.charAt(i))<<2|t(e.charAt(i+1))>>4)):1===a&&(n((s=t(e.charAt(i))<<10|t(e.charAt(i+1))<<4|t(e.charAt(i+2))>>2)>>8&255),n(255&s)),u},e.fromByteArray=function(e){var t,r,n,i=e.length%3,o="";for(t=0,n=e.length-i;t<n;t+=3)o+=r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((r=(e[t]<<16)+(e[t+1]<<8)+e[t+2])>>18&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&r);switch(i){case 1:o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((r=e[e.length-1])>>2),o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r<<4&63),o+="==";break;case 2:o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((r=(e[e.length-2]<<8)+e[e.length-1])>>10),o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>4&63),o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r<<2&63),o+="="}return o}}("undefined"==typeof r?this.base64js={}:r)},{}],3:[function(e,t,r){(function(r,n){(function(){function i(e){return"function"==typeof e}function o(){return function(){b(a)}}function s(){return function(){setTimeout(a,1)}}function a(){for(var e=0;e<k;e+=2)(0,C[e])(C[e+1]),C[e]=void 0,C[e+1]=void 0;k=0}function u(){}function l(e,t){if(e===t)h(e,new TypeError("You cannot resolve a promise with itself"));else if("function"==typeof t||"object"==typeof t&&null!==t)if(t.constructor===e.constructor)!function(e,t){1===t._state?f(e,t._result):2===t._state?h(e,t._result):p(t,void 0,function(t){l(e,t)},function(t){h(e,t)})}(e,t);else{var r;try{r=t.then}catch(e){O.error=e,r=O}r===O?h(e,O.error):void 0===r?f(e,t):i(r)?function(e,t,r){j(function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,function(r){n||(n=!0,t!==r?l(e,r):f(e,r))},function(t){n||(n=!0,h(e,t))});!n&&i&&(n=!0,h(e,i))},e)}(e,t,r):f(e,t)}else f(e,t)}function c(e){e._onerror&&e._onerror(e._result),d(e)}function f(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&j(d,e))}function h(e,t){void 0===e._state&&(e._state=2,e._result=t,j(c,e))}function p(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+1]=r,i[o+2]=n,0===o&&e._state&&j(d,e)}function d(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n,i,o=e._result,s=0;s<t.length;s+=3)i=t[s+r],(n=t[s])?v(r,n,i,o):i(o);e._subscribers.length=0}}function g(){this.error=null}function v(e,t,r,n){var o,s,a,u,c=i(r);if(c){try{o=r(n)}catch(e){F.error=e,o=F}if(o===F?(u=!0,s=o.error,o=null):a=!0,t===o)return void h(t,new TypeError("A promises callback cannot return that same promise."))}else o=n,a=!0;void 0===t._state&&(c&&a?l(t,o):u?h(t,s):1===e?f(t,o):2===e&&h(t,o))}function y(e,t){this._instanceConstructor=e,this.promise=new e(u),this._validateInput(t)?(this._input=t,this._remaining=this.length=t.length,this._init(),0===this.length?f(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&f(this.promise,this._result))):h(this.promise,this._validationError())}function m(e){if(this._id=S++,this._result=this._state=void 0,this._subscribers=[],u!==e){if(!i(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof m))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");!function(e,t){try{t(function(t){l(e,t)},function(t){h(e,t)})}catch(t){h(e,t)}}(this,e)}}var b,w,x,_=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},k=0,j=function(e,t){C[k]=e,C[k+1]=t,2===(k+=2)&&(w?w(a):x())},L="undefined"!=typeof window?window:void 0,A=(I=L||{}).MutationObserver||I.WebKitMutationObserver,I="undefined"!=typeof r&&"[object process]"==={}.toString.call(r),E="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,C=Array(1e3);x=I?function(){var e=r.nextTick,t=r.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(t)&&"0"===t[1]&&"10"===t[2]&&(e=setImmediate),function(){e(a)}}():A?function(){var e=0,t=new A(a),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}():E?function(){var e=new MessageChannel;return e.port1.onmessage=a,function(){e.port2.postMessage(0)}}():void 0===L&&"function"==typeof e?function(){try{var t=e("vertx");return b=t.runOnLoop||t.runOnContext,o()}catch(e){return s()}}():s();var O=new g,F=new g;y.prototype._validateInput=function(e){return _(e)},y.prototype._validationError=function(){return Error("Array Methods must be provided an Array")},y.prototype._init=function(){this._result=Array(this.length)},y.prototype._enumerate=function(){for(var e=this.length,t=this.promise,r=this._input,n=0;void 0===t._state&&n<e;n++)this._eachEntry(r[n],n)},y.prototype._eachEntry=function(e,t){var r=this._instanceConstructor;"object"==typeof e&&null!==e?e.constructor===r&&void 0!==e._state?(e._onerror=null,this._settledAt(e._state,t,e._result)):this._willSettleAt(r.resolve(e),t):(this._remaining--,this._result[t]=e)},y.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?h(n,r):this._result[t]=r),0===this._remaining&&f(n,this._result)},y.prototype._willSettleAt=function(e,t){var r=this;p(e,void 0,function(e){r._settledAt(1,t,e)},function(e){r._settledAt(2,t,e)})};var S=0;m.all=function(e){return new y(this,e).promise},m.race=function(e){function t(e){l(n,e)}function r(e){h(n,e)}var n=new this(u);if(!_(e))return h(n,new TypeError("You must pass an array to race.")),n;for(var i=e.length,o=0;void 0===n._state&&o<i;o++)p(this.resolve(e[o]),void 0,t,r);return n},m.resolve=function(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(u);return l(t,e),t},m.reject=function(e){var t=new this(u);return h(t,e),t},m._setScheduler=function(e){w=e},m._setAsap=function(e){j=e},m._asap=j,m.prototype={constructor:m,then:function(e,t){var r=this._state;if(1===r&&!e||2===r&&!t)return this;var n=new this.constructor(u),i=this._result;if(r){var o=arguments[r-1];j(function(){v(r,n,o,i)})}else p(this,n,e,t);return n},catch:function(e){return this.then(null,e)}},I={Promise:m,polyfill:L=function(){var e;if("undefined"!=typeof n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;t&&"[object Promise]"===Object.prototype.toString.call(t.resolve())&&!t.cast||(e.Promise=m)}},"undefined"!=typeof t&&t.exports?t.exports=I:"undefined"!=typeof this&&(this.ES6Promise=I),L()}).call(this)}).call(this,e("7YKIPe"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"7YKIPe":10}],4:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,s;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(void 0===(r=this._events[e]))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(t=arguments.length,n=Array(t-1),s=1;s<t;s++)n[s-1]=arguments[s];r.apply(this,n)}else if(o(r)){for(t=arguments.length,n=Array(t-1),s=1;s<t;s++)n[s-1]=arguments[s];for(t=(r=r.slice()).length,s=0;s<t;s++)r[s].apply(this,n)}return!0},n.prototype.on=n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(r=void 0!==this._maxListeners?this._maxListeners:n.defaultMaxListeners)&&0<r&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(r=this._events[e]).length,n=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(;0<s--;)if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}if(0>n)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(t=this._events[e]))this.removeListener(e,t);else for(;t.length;)this.removeListener(e,t[t.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){return e._events&&e._events[t]?i(e._events[t])?1:e._events[t].length:0}},{}],5:[function(e,t,r){},{}],6:[function(e,t,r){function n(e,t,r){if(!(this instanceof n))return new n(e,t,r);var i,o,s=typeof e;if("base64"===t&&"string"===s)for(e=e.trim?e.trim():e.replace(/^\s+|\s+$/g,"");0!=e.length%4;)e+="=";if("number"===s)i=y(e);else if("string"===s)i=n.byteLength(e,t);else{if("object"!==s)throw Error("First argument needs to be a number, array or string.");i=y(e.length)}if(n._useTypedArrays?o=n._augment(new Uint8Array(i)):((o=this).length=i,o._isBuffer=!0),n._useTypedArrays&&"number"==typeof e.byteLength)o._set(e);else{var a=e;if(m(a)||n.isBuffer(a)||a&&"object"==typeof a&&"number"==typeof a.length)for(t=0;t<i;t++)o[t]=n.isBuffer(e)?e.readUInt8(t):e[t];else if("string"===s)o.write(e,0,t);else if("number"===s&&!n._useTypedArrays&&!r)for(t=0;t<i;t++)o[t]=0}return o}function i(e,t,r,n){if(n||(A("boolean"==typeof r,"missing or invalid endian"),A(void 0!==t&&null!==t,"missing offset"),A(t+1<e.length,"Trying to read beyond buffer length")),!(t>=(n=e.length)))return r?(r=e[t],t+1<n&&(r|=e[t+1]<<8)):(r=e[t]<<8,t+1<n&&(r|=e[t+1])),r}function o(e,t,r,n){var i;if(n||(A("boolean"==typeof r,"missing or invalid endian"),A(void 0!==t&&null!==t,"missing offset"),A(t+3<e.length,"Trying to read beyond buffer length")),!(t>=(n=e.length)))return r?(t+2<n&&(i=e[t+2]<<16),t+1<n&&(i|=e[t+1]<<8),i|=e[t],t+3<n&&(i+=e[t+3]<<24>>>0)):(t+1<n&&(i=e[t+1]<<16),t+2<n&&(i|=e[t+2]<<8),t+3<n&&(i|=e[t+3]),i+=e[t]<<24>>>0),i}function s(e,t,r,n){if(n||(A("boolean"==typeof r,"missing or invalid endian"),A(void 0!==t&&null!==t,"missing offset"),A(t+1<e.length,"Trying to read beyond buffer length")),!(t>=e.length))return 32768&(e=i(e,t,r,!0))?-1*(65535-e+1):e}function a(e,t,r,n){if(n||(A("boolean"==typeof r,"missing or invalid endian"),A(void 0!==t&&null!==t,"missing offset"),A(t+3<e.length,"Trying to read beyond buffer length")),!(t>=e.length))return 2147483648&(e=o(e,t,r,!0))?-1*(4294967295-e+1):e}function u(e,t,r,n){return n||(A("boolean"==typeof r,"missing or invalid endian"),A(t+3<e.length,"Trying to read beyond buffer length")),E.read(e,t,r,23,4)}function l(e,t,r,n){return n||(A("boolean"==typeof r,"missing or invalid endian"),A(t+7<e.length,"Trying to read beyond buffer length")),E.read(e,t,r,52,8)}function c(e,t,r,n,i){i||(A(void 0!==t&&null!==t,"missing value"),A("boolean"==typeof n,"missing or invalid endian"),A(void 0!==r&&null!==r,"missing offset"),A(r+1<e.length,"trying to write beyond buffer length"),k(t,65535));var o=e.length;if(!(r>=o))for(i=0,o=Math.min(o-r,2);i<o;i++)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function f(e,t,r,n,i){i||(A(void 0!==t&&null!==t,"missing value"),A("boolean"==typeof n,"missing or invalid endian"),A(void 0!==r&&null!==r,"missing offset"),A(r+3<e.length,"trying to write beyond buffer length"),k(t,4294967295));var o=e.length;if(!(r>=o))for(i=0,o=Math.min(o-r,4);i<o;i++)e[r+i]=t>>>8*(n?i:3-i)&255}function h(e,t,r,n,i){i||(A(void 0!==t&&null!==t,"missing value"),A("boolean"==typeof n,"missing or invalid endian"),A(void 0!==r&&null!==r,"missing offset"),A(r+1<e.length,"Trying to write beyond buffer length"),j(t,32767,-32768)),r>=e.length||c(e,0<=t?t:65535+t+1,r,n,i)}function p(e,t,r,n,i){i||(A(void 0!==t&&null!==t,"missing value"),A("boolean"==typeof n,"missing or invalid endian"),A(void 0!==r&&null!==r,"missing offset"),A(r+3<e.length,"Trying to write beyond buffer length"),j(t,2147483647,-2147483648)),r>=e.length||f(e,0<=t?t:4294967295+t+1,r,n,i)}function d(e,t,r,n,i){i||(A(void 0!==t&&null!==t,"missing value"),A("boolean"==typeof n,"missing or invalid endian"),A(void 0!==r&&null!==r,"missing offset"),A(r+3<e.length,"Trying to write beyond buffer length"),L(t,3.4028234663852886e38,-3.4028234663852886e38)),r>=e.length||E.write(e,t,r,n,23,4)}function g(e,t,r,n,i){i||(A(void 0!==t&&null!==t,"missing value"),A("boolean"==typeof n,"missing or invalid endian"),A(void 0!==r&&null!==r,"missing offset"),A(r+7<e.length,"Trying to write beyond buffer length"),L(t,1.7976931348623157e308,-1.7976931348623157e308)),r>=e.length||E.write(e,t,r,n,52,8)}function v(e,t,r){return"number"!=typeof e?r:(e=~~e)>=t?t:0<=e?e:0<=(e+=t)?e:0}function y(e){return 0>(e=~~Math.ceil(+e))?0:e}function m(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function b(e){return 16>e?"0"+e.toString(16):e.toString(16)}function w(e){for(var t=[],r=0;r<e.length;r++){var n=e.charCodeAt(r);if(127>=n)t.push(e.charCodeAt(r));else{var i=r;for(55296<=n&&57343>=n&&r++,n=encodeURIComponent(e.slice(i,r+1)).substr(1).split("%"),i=0;i<n.length;i++)t.push(parseInt(n[i],16))}}return t}function x(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);i++)t[i+r]=e[i];return i}function _(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function k(e,t){A("number"==typeof e,"cannot write a non-number as a number"),A(0<=e,"specified a negative value for writing an unsigned value"),A(e<=t,"value is larger than maximum value for type"),A(Math.floor(e)===e,"value has a fractional component")}function j(e,t,r){A("number"==typeof e,"cannot write a non-number as a number"),A(e<=t,"value larger than maximum allowed value"),A(e>=r,"value smaller than minimum allowed value"),A(Math.floor(e)===e,"value has a fractional component")}function L(e,t,r){A("number"==typeof e,"cannot write a non-number as a number"),A(e<=t,"value larger than maximum allowed value"),A(e>=r,"value smaller than minimum allowed value")}function A(e,t){if(!e)throw Error(t||"Failed assertion")}var I=e("base64-js"),E=e("ieee754");r.Buffer=n,r.SlowBuffer=n,r.INSPECT_MAX_BYTES=50,n.poolSize=8192,n._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(e){return!1}}(),n.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.isBuffer=function(e){return!(null===e||void 0===e||!e._isBuffer)},n.byteLength=function(e,t){var r;switch(e+="",t||"utf8"){case"hex":r=e.length/2;break;case"utf8":case"utf-8":r=w(e).length;break;case"ascii":case"binary":case"raw":r=e.length;break;case"base64":r=I.toByteArray(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=2*e.length;break;default:throw Error("Unknown encoding")}return r},n.concat=function(e,t){if(A(m(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new n(0);if(1===e.length)return e[0];var r;if("number"!=typeof t)for(r=t=0;r<e.length;r++)t+=e[r].length;var i=new n(t),o=0;for(r=0;r<e.length;r++){var s=e[r];s.copy(i,o),o+=s.length}return i},n.prototype.write=function(e,t,r,i){if(isFinite(t))isFinite(r)||(i=r,r=void 0);else{var o=i;i=t,t=r,r=o}switch(t=Number(t)||0,o=this.length-t,r?(r=Number(r))>o&&(r=o):r=o,i=String(i||"utf8").toLowerCase()){case"hex":for(t=Number(t)||0,i=this.length-t,r?(r=Number(r))>i&&(r=i):r=i,A(0==(i=e.length)%2,"Invalid hex string"),r>i/2&&(r=i/2),i=0;i<r;i++)o=parseInt(e.substr(2*i,2),16),A(!isNaN(o),"Invalid hex string"),this[t+i]=o;n._charsWritten=2*i,e=i;break;case"utf8":case"utf-8":e=n._charsWritten=x(w(e),this,t,r);break;case"ascii":case"binary":e=n._charsWritten=x(function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t}(e),this,t,r);break;case"base64":e=n._charsWritten=x(I.toByteArray(e),this,t,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":o=[];for(var s,a=0;a<e.length;a++)i=(s=e.charCodeAt(a))>>8,o.push(s%=256),o.push(i);e=n._charsWritten=x(o,this,t,r);break;default:throw Error("Unknown encoding")}return e},n.prototype.toString=function(e,t,r){if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(r=void 0!==r?Number(r):r=this.length)===t)return"";switch(e){case"hex":for(e=this.length,(!t||0>t)&&(t=0),(!r||0>r||r>e)&&(r=e),e="";t<r;t++)e+=b(this[t]);r=e;break;case"utf8":case"utf-8":var n=e="";for(r=Math.min(this.length,r);t<r;t++)127>=this[t]?(e+=_(n)+String.fromCharCode(this[t]),n=""):n+="%"+this[t].toString(16);r=e+_(n);break;case"ascii":case"binary":r=function(e,t,r){var n="";for(r=Math.min(e.length,r);t<r;t++)n+=String.fromCharCode(e[t]);return n}(this,t,r);break;case"base64":r=I.fromByteArray(0===t&&r===this.length?this:this.slice(t,r));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(r=this.slice(t,r),t="",e=0;e<r.length;e+=2)t+=String.fromCharCode(r[e]+256*r[e+1]);r=t;break;default:throw Error("Unknown encoding")}return r},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},n.prototype.copy=function(e,t,r,i){if(r||(r=0),i||0===i||(i=this.length),t||(t=0),i!==r&&0!==e.length&&0!==this.length)if(A(i>=r,"sourceEnd < sourceStart"),A(0<=t&&t<e.length,"targetStart out of bounds"),A(0<=r&&r<this.length,"sourceStart out of bounds"),A(0<=i&&i<=this.length,"sourceEnd out of bounds"),i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r),100>(i-=r)||!n._useTypedArrays)for(var o=0;o<i;o++)e[o+t]=this[o+r];else e._set(this.subarray(r,r+i),t)},n.prototype.slice=function(e,t){if(e=v(e,r=this.length,0),t=v(t,r,r),n._useTypedArrays)return n._augment(this.subarray(e,t));for(var r,i=new n(r=t-e,void 0,!0),o=0;o<r;o++)i[o]=this[o+e];return i},n.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},n.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},n.prototype.readUInt8=function(e,t){if(t||(A(void 0!==e&&null!==e,"missing offset"),A(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},n.prototype.readUInt16LE=function(e,t){return i(this,e,!0,t)},n.prototype.readUInt16BE=function(e,t){return i(this,e,!1,t)},n.prototype.readUInt32LE=function(e,t){return o(this,e,!0,t)},n.prototype.readUInt32BE=function(e,t){return o(this,e,!1,t)},n.prototype.readInt8=function(e,t){if(t||(A(void 0!==e&&null!==e,"missing offset"),A(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},n.prototype.readInt16LE=function(e,t){return s(this,e,!0,t)},n.prototype.readInt16BE=function(e,t){return s(this,e,!1,t)},n.prototype.readInt32LE=function(e,t){return a(this,e,!0,t)},n.prototype.readInt32BE=function(e,t){return a(this,e,!1,t)},n.prototype.readFloatLE=function(e,t){return u(this,e,!0,t)},n.prototype.readFloatBE=function(e,t){return u(this,e,!1,t)},n.prototype.readDoubleLE=function(e,t){return l(this,e,!0,t)},n.prototype.readDoubleBE=function(e,t){return l(this,e,!1,t)},n.prototype.writeUInt8=function(e,t,r){r||(A(void 0!==e&&null!==e,"missing value"),A(void 0!==t&&null!==t,"missing offset"),A(t<this.length,"trying to write beyond buffer length"),k(e,255)),t>=this.length||(this[t]=e)},n.prototype.writeUInt16LE=function(e,t,r){c(this,e,t,!0,r)},n.prototype.writeUInt16BE=function(e,t,r){c(this,e,t,!1,r)},n.prototype.writeUInt32LE=function(e,t,r){f(this,e,t,!0,r)},n.prototype.writeUInt32BE=function(e,t,r){f(this,e,t,!1,r)},n.prototype.writeInt8=function(e,t,r){r||(A(void 0!==e&&null!==e,"missing value"),A(void 0!==t&&null!==t,"missing offset"),A(t<this.length,"Trying to write beyond buffer length"),j(e,127,-128)),t>=this.length||this.writeUInt8(0<=e?e:255+e+1,t,r)},n.prototype.writeInt16LE=function(e,t,r){h(this,e,t,!0,r)},n.prototype.writeInt16BE=function(e,t,r){h(this,e,t,!1,r)},n.prototype.writeInt32LE=function(e,t,r){p(this,e,t,!0,r)},n.prototype.writeInt32BE=function(e,t,r){p(this,e,t,!1,r)},n.prototype.writeFloatLE=function(e,t,r){d(this,e,t,!0,r)},n.prototype.writeFloatBE=function(e,t,r){d(this,e,t,!1,r)},n.prototype.writeDoubleLE=function(e,t,r){g(this,e,t,!0,r)},n.prototype.writeDoubleBE=function(e,t,r){g(this,e,t,!1,r)},n.prototype.fill=function(e,t,r){if(e||(e=0),t||(t=0),r||(r=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),A("number"==typeof e&&!isNaN(e),"value is not a number"),A(r>=t,"end < start"),r!==t&&0!==this.length)for(A(0<=t&&t<this.length,"start out of bounds"),A(0<=r&&r<=this.length,"end out of bounds");t<r;t++)this[t]=e},n.prototype.inspect=function(){for(var e=[],t=this.length,n=0;n<t;n++)if(e[n]=b(this[n]),n===r.INSPECT_MAX_BYTES){e[n+1]="...";break}return"<Buffer "+e.join(" ")+">"},n.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(n._useTypedArrays)return new n(this).buffer;for(var e=new Uint8Array(this.length),t=0,r=e.length;t<r;t+=1)e[t]=this[t];return e.buffer}throw Error("Buffer.toArrayBuffer not supported in this browser")};var C=n.prototype;n._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=C.get,e.set=C.set,e.write=C.write,e.toString=C.toString,e.toLocaleString=C.toString,e.toJSON=C.toJSON,e.copy=C.copy,e.slice=C.slice,e.readUInt8=C.readUInt8,e.readUInt16LE=C.readUInt16LE,e.readUInt16BE=C.readUInt16BE,e.readUInt32LE=C.readUInt32LE,e.readUInt32BE=C.readUInt32BE,e.readInt8=C.readInt8,e.readInt16LE=C.readInt16LE,e.readInt16BE=C.readInt16BE,e.readInt32LE=C.readInt32LE,e.readInt32BE=C.readInt32BE,e.readFloatLE=C.readFloatLE,e.readFloatBE=C.readFloatBE,e.readDoubleLE=C.readDoubleLE,e.readDoubleBE=C.readDoubleBE,e.writeUInt8=C.writeUInt8,e.writeUInt16LE=C.writeUInt16LE,e.writeUInt16BE=C.writeUInt16BE,e.writeUInt32LE=C.writeUInt32LE,e.writeUInt32BE=C.writeUInt32BE,e.writeInt8=C.writeInt8,e.writeInt16LE=C.writeInt16LE,e.writeInt16BE=C.writeInt16BE,e.writeInt32LE=C.writeInt32LE,e.writeInt32BE=C.writeInt32BE,e.writeFloatLE=C.writeFloatLE,e.writeFloatBE=C.writeFloatBE,e.writeDoubleLE=C.writeDoubleLE,e.writeDoubleBE=C.writeDoubleBE,e.fill=C.fill,e.inspect=C.inspect,e.toArrayBuffer=C.toArrayBuffer,e}},{"base64-js":2,ieee754:23}],7:[function(e,t,r){var n=t.exports;e("events");var i=e("./lib/request"),o=e("url");n.request=function(e,t){"string"==typeof e&&(e=o.parse(e)),e||(e={}),e.host||e.port||(e.port=parseInt(window.location.port,10)),!e.host&&e.hostname&&(e.host=e.hostname),e.scheme||(e.scheme=window.location.protocol.split(":")[0]),e.host||(e.host=window.location.hostname||window.location.host),/:/.test(e.host)&&(e.port||(e.port=e.host.split(":")[1]),e.host=e.host.split(":")[0]),e.port||(e.port="https"==e.scheme?443:80);var r=new i(new s,e);return t&&r.on("response",t),r},n.get=function(e,t){e.method="GET";var r=n.request(e,t);return r.end(),r},n.Agent=function(){},n.Agent.defaultMaxSockets=4;var s=function(){if("undefined"==typeof window)throw Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject)for(var e=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],t=0;t<e.length;t++)try{var r=new window.ActiveXObject(e[t]);return function(){if(r){var n=r;return r=null,n}return new window.ActiveXObject(e[t])}}catch(e){}throw Error("ajax not supported in this browser")}();n.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{"./lib/request":8,events:4,url:36}],8:[function(e,t,r){r=e("stream");var n=e("./response"),i=e("Base64");e=e("inherits");var o=t.exports=function(e,t){var r=this;r.writable=!0,r.xhr=e,r.body=[],r.uri=(t.scheme||"http")+"://"+t.host+(t.port?":"+t.port:"")+(t.path||"/"),"undefined"==typeof t.withCredentials&&(t.withCredentials=!0);try{e.withCredentials=t.withCredentials}catch(e){}if(e.open(t.method||"GET",r.uri,!0),r._headers={},t.headers)for(var o=s(t.headers),a=0;a<o.length;a++){var u=o[a];r.isSafeRequestHeader(u)&&r.setHeader(u,t.headers[u])}t.auth&&this.setHeader("Authorization","Basic "+i.btoa(t.auth));var l=new n;l.on("close",function(){r.emit("close")}),l.on("ready",function(){r.emit("response",l)}),e.onreadystatechange=function(){e.__aborted||l.handle(e)}};e(o,r),o.prototype.setHeader=function(e,t){this._headers[e.toLowerCase()]=t},o.prototype.getHeader=function(e){return this._headers[e.toLowerCase()]},o.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},o.prototype.write=function(e){this.body.push(e)},o.prototype.destroy=function(e){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},o.prototype.end=function(e){void 0!==e&&this.body.push(e);var t=s(this._headers);for(e=0;e<t.length;e++){var r=t[e],n=this._headers[r];if(a(n))for(var i=0;i<n.length;i++)this.xhr.setRequestHeader(r,n[i]);else this.xhr.setRequestHeader(r,n)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else{if(a(this.body[0]))for(t=[],e=0;e<this.body.length;e++)t.push.apply(t,this.body[e]);else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){for(e=i=0;e<this.body.length;e++)i+=this.body[e].length;for(t=new this.body[0].constructor(i),e=r=0;e<this.body.length;e++)for(n=this.body[e],i=0;i<n.length;i++)t[r++]=n[i]}else for(t="",e=0;e<this.body.length;e++)t+=this.body[e].toString();this.xhr.send(t)}},o.unsafeHeaders="accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "),o.prototype.isSafeRequestHeader=function(e){if(!e)return!1;var t;e:if(t=o.unsafeHeaders,e=e.toLowerCase(),t.indexOf)t=t.indexOf(e);else{for(var r=0;r<t.length;r++)if(t[r]===e){t=r;break e}t=-1}return-1===t};var s=Object.keys||function(e){var t,r=[];for(t in e)r.push(t);return r},a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{"./response":9,Base64:1,inherits:24,stream:15}],9:[function(e,t,r){function n(e){e=e.getAllResponseHeaders().split(/\r?\n/);for(var t={},r=0;r<e.length;r++){var n=e[r];if(""!==n){var i=n.match(/^([^:]+):\s*(.*)/);i?(n=i[1].toLowerCase(),i=i[2],void 0!==t[n]?s(t[n])?t[n].push(i):t[n]=[t[n],i]:t[n]=i):t[n]=!0}}return t}r=e("stream"),e=e("util"),t=t.exports=function(e){this.offset=0,this.readable=!0},e.inherits(t,r);var i=!0,o=!0;t.prototype.getResponse=function(e){var t=String(e.responseType).toLowerCase();return"blob"===t?e.responseBlob||e.response:"arraybuffer"===t?e.response:e.responseText},t.prototype.getHeader=function(e){return this.headers[e.toLowerCase()]},t.prototype.handle=function(e){if(2===e.readyState&&o){try{this.statusCode=e.status,this.headers=n(e)}catch(e){o=!1}o&&this.emit("ready")}else if(i&&3===e.readyState){try{this.statusCode||(this.statusCode=e.status,this.headers=n(e),this.emit("ready"))}catch(e){}try{this._emitData(e)}catch(e){i=!1}}else 4===e.readyState&&(this.statusCode||(this.statusCode=e.status,this.emit("ready")),this._emitData(e),e.error?this.emit("error",this.getResponse(e)):this.emit("end"),this.emit("close"))},t.prototype._emitData=function(e){(e=this.getResponse(e)).toString().match(/ArrayBuffer/)?(this.emit("data",new Uint8Array(e,this.offset)),this.offset=e.byteLength):e.length>this.offset&&(this.emit("data",e.slice(this.offset)),this.offset=e.length)};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{stream:15,util:38}],10:[function(e,t,r){function n(){}(e=t.exports={}).nextTick=function(){if("undefined"!=typeof window&&window.setImmediate)return function(e){return window.setImmediate(e)};if("undefined"!=typeof window&&window.postMessage&&window.addEventListener){var e=[];return window.addEventListener("message",function(t){var r=t.source;r!==window&&null!==r||"process-tick"!==t.data||(t.stopPropagation(),0<e.length&&e.shift()())},!0),function(t){e.push(t),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=n,e.addListener=n,e.once=n,e.off=n,e.removeListener=n,e.removeAllListeners=n,e.emit=n,e.binding=function(e){throw Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw Error("process.chdir is not supported")}},{}],11:[function(e,t,r){t.exports=function(e,t,r,i){r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var s=/\+/g;for(e=e.split(t||"&"),t=1e3,i&&"number"==typeof i.maxKeys&&(t=i.maxKeys),i=e.length,0<t&&i>t&&(i=t),t=0;t<i;++t){var a,u=e[t].replace(s,"%20"),l=u.indexOf(r);0<=l?(a=u.substr(0,l),u=u.substr(l+1)):(a=u,u=""),a=decodeURIComponent(a),u=decodeURIComponent(u),Object.prototype.hasOwnProperty.call(o,a)?n(o[a])?o[a].push(u):o[a]=[o[a],u]:o[a]=u}return o};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],12:[function(e,t,r){var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,r,s){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?function(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n]));return r}(o(e),function(o){var s=encodeURIComponent(n(o))+r;return i(e[o])?e[o].map(function(e){return s+encodeURIComponent(n(e))}).join(t):s+encodeURIComponent(n(e[o]))}).join(t):s?encodeURIComponent(n(s))+r+encodeURIComponent(n(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=Object.keys||function(e){var t,r=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.push(t);return r}},{}],13:[function(e,t,r){r.decode=r.parse=e("./decode"),r.encode=r.stringify=e("./encode")},{"./decode":11,"./encode":12}],14:[function(e,t,r){function n(e){if(!(this instanceof n))return new n(e);s.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",i)}function i(){if(!this.allowHalfOpen&&!this._writableState.ended){var e=this;o(function(){e.end()})}}t.exports=n,t=e("inherits");var o=e("process/browser.js").nextTick,s=e("./readable.js"),a=e("./writable.js");t(n,s),n.prototype.write=a.prototype.write,n.prototype.end=a.prototype.end,n.prototype._write=a.prototype._write},{"./readable.js":18,"./writable.js":20,inherits:24,"process/browser.js":16}],15:[function(e,t,r){function n(){i.call(this)}t.exports=n;var i=e("events").EventEmitter;e("inherits")(n,i),n.Readable=e("./readable.js"),n.Writable=e("./writable.js"),n.Duplex=e("./duplex.js"),n.Transform=e("./transform.js"),n.PassThrough=e("./passthrough.js"),n.Stream=n,n.prototype.pipe=function(e,t){function r(t){e.writable&&!1===e.write(t)&&l.pause&&l.pause()}function n(){l.readable&&l.resume&&l.resume()}function o(){c||(c=!0,e.end())}function s(){c||(c=!0,"function"==typeof e.destroy&&e.destroy())}function a(e){if(u(),0===i.listenerCount(this,"error"))throw e}function u(){l.removeListener("data",r),e.removeListener("drain",n),l.removeListener("end",o),l.removeListener("close",s),l.removeListener("error",a),e.removeListener("error",a),l.removeListener("end",u),l.removeListener("close",u),e.removeListener("close",u)}var l=this;l.on("data",r),e.on("drain",n),e._isStdio||t&&!1===t.end||(l.on("end",o),l.on("close",s));var c=!1;return l.on("error",a),e.on("error",a),l.on("end",u),l.on("close",u),e.on("close",u),e.emit("pipe",l),e}},{"./duplex.js":14,"./passthrough.js":17,"./readable.js":18,"./transform.js":19,"./writable.js":20,events:4,inherits:24}],16:[function(e,t,r){(e=t.exports={}).nextTick=function(){if("undefined"!=typeof window&&window.setImmediate)return function(e){return window.setImmediate(e)};if("undefined"!=typeof window&&window.postMessage&&window.addEventListener){var e=[];return window.addEventListener("message",function(t){var r=t.source;r!==window&&null!==r||"process-tick"!==t.data||(t.stopPropagation(),0<e.length&&e.shift()())},!0),function(t){e.push(t),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.binding=function(e){throw Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw Error("process.chdir is not supported")}},{}],17:[function(e,t,r){function n(e){if(!(this instanceof n))return new n(e);i.call(this,e)}t.exports=n;var i=e("./transform.js");e("inherits")(n,i),n.prototype._transform=function(e,t,r){r(null,e)}},{"./transform.js":19,inherits:24}],18:[function(e,t,r){(function(r){function n(t,r){var n=(t=t||{}).highWaterMark;this.highWaterMark=n||0===n?n:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.calledRead=this.reading=this.endEmitted=this.ended=this.flowing=!1,this.sync=!0,this.readableListening=this.emittedReadable=this.needReadable=!1,this.objectMode=!!t.objectMode,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.encoding=this.decoder=null,t.encoding&&(d||(d=e("string_decoder").StringDecoder),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function i(e){if(!(this instanceof i))return new i(e);this._readableState=new n(e,this),this.readable=!0,v.call(this)}function o(e,t,r,n,i){var o,s=null;return y.isBuffer(o=r)||"string"==typeof o||null===o||void 0===o||t.objectMode||s||(s=new TypeError("Invalid non-string/buffer chunk")),(o=s)?e.emit("error",o):null===r||void 0===r?(t.reading=!1,t.ended||(t.decoder&&!t.ended&&(r=t.decoder.end())&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length),t.ended=!0,0<t.length?a(e):h(e))):t.objectMode||r&&0<r.length?t.ended&&!i?(r=Error("stream.push() after EOF"),e.emit("error",r)):t.endEmitted&&i?(r=Error("stream.unshift() after end event"),e.emit("error",r)):(!t.decoder||i||n||(r=t.decoder.write(r)),t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):(t.reading=!1,t.buffer.push(r)),t.needReadable&&a(e),function(e,t){t.readingMore||(t.readingMore=!0,m(function(){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}))}(e,t)):i||(t.reading=!1),!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}function s(e,t){if(0===t.length&&t.ended)return 0;if(t.objectMode)return 0===e?0:1;if(isNaN(e)||null===e)return t.flowing&&t.buffer.length?t.buffer[0].length:t.length;if(0>=e)return 0;if(e>t.highWaterMark){var r=e;if(8388608<=r)r=8388608;else{r--;for(var n=1;32>n;n<<=1)r|=r>>n;r++}t.highWaterMark=r}return e>t.length?t.ended?t.length:(t.needReadable=!0,0):e}function a(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,t.sync?m(function(){e.emit("readable")}):e.emit("readable"))}function u(e){function t(e,t,i){!1===e.write(r)&&n.awaitDrain++}var r,n=e._readableState;for(n.awaitDrain=0;n.pipesCount&&null!==(r=e.read());)if(1===n.pipesCount?t(n.pipes):p(n.pipes,t),e.emit("data",r),0<n.awaitDrain)return;0===n.pipesCount?(n.flowing=!1,0<g.listenerCount(e,"data")&&c(e)):n.ranOut=!0}function l(){this._readableState.ranOut&&(this._readableState.ranOut=!1,u(this))}function c(e,t){if(e._readableState.flowing)throw Error("Cannot switch to old mode now.");var r=t||!1,n=!1;e.readable=!0,e.pipe=v.prototype.pipe,e.on=e.addListener=v.prototype.on,e.on("readable",function(){n=!0;for(var t;!r&&null!==(t=e.read());)e.emit("data",t);null===t&&(n=!1,e._readableState.needReadable=!0)}),e.pause=function(){r=!0,this.emit("pause")},e.resume=function(){r=!1,n?m(function(){e.emit("readable")}):this.read(0),this.emit("resume")},e.emit("readable")}function f(e,t){var r=t.buffer,n=t.length,i=!!t.decoder,o=!!t.objectMode;if(0===r.length)return null;if(0===n)n=null;else if(o)n=r.shift();else if(!e||e>=n)n=i?r.join(""):y.concat(r,n),r.length=0;else if(e<r[0].length)n=(o=r[0]).slice(0,e),r[0]=o.slice(e);else if(e===r[0].length)n=r.shift();else{n=i?"":new y(e);for(var s=0,a=0,u=r.length;a<u&&s<e;a++){o=r[0];var l=Math.min(e-s,o.length);i?n+=o.slice(0,l):o.copy(n,s,0,l),l<o.length?r[0]=o.slice(l):r.shift(),s+=l}}return n}function h(e){var t=e._readableState;if(0<t.length)throw Error("endReadable called on non-empty stream");!t.endEmitted&&t.calledRead&&(t.ended=!0,m(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function p(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}t.exports=i,i.ReadableState=n;var d,g=e("events").EventEmitter,v=e("./index.js"),y=e("buffer").Buffer,m=e("process/browser.js").nextTick;e("inherits")(i,v),i.prototype.push=function(e,t){var r=this._readableState;return"string"!=typeof e||r.objectMode||(t=t||r.defaultEncoding)!==r.encoding&&(e=new y(e,t),t=""),o(this,r,e,t,!1)},i.prototype.unshift=function(e){return o(this,this._readableState,e,"",!0)},i.prototype.setEncoding=function(t){d||(d=e("string_decoder").StringDecoder),this._readableState.decoder=new d(t),this._readableState.encoding=t},i.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var r=e;if(("number"!=typeof e||0<e)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return a(this),null;if(0===(e=s(e,t))&&t.ended)return 0===t.length&&h(this),null;var n=t.needReadable;return t.length-e<=t.highWaterMark&&(n=!0),(t.ended||t.reading)&&(n=!1),n&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),n&&!t.reading&&(e=s(r,t)),null===(r=0<e?f(e,t):null)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&h(this),r},i.prototype._read=function(e){this.emit("error",Error("not implemented"))},i.prototype.pipe=function(e,t){function n(e){e===f&&o()}function i(){e.end()}function o(){e.removeListener("close",a),e.removeListener("finish",c),e.removeListener("drain",d),e.removeListener("error",s),e.removeListener("unpipe",n),f.removeListener("end",i),f.removeListener("end",o),e._writableState&&!e._writableState.needDrain||d()}function s(t){f.unpipe(e),0===v&&0===g.listenerCount(e,"error")&&e.emit("error",t)}function a(){e.removeListener("finish",c),f.unpipe(e)}function c(){e.removeListener("close",a),f.unpipe(e)}var f=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=e;break;case 1:h.pipes=[h.pipes,e];break;default:h.pipes.push(e)}h.pipesCount+=1;var p=t&&!1===t.end||e===r.stdout||e===r.stderr?o:i;h.endEmitted?m(p):f.once("end",p),e.on("unpipe",n);var d=function(e){return function(){var t=e._readableState;t.awaitDrain--,0===t.awaitDrain&&u(e)}}(f);e.on("drain",d);var v=g.listenerCount(e,"error");return e.once("error",s),e.once("close",a),e.once("finish",c),e.emit("pipe",f),h.flowing||(this.on("readable",l),h.flowing=!0,m(function(){u(f)})),e},i.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",l),t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){e=t.pipes;var r=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",l),t.flowing=!1;for(var n=0;n<r;n++)e[n].emit("unpipe",this);return this}e:{r=0;for(var i=(n=t.pipes).length;r<i;r++)if(n[r]===e){n=r;break e}n=-1}return-1===n?this:(t.pipes.splice(n,1),--t.pipesCount,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},i.prototype.on=function(e,t){var r=v.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||c(this),"readable"===e&&this.readable){var n=this._readableState;n.readableListening||(n.readableListening=!0,n.emittedReadable=!1,n.needReadable=!0,n.reading?n.length&&a(this):this.read(0))}return r},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){c(this),this.read(0),this.emit("resume")},i.prototype.pause=function(){c(this,!0),this.emit("pause")},i.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var i in e.on("end",function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(i){t.decoder&&(i=t.decoder.write(i)),i&&(t.objectMode||i.length)&&!n.push(i)&&(r=!0,e.pause())}),e)"function"==typeof e[i]&&"undefined"==typeof this[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return p(["error","close","destroy","pause","resume"],function(t){e.on(t,function(e){return n.emit.apply(n,t,e)})}),n._read=function(t){r&&(r=!1,e.resume())},n},i._fromList=f}).call(this,e("7YKIPe"))},{"./index.js":15,"7YKIPe":10,buffer:6,events:4,inherits:24,"process/browser.js":16,string_decoder:21}],19:[function(e,t,r){function n(e){if(!(this instanceof n))return new n(e);o.call(this,e),this._transformState=new function(e,t){this.afterTransform=function(e,r){var n;(n=t._transformState).transforming=!1;var i=n.writecb;return i?(n.writechunk=null,n.writecb=null,null!==r&&void 0!==r&&t.push(r),i&&i(e),(n=t._readableState).reading=!1,(n.needReadable||n.length<n.highWaterMark)&&t._read(n.highWaterMark),n=void 0):n=t.emit("error",Error("no writecb in Transform class")),n},this.transforming=this.needTransform=!1,this.writechunk=this.writecb=null}(e,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(e){i(t,e)}):i(t)})}function i(e,t){if(t)return e.emit("error",t);var r=e._transformState;if(e._writableState.length)throw Error("calling transform done when ws.length != 0");if(r.transforming)throw Error("calling transform done when still transforming");return e.push(null)}t.exports=n;var o=e("./duplex.js");e("inherits")(n,o),n.prototype.push=function(e,t){return this._transformState.needTransform=!1,o.prototype.push.call(this,e,t)},n.prototype._transform=function(e,t,r){throw Error("not implemented")},n.prototype._write=function(e,t,r){var n=this._transformState;n.writecb=r,n.writechunk=e,n.writeencoding=t,n.transforming||(e=this._readableState,(n.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark))},n.prototype._read=function(e){(e=this._transformState).writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0}},{"./duplex.js":14,inherits:24}],20:[function(e,t,r){function n(e,t){var r=(e=e||{}).highWaterMark;this.highWaterMark=r||0===r?r:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.finished=this.ended=this.ending=this.needDrain=!1,this.decodeStrings=!1!==e.decodeStrings,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){r?c(function(){i(n)}):i(n),e.emit("error",n)}(e,0,n,t,i);else{var s=r.ending&&0===r.length&&!r.finished&&!r.writing;s||r.bufferProcessing||!r.buffer.length||function(e,t){t.bufferProcessing=!0;for(var r=0;r<t.buffer.length;r++){var n=(u=t.buffer[r]).chunk,i=e,o=t,s=n,a=u.encoding,u=u.callback;if(o.writelen=t.objectMode?1:n.length,o.writecb=u,o.writing=!0,o.sync=!0,i._write(s,a,o.onwrite),o.sync=!1,t.writing){r++;break}}t.bufferProcessing=!1,r<t.buffer.length?t.buffer=t.buffer.slice(r):t.buffer.length=0}(e,r),n?c(function(){o(e,r,s,i)}):o(e,r,s,i)}}(t,e)},this.writecb=null,this.writelen=0,this.buffer=[]}function i(e){if(!(this instanceof i||this instanceof l.Duplex))return new i(e);this._writableState=new n(e,this),this.writable=!0,l.call(this)}function o(e,t,r,n){!r&&0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain")),n(),r&&s(e,t)}function s(e,t){var r=t.ending&&0===t.length&&!t.finished&&!t.writing;return r&&(t.finished=!0,e.emit("finish")),r}t.exports=i,i.WritableState=n;var a="undefined"!=typeof Uint8Array?function(e){return e instanceof Uint8Array}:function(e){return e&&e.constructor&&"Uint8Array"===e.constructor.name},u="undefined"!=typeof ArrayBuffer?function(e){return e instanceof ArrayBuffer}:function(e){return e&&e.constructor&&"ArrayBuffer"===e.constructor.name};t=e("inherits");var l=e("./index.js"),c=e("process/browser.js").nextTick,f=e("buffer").Buffer;t(i,l),i.prototype.pipe=function(){this.emit("error",Error("Cannot pipe. Not readable."))},i.prototype.write=function(e,t,r){var n=this._writableState,i=!1;return"function"==typeof t&&(r=t,t=null),!f.isBuffer(e)&&a(e)&&(e=new f(e)),u(e)&&"undefined"!=typeof Uint8Array&&(e=new f(new Uint8Array(e))),f.isBuffer(e)?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof r&&(r=function(){}),n.ended?function(e,t,r){var n=Error("write after end");e.emit("error",n),c(function(){r(n)})}(this,0,r):function(e,t,r,n){var i=!0;if(!f.isBuffer(r)&&"string"!=typeof r&&null!==r&&void 0!==r&&!t.objectMode){var o=new TypeError("Invalid non-string/buffer chunk");e.emit("error",o),c(function(){n(o)}),i=!1}return i}(this,n,e,r)&&(i=function(e,t,r,n,i){t.objectMode||!1===t.decodeStrings||"string"!=typeof r||(r=new f(r,n));var o=t.objectMode?1:r.length;t.length+=o;var s=t.length<t.highWaterMark;return t.needDrain=!s,t.writing?t.buffer.push(new function(e,t,r){this.chunk=e,this.encoding=t,this.callback=r}(r,n,i)):(t.writelen=o,t.writecb=i,t.writing=!0,t.sync=!0,e._write(r,n,t.onwrite),t.sync=!1),s}(this,n,e,t,r)),i},i.prototype._write=function(e,t,r){r(Error("not implemented"))},i.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,t=e=null):"function"==typeof t&&(r=t,t=null),"undefined"!=typeof e&&null!==e&&this.write(e,t),n.ending||n.finished||(e=r,n.ending=!0,s(this,n),e&&(n.finished?c(e):this.once("finish",e)),n.ended=!0)}},{"./index.js":15,buffer:6,inherits:24,"process/browser.js":16}],21:[function(e,t,r){function n(e){return e.toString(this.encoding)}function i(e){return this.charLength=(e=this.charReceived=e.length%2)?2:0,e}function o(e){return this.charLength=(e=this.charReceived=e.length%3)?3:0,e}var s=e("buffer").Buffer;(e=r.StringDecoder=function(e){if(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),e&&!s.isEncoding(e))throw Error("Unknown encoding: "+e);switch(this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=i;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=o;break;default:return void(this.write=n)}this.charBuffer=new s(6),this.charLength=this.charReceived=0}).prototype.write=function(e){for(var t="",r=0;this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,r,n),this.charReceived+=n-r,r=n,this.charReceived<this.charLength)return"";var i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1);if(!(55296<=i&&56319>=i)){if(this.charReceived=this.charLength=0,n==e.length)return t;e=e.slice(n,e.length);break}this.charLength+=this.surrogateSize,t=""}return i=this.detectIncompleteChar(e),r=e.length,this.charLength&&(e.copy(this.charBuffer,0,e.length-i,r),this.charReceived=i,r-=i),55296<=(i=(t+=e.toString(this.encoding,0,r)).charCodeAt(r=t.length-1))&&56319>=i?(this.charLength+=e=this.surrogateSize,this.charReceived+=e,this.charBuffer.copy(this.charBuffer,e,0,e),this.charBuffer.write(t.charAt(t.length-1),this.encoding),t.substring(0,r)):t},e.prototype.detectIncompleteChar=function(e){for(var t=3<=e.length?3:e.length;0<t;t--){var r=e[e.length-t];if(1==t&&6==r>>5){this.charLength=2;break}if(2>=t&&14==r>>4){this.charLength=3;break}if(3>=t&&30==r>>3){this.charLength=4;break}}return t},e.prototype.end=function(e){var t="";return e&&e.length&&(t=this.write(e)),this.charReceived&&(e=this.encoding,t+=this.charBuffer.slice(0,this.charReceived).toString(e)),t}},{buffer:6}],22:[function(e,t,r){var n=e("http");for(var i in e=t.exports,n)n.hasOwnProperty(i)&&(e[i]=n[i]);e.request=function(e,t){return e||(e={}),e.scheme="https",e.protocol="https:",n.request.call(this,e,t)}},{http:7}],23:[function(e,t,r){r.read=function(e,t,r,n,i){var o,s=(1<<(o=8*i-n-1))-1,a=s>>1,u=-7;i=r?i-1:0;var l=r?-1:1,c=e[t+i];for(i+=l,r=c&(1<<-u)-1,c>>=-u,u+=o;0<u;r=256*r+e[t+i],i+=l,u-=8);for(o=r&(1<<-u)-1,r>>=-u,u+=n;0<u;o=256*o+e[t+i],i+=l,u-=8);if(0===r)r=1-a;else{if(r===s)return o?NaN:1/0*(c?-1:1);o+=Math.pow(2,n),r-=a}return(c?-1:1)*o*Math.pow(2,r-n)},r.write=function(e,t,r,n,i,o){var s,a=8*o-i-1,u=(1<<a)-1,l=u>>1,c=23===i?Math.pow(2,-24)-Math.pow(2,-77):0;o=n?0:o-1;var f=n?1:-1,h=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(t=isNaN(t)?1:0,n=u):(n=Math.floor(Math.log(t)/Math.LN2),1>t*(s=Math.pow(2,-n))&&(n--,s*=2),2<=(t=1<=n+l?t+c/s:t+c*Math.pow(2,1-l))*s&&(n++,s/=2),n+l>=u?(t=0,n=u):1<=n+l?(t=(t*s-1)*Math.pow(2,i),n+=l):(t=t*Math.pow(2,l-1)*Math.pow(2,i),n=0));8<=i;e[r+o]=255&t,o+=f,t/=256,i-=8);for(n=n<<i|t,a+=i;0<a;e[r+o]=255&n,o+=f,n/=256,a-=8);e[r+o-f]|=128*h}},{}],24:[function(e,t,r){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],25:[function(e,t,r){},{}],26:[function(e,t,r){(function(r,n,i){!function(){var o="undefined"!=typeof r&&r.versions&&r.versions.node,s=!o&&("undefined"!=typeof window||"undefined"!=typeof self);s&&"undefined"==typeof n&&("undefined"!=typeof window?n=window:"undefined"!=typeof self?n=self:"undefined"!=typeof $&&(n=$));var a=function(t){function a(){}function u(e){var t={};if(C(e)){t.type="literal";var r=e["@value"],n=e["@type"]||null;"boolean"==typeof r||"[object Boolean]"===Object.prototype.toString.call(r)?(t.value=r.toString(),t.datatype=n||"http://www.w3.org/2001/XMLSchema#boolean"):A(r)||"http://www.w3.org/2001/XMLSchema#double"===n?(A(r)||(r=parseFloat(r)),t.value=r.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),t.datatype=n||"http://www.w3.org/2001/XMLSchema#double"):L(r)?(t.value=r.toFixed(0),t.datatype=n||"http://www.w3.org/2001/XMLSchema#integer"):"@language"in e?(t.value=r,t.datatype=n||z,t.language=e["@language"]):(t.value=r,t.datatype=n||G)}else e=_(e)?e["@id"]:e,t.type=0===e.indexOf("_:")?"blank node":"IRI",t.value=e;return"IRI"!==t.type||S(t.value)?t:null}function l(e,r,n,i,o,s){if(k(e))for(var a=0;a<e.length;++a)l(e[a],r,n,i,void 0,s);else if(_(e))if(C(e)){if("@type"in e){var u=e["@type"];0===u.indexOf("_:")&&(e["@type"]=i.getId(u))}s&&s.push(e)}else{if("@type"in e){var c=e["@type"];for(a=0;a<c.length;++a)0===(u=c[a]).indexOf("_:")&&i.getId(u)}for(I(o)&&(o=F(e)?i.getId(e["@id"]):e["@id"]),s&&s.push({"@id":o}),(a=(s=r[n])[o]=s[o]||{})["@id"]=o,u=Object.keys(e).sort(),c=0;c<u.length;++c)if("@id"!==(h=u[c]))if("@reverse"===h){var f,h={"@id":o},p=e["@reverse"];for(f in p)for(var d=p[f],g=0;g<d.length;++g){var v=d[g],y=v["@id"];F(v)&&(y=i.getId(y)),l(v,r,n,i,y),t.addValue(s[y],f,h,{propertyIsArray:!0,allowDuplicate:!1})}}else if("@graph"===h)o in r||(r[o]={}),l(e[h],r,"@merged"===n?n:o,i);else if("@type"!==h&&x(h)){if("@index"===h&&h in a&&(e[h]!==a[h]||e[h]["@id"]!==a[h]["@id"]))throw new $("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:a});a[h]=e[h]}else if(p=e[h],0===h.indexOf("_:")&&(h=i.getId(h)),0===p.length)t.addValue(a,h,[],{propertyIsArray:!0});else for(d=0;d<p.length;++d)g=p[d],"@type"===h&&(g=0===g.indexOf("_:")?i.getId(g):g),y=!1,!_(v=g)||"@value"in v||"@set"in v||"@list"in v||(y=1<Object.keys(v).length||!("@id"in v)),y||E(g)?(v=F(g)?i.getId(g["@id"]):g["@id"],t.addValue(a,h,{"@id":v},{propertyIsArray:!0,allowDuplicate:!1}),l(g,r,n,i,v)):(O(g)?(l(g["@list"],r,n,i,o,v=[]),g={"@list":v}):l(g,r,n,i,o),t.addValue(a,h,g,{propertyIsArray:!0,allowDuplicate:!1}))}else s&&s.push(e)}function c(e){for(var t=e["@default"],r=Object.keys(e).sort(),n=0;n<r.length;++n)if("@default"!==(o=r[n])){var i=e[o];(s=t[o])?"@graph"in s||(s["@graph"]=[]):t[o]=s={"@id":o,"@graph":[]};for(var o=s["@graph"],s=Object.keys(i).sort(),a=0;a<s.length;++a){var u=i[s[a]];E(u)||o.push(u)}}return t}function f(e){var t,r={};for(t in e)void 0!==e[t]&&(r["@"+t]=[e[t]]);return[r]}function h(e,t,r){var n="@"+r;return e=n in e?e[n][0]:t[r],"embed"===r&&(!0===e?e="@last":!1===e?e="@never":"@always"!==e&&"@never"!==e&&"@link"!==e&&(e="@last")),e}function p(e,r,n){if("@type"in r&&(1!==r["@type"].length||!_(r["@type"][0]))){for(r=r["@type"],n=0;n<r.length;++n)if(t.hasValue(e,"@type",r[n]))return!0;return!1}var i,o=!0,s=!1;for(i in r){if(x(i)){if("@id"!==i&&"@type"!==i)continue;if(o=!1,"@id"===i&&j(r[i])){if(e[i]!==r[i])return!1;s=!0;continue}}if(o=!1,i in e){if(k(r[i])&&0===r[i].length&&void 0!==e[i])return!1;s=!0}else{var a=k(r[i])&&_(r[i][0])&&"@default"in r[i][0];if(n.requireAll&&!a)return!1}}return o||s}function d(e,r){var n=e.uniqueEmbeds,i=(s=n[r]).parent,o=s.property,s={"@id":r};if(k(i)){for(o=0;o<i.length;++o)if(t.compareValues(i[o],s)){i[o]=s;break}}else{var a=k(i[o]);t.removeValue(i,o,s,{propertyIsArray:a}),t.addValue(i,o,s,{propertyIsArray:a})}var u=function(e){for(var t=Object.keys(n),r=0;r<t.length;++r){var i=t[r];i in n&&_(n[i].parent)&&n[i].parent["@id"]===e&&(delete n[i],u(i))}};u(r)}function g(e,r,n){_(e)?t.addValue(e,r,n,{propertyIsArray:!0}):e.push(n)}function v(e,t){return e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1}function y(e,r,n,i,o){if(null===r)return r;I(n)&&(n=null),I(o)&&(o=!1),i=i||{};var s=e.getInverse();if(x(r))return r in s?s[r]["@none"]["@type"]["@none"]:r;if(i.vocab&&r in s){var a=e["@language"]||"@none";s=[],_(n)&&"@index"in n&&s.push("@index");var u="@language",l="@null";if(o)u="@type",l="@reverse",s.push("@set");else if(O(n)){"@index"in n||s.push("@list");var c=n["@list"];for(l=0===c.length?a:null,a=null,o=0;o<c.length;++o){var f=c[o],h="@none",p="@none";if(C(f)?"@language"in f?h=f["@language"]:"@type"in f?p=f["@type"]:h="@null":p="@id",null===l?l=h:h!==l&&C(f)&&(l="@none"),null===a?a=p:p!==a&&(a="@none"),"@none"===l&&"@none"===a)break}l=l||"@none","@none"!==(a=a||"@none")&&(u="@type",l=a)}else C(n)?"@language"in n&&!("@index"in n)?(s.push("@language"),l=n["@language"]):"@type"in n&&(u="@type",l=n["@type"]):(u="@type",l="@id"),s.push("@set");s.push("@none");e:{c=n,o=u,null===l&&(l="@null"),u=[],"@id"!==l&&"@reverse"!==l||!E(c)?u.push(l):("@reverse"===l&&u.push("@reverse"),l=y(e,c["@id"],null,{vocab:!0}),u.push.apply(u,l in e.mappings&&e.mappings[l]&&e.mappings[l]["@id"]===c["@id"]?["@vocab","@id"]:["@id","@vocab"])),u.push("@none"),c=e.inverse[r];for(l=0;l<s.length;++l)if((a=s[l])in c)for(a=c[a][o],f=0;f<u.length;++f)if((h=u[f])in a){s=a[h];break e}s=null}if(null!==s)return s}if(i.vocab&&"@vocab"in e&&0===r.indexOf(s=e["@vocab"])&&r!==s&&!((s=r.substr(s.length))in e.mappings))return s;for(s=null,o=0,u=[],c=e.fastCurieMap,l=r.length-1;o<l&&r[o]in c;++o)""in(c=c[r[o]])&&u.push(c[""][0]);for(o=u.length-1;0<=o;--o)for(l=(c=u[o]).terms,a=0;a<l.length;++a)(f=l[a]+":"+r.substr(c.iri.length))in e.mappings&&(null!==n||e.mappings[f]["@id"]!==r)||!(null===s||0>v(f,s))||(s=f);if(null!==s)return s;if(!i.vocab&&null!==(e=e["@base"])&&(j(e)&&(e=t.url.parse(e||"")),n="",""!==e.href?n+=(e.protocol||"")+"//"+(e.authority||""):r.indexOf("//")&&(n+="//"),0===r.indexOf(n))){for(r=t.url.parse(r.substr(n.length)),e=e.normalizedPath.split("/"),n=r.normalizedPath.split("/"),i=r.fragment||r.query?0:1;0<e.length&&n.length>i&&e[0]===n[0];)e.shift(),n.shift();if(i="",0<e.length)for(e.pop(),s=0;s<e.length;++s)i+="../";i+=n.join("/"),null!==r.query&&(i+="?"+r.query),null!==r.fragment&&(i+="#"+r.fragment),""===i&&(i="./"),r=i}return r}function m(e,t,r,n){if(r in n){if(n[r])return;throw new $("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:r})}if(n[r]=!1,x(r))throw new $("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:r});if(""===r)throw new $("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t});e.mappings[r]&&delete e.mappings[r];var i=t[r];if(null===i||_(i)&&null===i["@id"])e.mappings[r]=null,n[r]=!0;else{if(j(i)&&(i={"@id":i}),!_(i))throw new $("Invalid JSON-LD syntax; @context property values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});var o=e.mappings[r]={};if(o.reverse=!1,"@reverse"in i){if("@id"in i)throw new $("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});var s=i["@reverse"];if(!j(s))throw new $("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(!S(s=b(e,s,{vocab:!0,base:!1},t,n)))throw new $("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});o["@id"]=s,o.reverse=!0}else if("@id"in i){if(!j(s=i["@id"]))throw new $("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(s!==r){if(!S(s=b(e,s,{vocab:!0,base:!1},t,n))&&!x(s))throw new $("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});o["@id"]=s}}var a=r.indexOf(":");if(o._termHasColon=-1!==a,!("@id"in o))if(o._termHasColon)(s=r.substr(0,a))in t&&m(e,t,s,n),e.mappings[s]?(a=r.substr(a+1),o["@id"]=e.mappings[s]["@id"]+a):o["@id"]=r;else{if(!("@vocab"in e))throw new $("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:r});o["@id"]=e["@vocab"]+r}if(n[r]=!0,"@type"in i){if(!j(r=i["@type"]))throw new $("Invalid JSON-LD syntax; an @context @type values must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@id"!==r&&"@vocab"!==r){if(!S(r=b(e,r,{vocab:!0,base:!1},t,n)))throw new $("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===r.indexOf("_:"))throw new $("Invalid JSON-LD syntax; an @context @type values must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}o["@type"]=r}if("@container"in i){if("@list"!==(e=i["@container"])&&"@set"!==e&&"@index"!==e&&"@language"!==e)throw new $("Invalid JSON-LD syntax; @context @container value must be one of the following: @list, @set, @index, or @language.","jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(o.reverse&&"@index"!==e&&"@set"!==e&&null!==e)throw new $("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});o["@container"]=e}if("@language"in i&&!("@type"in i)){if(null!==(i=i["@language"])&&!j(i))throw new $("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==i&&(i=i.toLowerCase()),o["@language"]=i}if("@context"===(s=o["@id"])||"@preserve"===s)throw new $("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t})}}function b(e,r,n,i,o){if(null===r||x(r))return r;if(r=String(r),i&&r in i&&!0!==o[r]&&m(e,i,r,o),(n=n||{}).vocab){var s=e.mappings[r];if(null===s)return null;if(s)return s["@id"]}if(-1!==(s=r.indexOf(":"))){n=r.substr(0,s);var a=r.substr(s+1);return"_"===n||0===a.indexOf("//")?r:(i&&n in i&&m(e,i,n,o),(s=e.mappings[n])?s["@id"]+a:r)}return n.vocab&&"@vocab"in e?e["@vocab"]+r:(n.base&&(r=t.prependBase(e["@base"],r)),r)}function w(e){function r(e,t,n){var i=e[t];e=e[t]={};for(var o,s=0;s<i.length;++s)(o=n>=(o=i[s].iri).length?"":o[n])in e?e[o].push(i[s]):e[o]=[i[s]];for(t in e)""!==t&&r(e,t,n+1)}return{"@base":t.url.parse(e.base||""),mappings:{},inverse:null,getInverse:function(){if(this.inverse)return this.inverse;for(var e=this.inverse={},t=this.fastCurieMap={},n={},i=this["@language"]||"@none",o=this.mappings,s=Object.keys(o).sort(v),a=0;a<s.length;++a){var u=s[a],l=o[u];if(null!==l){var c=l["@container"]||"@none",f=l["@id"];k(f)||(f=[f]);for(var h=0;h<f.length;++h){var p=f[h],d=e[p],g=x(p);d?g||l._termHasColon||n[p].push(u):(e[p]=d={},g||l._termHasColon||(n[p]=[u],g={iri:p,terms:n[p]},p[0]in t?t[p[0]].push(g):t[p[0]]=[g])),d[c]||(d[c]={"@language":{},"@type":{}}),d=d[c],l.reverse?"@reverse"in(d=d["@type"])||(d["@reverse"]=u):"@type"in l?(p=l["@type"])in(d=d["@type"])||(d[p]=u):"@language"in l?(d=d["@language"],(p=l["@language"]||"@null")in d||(d[p]=u)):(i in(p=d["@language"])||(p[i]=u),"@none"in(p=d["@type"])||(p["@none"]=u),"@none"in(d=d["@language"])||(d["@none"]=u))}}}for(var y in t)r(t,y,1);return e},clone:function(){var e={};return e["@base"]=this["@base"],e.mappings=R(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,"@language"in this&&(e["@language"]=this["@language"]),"@vocab"in this&&(e["@vocab"]=this["@vocab"]),e}}}function x(e){if(!j(e))return!1;switch(e){case"@base":case"@context":case"@container":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@omitDefault":case"@preserve":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@vocab":return!0}return!1}function _(e){return"[object Object]"===Object.prototype.toString.call(e)}function k(e){return Array.isArray(e)}function j(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)}function L(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function A(e){return L(e)&&-1!==String(e).indexOf(".")}function I(e){return"undefined"==typeof e}function E(e){return _(e)&&1===Object.keys(e).length&&"@id"in e}function C(e){return _(e)&&"@value"in e}function O(e){return _(e)&&"@list"in e}function F(e){var t=!1;return _(e)&&(t="@id"in e?0===e["@id"].indexOf("_:"):0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e)),t}function S(e){return j(e)&&-1!==e.indexOf(":")}function R(e){if(e&&"object"==typeof e){var t;if(k(e)){t=[];for(var r=0;r<e.length;++r)t[r]=R(e[r])}else if(_(e))for(r in t={},e)t[r]=R(e[r]);else t=e.toString();return t}return e}function T(e,r,n,i){var o=Object.keys(r).length;if(k(e)){for(var s=0;s<e.length;++s)T(e[s],r,n,i);return o<Object.keys(r).length}if(_(e)){for(var a in e)if("@context"!==a)T(e[a],r,n,i);else{var u=e[a];if(k(u)){var l=u.length;for(s=0;s<l;++s){var c=u[s];j(c)&&(c=t.prependBase(i,c),n?k(c=r[c])?(Array.prototype.splice.apply(u,[s,1].concat(c)),s+=c.length-1,l=u.length):u[s]=c:c in r||(r[c]=!1))}}else j(u)&&(u=t.prependBase(i,u),n?e[a]=r[u]:u in r||(r[u]=!1))}return o<Object.keys(r).length}return!1}function M(e,t,r){var n=null,i=function(e,t,r,o,s){if(Object.keys(t).length>V)return n=new $("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:V}),s(n);var a={};T(e,a,!1,o)||(T(e,a,!0,o),s(null,e));var u,l=[];for(u in a)!1===a[u]&&l.push(u);var c=l.length;for(u=0;u<l.length;++u)!function(u){if(u in t)return n=new $("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:u}),s(n);var l=R(t);l[u]=!0;var f=function(t,f){if(!n){var h=f?f.document:null;if(!t&&j(h))try{h=JSON.parse(h)}catch(e){t=e}if(t?t=new $("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:u,cause:t}):_(h)||(t=new $("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:u,cause:t})),t)return s(n=t);h="@context"in h?{"@context":h["@context"]}:{"@context":{}},f.contextUrl&&(k(h["@context"])||(h["@context"]=[h["@context"]]),h["@context"].push(f.contextUrl)),i(h,l,r,u,function(t,r){if(t)return s(t);a[u]=r["@context"],0==--c&&(T(e,a,!0,o),s(null,e))})}},h=r(u,f);h&&"then"in h&&h.then(f.bind(null,null),f)}(l[u])};i(e,{},t.documentLoader,t.base,r)}function N(e){var t=/^[ \t]*(?:#.*)?$/,r=/^[ \t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z0-9]+)))[ \t]+(?:<([^:]+:[^>]*)>)[ \t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z0-9]+))|(?:"([^"\\]*(?:\\.[^"\\]*)*)"(?:(?:\^\^(?:<([^:]+:[^>]*)>))|(?:@([a-z]+(?:-[a-z0-9]+)*)))?))[ \t]*(?:\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z0-9]+)))[ \t]*\.))[ \t]*(?:#.*)?$/,n={};e=e.split(/(?:\r\n)|(?:\n)|(?:\r)/g);for(var i=0,o=0;o<e.length;++o){var s=e[o];if(i++,!t.test(s)){if(null===(u=s.match(r)))throw new $("Error while parsing N-Quads; invalid quad.","jsonld.ParseError",{line:i});if((s={}).subject=I(u[1])?{type:"blank node",value:u[2]}:{type:"IRI",value:u[1]},s.predicate={type:"IRI",value:u[3]},I(u[4]))if(I(u[5])){s.object={type:"literal"},I(u[7])?I(u[8])?s.object.datatype=G:(s.object.datatype=z,s.object.language=u[8]):s.object.datatype=u[7];var a=u[6].replace(/\\"/g,'"').replace(/\\t/g,"\t").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");s.object.value=a}else s.object={type:"blank node",value:u[5]};else s.object={type:"IRI",value:u[4]};if(a="@default",I(u[9])?I(u[10])||(a=u[10]):a=u[9],a in n){for(var u=!0,l=(a=n[a],0);u&&l<a.length;++l){var c;e:{c=a[l];for(var f=["subject","predicate","object"],h=0;h<f.length;++h){var p=f[h];if(c[p].type!==s[p].type||c[p].value!==s[p].value){c=!1;break e}}c=c.object.language===s.object.language&&c.object.datatype===s.object.datatype}c&&(u=!1)}u&&a.push(s)}else n[a]=[s]}}return n}function D(e,t){var r=e.subject,n=e.predicate,i=e.object,o=t||null;"name"in e&&e.name&&(o=e.name.value);var s="";return s=(s="IRI"===r.type?s+"<"+r.value+">":s+r.value)+" ",s=(s="IRI"===n.type?s+"<"+n.value+">":s+n.value)+" ","IRI"===i.type?s+="<"+i.value+">":"blank node"===i.type?s+=i.value:(s+='"'+(r=i.value.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"'))+'"',i.datatype===z?i.language&&(s+="@"+i.language):i.datatype!==G&&(s+="^^<"+i.datatype+">")),null!==o&&void 0!==o&&(s=0!==o.indexOf("_:")?s+" <"+o+">":s+" "+o),s+" .\n"}function P(e){this.prefix=e,this.counter=0,this.existing={}}function U(e,t){var r="";0===e.indexOf("/")&&(r="/");for(var n=e.split("/"),i=[];0<n.length;)"."===n[0]||""===n[0]&&1<n.length?n.shift():".."===n[0]?(n.shift(),t||0<i.length&&".."!==i[i.length-1]?i.pop():i.push("..")):i.push(n.shift());return r+i.join("/")}if(t.compact=function(e,r,n,i){return 2>arguments.length?t.nextTick(function(){i(new TypeError("Could not compact, too few arguments."))}):("function"==typeof n&&(i=n,n={}),n=n||{},null===r?t.nextTick(function(){i(new $("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"}))}):null===e?t.nextTick(function(){i(null,null)}):("base"in n||(n.base="string"==typeof e?e:""),"compactArrays"in n||(n.compactArrays=!0),"graph"in n||(n.graph=!1),"skipExpansion"in n||(n.skipExpansion=!1),"documentLoader"in n||(n.documentLoader=t.loadDocument),"link"in n||(n.link=!1),n.link&&(n.skipExpansion=!0),void function(e,r,n){if(r.skipExpansion)return t.nextTick(function(){n(null,e)});t.expand(e,r,n)}(e,n,function(e,o){if(e)return i(new $("Could not expand input before compaction.","jsonld.CompactError",{cause:e}));var s=w(n);t.processContext(s,r,n,function(e,t){if(e)return i(new $("Could not process context before compaction.","jsonld.CompactError",{cause:e}));var s;try{s=(new J).compact(t,null,o,n)}catch(e){return i(e)}var a=n;a.compactArrays&&!a.graph&&k(s)?1===s.length?s=s[0]:0===s.length&&(s={}):a.graph&&_(s)&&(s=[s]),_(r)&&"@context"in r&&(r=r["@context"]),k(r=R(r))||(r=[r]),a=r,r=[];for(var u=0;u<a.length;++u)(!_(a[u])||0<Object.keys(a[u]).length)&&r.push(a[u]);if(a=0<r.length,1===r.length&&(r=r[0]),k(s)){var l=y(t,"@graph");u=s,s={},a&&(s["@context"]=r),s[l]=u}else if(_(s)&&a)for(l in u=s,s={"@context":r},u)s[l]=u[l];i(null,s,t)})})))},t.expand=function(e,r,n){function i(e){if("base"in r||(r.base=e.documentUrl||""),e={document:R(e.document),remoteContext:{"@context":e.contextUrl}},"expandContext"in r){var t=R(r.expandContext);e.expandContext="object"==typeof t&&"@context"in t?t:{"@context":t}}M(e,r,function(e,t){if(e)return n(e);var i;try{var o=new J,s=w(r),a=t.document,u=t.remoteContext["@context"];t.expandContext&&(s=o.processContext(s,t.expandContext["@context"],r)),u&&(s=o.processContext(s,u,r)),_(i=o.expand(s,null,a,r,!1))&&"@graph"in i&&1===Object.keys(i).length?i=i["@graph"]:null===i&&(i=[]),k(i)||(i=[i])}catch(e){return n(e)}n(null,i)})}if(1>arguments.length)return t.nextTick(function(){n(new TypeError("Could not expand, too few arguments."))});"function"==typeof r&&(n=r,r={}),"documentLoader"in(r=r||{})||(r.documentLoader=t.loadDocument),"keepFreeFloatingNodes"in r||(r.keepFreeFloatingNodes=!1),t.nextTick(function(){if("string"==typeof e){var t=function(e,t){if(e)return n(e);try{if(!t.document)throw new $("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof t.document&&(t.document=JSON.parse(t.document))}catch(e){return n(new $("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:t}))}i(t)},o=r.documentLoader(e,t);o&&"then"in o&&o.then(t.bind(null,null),t)}else i({contextUrl:null,documentUrl:null,document:e})})},t.flatten=function(e,r,n,i){if(1>arguments.length)return t.nextTick(function(){i(new TypeError("Could not flatten, too few arguments."))});"function"==typeof n?(i=n,n={}):"function"==typeof r&&(i=r,r=null,n={}),"base"in(n=n||{})||(n.base="string"==typeof e?e:""),"documentLoader"in n||(n.documentLoader=t.loadDocument),t.expand(e,n,function(e,o){if(e)return i(new $("Could not expand input before flattening.","jsonld.FlattenError",{cause:e}));var s;try{s=(new J).flatten(o)}catch(e){return i(e)}if(null===r)return i(null,s);n.graph=!0,n.skipExpansion=!0,t.compact(s,r,n,function(e,t){if(e)return i(new $("Could not compact flattened output.","jsonld.FlattenError",{cause:e}));i(null,t)})})},t.frame=function(e,r,n,i){function o(r){var o,s=r.document;s?(o=s["@context"],r.contextUrl?(o?k(o)?o.push(r.contextUrl):o=[o,r.contextUrl]:o=r.contextUrl,s["@context"]=o):o=o||{}):o={},t.expand(e,n,function(e,r){if(e)return i(new $("Could not expand input before framing.","jsonld.FrameError",{cause:e}));var a=R(n);a.isFrame=!0,a.keepFreeFloatingNodes=!0,t.expand(s,a,function(e,n){if(e)return i(new $("Could not expand frame before framing.","jsonld.FrameError",{cause:e}));var s;try{s=(new J).frame(r,n,a)}catch(e){return i(e)}a.graph=!0,a.skipExpansion=!0,a.link={},t.compact(s,o,a,function(e,r,n){if(e)return i(new $("Could not compact framed output.","jsonld.FrameError",{cause:e}));e=y(n,"@graph"),a.link={},r[e]=function e(r,n,i){if(k(n)){for(var o=[],s=0;s<n.length;++s){var a=e(r,n[s],i);null!==a&&o.push(a)}n=o}else if(_(n)){if("@preserve"in n)return"@null"===n["@preserve"]?null:n["@preserve"];if(C(n))return n;if(O(n))return n["@list"]=e(r,n["@list"],i),n;if((a=y(r,"@id"))in n)if((a=n[a])in i.link){if(-1!==(s=i.link[a].indexOf(n)))return i.link[a][s];i.link[a].push(n)}else i.link[a]=[n];for(o in n)a=e(r,n[o],i),s=t.getContextValue(r,o,"@container"),i.compactArrays&&k(a)&&1===a.length&&null===s&&(a=a[0]),n[o]=a}return n}(n,r[e],a),i(null,r)})})})}if(2>arguments.length)return t.nextTick(function(){i(new TypeError("Could not frame, too few arguments."))});"function"==typeof n&&(i=n,n={}),"base"in(n=n||{})||(n.base="string"==typeof e?e:""),"documentLoader"in n||(n.documentLoader=t.loadDocument),"embed"in n||(n.embed="@last"),n.explicit=n.explicit||!1,"requireAll"in n||(n.requireAll=!0),n.omitDefault=n.omitDefault||!1,t.nextTick(function(){if("string"==typeof r){var e=function(e,t){if(e)return i(e);try{if(!t.document)throw new $("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof t.document&&(t.document=JSON.parse(t.document))}catch(e){return i(new $("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:t}))}o(t)},t=n.documentLoader(r,e);t&&"then"in t&&t.then(e.bind(null,null),e)}else o({contextUrl:null,documentUrl:null,document:r})})},t.link=function(e,r,n,i){var o={};r&&(o["@context"]=r),o["@embed"]="@link",t.frame(e,o,n,i)},t.objectify=function(e,r,n,i){"function"==typeof n&&(i=n,n={}),"base"in(n=n||{})||(n.base="string"==typeof e?e:""),"documentLoader"in n||(n.documentLoader=t.loadDocument),t.expand(e,n,function(e,o){if(e)return i(new $("Could not expand input before linking.","jsonld.LinkError",{cause:e}));var s;try{s=(new J).flatten(o)}catch(e){return i(e)}n.graph=!0,n.skipExpansion=!0,t.compact(s,r,n,function(e,r,n){if(e)return i(new $("Could not compact flattened output before linking.","jsonld.LinkError",{cause:e}));var o=r[e=y(n,"@graph")][0],s=function(e){if(_(e)||k(e)){if(_(e)){if(s.visited[e["@id"]])return;s.visited[e["@id"]]=!0}for(var r in e){var i=e[r],a="@id"===t.getContextValue(n,r,"@type");if(k(i)||_(i)||a)if(j(i)&&a)e[r]=i=o[i],s(i);else if(k(i))for(var u=0;u<i.length;++u)j(i[u])&&a?i[u]=o[i[u]]:_(i[u])&&"@id"in i[u]&&(i[u]=o[i[u]["@id"]]),s(i[u]);else _(i)&&(e[r]=i=o[i["@id"]],s(i))}}};for(var a in s.visited={},s(o),r.of_type={},o)if("@type"in o[a]){k(e=o[a]["@type"])||(e=[e]);for(var u=0;u<e.length;++u)e[u]in r.of_type||(r.of_type[e[u]]=[]),r.of_type[e[u]].push(o[a])}i(null,r)})})},t.normalize=function(e,r,n){if(1>arguments.length)return t.nextTick(function(){n(new TypeError("Could not normalize, too few arguments."))});if("function"==typeof r&&(n=r,r={}),"algorithm"in(r=r||{})||(r.algorithm="URGNA2012"),"base"in r||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=t.loadDocument),"inputFormat"in r){if("application/nquads"!==r.inputFormat)return n(new $("Unknown normalization input format.","jsonld.NormalizeError"));var i=N(e);(new J).normalize(i,r,n)}else delete(i=R(r)).format,i.produceGeneralizedRdf=!1,t.toRDF(e,i,function(e,t){if(e)return n(new $("Could not convert input to RDF dataset before normalization.","jsonld.NormalizeError",{cause:e}));(new J).normalize(t,r,n)})},t.fromRDF=function(e,r,n){if(1>arguments.length)return t.nextTick(function(){n(new TypeError("Could not convert from RDF, too few arguments."))});"function"==typeof r&&(n=r,r={}),"useRdfType"in(r=r||{})||(r.useRdfType=!1),"useNativeTypes"in r||(r.useNativeTypes=!1),"format"in r||!j(e)||"format"in r||(r.format="application/nquads"),t.nextTick(function(){function t(e,t,r){(new J).fromRDF(e,t,r)}var i;if(r.format){if(!(i=r.rdfParser||W[r.format]))return n(new $("Unknown input format.","jsonld.UnknownFormat",{format:r.format}))}else i=function(){return e};var o=!1;try{e=i(e,function(e,i){if(o=!0,e)return n(e);t(i,r,n)})}catch(e){if(!o)return n(e);throw e}if(e){if("then"in e)return e.then(function(e){t(e,r,n)},n);t(e,r,n)}})},t.toRDF=function(e,r,n){if(1>arguments.length)return t.nextTick(function(){n(new TypeError("Could not convert to RDF, too few arguments."))});"function"==typeof r&&(n=r,r={}),"base"in(r=r||{})||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=t.loadDocument),t.expand(e,r,function(e,t){if(e)return n(new $("Could not expand input before serialization to RDF.","jsonld.RdfError",{cause:e}));var i;try{if(i=J.prototype.toRDF(t,r),r.format){if("application/nquads"===r.format){var o,s=n,a=[];for(o in i)for(var u=i[o],l=0;l<u.length;++l)"@default"===o&&(o=null),a.push(D(u[l],o));return s(null,a.sort().join(""))}throw new $("Unknown output format.","jsonld.UnknownFormat",{format:r.format})}}catch(e){return n(e)}n(null,i)})},t.createNodeMap=function(e,r,n){if(1>arguments.length)return t.nextTick(function(){n(new TypeError("Could not create node map, too few arguments."))});"function"==typeof r&&(n=r,r={}),"base"in(r=r||{})||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=t.loadDocument),t.expand(e,r,function(e,t){if(e)return n(new $("Could not expand input before creating node map.","jsonld.CreateNodeMapError",{cause:e}));var i;try{i=(new J).createNodeMap(t,r)}catch(e){return n(e)}n(null,i)})},t.merge=function(e,r,n,i){function o(e,t){if(!u){if(e)return u=e,i(new $("Could not expand input before flattening.","jsonld.FlattenError",{cause:e}));a.push(t),0==--f&&s(a)}}function s(e){var o=!0;"mergeNodes"in n&&(o=n.mergeNodes);var s,a=n.namer||n.issuer||new P("_:b"),u={"@default":{}};try{for(var f=0;f<e.length;++f){var h=t.relabelBlankNodes(h=e[f],{issuer:new P("_:b"+f+"-")}),p=o||0===f?u:{"@default":{}};if(l(h,p,"@default",a),p!==u)for(var d in p){var g=p[d];if(d in u){var v,y=u[d];for(v in g)v in y||(y[v]=g[v])}else u[d]=g}}s=c(u)}catch(e){return i(e)}for(e=[],o=Object.keys(s).sort(),a=0;a<o.length;++a)E(u=s[o[a]])||e.push(u);if(null===r)return i(null,e);n.graph=!0,n.skipExpansion=!0,t.compact(e,r,n,function(e,t){if(e)return i(new $("Could not compact merged output.","jsonld.MergeError",{cause:e}));i(null,t)})}if(1>arguments.length)return t.nextTick(function(){i(new TypeError("Could not merge, too few arguments."))});if(!k(e))return t.nextTick(function(){i(new TypeError('Could not merge, "docs" must be an array.'))});"function"==typeof n?(i=n,n={}):"function"==typeof r&&(i=r,r=null,n={}),n=n||{};for(var a=[],u=null,f=e.length,h=0;h<e.length;++h){var p,d={};for(p in n)d[p]=n[p];t.expand(e[h],d,o)}},t.relabelBlankNodes=function(e,t){return function e(t,r){if(k(r))for(var n=0;n<r.length;++n)r[n]=e(t,r[n]);else if(O(r))r["@list"]=e(t,r["@list"]);else if(_(r)){F(r)&&(r["@id"]=t.getId(r["@id"])),n=Object.keys(r).sort();for(var i=0;i<n.length;++i){var o=n[i];"@id"!==o&&(r[o]=e(t,r[o]))}}return r}((t=t||{}).namer||t.issuer||new P("_:b"),e)},t.prependBase=function(e,r){var n,i=e;if(null===i)n=r;else if(-1!==r.indexOf(":"))n=r;else{j(i)&&(i=t.url.parse(i||"")),n=t.url.parse(r);var o,s,a=i.protocol||"";null!==n.authority?(o=n.authority,s=n.path,i=n.query):(o=i.authority,""===n.path?(s=i.path,i=null!==n.query?n.query:i.query):(0===n.path.indexOf("/")?s=n.path:(s=i.path,""!==n.path&&(0<(s=s.substr(0,s.lastIndexOf("/")+1)).length&&"/"!==s.substr(-1)&&(s+="/"),s+=n.path)),i=n.query)),s=U(s,!!o),null!==o&&(a+="//"+o),a+=s,null!==i&&(a+="?"+i),null!==n.fragment&&(a+="#"+n.fragment),""===a&&(a="./"),n=a}return n},t.documentLoader=function(e,r){var n=new $("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed"});return o?r(n,{contextUrl:null,documentUrl:e,document:null}):t.promisify(function(e){e(n)})},t.loadDocument=function(e,r){var n=t.documentLoader(e,r);n&&"then"in n&&n.then(r.bind(null,null),r)},t.promises=function(r){r=r||{};var i=Array.prototype.slice,o=t.promisify,s=r.api||{},a=r.version||"jsonld.js";"string"==typeof r.api&&(r.version||(a=r.api),s={}),s.expand=function(e){if(1>arguments.length)throw new TypeError("Could not expand, too few arguments.");return o.apply(null,[t.expand].concat(i.call(arguments)))},s.compact=function(e,r){if(2>arguments.length)throw new TypeError("Could not compact, too few arguments.");return o.apply(null,[function(e,r,n,i){t.compact(e,r,n,function(e,t){i(e,t)})}].concat(i.call(arguments)))},s.flatten=function(e){if(1>arguments.length)throw new TypeError("Could not flatten, too few arguments.");return o.apply(null,[t.flatten].concat(i.call(arguments)))},s.frame=function(e,r){if(2>arguments.length)throw new TypeError("Could not frame, too few arguments.");return o.apply(null,[t.frame].concat(i.call(arguments)))},s.fromRDF=function(e){if(1>arguments.length)throw new TypeError("Could not convert from RDF, too few arguments.");return o.apply(null,[t.fromRDF].concat(i.call(arguments)))},s.toRDF=function(e){if(1>arguments.length)throw new TypeError("Could not convert to RDF, too few arguments.");return o.apply(null,[t.toRDF].concat(i.call(arguments)))},s.normalize=function(e){if(1>arguments.length)throw new TypeError("Could not normalize, too few arguments.");return o.apply(null,[t.normalize].concat(i.call(arguments)))},"jsonld.js"===a&&(s.link=function(e,r){if(2>arguments.length)throw new TypeError("Could not link, too few arguments.");return o.apply(null,[t.link].concat(i.call(arguments)))},s.objectify=function(e){return o.apply(null,[t.objectify].concat(i.call(arguments)))},s.createNodeMap=function(e){return o.apply(null,[t.createNodeMap].concat(i.call(arguments)))},s.merge=function(e){return o.apply(null,[t.merge].concat(i.call(arguments)))});try{t.Promise=n.Promise||e("es6-promise").Promise}catch(e){for(var u in r=function(){throw Error("Unable to find a Promise implementation.")},s)s[u]=r}return s},t.promisify=function(r){if(!t.Promise)try{t.Promise=n.Promise||e("es6-promise").Promise}catch(e){throw Error("Unable to find a Promise implementation.")}var i=Array.prototype.slice.call(arguments,1);return new t.Promise(function(e,t){r.apply(null,i.concat(function(r,n){r?t(r):e(n)}))})},t.promises({api:t.promises}),(a.prototype=t.promises({version:"json-ld-1.0"})).toString=function(){return this instanceof a?"[object JsonLdProcessor]":"[object JsonLdProcessorPrototype]"},t.JsonLdProcessor=a,B=!!Object.defineProperty)try{Object.defineProperty({},"x",{})}catch(e){B=!1}B&&(Object.defineProperty(a,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(a.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:a})),s&&"undefined"==typeof n.JsonLdProcessor&&(B?Object.defineProperty(n,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:a}):n.JsonLdProcessor=a);var Q="function"==typeof setImmediate&&setImmediate,B=Q?function(e){Q(e)}:function(e){setTimeout(e,0)};t.nextTick="object"==typeof r&&"function"==typeof r.nextTick?r.nextTick:B,t.setImmediate=Q?B:t.nextTick,t.parseLinkHeader=function(e){var t={};e=e.match(/(?:<[^>]*?>|"[^"]*?"|[^,])+/g);for(var r=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,n=0;n<e.length;++n){var i=e[n].match(r);if(i){for(var o={target:i[1]},s=i[2],a=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g;i=a.exec(s);)o[i[1]]=void 0===i[2]?i[3]:i[2];k(t[i=o.rel||""])?t[i].push(o):t[i]=i in t?[t[i],o]:o}}return t},t.RequestQueue=function(){this._requests={}},t.RequestQueue.prototype.wrapLoader=function(e){return this._loader=e,this._usePromise=1===e.length,this.add.bind(this)},t.RequestQueue.prototype.add=function(e,r){var n=this;if(!r&&!n._usePromise)throw Error("callback must be specified.");if(n._usePromise)return new t.Promise(function(t,r){var i=n._requests[e];i||(i=n._requests[e]=n._loader(e).then(function(t){return delete n._requests[e],t}).catch(function(t){throw delete n._requests[e],t})),i.then(function(e){t(e)}).catch(function(e){r(e)})});e in n._requests?n._requests[e].push(r):(n._requests[e]=[r],n._loader(e,function(t,r){var i=n._requests[e];delete n._requests[e];for(var o=0;o<i.length;++o)i[o](t,r)}))},t.DocumentCache=function(e){this.order=[],this.cache={},this.size=e||50,this.expires=3e4},t.DocumentCache.prototype.get=function(e){if(e in this.cache){var t=this.cache[e];if(t.expires>=+new Date)return t.ctx;delete this.cache[e],this.order.splice(this.order.indexOf(e),1)}return null},t.DocumentCache.prototype.set=function(e,t){this.order.length===this.size&&delete this.cache[this.order.shift()],this.order.push(e),this.cache[e]={ctx:t,expires:+new Date+this.expires}},t.ActiveContextCache=function(e){this.order=[],this.cache={},this.size=e||100},t.ActiveContextCache.prototype.get=function(e,t){var r=JSON.stringify(e),n=JSON.stringify(t);return(r=this.cache[r])&&n in r?r[n]:null},t.ActiveContextCache.prototype.set=function(e,t,r){if(this.order.length===this.size){var n=this.order.shift();delete this.cache[n.activeCtx][n.localCtx]}e=JSON.stringify(e),t=JSON.stringify(t),this.order.push({activeCtx:e,localCtx:t}),e in this.cache||(this.cache[e]={}),this.cache[e][t]=R(r)},t.cache={activeCtx:new t.ActiveContextCache},t.documentLoaders={},t.documentLoaders.jquery=function(e,r){function n(n,i){return 0!==n.indexOf("http:")&&0!==n.indexOf("https:")?i(new $('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:n}),{contextUrl:null,documentUrl:n,document:null}):r.secure&&0!==n.indexOf("https")?i(new $('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:n}),{contextUrl:null,documentUrl:n,document:null}):void e.ajax({url:n,accepts:{json:"application/ld+json, application/json"},headers:{Accept:"application/ld+json, application/json"},dataType:"json",crossDomain:!0,success:function(e,r,o){if(e={contextUrl:null,documentUrl:n,document:e},r=o.getResponseHeader("Content-Type"),(o=o.getResponseHeader("Link"))&&"application/ld+json"!==r){if(k(o=t.parseLinkHeader(o)[H]))return i(new $("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:n}),e);o&&(e.contextUrl=o.target)}i(null,e)},error:function(e,t,r){i(new $("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:n,cause:r}),{contextUrl:null,documentUrl:n,document:null})}})}r=r||{};var i=new t.RequestQueue;return("usePromise"in r?r.usePromise:"undefined"!=typeof Promise)?i.wrapLoader(function(e){return t.promisify(n,e)}):i.wrapLoader(n)},t.documentLoaders.node=function(r){function n(e,u,l){if(0!==e.indexOf("http:")&&0!==e.indexOf("https:"))return l(new $('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:e}),{contextUrl:null,documentUrl:e,document:null});if(r.secure&&0!==e.indexOf("https"))return l(new $('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:e}),{contextUrl:null,documentUrl:e,document:null});var c=null;if(null!==c)return l(null,c);var f,h={Accept:"application/ld+json, application/json"};for(f in r.headers)h[f]=r.headers[f];s({url:e,headers:h,strictSSL:i,followRedirect:!1},function(r,i,s){if(c={contextUrl:null,documentUrl:e,document:s||null},r)return l(new $("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:e,cause:r}),c);if(s=a.STATUS_CODES[i.statusCode],400<=i.statusCode)return l(new $("URL could not be dereferenced: "+s,"jsonld.InvalidUrl",{code:"loading document failed",url:e,httpStatusCode:i.statusCode}),c);if(i.headers.link&&"application/ld+json"!==i.headers["content-type"]){if(k(s=t.parseLinkHeader(i.headers.link)[H]))return l(new $("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:e}),c);s&&(c.contextUrl=s.target)}if(300<=i.statusCode&&400>i.statusCode&&i.headers.location)return u.length===o?l(new $("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:e,httpStatusCode:i.statusCode,redirects:u}),c):-1!==u.indexOf(e)?l(new $("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:e,httpStatusCode:i.statusCode,redirects:u}),c):(u.push(e),n(i.headers.location,u,l));u.push(e),l(r,c)})}var i=!("strictSSL"in(r=r||{}))||r.strictSSL,o="maxRedirects"in r?r.maxRedirects:-1,s="request"in r?r.request:e("request"),a=e("http"),u=new t.RequestQueue;if(r.usePromise)return u.wrapLoader(function(e){return t.promisify(n,e,[])});var l=r.headers||{};if("Accept"in l||"accept"in l)throw new RangeError('Accept header may not be specified as an option; only "application/ld+json, application/json" is supported.');return u.wrapLoader(function(e,t){n(e,[],t)})},t.documentLoaders.xhr=function(e){function r(r,i){if(0!==r.indexOf("http:")&&0!==r.indexOf("https:"))return i(new $('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null});if(e.secure&&0!==r.indexOf("https"))return i(new $('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null});var o=new(e.xhr||XMLHttpRequest);o.onload=function(){if(400<=o.status)return i(new $("URL could not be dereferenced: "+o.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:r,httpStatusCode:o.status}),{contextUrl:null,documentUrl:r,document:null});var e,s={contextUrl:null,documentUrl:r,document:o.response},a=o.getResponseHeader("Content-Type");if(n.test(o.getAllResponseHeaders())&&(e=o.getResponseHeader("Link")),e&&"application/ld+json"!==a){if(k(e=t.parseLinkHeader(e)[H]))return i(new $("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:r}),s);e&&(s.contextUrl=e.target)}i(null,s)},o.onerror=function(){i(new $("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null})},o.open("GET",r,!0),o.setRequestHeader("Accept","application/ld+json, application/json"),o.send()}e=e||{};var n=/(^|(\r\n))link:/i,i=new t.RequestQueue;return("usePromise"in e?e.usePromise:"undefined"!=typeof Promise)?i.wrapLoader(function(e){return t.promisify(r,e)}):i.wrapLoader(r)},t.useDocumentLoader=function(e){if(!(e in t.documentLoaders))throw new $('Unknown document loader type: "'+e+'"',"jsonld.UnknownDocumentLoader",{type:e});t.documentLoader=t.documentLoaders[e].apply(t,Array.prototype.slice.call(arguments,1))},t.processContext=function(e,r){var n={},i=2;3<arguments.length&&(n=arguments[2]||{},i+=1);var o=arguments[i];if("base"in n||(n.base=""),"documentLoader"in n||(n.documentLoader=t.loadDocument),null===r)return o(null,w(n));_(r=R(r))&&"@context"in r||(r={"@context":r}),M(r,n,function(t,r){if(t)return o(t);try{r=(new J).processContext(e,r,n)}catch(e){return o(e)}o(null,r)})},t.hasProperty=function(e,t){var r=!1;return t in e&&(r=!k(r=e[t])||0<r.length),r},t.hasValue=function(e,r,n){var i=!1;if(t.hasProperty(e,r))if(r=O(e=e[r]),k(e)||r){for(r&&(e=e["@list"]),r=0;r<e.length;++r)if(t.compareValues(n,e[r])){i=!0;break}}else k(n)||(i=t.compareValues(n,e));return i},t.addValue=function(e,r,n,i){if("propertyIsArray"in(i=i||{})||(i.propertyIsArray=!1),"allowDuplicate"in i||(i.allowDuplicate=!0),k(n)){0!==n.length||!i.propertyIsArray||r in e||(e[r]=[]);for(var o=0;o<n.length;++o)t.addValue(e,r,n[o],i)}else r in e?(o=!i.allowDuplicate&&t.hasValue(e,r,n),k(e[r])||o&&!i.propertyIsArray||(e[r]=[e[r]]),o||e[r].push(n)):e[r]=i.propertyIsArray?[n]:n},t.getValues=function(e,t){var r=e[t]||[];return k(r)||(r=[r]),r},t.removeProperty=function(e,t){delete e[t]},t.removeValue=function(e,r,n,i){"propertyIsArray"in(i=i||{})||(i.propertyIsArray=!1);var o=t.getValues(e,r).filter(function(e){return!t.compareValues(e,n)});0===o.length?t.removeProperty(e,r):e[r]=1!==o.length||i.propertyIsArray?o:o[0]},t.compareValues=function(e,t){return!!(e===t||C(e)&&C(t)&&e["@value"]===t["@value"]&&e["@type"]===t["@type"]&&e["@language"]===t["@language"]&&e["@index"]===t["@index"])||!!(_(e)&&"@id"in e&&_(t)&&"@id"in t)&&e["@id"]===t["@id"]},t.getContextValue=function(e,t,r){var n=null;return null===t?n:("@language"===r&&r in e&&(n=e[r]),e.mappings[t]&&(e=e.mappings[t],I(r)?n=e:r in e&&(n=e[r])),n)};var W={};if(t.registerRDFParser=function(e,t){W[e]=t},t.unregisterRDFParser=function(e){delete W[e]},o){if("undefined"==typeof q)var q=null;if("undefined"==typeof X)var X={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var G="http://www.w3.org/2001/XMLSchema#string",z="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",H="http://www.w3.org/ns/json-ld#context",V=10,$=function(e,t,r){o?(Error.call(this),Error.captureStackTrace(this,this.constructor)):"undefined"!=typeof Error&&(this.stack=Error().stack),this.name=t||"jsonld.Error",this.message=e||"An unspecified JSON-LD error occurred.",this.details=r||{}};o?e("util").inherits($,Error):"undefined"!=typeof Error&&($.prototype=Error());var J=function(){};J.prototype.compact=function(e,r,n,i){if(k(n)){for(var o=[],s=0;s<n.length;++s){var a=this.compact(e,r,n[s],i);null!==a&&o.push(a)}return i.compactArrays&&1===o.length&&null===(v=t.getContextValue(e,r,"@container"))&&(o=o[0]),o}if(_(n)){if(i.link&&"@id"in n&&n["@id"]in i.link)for(o=i.link[n["@id"]],s=0;s<o.length;++s)if(o[s].expanded===n)return o[s].compacted;if(C(n)||E(n))return o=function(e,r,n){if(C(n)){var i=t.getContextValue(e,r,"@type"),o=t.getContextValue(e,r,"@language"),s=t.getContextValue(e,r,"@container");if(!(s="@index"in n&&"@index"!==s)&&(n["@type"]===i||n["@language"]===o))return n["@value"];i=1===(i=Object.keys(n).length)||2===i&&"@index"in n&&!s,o="@language"in e;var a=j(n["@value"]);return r=e.mappings[r]&&null===e.mappings[r]["@language"],!i||o&&a&&!r?(r={},s&&(r[y(e,"@index")]=n["@index"]),"@type"in n?r[y(e,"@type")]=y(e,n["@type"],null,{vocab:!0}):"@language"in n&&(r[y(e,"@language")]=n["@language"]),r[y(e,"@value")]=n["@value"],r):n["@value"]}return s=b(e,r,{vocab:!0}),i=t.getContextValue(e,r,"@type"),n=y(e,n["@id"],null,{vocab:"@vocab"===i}),"@id"===i||"@vocab"===i||"@graph"===s?n:((r={})[y(e,"@id")]=n,r)}(e,r,n),i.link&&E(n)&&(n["@id"]in i.link||(i.link[n["@id"]]=[]),i.link[n["@id"]].push({expanded:n,compacted:o})),o;s="@reverse"===r,o={},i.link&&"@id"in n&&(n["@id"]in i.link||(i.link[n["@id"]]=[]),i.link[n["@id"]].push({expanded:n,compacted:o}));for(var u=Object.keys(n).sort(),l=0;l<u.length;++l){var c=u[l],f=n[c];if("@id"===c||"@type"===c){var h;if(j(f))h=y(e,f,null,{vocab:"@type"===c});else{h=[];for(var p=0;p<f.length;++p)h.push(y(e,f[p],null,{vocab:!0}))}c=y(e,c),v=k(h)&&0===f.length,t.addValue(o,c,h,{propertyIsArray:v})}else if("@reverse"===c){for(a in h=this.compact(e,"@reverse",f,i))e.mappings[a]&&e.mappings[a].reverse&&(f=h[a],v=t.getContextValue(e,a,"@container"),t.addValue(o,a,f,{propertyIsArray:"@set"===v||!i.compactArrays}),delete h[a]);0<Object.keys(h).length&&(c=y(e,c),t.addValue(o,c,h))}else if("@index"===c)"@index"!==(v=t.getContextValue(e,r,"@container"))&&(c=y(e,c),t.addValue(o,c,f));else if("@graph"!==c&&"@list"!==c&&x(c))c=y(e,c),t.addValue(o,c,f);else for(0===f.length&&(h=y(e,c,f,{vocab:!0},s),t.addValue(o,h,f,{propertyIsArray:!0})),p=0;p<f.length;++p){var d=f[p];h=y(e,c,d,{vocab:!0},s);var g,v=t.getContextValue(e,h,"@container"),m=O(d),w=null;if(m&&(w=d["@list"]),w=this.compact(e,h,m?w:d,i),m)if(k(w)||(w=[w]),"@list"!==v)(m={})[y(e,"@list")]=w,w=m,"@index"in d&&(w[y(e,"@index")]=d["@index"]);else if(h in o)throw new $('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError",{code:"compaction to list of lists"});"@language"===v||"@index"===v?(h in o?g=o[h]:o[h]=g={},"@language"===v&&C(w)&&(w=w["@value"]),t.addValue(g,d[v],w)):(v=!i.compactArrays||"@set"===v||"@list"===v||k(w)&&0===w.length||"@list"===c||"@graph"===c,t.addValue(o,h,w,{propertyIsArray:v}))}}return o}return n},J.prototype.expand=function(e,r,n,i,o){if(null===n||void 0===n)return null;if(!k(n)&&!_(n))return o||null!==r&&"@graph"!==b(e,r,{vocab:!0})?function(e,r,n){if(null===n||void 0===n)return null;var i=b(e,r,{vocab:!0});if("@id"===i)return b(e,n,{base:!0});if("@type"===i)return b(e,n,{vocab:!0,base:!0});var o=t.getContextValue(e,r,"@type");return"@id"===o||"@graph"===i&&j(n)?{"@id":b(e,n,{base:!0})}:"@vocab"===o?{"@id":b(e,n,{vocab:!0,base:!0})}:x(i)?n:(i={},null!==o?i["@type"]=o:j(n)&&null!==(e=t.getContextValue(e,r,"@language"))&&(i["@language"]=e),-1===["boolean","number","string"].indexOf(typeof n)&&(n=n.toString()),i["@value"]=n,i)}(e,r,n):null;if(k(n)){var s=[],a=t.getContextValue(e,r,"@container");o=o||"@list"===a;for(var u=0;u<n.length;++u){var l=this.expand(e,r,n[u],i);if(o&&(k(l)||O(l)))throw new $("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});null!==l&&(k(l)?s=s.concat(l):s.push(l))}return s}"@context"in n&&(e=this.processContext(e,n["@context"],i)),u=b(e,r,{vocab:!0}),s={},l=Object.keys(n).sort();for(var c=0;c<l.length;++c){var f=l[c],h=n[f];if("@context"!==f){var p=b(e,f,{vocab:!0});if(null!==p&&(S(p)||x(p))){if(x(p)){if("@reverse"===u)throw new $("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:h});if(p in s)throw new $("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:p})}if("@id"===p&&!j(h)){if(!i.isFrame)throw new $('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:h});if(!_(h))throw new $('Invalid JSON-LD syntax; "@id" value must be a string or an object.',"jsonld.SyntaxError",{code:"invalid @id value",value:h})}if("@type"===p){var d=void 0;if((d=j(a=h))||(d=_(a)&&0===Object.keys(a).length),!d){if(d=!1,k(a)){d=!0;for(var g=0;g<a.length;++g)if(!j(a[g])){d=!1;break}}if(!d)throw new $('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:a})}}if("@graph"===p&&!_(h)&&!k(h))throw new $('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:h});if("@value"===p&&(_(h)||k(h)))throw new $('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:h});if("@language"===p){if(null===h)continue;if(!j(h))throw new $('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:h});h=h.toLowerCase()}if("@index"===p&&!j(h))throw new $('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:h});if("@reverse"===p){if(!_(h))throw new $('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:h});if("@reverse"in(h=this.expand(e,"@reverse",h,i)))for(var v in h["@reverse"])t.addValue(s,v,h["@reverse"][v],{propertyIsArray:!0});for(v in f=s["@reverse"]||null,h)if("@reverse"!==v)for(null===f&&(f=s["@reverse"]={}),t.addValue(f,v,[],{propertyIsArray:!0}),p=h[v],a=0;a<p.length;++a){if(C(d=p[a])||O(d))throw new $('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:h});t.addValue(f,v,d,{propertyIsArray:!0})}}else{if("@language"===(a=t.getContextValue(e,f,"@container"))&&_(h)){d=[],g=Object.keys(h).sort();for(var y=0;y<g.length;++y){var m=g[y],w=h[m];k(w)||(w=[w]);for(var L=0;L<w.length;++L){var A=w[L];if(null!==A){if(!j(A))throw new $("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:h});d.push({"@value":A,"@language":m.toLowerCase()})}}}h=d}else if("@index"===a&&_(h)){for(d=f,g=[],y=Object.keys(h).sort(),m=0;m<y.length;++m)for(k(L=h[w=y[m]])||(L=[L]),L=this.expand(e,d,L,i,!1),A=0;A<L.length;++A){var I=L[A];"@index"in I||(I["@index"]=w),g.push(I)}h=g}else if((d="@list"===p)||"@set"===p){if(g=r,d&&"@graph"===u&&(g=null),h=this.expand(e,g,h,i,d),d&&O(h))throw new $("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"})}else h=this.expand(e,f,h,i,!1);if(null!==h||"@value"===p)if("@list"===p||O(h)||"@list"!==a||(h={"@list":h=k(h)?h:[h]}),e.mappings[f]&&e.mappings[f].reverse)for(f=s["@reverse"]=s["@reverse"]||{},k(h)||(h=[h]),a=0;a<h.length;++a){if(C(d=h[a])||O(d))throw new $('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:h});t.addValue(f,p,d,{propertyIsArray:!0})}else f=-1===["@index","@id","@type","@value","@language"].indexOf(p),t.addValue(s,p,h,{propertyIsArray:f})}}}}if(e=(l=Object.keys(s)).length,"@value"in s){if("@type"in s&&"@language"in s)throw new $('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:s});if(n=e-1,"@type"in s&&--n,"@index"in s&&--n,"@language"in s&&--n,0!==n)throw new $('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:s});if(null===s["@value"])s=null;else{if("@language"in s&&!j(s["@value"]))throw new $("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:s});if("@type"in s&&(!S(s["@type"])||0===s["@type"].indexOf("_:")))throw new $('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:s})}}else if("@type"in s&&!k(s["@type"]))s["@type"]=[s["@type"]];else if("@set"in s||"@list"in s){if(1<e&&!(2===e&&"@index"in s))throw new $('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:s});"@set"in s&&(s=s["@set"],e=(l=Object.keys(s)).length)}else 1===e&&"@language"in s&&(s=null);return!_(s)||i.keepFreeFloatingNodes||o||null!==r&&"@graph"!==u||!(0===e||"@value"in s||"@list"in s||1===e&&"@id"in s)||(s=null),s},J.prototype.createNodeMap=function(e,t){var r={"@default":{}};return l(e,r,"@default",(t=t||{}).namer||t.issuer||new P("_:b")),c(r)},J.prototype.flatten=function(e){e=this.createNodeMap(e);for(var t=[],r=Object.keys(e).sort(),n=0;n<r.length;++n){var i=e[r[n]];E(i)||t.push(i)}return t},J.prototype.frame=function(e,t,r){r={options:r,graphs:{"@default":{},"@merged":{}},subjectStack:[],link:{}};var n=new P("_:b");return l(e,r.graphs,"@merged",n),r.subjects=r.graphs["@merged"],e=[],function e(t,r,n,i,o){if(!k(s=n)||1!==s.length||!_(s[0]))throw new $("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:s});for(var s,a={embed:h(n=n[0],s=t.options,"embed"),explicit:h(n,s,"explicit"),requireAll:h(n,s,"requireAll")},u=n,l={},c=0;c<r.length;++c){var v=r[c],y=t.subjects[v];p(y,u,a)&&(l[v]=y)}for(r=Object.keys(l).sort(),u=0;u<r.length;++u)if(v=l[y=r[u]],"@link"===a.embed&&y in t.link)g(i,o,t.link[y]);else{var m;if(null===o&&(t.uniqueEmbeds={}),(c={})["@id"]=y,t.link[y]=c,!(m="@never"===a.embed))e:{for(var b=(m=t.subjectStack).length-1;0<=b;--b)if(m[b]["@id"]===v["@id"]){m=!0;break e}m=!1}if(m)g(i,o,c);else{"@last"===a.embed&&(y in t.uniqueEmbeds&&d(t,y),t.uniqueEmbeds[y]={parent:i,property:o}),t.subjectStack.push(v),y=Object.keys(v).sort();for(m=0;m<y.length;m++)if(x(b=y[m]))c[b]=R(v[b]);else if(!a.explicit||b in n)for(var w=v[b],j=0;j<w.length;++j){var L=w[j];if(O(L)){var A={"@list":[]};g(c,b,A);var I,C=L["@list"];for(I in C)if(E(L=C[I])){var F=b in n?n[b][0]["@list"]:f(a);e(t,[L["@id"]],F,A,"@list")}else g(A,"@list",R(L))}else E(L)?(F=b in n?n[b]:f(a),e(t,[L["@id"]],F,c,b)):g(c,b,R(L))}for(y=Object.keys(n).sort(),m=0;m<y.length;++m)x(b=y[m])||h(v=n[b][0],s,"omitDefault")||b in c||(w="@null","@default"in v&&(w=R(v["@default"])),k(w)||(w=[w]),c[b]=[{"@preserve":w}]);g(i,o,c),t.subjectStack.pop()}}}(r,Object.keys(r.subjects).sort(),t,e,null),e},J.prototype.normalize=function(e,t,r){return"URDNA2015"===t.algorithm?new Y(t).main(e,r):"URGNA2012"===t.algorithm?new K(t).main(e,r):void r(Error("Invalid RDF Dataset Normalization algorithm: "+t.algorithm))},J.prototype.fromRDF=function(e,r,n){var i,o={},s={"@default":o},a={};for(i in e){var u=e[i];i in s||(s[i]={}),"@default"===i||i in o||(o[i]={"@id":i});for(var l=s[i],c=0;c<u.length;++c){var f=(p=u[c]).subject.value,h=p.predicate.value,p=p.object;f in l||(l[f]={"@id":f}),f=l[f];var d="IRI"===p.type||"blank node"===p.type;if(!d||p.value in l||(l[p.value]={"@id":p.value}),"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===h&&!r.useRdfType&&d)t.addValue(f,"@type",p.value,{propertyIsArray:!0});else{var g,v=p,y=r.useNativeTypes;"IRI"===v.type||"blank node"===v.type?g={"@id":v.value}:(g={"@value":v.value},v.language?g["@language"]=v.language:((v=v.datatype)||(v=G),y?("http://www.w3.org/2001/XMLSchema#boolean"===v?"true"===g["@value"]?g["@value"]=!0:"false"===g["@value"]&&(g["@value"]=!1):(y=g["@value"],!isNaN(parseFloat(y))&&isFinite(y)&&("http://www.w3.org/2001/XMLSchema#integer"===v?(y=parseInt(g["@value"],10)).toFixed(0)===g["@value"]&&(g["@value"]=y):"http://www.w3.org/2001/XMLSchema#double"===v&&(g["@value"]=parseFloat(g["@value"])))),-1===["http://www.w3.org/2001/XMLSchema#boolean","http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#double",G].indexOf(v)&&(g["@type"]=v)):v!==G&&(g["@type"]=v))),t.addValue(f,h,g,{propertyIsArray:!0}),d&&("http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"===p.value?("usages"in(p=l[p.value])||(p.usages=[]),p.usages.push({node:f,property:h,value:g})):a[p.value]=!(p.value in a)&&{node:f,property:h,value:g})}}}for(i in s)if("http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"in(r=s[i])){for(u=r["http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"],e=0;e<u.usages.length;++e){for(f=(p=u.usages[e]).node,c=p.property,p=p.value,h=[],l=[],d=Object.keys(f).length;"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"===c&&_(a[f["@id"]])&&k(f["http://www.w3.org/1999/02/22-rdf-syntax-ns#first"])&&1===f["http://www.w3.org/1999/02/22-rdf-syntax-ns#first"].length&&k(f["http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"])&&1===f["http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"].length&&(3===d||4===d&&k(f["@type"])&&1===f["@type"].length&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#List"===f["@type"][0])&&(h.push(f["http://www.w3.org/1999/02/22-rdf-syntax-ns#first"][0]),l.push(f["@id"]),f=(p=a[f["@id"]]).node,c=p.property,p=p.value,d=Object.keys(f).length,0===f["@id"].indexOf("_:")););if("http://www.w3.org/1999/02/22-rdf-syntax-ns#first"===c){if("http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"===f["@id"])continue;p=r[p["@id"]]["http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"][0],h.pop(),l.pop()}for(delete p["@id"],p["@list"]=h.reverse(),f=0;f<l.length;++f)delete r[l[f]]}delete u.usages}for(a=[],i=Object.keys(o).sort(),e=0;e<i.length;++e){if(f=o[r=i[e]],r in s)for(u=f["@graph"]=[],r=s[r],l=Object.keys(r).sort(),c=0;c<l.length;++c)E(h=r[l[c]])||u.push(h);E(f)||a.push(f)}n(null,a)},J.prototype.toRDF=function(e,t){var r=new P("_:b"),n={"@default":{}};l(e,n,"@default",r);for(var i={},o=Object.keys(n).sort(),s=0;s<o.length;++s)if("@default"===(c=o[s])||S(c)){for(var a=c,c=n[c],f=r,h=t,p=[],d=Object.keys(c).sort(),g=0;g<d.length;++g)for(var v=d[g],y=c[v],m=Object.keys(y).sort(),b=0;b<m.length;++b){var w=m[b],_=y[w];if("@type"===w)w="http://www.w3.org/1999/02/22-rdf-syntax-ns#type";else if(x(w))continue;for(var k=0;k<_.length;++k){var j=_[k],L={};if(L.type=0===v.indexOf("_:")?"blank node":"IRI",L.value=v,S(v)){var A={};if(A.type=0===w.indexOf("_:")?"blank node":"IRI",A.value=w,S(w)&&("blank node"!==A.type||h.produceGeneralizedRdf))if(O(j)){j=j["@list"];for(var I=f,E=p,C={type:"IRI",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},F={type:"IRI",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},R=0;R<j.length;++R){var T=j[R],M={type:"blank node",value:I.getId()};E.push({subject:L,predicate:A,object:M}),L=M,A=C,(T=u(T))&&E.push({subject:L,predicate:A,object:T}),A=F}E.push({subject:L,predicate:A,object:{type:"IRI",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}})}else(j=u(j))&&p.push({subject:L,predicate:A,object:j})}}}i[a]=p}return i},J.prototype.processContext=function(e,r,n){if(_(r)&&"@context"in r&&k(r["@context"])&&(r=r["@context"]),0===(r=k(r)?r:[r]).length)return e.clone();for(var i=e,o=0;o<r.length;++o){var s=r[o];if(null===s)i=e=w(n);else{if(_(s)&&"@context"in s&&(s=s["@context"]),!_(s))throw new $("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:s});if(t.cache.activeCtx&&(e=t.cache.activeCtx.get(e,s))){i=e;continue}e=i,i=i.clone();var a={};if("@base"in s){var u=s["@base"];if(null===u)u=null;else{if(!j(u))throw new $('Invalid JSON-LD syntax; the value of "@base" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:s});if(""!==u&&!S(u))throw new $('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI or the empty string.',"jsonld.SyntaxError",{code:"invalid base IRI",context:s})}null!==u&&(u=t.url.parse(u||"")),i["@base"]=u,a["@base"]=!0}if("@vocab"in s){if(null===(u=s["@vocab"]))delete i["@vocab"];else{if(!j(u))throw new $('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:s});if(!S(u))throw new $('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:s});i["@vocab"]=u}a["@vocab"]=!0}if("@language"in s){if(null===(u=s["@language"]))delete i["@language"];else{if(!j(u))throw new $('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:s});i["@language"]=u.toLowerCase()}a["@language"]=!0}for(var l in s)m(i,s,l,a);t.cache.activeCtx&&t.cache.activeCtx.set(e,s,i)}}return i};var Y=function(){var e={subject:"s",object:"o",name:"g"},r=function(e){e=e||{},this.name="URDNA2015",this.options=e,this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new P("_:c14n"),this.quads=[],this.schedule={},this.schedule.MAX_DEPTH="maxCallStackDepth"in e?e.maxCallStackDepth:500,this.schedule.MAX_TOTAL_DEPTH="maxTotalCallStackDepth"in e?e.maxCallStackDepth:4294967295,this.schedule.depth=0,this.schedule.totalDepth=0,this.schedule.timeSlice="timeSlice"in e?e.timeSlice:10};return r.prototype.doWork=function(e,r){var n=this.schedule;if(n.totalDepth>=n.MAX_TOTAL_DEPTH)return r(Error("Maximum total call stack depth exceeded; normalization aborting."));!function i(){if(n.depth===n.MAX_DEPTH)return n.depth=0,n.running=!1,t.nextTick(i);var o=(new Date).getTime();if(n.running||(n.start=(new Date).getTime(),n.deadline=n.start+n.timeSlice),o<n.deadline)return n.running=!0,n.depth++,n.totalDepth++,e(function(e,t){n.depth--,n.totalDepth--,r(e,t)});n.depth=0,n.running=!1,t.setImmediate(i)}()},r.prototype.forEach=function(e,t,r){var n,i,o=this,s=0;if(k(e))i=e.length,n=function(){return s!==i&&(n.value=e[s++],n.key=s,!0)};else{var a=Object.keys(e);i=a.length,n=function(){return s!==i&&(n.key=a[s++],n.value=e[n.key],!0)}}!function e(i,s){return i?r(i):n()?o.doWork(function(){t(n.value,n.key,e)}):void r()}()},r.prototype.waterfall=function(e,t){var r=this;r.forEach(e,function(e,t,n){r.doWork(e,n)},t)},r.prototype.whilst=function(e,t,r){var n=this;!function i(o){return o?r(o):e()?void n.doWork(t,i):r()}()},r.prototype.main=function(e,t){var r,n=this;if(n.schedule.start=(new Date).getTime(),n.options.format&&"application/nquads"!==n.options.format)return t(new $("Unknown output format.","jsonld.UnknownFormat",{format:n.options.format}));var i={};n.waterfall([function(t){n.forEach(e,function(e,t,r){"@default"===t&&(t=null),n.forEach(e,function(e,r,o){null!==t&&(e.name=0===t.indexOf("_:")?{type:"blank node",value:t}:{type:"IRI",value:t}),n.quads.push(e),n.forEachComponent(e,function(t){"blank node"===t.type&&((t=t.value)in n.blankNodeInfo?n.blankNodeInfo[t].quads.push(e):(i[t]=!0,n.blankNodeInfo[t]={quads:[e]}))}),o()},r)},t)},function(e){var t=!0;n.whilst(function(){return t},function(e){t=!1,n.hashToBlankNodes={},n.waterfall([function(e){n.forEach(i,function(e,t,r){n.hashFirstDegreeQuads(t,function(e,i){if(e)return r(e);i in n.hashToBlankNodes?n.hashToBlankNodes[i].push(t):n.hashToBlankNodes[i]=[t],r()})},e)},function(e){var r=Object.keys(n.hashToBlankNodes).sort();n.forEach(r,function(e,r,o){if(1<(r=n.hashToBlankNodes[e]).length)return o();n.canonicalIssuer.getId(r=r[0]),delete i[r],delete n.hashToBlankNodes[e],t=!0,o()},e)}],e)},e)},function(e){var t=Object.keys(n.hashToBlankNodes).sort();n.forEach(t,function(e,t,r){var i=[],o=n.hashToBlankNodes[e];n.waterfall([function(e){n.forEach(o,function(e,t,r){if(n.canonicalIssuer.hasId(e))return r();(t=new P("_:b")).getId(e),n.hashNDegreeQuads(e,t,function(e,t){if(e)return r(e);i.push(t),r()})},e)},function(e){i.sort(function(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}),n.forEach(i,function(e,t,r){for(var i in e.issuer.existing)n.canonicalIssuer.getId(i);r()},e)}],r)},e)},function(e){var t=[];n.waterfall([function(e){n.forEach(n.quads,function(e,r,i){n.forEachComponent(e,function(e){"blank node"===e.type&&0!==e.value.indexOf(n.canonicalIssuer.prefix)&&(e.value=n.canonicalIssuer.getId(e.value))}),t.push(D(e)),i()},e)},function(e){if(t.sort(),"application/nquads"===n.options.format)return r=t.join(""),e();r=N(t.join("")),e()}],e)}],function(e){t(e,r)})},r.prototype.hashFirstDegreeQuads=function(e,t){var r=this,n=r.blankNodeInfo[e];if("hash"in n)return t(null,n.hash);var i=[];r.forEach(n.quads,function(t,n,o){var s={predicate:t.predicate};r.forEachComponent(t,function(t,n){s[n]=r.modifyFirstDegreeComponent(e,t,n)}),i.push(D(s)),o()},function(e){if(e)return t(e);i.sort(),n.hash=ee.hashNQuads(r.name,i),t(null,n.hash)})},r.prototype.modifyFirstDegreeComponent=function(e,t){return"blank node"!==t.type?t:((t=R(t)).value=t.value===e?"_:a":"_:z",t)},r.prototype.hashRelatedBlankNode=function(e,t,r,n,i){var o,s=this;s.waterfall([function(t){return s.canonicalIssuer.hasId(e)?(o=s.canonicalIssuer.getId(e),t()):r.hasId(e)?(o=r.getId(e),t()):void s.hashFirstDegreeQuads(e,function(e,r){if(e)return t(e);o=r,t()})}],function(e){return e?i(e):((e=new ee(s.name)).update(n),"g"!==n&&e.update(s.getRelatedPredicate(t)),e.update(o),i(null,e.digest()))})},r.prototype.getRelatedPredicate=function(e){return"<"+e.predicate.value+">"},r.prototype.hashNDegreeQuads=function(e,t,r){var n,i=this,o=new ee(i.name);i.waterfall([function(r){i.createHashToRelated(e,t,function(e,t){if(e)return r(e);n=t,r()})},function(e){var r=Object.keys(n).sort();i.forEach(r,function(e,r,s){o.update(e);var a,u="",l=new Z(n[e]);i.whilst(function(){return l.hasNext()},function(e){var r=l.next(),n=t.clone(),o="",s=[];i.waterfall([function(t){i.forEach(r,function(t,r,a){if(i.canonicalIssuer.hasId(t)?o+=i.canonicalIssuer.getId(t):(n.hasId(t)||s.push(t),o+=n.getId(t)),0!==u.length&&o.length>=u.length&&o>u)return e();a()},t)},function(t){i.forEach(s,function(t,r,s){i.hashNDegreeQuads(t,n,function(r,i){return r?s(r):(o+=n.getId(t),o+="<"+i.hash+">",n=i.issuer,0!==u.length&&o.length>=u.length&&o>u?e():void s())})},t)},function(e){(0===u.length||o<u)&&(u=o,a=n),e()}],e)},function(e){if(e)return s(e);o.update(u),t=a,s()})},e)}],function(e){r(e,{hash:o.digest(),issuer:t})})},r.prototype.createHashToRelated=function(t,r,n){var i=this,o={};i.forEach(i.blankNodeInfo[t].quads,function(n,s,a){i.forEach(n,function(s,a,u){if("predicate"===a||"blank node"!==s.type||s.value===t)return u();var l=s.value;i.hashRelatedBlankNode(l,n,r,e[a],function(e,t){if(e)return u(e);t in o?o[t].push(l):o[t]=[l],u()})},a)},function(e){n(e,o)})},r.prototype.forEachComponent=function(e,t){for(var r in e)"predicate"!==r&&t(e[r],r,e)},r}(),K=function(){var e=function(e){Y.call(this,e),this.name="URGNA2012"};return(e.prototype=new Y).modifyFirstDegreeComponent=function(e,t,r){return"blank node"!==t.type?t:((t=R(t)).value="name"===r?"_:g":t.value===e?"_:a":"_:z",t)},e.prototype.getRelatedPredicate=function(e){return e.predicate.value},e.prototype.createHashToRelated=function(e,t,r){var n=this,i={};n.forEach(n.blankNodeInfo[e].quads,function(r,o,s){var a;if("blank node"===r.subject.type&&r.subject.value!==e)a=r.subject.value,o="p";else{if("blank node"!==r.object.type||r.object.value===e)return s();a=r.object.value,o="r"}n.hashRelatedBlankNode(a,r,t,o,function(e,t){t in i?i[t].push(a):i[t]=[a],s()})},function(e){r(e,i)})},e}();Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on non-object");var t,r=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.push(t);return r}),t.registerRDFParser("application/nquads",N),t.registerRDFParser("rdfa-api",function(t){for(var r={"@default":[]},n=t.getSubjects(),i=0;i<n.length;++i){var o=n[i];if(null!==o&&null!==(a=t.getSubjectTriples(o))){var s,a=a.predicates;for(s in a)for(var u=a[s].objects,l=0;l<u.length;++l){var c=u[l],f={};f.subject=0===o.indexOf("_:")?{type:"blank node",value:o}:{type:"IRI",value:o},f.predicate=0===s.indexOf("_:")?{type:"blank node",value:s}:{type:"IRI",value:s};var h=c.value;if("http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral"===c.type){q||(q=e("xmldom").XMLSerializer);for(var p=new q,d=(h="",0);d<c.value.length;d++)c.value[d].nodeType===X.ELEMENT_NODE?h+=p.serializeToString(c.value[d]):c.value[d].nodeType===X.TEXT_NODE&&(h+=c.value[d].nodeValue)}f.object={},"http://www.w3.org/1999/02/22-rdf-syntax-ns#object"===c.type?f.object.type=0===c.value.indexOf("_:")?"blank node":"IRI":(f.object.type="literal","http://www.w3.org/1999/02/22-rdf-syntax-ns#PlainLiteral"===c.type?c.language?(f.object.datatype=z,f.object.language=c.language):f.object.datatype=G:f.object.datatype=c.type),f.object.value=h,r["@default"].push(f)}}}return r}),t.IdentifierIssuer=P,t.UniqueNamer=P,P.prototype.clone=function(){var e=new P(this.prefix);return e.counter=this.counter,e.existing=R(this.existing),e},P.prototype.getId=function(e){if(e&&e in this.existing)return this.existing[e];var t=this.prefix+this.counter;return this.counter+=1,e&&(this.existing[e]=t),t},P.prototype.getName=P.prototype.getName,P.prototype.isNamed=P.prototype.hasId=function(e){return e in this.existing};var Z=function(e){this.list=e.sort(),this.done=!1,this.left={};for(var t=0;t<e.length;++t)this.left[e[t]]=!0};Z.prototype.hasNext=function(){return!this.done},Z.prototype.next=function(){for(var e=this.list.slice(),t=null,r=0,n=this.list.length,i=0;i<n;++i){var o=this.list[i],s=this.left[o];(null===t||o>t)&&(s&&0<i&&o>this.list[i-1]||!s&&i<n-1&&o>this.list[i+1])&&(t=o,r=i)}if(null===t)this.done=!0;else for(this.list[r]=this.list[i=this.left[t]?r-1:r+1],this.list[i]=t,i=0;i<n;++i)this.list[i]>t&&(this.left[this.list[i]]=!this.left[this.list[i]]);return e};var ee=function(e){if(!(this instanceof ee))return new ee(e);if(-1===["URDNA2015","URGNA2012"].indexOf(e))throw Error("Invalid RDF Dataset Normalization algorithm: "+e);ee._init.call(this,e)};return ee.hashNQuads=function(e,t){for(var r=new ee(e),n=0;n<t.length;++n)r.update(t[n]);return r.digest()},function(t){if(t){var r=e("crypto");ee._init=function(e){this.md=r.createHash("URDNA2015"===e?"sha256":"sha1")},ee.prototype.update=function(e){return this.md.update(e,"utf8")},ee.prototype.digest=function(){return this.md.digest("hex")}}else{ee._init=function(e){e="URDNA2015"===e?new o.Algorithm:new i.Algorithm,this.md=new n(e)},ee.prototype.update=function(e){return this.md.update(e)},ee.prototype.digest=function(){return this.md.digest().toHex()};var n=function(e){if(!(this instanceof n))return new n(e);if(this._algorithm=e,!n._padding||n._padding.length<this._algorithm.blockSize){n._padding=String.fromCharCode(128),e=String.fromCharCode(0);for(var t=64;0<t;)1&t&&(n._padding+=e),0<(t>>>=1)&&(e+=e)}this.start()};n.prototype.start=function(){this.messageLength=0,this.fullMessageLength=[];for(var e=this._algorithm.messageLengthSize/4,t=0;t<e;++t)this.fullMessageLength.push(0);return this._input=new n.ByteBuffer,this.state=this._algorithm.start(),this},n.prototype.update=function(e){e=new n.ByteBuffer(unescape(encodeURIComponent(e))),this.messageLength+=e.length();for(var t=[(t=e.length())/4294967296>>>0,t>>>0],r=this.fullMessageLength.length-1;0<=r;--r)this.fullMessageLength[r]+=t[1],t[1]=t[0]+(this.fullMessageLength[r]/4294967296>>>0),this.fullMessageLength[r]>>>=0,t[0]=t[1]/4294967296>>>0;for(this._input.putBytes(e.bytes());this._input.length()>=this._algorithm.blockSize;)this.state=this._algorithm.digest(this.state,this._input);return(2048<this._input.read||0===this._input.length())&&this._input.compact(),this},n.prototype.digest=function(){var e=new n.ByteBuffer;e.putBytes(this._input.bytes()),e.putBytes(n._padding.substr(0,this._algorithm.blockSize-(this.fullMessageLength[this.fullMessageLength.length-1]+this._algorithm.messageLengthSize&this._algorithm.blockSize-1)));for(var t=new n.ByteBuffer,r=0;r<this.fullMessageLength.length;++r)t.putInt32(this.fullMessageLength[r]<<3|this.fullMessageLength[r+1]>>>28);return this._algorithm.writeMessageLength(e,t),e=this._algorithm.digest(this.state.copy(),e),t=new n.ByteBuffer,e.write(t),t},n.ByteBuffer=function(e){this.data="string"==typeof e?e:"",this.read=0},n.ByteBuffer.prototype.putInt32=function(e){this.data+=String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)},n.ByteBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},n.ByteBuffer.prototype.putBytes=function(e){this.data+=e},n.ByteBuffer.prototype.bytes=function(){return this.data.slice(this.read)},n.ByteBuffer.prototype.length=function(){return this.data.length-this.read},n.ByteBuffer.prototype.compact=function(){this.data=this.data.slice(this.read),this.read=0},n.ByteBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);16>r&&(e+="0"),e+=r.toString(16)}return e};var i={_w:null,Algorithm:function(){this.name="sha1",this.blockSize=64,this.digestLength=20,this.messageLengthSize=8}};i.Algorithm.prototype.start=function(){return i._w||(i._w=Array(80)),i._createState()},i.Algorithm.prototype.writeMessageLength=function(e,t){e.putBytes(t.bytes())},i.Algorithm.prototype.digest=function(e,t){for(var r,n,o,s,a,u,l,c=t.length(),f=i._w;64<=c;){for(n=e.h0,o=e.h1,s=e.h2,a=e.h3,u=e.h4,l=0;16>l;++l)r=t.getInt32(),f[l]=r,r=(n<<5|n>>>27)+(a^o&(s^a))+u+1518500249+r,u=a,a=s,s=o<<30|o>>>2,o=n,n=r;for(;20>l;++l)f[l]=r=(r=f[l-3]^f[l-8]^f[l-14]^f[l-16])<<1|r>>>31,r=(n<<5|n>>>27)+(a^o&(s^a))+u+1518500249+r,u=a,a=s,s=o<<30|o>>>2,o=n,n=r;for(;32>l;++l)f[l]=r=(r=f[l-3]^f[l-8]^f[l-14]^f[l-16])<<1|r>>>31,r=(n<<5|n>>>27)+(o^s^a)+u+1859775393+r,u=a,a=s,s=o<<30|o>>>2,o=n,n=r;for(;40>l;++l)f[l]=r=(r=f[l-6]^f[l-16]^f[l-28]^f[l-32])<<2|r>>>30,r=(n<<5|n>>>27)+(o^s^a)+u+1859775393+r,u=a,a=s,s=o<<30|o>>>2,o=n,n=r;for(;60>l;++l)f[l]=r=(r=f[l-6]^f[l-16]^f[l-28]^f[l-32])<<2|r>>>30,r=(n<<5|n>>>27)+(o&s|a&(o^s))+u+2400959708+r,u=a,a=s,s=o<<30|o>>>2,o=n,n=r;for(;80>l;++l)f[l]=r=(r=f[l-6]^f[l-16]^f[l-28]^f[l-32])<<2|r>>>30,r=(n<<5|n>>>27)+(o^s^a)+u+3395469782+r,u=a,a=s,s=o<<30|o>>>2,o=n,n=r;e.h0=e.h0+n|0,e.h1=e.h1+o|0,e.h2=e.h2+s|0,e.h3=e.h3+a|0,e.h4=e.h4+u|0,c-=64}return e},i._createState=function(){var e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520,copy:function(){var t=i._createState();return t.h0=e.h0,t.h1=e.h1,t.h2=e.h2,t.h3=e.h3,t.h4=e.h4,t},write:function(t){t.putInt32(e.h0),t.putInt32(e.h1),t.putInt32(e.h2),t.putInt32(e.h3),t.putInt32(e.h4)}};return e};var o={_k:null,_w:null,Algorithm:function(){this.name="sha256",this.blockSize=64,this.digestLength=32,this.messageLengthSize=8}};o.Algorithm.prototype.start=function(){return o._k||o._init(),o._createState()},o.Algorithm.prototype.writeMessageLength=function(e,t){e.putBytes(t.bytes())},o.Algorithm.prototype.digest=function(e,t){for(var r,n,i,s,a,u,l,c,f,h,p,d,g=t.length(),v=o._k,y=o._w;64<=g;){for(s=0;16>s;++s)y[s]=t.getInt32();for(;64>s;++s)y[s]=(r=((r=y[s-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)+y[s-7]+(n=((n=y[s-15])>>>7|n<<25)^(n>>>18|n<<14)^n>>>3)+y[s-16]|0;for(a=e.h0,u=e.h1,l=e.h2,c=e.h3,f=e.h4,h=e.h5,p=e.h6,d=e.h7,s=0;64>s;++s)n=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),i=a&u|l&(a^u),r=d+(r=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(p^f&(h^p))+v[s]+y[s],d=p,p=h,h=f,f=c+r|0,c=l,l=u,u=a,a=r+(n+=i)|0;e.h0=e.h0+a|0,e.h1=e.h1+u|0,e.h2=e.h2+l|0,e.h3=e.h3+c|0,e.h4=e.h4+f|0,e.h5=e.h5+h|0,e.h6=e.h6+p|0,e.h7=e.h7+d|0,g-=64}return e},o._createState=function(){var e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225,copy:function(){var t=o._createState();return t.h0=e.h0,t.h1=e.h1,t.h2=e.h2,t.h3=e.h3,t.h4=e.h4,t.h5=e.h5,t.h6=e.h6,t.h7=e.h7,t},write:function(t){t.putInt32(e.h0),t.putInt32(e.h1),t.putInt32(e.h2),t.putInt32(e.h3),t.putInt32(e.h4),t.putInt32(e.h5),t.putInt32(e.h6),t.putInt32(e.h7)}};return e},o._init=function(){o._k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o._w=Array(64)}}}(o),t.url={},t.url.parsers={simple:{keys:"href scheme authority path query fragment".split(" "),regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:"href protocol scheme authority auth user password hostname port path directory file query fragment".split(" "),regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},t.url.parse=function(e,r){for(var n={},i=t.url.parsers[r||"full"],o=i.regex.exec(e),s=i.keys.length;s--;)n[i.keys[s]]=void 0===o[s]?null:o[s];return n.normalizedPath=U(n.path,!!n.authority),n},o?t.useDocumentLoader("node"):"undefined"!=typeof XMLHttpRequest&&t.useDocumentLoader("xhr"),o&&(t.use=function(r){switch(r){case"request":t.request=e("jsonld-request");break;default:throw new $("Unknown extension.","jsonld.UnknownExtension",{extension:r})}},B={exports:{},filename:i},e("pkginfo")(B,"version"),t.version=B.exports.version),t},u=function(){return a(function(){return u()})};a(u),"function"==typeof e&&"undefined"!=typeof t&&t.exports&&(t.exports=u),s&&("undefined"==typeof jsonld?jsonld=jsonldjs=u:jsonldjs=u)}()}).call(this,e("7YKIPe"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},"/../node_modules/jsonld/js")},{"7YKIPe":10,crypto:25,"es6-promise":3,http:25,"jsonld-request":25,pkginfo:25,request:25,util:25,xmldom:25}],27:[function(e,t,r){var n=e;r=t.exports={Lexer:(e=function(){})("./lib/N3Lexer"),Parser:e("./lib/N3Parser"),Writer:e("./lib/N3Writer"),Store:e("./lib/N3Store"),StreamParser:e("./lib/N3StreamParser"),StreamWriter:e("./lib/N3StreamWriter"),Util:e("./lib/N3Util")},Object.keys(r).forEach(function(e){Object.defineProperty(r,e,{configurable:!0,enumerable:!0,get:function(){return delete r[e],r[e]=n("./lib/N3"+e)}})})},{"./lib/N3Lexer":28,"./lib/N3Parser":29,"./lib/N3Store":30,"./lib/N3StreamParser":31,"./lib/N3StreamWriter":32,"./lib/N3Util":33,"./lib/N3Writer":34}],28:[function(e,t,r){function n(e){if(!(this instanceof n))return new n(e);if(e&&e.lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var t=this;this._tokenize=this.tokenize,this.tokenize=function(e,r){this._tokenize(e,function(e,n){!e&&/^(?:IRI|prefixed|literal|langcode|type|\.|eof)$/.test(n.type)?r&&r(e,n):r&&r(e||t._syntaxError(n.type,r=null))})}}}var i=String.fromCharCode,o="function"==typeof setImmediate?setImmediate:function(e){setTimeout(e,0)},s=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,a={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},u=/[\x00-\x20<>\\"\{\}\|\^\`]/;n.prototype={_iri:/^<((?:[^>\\]|\\[uU])+)>/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>/,_unescapedString:/^"[^"\\]+"(?=[^"\\])/,_singleQuotedString:/^"[^"\\]*(?:\\.[^"\\]*)*"(?=[^"\\])|^'[^'\\]*(?:\\.[^'\\]*)*'(?=[^'\\])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?=\.?[,;\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=[.,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;:\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<:])/,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<:])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(e,t){function r(t){e(t._syntaxError(/^\S*/.exec(n)[0]))}for(var n=this._input;;){for(var i;i=this._newline.exec(n);)n=n.substr(i[0].length,n.length),this._line++;if((i=this._whitespace.exec(n))&&(n=n.substr(i[0].length,n.length)),this._endOfFile.test(n))return t&&e(n=null,{line:this._line,type:"eof",value:"",prefix:""}),this._input=n;i=this._line;var o="",s="",a="",l=n[0],c=null,f=0,h=!1;switch(l){case"^":if(1===n.length)break;if("^"!==n[1])return r(this);if(this._prevTokenType="^","<"!==(n=n.substr(2))[0]){h=!0;break}case"<":if(c=this._unescapedIri.exec(n))o="IRI",s=c[1];else if(c=this._iri.exec(n)){if(null===(s=this._unescape(c[1]))||u.test(s))return r(this);o="IRI"}break;case"_":((c=this._blank.exec(n))||t&&(c=this._blank.exec(n+" ")))&&(o="prefixed",a="_",s=c[1]);break;case'"':case"'":if(c=this._unescapedString.exec(n))o="literal",s=c[0];else if(c=this._singleQuotedString.exec(n)){if(null===(s=this._unescape(c[0])))return r(this);o="literal",s=s.replace(/^'|'$/g,'"')}else if(c=this._tripleQuotedString.exec(n)){if(this._line+=(s=c[1]||c[2]).split(/\r\n|\r|\n/).length-1,null===(s=this._unescape(s)))return r(this);o="literal",s=s.replace(/^'|'$/g,'"')}break;case"@":"literal"===this._prevTokenType&&(c=this._langcode.exec(n))?(o="langcode",s=c[1]):(c=this._keyword.exec(n))&&(o=c[0]);break;case".":if(1===n.length?t:"0">n[1]||"9"<n[1]){o=".",f=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(c=this._number.exec(n))&&(o="literal",s='"'+c[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(c[1]?"double":/^[+\-]?\d+$/.test(c[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(c=this._sparqlKeyword.exec(n))?o=c[0].toUpperCase():h=!0;break;case"f":case"t":(c=this._boolean.exec(n))?(o="literal",s='"'+c[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):h=!0;break;case"a":(c=this._shortPredicates.exec(n))?(o="abbreviation",s="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):h=!0;break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":f=1,o=l;break;default:h=!0}if(h&&("@prefix"!==this._prevTokenType&&"PREFIX"!==this._prevTokenType||!(c=this._prefix.exec(n))?((c=this._prefixed.exec(n))||t&&(c=this._prefixed.exec(n+" ")))&&(o="prefixed",a=c[1]||"",s=this._unescape(c[2])):(o="prefix",s=c[1]||"")),"^"===this._prevTokenType&&(o="IRI"===o||"prefixed"===o?"type":""),!o)return t||!/^'''|^"""/.test(n)&&/\n|\r/.test(n)?r(this):this._input=n;e(null,{line:i,type:o,value:s,prefix:a}),this._prevTokenType=o,n=n.substr(f||c[0].length,n.length)}},_unescape:function(e){try{return e.replace(s,function(e,t,r,n){if(t){if(e=parseInt(t,16),isNaN(e))throw Error();return i(e)}if(r){if(e=parseInt(r,16),isNaN(e))throw Error();return 65535>=e?i(e):i(55296+(e-=65536)/1024,56320+(1023&e))}if(!(e=a[n]))throw Error();return e})}catch(e){return null}},_syntaxError:function(e){return this._input=null,Error('Syntax error: unexpected "'+e+'" on line '+this._line+".")},tokenize:function(e,t){function r(e){null!==i._input&&(i._input+=e,i._tokenizeToEnd(t,!1))}function n(){null!==i._input&&i._tokenizeToEnd(t,!0)}var i=this;this._line=1,"string"==typeof e?(this._input=e,o(function(){i._tokenizeToEnd(t,!0)})):(this._input="",e&&"function"!=typeof e?("function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",r),e.on("end",n)):(this.addChunk=r,this.end=n,t||(t=e)))}},t.exports=n},{}],29:[function(e,t,r){function n(e){if(!(this instanceof n))return new n(e);this._tripleStack=[],this._graph=null,this._setBase((e=e||{}).documentIRI);var t="turtle"===(a="string"==typeof e.format&&e.format.match(/\w*$/)[0].toLowerCase()),r="trig"===a,s=/triple/.test(a),a=/quad/.test(a);a=s||a,(this._supportsNamedGraphs=!t)||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(t||r||s),a&&(this._base="",this._resolveIRI=function(e){return this._error("Disallowed relative IRI",e),this._callback=i,this._subject=null}),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":"_:"+e.blankNodePrefix.replace(/^_:/,""),this._lexer=e.lexer||new o({lineMode:a})}function i(){}var o=e("./N3Lexer"),s=/^[a-z][a-z0-9+.-]*:/i,a=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,u=/(?:^|\/)\.\.?(?:$|[\/#?])/,l=0,c=0;n._resetBlankNodeIds=function(){l=c=0},n.prototype={_setBase:function(e){if(e){if(0<=e.indexOf("#"))throw Error("Invalid base IRI "+e)}else e=null;(this._base=e)&&(this._basePath=e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(a),this._baseRoot=e[0],this._baseScheme=e[1])},_readInTopContext:function(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"@prefix":return this._sparqlStyle=!1,this._readPrefix;case"PREFIX":return this._sparqlStyle=!0,this._readPrefix;case"@base":return this._sparqlStyle=!1,this._readBaseIRI;case"BASE":return this._sparqlStyle=!0,this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}},_readSubject:function(e){switch(this._predicate=null,e.type){case"IRI":this._subject=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e);break;case"prefixed":var t=this._prefixes[e.prefix];if(void 0===t)return this._error('Undefined prefix "'+e.prefix+':"',e);this._subject=t+e.value;break;case"[":return this._subject="_:b"+c++,this._tripleStack.push({subject:this._subject,predicate:null,object:null,type:"blank"}),this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil",predicate:null,object:null,type:"list"}),this._subject=null,this._readListItem;case"}":return this._readPunctuation(e);default:return this._error("Expected subject but got "+e.type,e)}return this._readPredicateOrNamedGraph},_readPredicate:function(e){var t=e.type;switch(t){case"IRI":case"abbreviation":this._predicate=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e);break;case"prefixed":if("_"===e.prefix)return this._error("Disallowed blank node as predicate",e);if(void 0===(t=this._prefixes[e.prefix]))return this._error('Undefined prefix "'+e.prefix+':"',e);this._predicate=t+e.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+t,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return this._readPredicate;default:return this._error('Expected predicate to follow "'+this._subject+'"',e)}return this._readObject},_readObject:function(e){switch(e.type){case"IRI":this._object=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e);break;case"prefixed":var t=this._prefixes[e.prefix];if(void 0===t)return this._error('Undefined prefix "'+e.prefix+':"',e);this._object=t+e.value;break;case"literal":return this._object=e.value,this._readDataTypeOrLang;case"[":return e="_:b"+c++,this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:e,type:"blank"}),this._subject=e,this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil",type:"list"}),this._subject=null,this._readListItem;default:return this._error('Expected object to follow "'+this._predicate+'"',e)}return this._getTripleEndReader()},_readPredicateOrNamedGraph:function(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)},_readGraph:function(e){return"{"!==e.type?this._error("Expected graph but got "+e.type,e):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))},_readBlankNodeTail:function(e){return"]"!==e.type?this._readBlankNodePunctuation(e):(null!==this._subject&&this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""}),e=this._tripleStack.pop(),this._subject=e.subject,null!==e.object?(this._predicate=e.predicate,this._object=e.object,this._getTripleEndReader()):null!==this._predicate?this._readPredicate:this._readPredicateOrNamedGraph)},_readDataTypeOrLang:function(e){switch(e.type){case"type":if(""===e.prefix)e=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e);else{var t=this._prefixes[e.prefix];if(void 0===t)return this._error('Undefined prefix "'+e.prefix+':"',e);e=t+e.value}return this._object+="^^"+e,this._getTripleEndReader();case"langcode":return this._object+="@"+e.value.toLowerCase(),this._getTripleEndReader();default:return this._getTripleEndReader().call(this,e)}},_readListItem:function(e){var t=null,r=null,n=this._subject,i=this._tripleStack,o=i[i.length-1],a=this._readListItem;switch(e.type){case"IRI":t=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e);break;case"prefixed":if(void 0===(t=this._prefixes[e.prefix]))return this._error('Undefined prefix "'+e.prefix+':"',e);t+=e.value;break;case"literal":t=e.value,a=this._readDataTypeOrLang;break;case"[":r="_:b"+c++,t="_:b"+c++,i.push({subject:r,predicate:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first",object:t,type:"blank"}),this._subject=t,a=this._readBlankNodeHead;break;case"(":r="_:b"+c++,i.push({subject:r,predicate:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first",object:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil",type:"list"}),this._subject=null,a=this._readListItem;break;case")":if(i.pop(),0!==i.length&&"list"===i[i.length-1].type&&this._callback(null,{subject:o.subject,predicate:o.predicate,object:o.object,graph:this._graph||""}),this._subject=o.subject,null===o.predicate){if(a=this._readPredicate,"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"===o.subject)return a}else if(this._predicate=o.predicate,this._object=o.object,a=this._getTripleEndReader(),"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"===o.object)return a;r="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil";break;default:return this._error('Expected list item instead of "'+e.type+'"',e)}return null===r&&(this._subject=r="_:b"+c++),null===n?"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"===o.object?o.object=r:o.subject=r:this._callback(null,{subject:n,predicate:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest",object:r,graph:this._graph||""}),null!==t&&this._callback(null,{subject:r,predicate:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first",object:t,graph:this._graph||""}),a},_readPunctuation:function(e){var t=this._subject,r=this._graph;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);this._graph=null;case".":this._subject=null,e=this._readInTopContext;break;case";":e=this._readPredicate;break;case",":e=this._readObject;break;case"IRI":if(this._supportsQuads&&null===this._graph){r=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e),t=this._subject,e=this._readQuadPunctuation;break}case"prefixed":if(this._supportsQuads&&null===this._graph){if(void 0===(r=this._prefixes[e.prefix]))return this._error('Undefined prefix "'+e.prefix+':"',e);r+=e.value,e=this._readQuadPunctuation;break}default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return null!==t&&this._callback(null,{subject:t,predicate:this._predicate,object:this._object,graph:r||""}),e},_readBlankNodePunctuation:function(e){switch(e.type){case";":e=this._readPredicate;break;case",":e=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""}),e},_readQuadPunctuation:function(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext},_readPrefix:function(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)},_readPrefixIRI:function(e){return"IRI"!==e.type?this._error('Expected IRI to follow prefix "'+this._prefix+':"',e):(e=null===this._base||s.test(e.value)?e.value:this._resolveIRI(e),this._prefixes[this._prefix]=e,this._prefixCallback(this._prefix,e),this._readDeclarationPunctuation)},_readBaseIRI:function(e){if("IRI"!==e.type)return this._error("Expected IRI to follow base declaration",e);try{this._setBase(null===this._base||s.test(e.value)?e.value:this._resolveIRI(e))}catch(t){this._error(t.message,e)}return this._readDeclarationPunctuation},_readNamedGraphLabel:function(e){switch(e.type){case"IRI":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}},_readNamedGraphBlankLabel:function(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject="_:b"+c++,this._readGraph)},_readDeclarationPunctuation:function(e){return this._sparqlStyle?this._readInTopContext(e):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext},_getTripleEndReader:function(){var e=this._tripleStack;if(0===e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem}},_error:function(e,t){this._callback(Error(e+" at line "+t.line+"."))},_resolveIRI:function(e){switch((e=e.value)[0]){case void 0:return this._base;case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return this._removeDotSegments(this._basePath+e)}},_removeDotSegments:function(e){if(!u.test(e))return e;for(var t="",r=e.length,n=-1,i=-1,o=0,s="/";n<r;){switch(s){case":":if(0>i&&"/"===e[++n]&&"/"===e[++n])for(;(i=n+1)<r&&"/"!==e[i];)n=i;break;case"?":case"#":n=r;break;case"/":if("."===e[n+1])switch(s=e[++n+1],s){case"/":t+=e.substring(o,n-1),o=n+1;break;case void 0:case"?":case"#":return t+e.substring(o,n)+e.substr(n+1);case".":if(void 0===(s=e[++n+1])||"/"===s||"?"===s||"#"===s){if((o=(t+=e.substring(o,n-2)).lastIndexOf("/"))>=i&&(t=t.substr(0,o)),"/"!==s)return t+"/"+e.substr(n+1);o=n+1}}}s=e[++n]}return t+e.substring(o)},parse:function(e,t,r){this._readCallback=this._readInTopContext,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+l+++"_","function"==typeof e&&(r=t,t=e,e=null),this._callback=t||i,this._prefixCallback=r||i;var n=this;this._lexer.tokenize(e,function(e,t){null!==e?(n._callback(e),n._callback=i):void 0!==n._readCallback&&(n._readCallback=n._readCallback(t))}),e||(this.addChunk=this._lexer.addChunk,this.end=this._lexer.end)}},t.exports=n},{"./N3Lexer":28}],30:[function(e,t,r){function n(e,t){if(!(this instanceof n))return new n(e,t);this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),t=t||{},this._prefixes=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes),this.defaultGraph=t.defaultGraph||"http://example.org/#defaultGraph",e&&this.addTriples(e)}var i=e("./N3Util").expandPrefixedName;n.prototype={get size(){var e=this._size;if(null!==e)return e;var t,r,n,i=this._graphs;for(n in i)for(var o in t=i[n].subjects)for(var s in r=t[o])e+=Object.keys(r[s]).length;return this._size=e},_addToIndex:function(e,t,r,n){return r=(e=e[t]||(e[t]={}))[r]||(e[r]={}),(e=n in r)||(r[n]=null),!e},_removeFromIndex:function(e,t,r,n){var i,o=e[t],s=o[r];for(i in delete s[n],s)return;for(i in delete o[r],o)return;delete e[t]},_findInIndex:function(e,t,r,n,i,o,s,a){var u,l,c=[],f=1<!t+!r+!n?Object.keys(this._ids):this._entities;for(var h in t&&((u=e,e={})[t]=u[t]),e){var p=f[h];if(t=e[h])for(var d in r&&((u=t,t={})[r]=u[r]),t){var g=f[d];if(l=t[d])for(var v=((l=n?n in l?[n]:[]:Object.keys(l)).length-1);0<=v;v--){var y={subject:"",predicate:"",object:"",graph:a};y[i]=p,y[o]=g,y[s]=f[l[v]],c.push(y)}}}return c},_countInIndex:function(e,t,r,n){var i,o,s=0;for(var a in t&&((i=e,e={})[t]=i[t]),e)if(t=e[a])for(var u in r&&((i=t,t={})[r]=i[r]),t)(o=t[u])&&(n?n in o&&s++:s+=Object.keys(o).length);return s},addTriple:function(e,t,r,n){t||(n=e.graph,r=e.object,t=e.predicate,e=e.subject);var i=this._graphs[n=n||this.defaultGraph];i||(i=this._graphs[n]={subjects:{},predicates:{},objects:{}},Object.freeze(i));var o=this._entities;return e=(n=this._ids)[e]||(n[o[++this._id]=e]=this._id),t=n[t]||(n[o[++this._id]=t]=this._id),r=n[r]||(n[o[++this._id]=r]=this._id),n=this._addToIndex(i.subjects,e,t,r),this._addToIndex(i.predicates,t,r,e),this._addToIndex(i.objects,r,e,t),this._size=null,n},addTriples:function(e){for(var t=e.length-1;0<=t;t--)this.addTriple(e[t])},addPrefix:function(e,t){this._prefixes[e]=t},addPrefixes:function(e){for(var t in e)this.addPrefix(t,e[t])},removeTriple:function(e,t,r,n){t||(n=e.graph,r=e.object,t=e.predicate,e=e.subject),n=n||this.defaultGraph;var i,o,s,a=this._ids,u=this._graphs;if(!((e=a[e])&&(t=a[t])&&(r=a[r])&&(i=u[n])))return!1;if(!((o=i.subjects[e])&&(s=o[t])&&r in s))return!1;for(e in this._removeFromIndex(i.subjects,e,t,r),this._removeFromIndex(i.predicates,t,r,e),this._removeFromIndex(i.objects,r,e,t),null!==this._size&&this._size--,i.subjects)return!0;return delete u[n],!0},removeTriples:function(e){for(var t=e.length-1;0<=t;t--)this.removeTriple(e[t])},find:function(e,t,r,n){var o=this._prefixes;return this.findByIRI(i(e,o),i(t,o),i(r,o),i(n,o))},findByIRI:function(e,t,r,n){var i,o,s,a=[],u={},l=this._ids;for(var c in n?u[n]=this._graphs[n]:u=this._graphs,u)if(n=u[c]){if(e&&!(i=l[e])||t&&!(o=l[t])||r&&!(s=l[r]))return a;a.push(i?s?this._findInIndex(n.objects,s,i,o,"object","subject","predicate",c):this._findInIndex(n.subjects,i,o,null,"subject","predicate","object",c):o?this._findInIndex(n.predicates,o,s,null,"predicate","object","subject",c):s?this._findInIndex(n.objects,s,null,null,"object","subject","predicate",c):this._findInIndex(n.subjects,null,null,null,"subject","predicate","object",c))}return 1===a.length?a[0]:a.concat.apply([],a)},count:function(e,t,r,n){var o=this._prefixes;return this.countByIRI(i(e,o),i(t,o),i(r,o),i(n,o))},countByIRI:function(e,t,r,n){var i=this._ids;return!(n=this._graphs[n=n||this.defaultGraph])||e&&!(e=i[e])||t&&!(t=i[t])||r&&!(r=i[r])?0:e?r?this._countInIndex(n.objects,r,e,t):this._countInIndex(n.subjects,e,t,r):t?this._countInIndex(n.predicates,t,r,e):this._countInIndex(n.objects,r,e,t)},createBlankNode:function(e){var t,r;if(e)for(t=e="_:"+e,r=1;this._ids[t];)t=e+r++;else do{t="_:b"+this._blankNodeIndex++}while(this._ids[t]);return this._ids[t]=++this._id,t}},t.exports=n},{"./N3Util":33}],31:[function(e,t,r){function n(e){if(!(this instanceof n))return new n(e);i.call(this,{decodeStrings:!0}),this._readableState.objectMode=!0;var t=this,r=new o(e);r.parse(function(e,r){r&&t.push(r)||e&&t.emit("error",e)},this.emit.bind(this,"prefix")),this._transform=function(e,t,n){r.addChunk(e),n()},this._flush=function(e){r.end(),e()}}var i=e("stream").Transform;r=e("util");var o=e("./N3Parser.js");r.inherits(n,i),t.exports=n},{"./N3Parser.js":29,stream:15,util:38}],32:[function(e,t,r){function n(e){if(!(this instanceof n))return new n(e);i.call(this,{encoding:"utf8"}),this._writableState.objectMode=!0;var t=this,r=new o({write:function(e,r,n){t.push(e),n&&n()},end:function(e){t.push(null),e&&e()}},e);this._transform=function(e,t,n){r.addTriple(e,n)},this._flush=function(e){r.end(e)}}var i=e("stream").Transform;r=e("util");var o=e("./N3Writer.js");r.inherits(n,i),t.exports=n},{"./N3Writer.js":34,stream:15,util:38}],33:[function(e,t,r){function n(e,t){for(var r in o)t?e.prototype[r]=i(o[r]):e[r]=o[r];return e}function i(e){return function(t){return e(this,t)}}var o={isIRI:function(e){return e?'"'!==(e=e[0])&&"_"!==e:e},isLiteral:function(e){return e&&'"'===e[0]},isBlank:function(e){return e&&"_:"===e.substr(0,2)},getLiteralValue:function(e){var t=/^"([^]*)"/.exec(e);if(!t)throw Error(e+" is not a literal");return t[1]},getLiteralType:function(e){var t=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(e);if(!t)throw Error(e+" is not a literal");return t[1]||(t[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":"http://www.w3.org/2001/XMLSchema#string")},getLiteralLanguage:function(e){var t=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(e);if(!t)throw Error(e+" is not a literal");return t[1]?t[1].toLowerCase():""},isPrefixedName:function(e){return e&&/^[^:\/"']*:[^:\/"']+$/.test(e)},expandPrefixedName:function(e,t){var r,n,i,o=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(e);return o&&(n=t[r=o[1]],i=o.index),void 0===n?e:0===i?n+e.substr(r.length+1):e.substr(0,i+3)+n+e.substr(i+r.length+4)},createIRI:function(e){return e&&'"'===e[0]?o.getLiteralValue(e):e},createLiteral:function(e,t){if(!t)switch(typeof e){case"boolean":t="http://www.w3.org/2001/XMLSchema#boolean";break;case"number":if(isFinite(e)){t=0==e%1?"http://www.w3.org/2001/XMLSchema#integer":"http://www.w3.org/2001/XMLSchema#decimal";break}default:return'"'+e+'"'}return'"'+e+(/^[a-z]+(-[a-z0-9]+)*$/i.test(t)?'"@'+t.toLowerCase():'"^^'+t)},prefix:function(e){return o.prefixes({"":e})("")},prefixes:function(e){function t(e,t){if(t||!(e in n)){var r=Object.create(null);t=t||"",n[e]=function(e){return r[e]||(r[e]=t+e)}}return n[e]}var r,n=Object.create(null);for(r in e)t(r,e[r]);return t}};t.exports=n(n)},{}],34:[function(e,t,r){function n(e,t){if(!(this instanceof n))return new n(e,t);if(e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{var r="";this._outputStream={write:function(e,t,n){r+=e,n&&n()},end:function(e){e&&e(null,r)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes))}function i(e){var t=u[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}var o=/^"([^]*)"(?:\^\^(.+)|@([\-a-z]+))?$/i,s=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,a=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,u={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};n.prototype={_write:function(e,t){this._outputStream.write(e,"utf8",t)},_writeTriple:function(e,t,r,n,i){try{this._graph!==n&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(n?this._encodeIriOrBlankNode(n)+" {\n":"")),this._subject=null,this._graph="["!==n[0]?n:"]"),this._write(this._subject===e?this._predicate===t?", "+this._encodeObject(r):";\n    "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(r):(null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)+" "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(r),i)}catch(e){i&&i(e)}},_writeTripleLine:function(e,t,r,n,i){delete this._prefixMatch;try{this._write(this._encodeIriOrBlankNode(e)+" "+this._encodeIriOrBlankNode(t)+" "+this._encodeObject(r)+(n?" "+this._encodeIriOrBlankNode(n)+".\n":".\n"),i)}catch(e){i&&i(e)}},_encodeIriOrBlankNode:function(e){var t=e[0];return"["===t||"("===t||"_"===t&&":"===e[1]?e:(s.test(e)&&(e=e.replace(a,i)),(t=this._prefixRegex.exec(e))?t[1]?this._prefixIRIs[t[1]]+t[2]:e:"<"+e+">")},_encodeLiteral:function(e,t,r){return s.test(e)&&(e=e.replace(a,i)),r?'"'+e+'"@'+r:t?'"'+e+'"^^'+this._encodeIriOrBlankNode(t):'"'+e+'"'},_encodeSubject:function(e){if('"'===e[0])throw Error("A literal as subject is not allowed: "+e);return"["===e[0]&&(this._subject="]"),this._encodeIriOrBlankNode(e)},_encodePredicate:function(e){if('"'===e[0])throw Error("A literal as predicate is not allowed: "+e);return"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===e?"a":this._encodeIriOrBlankNode(e)},_encodeObject:function(e){if('"'!==e[0])return this._encodeIriOrBlankNode(e);var t=o.exec(e);if(!t)throw Error("Invalid literal: "+e);return this._encodeLiteral(t[1],t[2],t[3])},_blockedWrite:function(){throw Error("Cannot write because the writer has been closed.")},addTriple:function(e,t,r,n,i){void 0===r?this._writeTriple(e.subject,e.predicate,e.object,e.graph||"",t):"string"!=typeof n?this._writeTriple(e,t,r,"",n):this._writeTriple(e,t,r,n,i)},addTriples:function(e){for(var t=0;t<e.length;t++)this.addTriple(e[t])},addPrefix:function(e,t,r){var n={};n[e]=t,this.addPrefixes(n,r)},addPrefixes:function(e,t){var r,n=this._prefixIRIs,i=!1;for(r in e)/[#\/]$/.test(s=e[r])&&n[s]!==(r+=":")&&(i=!0,n[s]=r,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+r+" <"+s+">.\n"));if(i){var o,s=r="";for(o in n)r+=r?"|"+o:o,s+=(s?"|":"")+n[o];r=r.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+s+")[^/]*$|^("+r+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(i?"\n":"",t)},blank:function(e,t){var r,n,i=e;switch(void 0===e?i=[]:"string"==typeof e?i=[{predicate:e,object:t}]:"length"in e||(i=[e]),n=i.length){case 0:return"[]";case 1:if("["!==(r=i[0]).object[0])return"[ "+this._encodePredicate(r.predicate)+" "+this._encodeObject(r.object)+" ]";default:for(var o="[",s=0;s<n;s++)(r=i[s]).predicate===e?o+=", "+this._encodeObject(r.object):(o+=(s?";\n  ":"\n  ")+this._encodePredicate(r.predicate)+" "+this._encodeObject(r.object),e=r.predicate);return o+"\n]"}},list:function(e){for(var t=e&&e.length||0,r=Array(t),n=0;n<t;n++)r[n]=this._encodeObject(e[n]);return"("+r.join(" ")+")"},_prefixRegex:/$0^/,end:function(e){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var t=e&&function(r,n){t=null,e(r,n)};if(this._endStream)try{return this._outputStream.end(t)}catch(e){}t&&t()}},t.exports=n},{}],35:[function(e,t,r){(function(e){!function(n){function i(e){throw RangeError(b[e])}function o(e,t){for(var r=e.length;r--;)e[r]=t(e[r]);return e}function s(e,t){return o(e.split(m),t).join(".")}function a(e){for(var t,r,n=[],i=0,o=e.length;i<o;)55296<=(t=e.charCodeAt(i++))&&56319>=t&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function u(e){return o(e,function(e){var t="";return 65535<e&&(t+=x((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+x(e)}).join("")}function l(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function c(e,t,r){var n=0;for(e=r?w(e/700):e>>1,e+=w(e/t);455<e;n+=36)e=w(e/35);return w(n+36*e/(e+38))}function f(e){var t,r,n,o,s,a,l=[],f=e.length,h=0,p=128,d=72;for(0>(r=e.lastIndexOf("-"))&&(r=0),n=0;n<r;++n)128<=e.charCodeAt(n)&&i("not-basic"),l.push(e.charCodeAt(n));for(r=0<r?r+1:0;r<f;){for(n=h,t=1,o=36;r>=f&&i("invalid-input"),(36<=(s=10>(s=e.charCodeAt(r++))-48?s-22:26>s-65?s-65:26>s-97?s-97:36)||s>w((2147483647-h)/t))&&i("overflow"),h+=s*t,!(s<(a=o<=d?1:o>=d+26?26:o-d));o+=36)t>w(2147483647/(s=36-a))&&i("overflow"),t*=s;d=c(h-n,t=l.length+1,0==n),w(h/t)>2147483647-p&&i("overflow"),p+=w(h/t),h%=t,l.splice(h++,0,p)}return u(l)}function h(e){var t,r,n,o,s,u,f,h,p,d,g,v,y=[];for(d=(e=a(e)).length,t=128,r=0,s=72,u=0;u<d;++u)128>(p=e[u])&&y.push(x(p));for((n=o=y.length)&&y.push("-");n<d;){for(f=2147483647,u=0;u<d;++u)(p=e[u])>=t&&p<f&&(f=p);for(f-t>w((2147483647-r)/(g=n+1))&&i("overflow"),r+=(f-t)*g,t=f,u=0;u<d;++u)if((p=e[u])<t&&2147483647<++r&&i("overflow"),p==t){for(h=r,f=36;!(h<(p=f<=s?1:f>=s+26?26:f-s));f+=36)y.push(x(l(p+(v=h-p)%(h=36-p),0))),h=w(v/h);y.push(x(l(h,0))),s=c(r,g,n==o),r=0,++n}++r,++t}return y.join("")}var p="object"==typeof r&&r,d="object"==typeof t&&t&&t.exports==p&&t;(_="object"==typeof e&&e).global!==_&&_.window!==_||(n=_);var g,v=/^xn--/,y=/[^ -~]/,m=/\x2E|\u3002|\uFF0E|\uFF61/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=Math.floor,x=String.fromCharCode,_={version:"1.2.4",ucs2:{decode:a,encode:u},decode:f,encode:h,toASCII:function(e){return s(e,function(e){return y.test(e)?"xn--"+h(e):e})},toUnicode:function(e){return s(e,function(e){return v.test(e)?f(e.slice(4).toLowerCase()):e})}};if(p&&!p.nodeType)if(d)d.exports=_;else for(g in _)_.hasOwnProperty(g)&&(p[g]=_[g]);else n.punycode=_}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],36:[function(e,t,r){function n(){this.href=this.path=this.pathname=this.query=this.search=this.hash=this.hostname=this.port=this.host=this.auth=this.slashes=this.protocol=null}function i(e,t,r){if(e&&o(e)&&e instanceof n)return e;var i=new n;return i.parse(e,t,r),i}function o(e){return"object"==typeof e&&null!==e}var s=e("punycode");r.parse=i,r.resolve=function(e,t){return i(e,!1,!0).resolve(t)},r.resolveObject=function(e,t){return e?i(e,!1,!0).resolveObject(t):t},r.format=function(e){return"string"==typeof e&&(e=i(e)),e instanceof n?e.format():n.prototype.format.call(e)},r.Url=n;var a=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/;t="{}|\\^`".split("").concat('<>"` \r\n\t'.split(""));var l=["'"].concat(t),c=["%","/","?",";","#"].concat(l),f=["/","?","#"],h=/^[a-z0-9A-Z_-]{0,63}$/,p=/^([a-z0-9A-Z_-]{0,63})(.*)$/,d={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=e("querystring");n.prototype.parse=function(e,t,r){if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);if(e=e.trim(),n=a.exec(e)){var n,i=(n=n[0]).toLowerCase();this.protocol=i,e=e.substr(n.length)}if(r||n||e.match(/^\/\/[^@\/]+@[^@\/]+/)){var o="//"===e.substr(0,2);!o||n&&g[n]||(e=e.substr(2),this.slashes=!0)}if(!g[n]&&(o||n&&!v[n])){for(o=-1,r=0;r<f.length;r++)-1!==(n=e.indexOf(f[r]))&&(-1===o||n<o)&&(o=n);for(-1!==(o=-1===o?e.lastIndexOf("@"):e.lastIndexOf("@",o))&&(r=e.slice(0,o),e=e.slice(o+1),this.auth=decodeURIComponent(r)),o=-1,r=0;r<c.length;r++)-1!==(n=e.indexOf(c[r]))&&(-1===o||n<o)&&(o=n);if(-1===o&&(o=e.length),this.host=e.slice(0,o),e=e.slice(o),this.parseHost(),this.hostname=this.hostname||"",!(o="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1])){var u=this.hostname.split(/\./);for(r=0,n=u.length;r<n;r++){var m=u[r];if(m&&!m.match(h)){for(var b="",w=0,x=m.length;w<x;w++)b=127<m.charCodeAt(w)?b+"x":b+m[w];if(!b.match(h)){n=u.slice(0,r),r=u.slice(r+1),(m=m.match(p))&&(n.push(m[1]),r.unshift(m[2])),r.length&&(e="/"+r.join(".")+e),this.hostname=n.join(".");break}}}}if(this.hostname=255<this.hostname.length?"":this.hostname.toLowerCase(),!o){for(m=this.hostname.split("."),u=[],r=0;r<m.length;++r)u.push((n=m[r]).match(/[^A-Za-z0-9_-]/)?"xn--"+s.encode(n):n);this.hostname=u.join(".")}r=this.port?":"+this.port:"",this.host=(this.hostname||"")+r,this.href+=this.host,o&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==e[0]&&(e="/"+e))}if(!d[i])for(r=0,n=l.length;r<n;r++)o=l[r],(m=encodeURIComponent(o))===o&&(m=escape(o)),e=e.split(o).join(m);return-1!==(r=e.indexOf("#"))&&(this.hash=e.substr(r),e=e.slice(0,r)),-1!==(r=e.indexOf("?"))?(this.search=e.substr(r),this.query=e.substr(r+1),t&&(this.query=y.parse(this.query)),e=e.slice(0,r)):t&&(this.search="",this.query={}),e&&(this.pathname=e),v[i]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(this.path=(r=this.pathname||"")+(n=this.search||"")),this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,s="";return this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&o(this.query)&&Object.keys(this.query).length&&(s=y.stringify(this.query)),e=this.search||s&&"?"+s||"",t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||v[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),e&&"?"!==e.charAt(0)&&(e="?"+e),t+i+(r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(e=e.replace("#","%23"))+n},n.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},n.prototype.resolveObject=function(e){"string"==typeof e&&((i=new n).parse(e,!1,!0),e=i);var t=new n;if(Object.keys(this).forEach(function(e){t[e]=this[e]},this),t.hash=e.hash,""===e.href)return t.href=t.format(),t;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(r){"protocol"!==r&&(t[r]=e[r])}),v[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/"),t.href=t.format(),t;if(e.protocol&&e.protocol!==t.protocol){if(!v[e.protocol])return Object.keys(e).forEach(function(r){t[r]=e[r]}),t.href=t.format(),t;if(t.protocol=e.protocol,e.host||g[e.protocol])t.pathname=e.pathname;else{for(var r=(e.pathname||"").split("/");r.length&&!(e.host=r.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==r[0]&&r.unshift(""),2>r.length&&r.unshift(""),t.pathname=r.join("/")}return t.search=e.search,t.query=e.query,t.host=e.host||"",t.auth=e.auth,t.hostname=e.hostname||e.host,t.port=e.port,(t.pathname||t.search)&&(t.path=(t.pathname||"")+(t.search||"")),t.slashes=t.slashes||e.slashes,t.href=t.format(),t}var i=t.pathname&&"/"===t.pathname.charAt(0),o=i=(u=e.host||e.pathname&&"/"===e.pathname.charAt(0))||i||t.host&&e.pathname,s=t.pathname&&t.pathname.split("/")||[],a=(r=e.pathname&&e.pathname.split("/")||[],t.protocol&&!v[t.protocol]);if(a&&(t.hostname="",t.port=null,t.host&&(""===s[0]?s[0]=t.host:s.unshift(t.host)),t.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===r[0]?r[0]=e.host:r.unshift(e.host)),e.host=null),i=i&&(""===r[0]||""===s[0])),u)t.host=e.host||""===e.host?e.host:t.host,t.hostname=e.hostname||""===e.hostname?e.hostname:t.hostname,t.search=e.search,t.query=e.query,s=r;else if(r.length)s||(s=[]),s.pop(),s=s.concat(r),t.search=e.search,t.query=e.query;else if(null!=e.search)return a&&(t.hostname=t.host=s.shift(),a=!!(t.host&&0<t.host.indexOf("@"))&&t.host.split("@"))&&(t.auth=a.shift(),t.host=t.hostname=a.shift()),t.search=e.search,t.query=e.query,null===t.pathname&&null===t.search||(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t;if(!s.length)return t.pathname=null,t.path=t.search?"/"+t.search:null,t.href=t.format(),t;for(var u=s.slice(-1)[0],l=(r=(t.host||e.host)&&("."===u||".."===u)||""===u,0),c=s.length;0<=c;c--)"."==(u=s[c])?s.splice(c,1):".."===u?(s.splice(c,1),l++):l&&(s.splice(c,1),l--);if(!i&&!o)for(;l--;l)s.unshift("..");return!i||""===s[0]||s[0]&&"/"===s[0].charAt(0)||s.unshift(""),r&&"/"!==s.join("/").substr(-1)&&s.push(""),o=""===s[0]||s[0]&&"/"===s[0].charAt(0),a&&(t.hostname=t.host=o?"":s.length?s.shift():"",a=!!(t.host&&0<t.host.indexOf("@"))&&t.host.split("@"))&&(t.auth=a.shift(),t.host=t.hostname=a.shift()),(i=i||t.host&&s.length)&&!o&&s.unshift(""),s.length?t.pathname=s.join("/"):(t.pathname=null,t.path=null),null===t.pathname&&null===t.search||(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=e.auth||t.auth,t.slashes=t.slashes||e.slashes,t.href=t.format(),t},n.prototype.parseHost=function(){var e=this.host,t=u.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{punycode:35,querystring:13}],37:[function(e,t,r){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],38:[function(e,t,r){(function(t,n){function i(e,t){var n={seen:[],stylize:s};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),h(t)?n.showHidden=t:t&&r._extend(n,t),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),a(n,e,n.depth)}function o(e,t){var r=i.styles[t];return r?"\x1b["+i.colors[r][0]+"m"+e+"\x1b["+i.colors[r][1]+"m":e}function s(e,t){return e}function a(e,t,n){if(e.customInspect&&t&&w(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t))return d(s=t.inspect(n,e))||(s=a(e,s,n)),s;if(s=u(e,t))return s;var i=Object.keys(t),o=function(e){var t={};return i.forEach(function(e,r){t[e]=!0}),t}();if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),b(t)&&(0<=i.indexOf("message")||0<=i.indexOf("description")))return l(t);if(0===i.length){if(w(t))return e.stylize("[Function"+(t.name?": "+t.name:"")+"]","special");if(v(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(m(t))return e.stylize(Date.prototype.toString.call(t),"date");if(b(t))return l(t)}var s="",h=!1,p=["{","}"];return f(t)&&(h=!0,p=["[","]"]),w(t)&&(s=" [Function"+(t.name?": "+t.name:"")+"]"),v(t)&&(s=" "+RegExp.prototype.toString.call(t)),m(t)&&(s=" "+Date.prototype.toUTCString.call(t)),b(t)&&(s=" "+l(t)),0!==i.length||h&&0!=t.length?0>n?v(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),i=h?function(e,t,r,n,i){for(var o=[],s=0,a=t.length;s<a;++s)Object.prototype.hasOwnProperty.call(t,String(s))?o.push(c(e,t,r,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(c(e,t,r,n,i,!0))}),o}(e,t,n,o,i):i.map(function(r){return c(e,t,n,o,r,h)}),e.seen.pop(),function(e,t,r){return 60<e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}(i,s,p)):p[0]+s+p[1]}function u(e,t){if(g(t))return e.stylize("undefined","undefined");if(d(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return p(t)?e.stylize(""+t,"number"):h(t)?e.stylize(""+t,"boolean"):null===t?e.stylize("null","null"):void 0}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function c(e,t,r,n,i,o){var s,u;if((t=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?u=e.stylize(t.set?"[Getter/Setter]":"[Getter]","special"):t.set&&(u=e.stylize("[Setter]","special")),Object.prototype.hasOwnProperty.call(n,i)||(s="["+i+"]"),u||(0>e.seen.indexOf(t.value)?-1<(u=a(e,t.value,null===r?null:r-1)).indexOf("\n")&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n")):u=e.stylize("[Circular]","special")),g(s)){if(o&&i.match(/^\d+$/))return u;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function f(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function p(e){return"number"==typeof e}function d(e){return"string"==typeof e}function g(e){return void 0===e}function v(e){return y(e)&&"[object RegExp]"===Object.prototype.toString.call(e)}function y(e){return"object"==typeof e&&null!==e}function m(e){return y(e)&&"[object Date]"===Object.prototype.toString.call(e)}function b(e){return y(e)&&("[object Error]"===Object.prototype.toString.call(e)||e instanceof Error)}function w(e){return"function"==typeof e}function x(e){return 10>e?"0"+e.toString(10):e.toString(10)}var _=/%[sdj%]/g;r.format=function(e){if(!d(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(i(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,o=n.length,s=(t=String(e).replace(_,function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),n[r]);r<o;s=n[++r])t=null!==s&&y(s)?t+" "+i(s):t+" "+s;return t},r.deprecate=function(e,i){if(g(n.process))return function(){return r.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var o=!1;return function(){if(!o){if(t.throwDeprecation)throw Error(i);t.traceDeprecation?console.trace(i):console.error(i),o=!0}return e.apply(this,arguments)}};var k,j={};r.debuglog=function(e){if(g(k)&&(k=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!j[e])if(new RegExp("\\b"+e+"\\b","i").test(k)){var n=t.pid;j[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,n,t)}}else j[e]=function(){};return j[e]},r.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=f,r.isBoolean=h,r.isNull=function(e){return null===e},r.isNullOrUndefined=function(e){return null==e},r.isNumber=p,r.isString=d,r.isSymbol=function(e){return"symbol"==typeof e},r.isUndefined=g,r.isRegExp=v,r.isObject=y,r.isDate=m,r.isError=b,r.isFunction=w,r.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e},r.isBuffer=e("./support/isBuffer");var L="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");r.log=function(){var e,t;console.log("%s - %s",(t=[x((e=new Date).getHours()),x(e.getMinutes()),x(e.getSeconds())].join(":"),[e.getDate(),L[e.getMonth()],t].join(" ")),r.format.apply(r,arguments))},r.inherits=e("inherits"),r._extend=function(e,t){if(!t||!y(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this,e("7YKIPe"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":37,"7YKIPe":10,inherits:24}],39:[function(e,t,r){function n(e,t){this.name="NonSupportedSparqlFeatureError",this.feature=e,this.message=t||"SPARQL feature "+e+" non supported"}function i(e){this.name=ParserError,this.message=e||"Error parsing SPARQL query"}var o=e("./parser"),s=e("./utils");n.prototype=Error(),n.constructor=n,i.prototype=Error(),i.constructor=i,AbstractQueryTree=function(){},AbstractQueryTree.prototype.parseQueryString=function(e){return o.parse(e)},AbstractQueryTree.prototype.parseExecutableUnit=function(e){if("select"===e.kind||"ask"===e.kind||"modify"===e.kind||"construct"===e.kind)return this.parseSelect(e);if("insertdata"===e.kind||"deletedata"===e.kind)return this.parseInsertData(e);if("load"===e.kind||"clear"===e.kind||"drop"===e.kind||"create"===e.kind)return e;throw Error("unknown executable unit: "+e.kind)},AbstractQueryTree.prototype.parseSelect=function(e){return null==e?(console.log("error parsing query"),null):(e.pattern=this.build(e.pattern,{freshCounter:0}),e)},AbstractQueryTree.prototype.parseInsertData=function(e){return null==e?(console.log("error parsing query"),null):e},AbstractQueryTree.prototype.build=function(e,t){if("groupgraphpattern"===e.token)return this._buildGroupGraphPattern(e,t);if("basicgraphpattern"===e.token){var r={kind:"BGP",value:e.triplesContext};return AbstractQueryTree.translatePathExpressionsInBGP(r,t)}if("graphunionpattern"===e.token)return{kind:"UNION",value:[r=this.build(e.value[0],t),this.build(e.value[1],t)]};if("graphgraphpattern"===e.token)return{kind:"GRAPH",value:this.build(e.value,t),graph:e.graph};if(null!=e.token)throw new n(e.token,"Non implemented SPARQL graph pattern: '"+e.token+"'");throw new i("Error parsing graph pattern: '"+JSON.stringify(e)+"'")},AbstractQueryTree.translatePathExpressionsInBGP=function(e,t){var r,n,i,o=[];for(i=0;i<e.value.length;i++)if(e.value[i].predicate&&"path"===e.value[i].predicate.token){r=e.value[i],n=e.value.slice(i+1);var a=AbstractQueryTree.translatePathExpression(r,t);if(r=null,"BGP"!==a.kind){if("ZERO_OR_MORE_PATH"===a.kind||"ONE_OR_MORE_PATH"===a.kind){if(i=0<o.length?{kind:"JOIN",lvalue:{kind:"BGP",value:o},rvalue:a}:a,"ZERO_OR_MORE_PATH"===a.kind)if("var"===a.y.token&&0===a.y.value.indexOf("fresh:")&&"var"===a.x.token&&0===a.x.value.indexOf("fresh:"))for(var u=0;u<e.value.length;u++)e.value[u].object&&"var"===e.value[u].object.token&&e.value[u].object.value===a.x.value&&((r=s.clone(e.value[u],!0)).object=a.y);else if("var"===a.y.token&&0===a.y.value.indexOf("fresh:"))for(u=0;u<e.value.length;u++)e.value[u].subject&&"var"===e.value[u].subject.token&&e.value[u].subject.value===a.y.value&&((r=s.clone(e.value[u],!0)).subject=a.x);return 0<n.length?(a=AbstractQueryTree.translatePathExpressionsInBGP({kind:"BGP",value:n},t),null!=r?{kind:"UNION",value:[{kind:"JOIN",lvalue:i,rvalue:a},{kind:"BGP",value:o=o.concat([r]).concat(n)}]}:{kind:"JOIN",lvalue:i,rvalue:a}):i}return a}o=o.concat(a.value)}else o.push(e.value[i]);return e.value=o,e},AbstractQueryTree.translatePathExpression=function(e,t){if("element"===e.predicate.kind)return"+"===e.predicate.modifier?(e.predicate.modifier=null,{kind:"ONE_OR_MORE_PATH",path:o=AbstractQueryTree.translatePathExpression(e,t),x:e.subject,y:e.object}):"*"===e.predicate.modifier?(e.predicate.modifier=null,{kind:"ZERO_OR_MORE_PATH",path:o=AbstractQueryTree.translatePathExpression(e,t),x:e.subject,y:e.object}):(e.predicate=e.predicate.value,{kind:"BGP",value:[e]});if("sequence"===e.predicate.kind){for(var r,i,o=e.subject,a=e.object,u=e.graph,l=[],c=0;c<e.predicate.value.length;c++)c!=e.predicate.value.length-1?(r={token:"var",value:"fresh:"+t.freshCounter},t.freshCounter++):r=a,i={subject:o,predicate:e.predicate.value[c],object:r},null!=u&&(i.graph=s.clone(u,!0)),l.push(i),c!=e.predicate.value.length-1&&(o=s.clone(r,!0));return AbstractQueryTree.translatePathExpressionsInBGP({kind:"BGP",value:l},t)}throw new n("Non supported path expression "+e.predicate.kind)},AbstractQueryTree.prototype._buildGroupGraphPattern=function(e,t){for(var r=e.filters||[],n=e.binds||[],i={kind:"EMPTY_PATTERN"},o=0;o<e.patterns.length;o++){var s=e.patterns[o];"optionalgraphpattern"===s.token?i="FILTER"===(s=this.build(s.value,t)).kind?{kind:"LEFT_JOIN",lvalue:i,rvalue:s.value,filter:s.filter}:{kind:"LEFT_JOIN",lvalue:i,rvalue:s,filter:!0}:(s=this.build(s,t),i="EMPTY_PATTERN"==i.kind?s:{kind:"JOIN",lvalue:i,rvalue:s})}if(i.binds=n,0!=r.length){if("EMPTY_PATTERN"===i.kind||"LEFT_JOIN"===i.kind&&!0===i.filter||"LEFT_JOIN"===i.kind||"JOIN"===i.kind||"UNION"===i.kind||"GRAPH"===i.kind||"BGP"===i.kind)return{kind:"FILTER",filter:r,value:i};throw Error("Unknow kind of algebra expression: "+i.kind)}return i},AbstractQueryTree.prototype.collectBasicTriples=function(e,t){if(null==t&&(t=[]),"select"===e.kind)t=this.collectBasicTriples(e.pattern,t);else if("BGP"===e.kind)t=t.concat(e.value);else if("ZERO_OR_MORE_PATH"===e.kind)t=this.collectBasicTriples(e.path);else if("UNION"===e.kind)t=this.collectBasicTriples(e.value[0],t),t=this.collectBasicTriples(e.value[1],t);else if("GRAPH"===e.kind)t=this.collectBasicTriples(e.value,t);else if("LEFT_JOIN"===e.kind||"JOIN"===e.kind)t=this.collectBasicTriples(e.lvalue,t),t=this.collectBasicTriples(e.rvalue,t);else if("FILTER"===e.kind)t=this.collectBasicTriples(e.value,t);else if("construct"===e.kind)t=this.collectBasicTriples(e.pattern,t);else if("EMPTY_PATTERN"!==e.kind)throw"Unknown pattern: "+e.kind;return t},AbstractQueryTree.prototype.bind=function(e,t){if(null!=e.graph&&e.graph.token&&"var"===e.graph.token&&null!=t[e.graph.value]&&(e.graph=t[e.graph.value]),null!=e.filter){for(var r=[],n=0;n<e.filter.length;n++)e.filter[n].value=this._bindFilter(e.filter[n].value,t),r.push(e.filter[n]);e.filter=r}if("select"===e.kind)e.pattern=this.bind(e.pattern,t);else if("BGP"===e.kind)e.value=this._bindTripleContext(e.value,t);else if("ZERO_OR_MORE_PATH"===e.kind)e.path=this._bindTripleContext(e.path,t),e.x&&"var"===e.x.token&&null!=t[e.x.value]&&(e.x=t[e.x.value]),e.y&&"var"===e.y.token&&null!=t[e.y.value]&&(e.y=t[e.y.value]);else if("UNION"===e.kind)e.value[0]=this.bind(e.value[0],t),e.value[1]=this.bind(e.value[1],t);else if("GRAPH"===e.kind)e.value=this.bind(e.value,t);else if("LEFT_JOIN"===e.kind||"JOIN"===e.kind)e.lvalue=this.bind(e.lvalue,t),e.rvalue=this.bind(e.rvalue,t);else if("FILTER"===e.kind){var i=this;e.value=this.bind(e.value,t),e.filter=e.filter.map(function(e){return{token:"filter",value:i._bindFilter(e.value,t)}})}else if("EMPTY_PATTERN"!==e.kind)throw"Unknown pattern: "+e.kind;return e},AbstractQueryTree.prototype._bindTripleContext=function(e,t){for(var r=0;r<e.length;r++)for(var n in delete e[r].graph,delete e[r].variables,e[r]){var i=e[r][n];"var"===i.token&&null!=t[i.value]&&(e[r][n]=t[i.value])}return e},AbstractQueryTree.prototype._bindFilter=function(e,t){if(null!=e.expressionType){var r=e.expressionType;if("relationalexpression"==r)e.op1=this._bindFilter(e.op1,t),e.op2=this._bindFilter(e.op2,t);else if("conditionalor"==r||"conditionaland"==r)for(r=0;r<e.operands.length;r++)e.operands[r]=this._bindFilter(e.operands[r],t);else if("additiveexpression"==r)for(e.summand=this._bindFilter(e.summand,t),r=0;r<e.summands.length;r++)e.summands[r].expression=this._bindFilter(e.summands[r].expression,t);else if("builtincall"==r)for(r=0;r<e.args.length;r++)e.args[r]=this._bindFilter(e.args[r],t);else if("multiplicativeexpression"==r)for(e.factor=this._bindFilter(e.factor,t),r=0;r<e.factors.length;r++)e.factors[r].expression=this._bindFilter(e.factors[r].expression,t);else if("unaryexpression"==r)e.expression=this._bindFilter(e.expression,t);else if("irireforfunction"==r)for(r=0;r<e.factors.args;r++)e.args[r]=this._bindFilter(e.args[r],t);else"atomic"==r&&"var"==e.primaryexpression&&null!=t[e.value.value]&&(e.primaryexpression="uri"===(r=t[e.value.value]).token?"iri":"literal",e.value=r)}return e},AbstractQueryTree.prototype.replace=function(e,t,r,n){if(null!=e.graph&&e.graph.token&&e.graph.token===t.token&&e.graph.value==t.value&&(e.graph=s.clone(r,!0)),null!=e.filter){for(var i=[],o=0;o<e.filter.length;o++)e.filter[o].value=this._replaceFilter(e.filter[o].value,t,r,n),i.push(e.filter[o]);e.filter=i}if("select"===e.kind)e.pattern=this.replace(e.pattern,t,r,n);else if("BGP"===e.kind)e.value=this._replaceTripleContext(e.value,t,r,n);else if("ZERO_OR_MORE_PATH"===e.kind)e.path=this._replaceTripleContext(e.path,t,r,n),e.x&&e.x.token===t.token&&e.value===t.value&&(e.x=s.clone(r,!0)),e.y&&e.y.token===t.token&&e.value===t.value&&(e.y=s.clone(r,!0));else if("UNION"===e.kind)e.value[0]=this.replace(e.value[0],t,r,n),e.value[1]=this.replace(e.value[1],t,r,n);else if("GRAPH"===e.kind)e.value=this.replace(e.value,t,r);else if("LEFT_JOIN"===e.kind||"JOIN"===e.kind)e.lvalue=this.replace(e.lvalue,t,r,n),e.rvalue=this.replace(e.rvalue,t,r,n);else if("FILTER"===e.kind)e.value=this._replaceFilter(e.value,t,r,n);else if("EMPTY_PATTERN"!==e.kind)throw"Unknown pattern: "+e.kind;return e},AbstractQueryTree.prototype._replaceTripleContext=function(e,t,r,n){for(var i=0;i<e.length;i++)for(var o in e[i]){var a=e[i][o];"var"===a.token&&"var"===t.token&&a.value===t.value?e[i][o]=r:"blank"===a.token&&"blank"===t.token&&a.value===t.value?e[i][o]=r:"literal"!==a.token&&"uri"!==a.token||"literal"!==t.token&&"uri"!==t.token||a.token!==t.token||s.lexicalFormTerm(a,n)[a.token]!==s.lexicalFormTerm(t,n)[a.token]||(e[i][o]=r)}return e},AbstractQueryTree.prototype._replaceFilter=function(e,t,r,n){if(null!=e.expressionType){var i=e.expressionType;if("relationalexpression"==i)e.op1=this._replaceFilter(e.op1,t,r,n),e.op2=this._replaceFilter(e.op2,t,r,n);else if("conditionalor"==i||"conditionaland"==i)for(i=0;i<e.operands.length;i++)e.operands[i]=this._replaceFilter(e.operands[i],t,r,n);else if("additiveexpression"==i)for(e.summand=this._replaceFilter(e.summand,t,r,n),i=0;i<e.summands.length;i++)e.summands[i].expression=this._replaceFilter(e.summands[i].expression,t,r,n);else if("builtincall"==i)for(i=0;i<e.args.length;i++)e.args[i]=this._replaceFilter(e.args[i],t,r,n);else if("multiplicativeexpression"==i)for(e.factor=this._replaceFilter(e.factor,t,r,n),i=0;i<e.factors.length;i++)e.factors[i].expression=this._replaceFilter(e.factors[i].expression,t,r,n);else if("unaryexpression"==i)e.expression=this._replaceFilter(e.expression,t,r,n);else if("irireforfunction"==i)for(i=0;i<e.factors.args;i++)e.args[i]=this._replaceFilter(e.args[i],t,r,n);else"atomic"==i&&(n=null,e.primaryexpression==t.token&&e.value==t.value?n=r.value:"iri"==e.primaryexpression&&"uri"==t.token&&e.value==t.value&&(n=r.value),null!=n&&(e.primaryexpression="uri"===r.token?"iri":r.token,e.value=n))}return e},AbstractQueryTree.prototype.treeWithUnion=function(e){if(null==e||null==e.kind)return!1;if("select"===e.kind)return this.treeWithUnion(e.pattern);if("BGP"===e.kind)return this.treeWithUnion(e.value);if("ZERO_OR_MORE_PATH"===e.kind)return!1;if("UNION"===e.kind){if(null==e.value[0].value||null==e.value[0].value.variables||null==e.value[1].value||null==e.value[1].value.variables)return!0;if(e.value[0].variables.join("/")===e.values[1].variables.join("/"))return!!this.treeWithUnion(e.value[0])||this.treeWithUnion(e.value[1])}else{if("GRAPH"===e.kind||"LEFT_JOIN"!==e.kind&&"JOIN"!==e.kind)return!1;if(this.treeWithUnion(e.lvalue))return!0;this.treeWithUnion(e.rvalue)}},t.exports={AbstractQueryTree:AbstractQueryTree,NonSupportedSparqlFeatureError:n,SparqlParserError:i}},{"./parser":46,"./utils":57}],40:[function(e,t,r){var n=e("./utils"),i=n.nextTick,o=function(e,t){if(0!=arguments.length){this.order=e,this.root=this._allocateNode(),this.root.isLeaf=!0,this.root.level=0;var r=this;this._diskWrite(this.root,function(e){r.root=e,r._updateRootNode(r.root,function(e){r.comparator=function(e,t){return e<t?-1:e>t?1:0},r.merger=null,null!=t&&t(r)})})}};o.prototype._allocateNode=function(){return new s},o.prototype._diskWrite=function(e,t){i(function(){t(e)})},o.prototype._diskRead=function(e,t){i(function(){t(e)})},o.prototype._diskDelete=function(e,t){i(function(){t()})},o.prototype._updateRootNode=function(e,t){t(e)},o.prototype.search=function(e,t,r){this.__search(this,e,this.root,t,r)},o.prototype.__search=function(e,t,r,n,i){for(var o=0;o<r.numberActives&&1===e.comparator(t,r.keys[o].key);)o++;o<r.numberActives&&0===e.comparator(r.keys[o].key,t)?n(null!=i&&1==i||r.keys[o].data):!0===r.isLeaf?n(null):e._diskRead(r.children[o],function(r){e.__search(e,t,r,n,i)})},o.prototype.walk=function(e,t){this.__walk(this,this.root,e,t)},o.prototype.__walk=function(e,t,r,i){var o=t.numberActives,s=0;if(t.isLeaf){for(s=0;s<t.numberActives;s++)r(t.keys[s]);return i()}n.whilst(function(){return s<o},function(n){e._diskRead(t.children[s],function(i){e.__walk(e,i,r,function(){e._diskRead(t.keys[s],function(e){r(e),s++,n()})})})},function(){e._diskRead(t.children[o],function(t){e.__walk(e,t,r,function(){i()})})})},o.prototype.walkNodes=function(e){this.__walkNodes(this,root,e,function(){})},o.prototype.__walkNodes=function(e,t,r,i){if(t.isLeaf)return r(t),i();r(t);var o=t.numberActives,s=0;n.whilst(function(){return s<o},function(n){e._diskRead(t.children[s],function(t){e.__walkNodes(e,t,r,function(){s++,n()})})},function(){e._diskRead(t.children[o],function(t){e.__walkNodes(e,t,r,function(){})})})},o.prototype._splitChild=function(e,t,r,n){var i=this._allocateNode();i.isLeaf=r.isLeaf,i.level=r.level,i.numberActives=this.order-1;var o=r.keys[this.order-1];r.keys[this.order-1]=null;for(var s=0;s<this.order-1;s++)i.keys[s]=r.keys[s+this.order],r.keys[s+this.order]=null,r.isLeaf||(i.children[s]=r.children[s+this.order],r.children[s+this.order]=null);for(r.isLeaf||(i.children[s]=r.children[s+this.order],r.children[s+this.order]=null),r.numberActives=this.order-1,s=e.numberActives+1;s>t+1;s--)e.children[s]=e.children[s-1];for(e.children[t+1]=i,s=e.numberActives;s>t;s--)e.keys[s]=e.keys[s-1];e.keys[t]=o,e.numberActives++;var a=this;this._diskWrite(i,function(i){a._diskWrite(e,function(e){e.children[t+1]=i,a._diskWrite(r,function(t){return n(e)})})})},o.prototype.insert=function(e,t,r){if(this.root.numberActives===2*this.order-1){var n=this._allocateNode();n.isLeaf=!1,n.level=this.root.level+1,n.numberActives=0,n.children[0]=this.root;var i=this;this._splitChild(n,0,this.root,function(o){i.root=n=o,i._updateRootNode(n,function(n){i._insertNonFull(n,e,t,r)})})}else this._insertNonFull(this.root,e,t,r)},o.prototype._insertNonFull=function(e,t,r,n){this.__insertNonFull(this,e,e.numberActives-1,t,r,n)},o.prototype.__insertNonFull=function(e,t,r,n,i,o){if(t.isLeaf){for(;0<=r&&-1===e.comparator(n,t.keys[r].key);)t.keys[r+1]=t.keys[r],r--;0<=r&&0===e.comparator(n,t.keys[r].key)?t.keys[r]={key:n,data:i}:(t.keys[r+1]={key:n,data:i},t.numberActives++),e._diskWrite(t,function(e){return o(e)})}else{for(;0<=r&&-1===e.comparator(n,t.keys[r].key);)r--;e._diskRead(t.children[++r],function(s){s.numberActives===2*e.order-1?e._splitChild(t,r,s,function(){1===e.comparator(n,t.keys[r].key)&&r++,e._diskRead(t.children[r],function(t){e.__insertNonFull(e,t,r=t.numberActives-1,n,i,o)})}):e._diskRead(t.children[r],function(t){e.__insertNonFull(e,t,r=t.numberActives-1,n,i,o)})})}},o.prototype.delete=function(e,t){o.prototype.__deleteSearchNode(this,e,this.root,t)},o.prototype.__deleteSearchNode=function(e,t,r,n){var i=0;if(0===r.numberActives)return n(!1);for(;i<r.numberActives&&1===e.comparator(t,r.keys[i].key);)i++;var o=i;return i<r.numberActives&&0===e.comparator(t,r.keys[i].key)?e.__deleteNodeFound(e,o,t,r,n):!0===r.isLeaf?n(!1):void e._diskRead(r.children[i],function(s){if(null===s)return n(!1);var a=!1,u=!1,l=null,c=null;o===r.numberActives?(u=!0,c=r.children[o-1],l=r.children[o-1]):0===o?(a=!0,l=r.children[1],c=r.children[1]):(c=r.children[o-1],l=r.children[o+1]),e._diskRead(c,function(o){e._diskRead(l,function(l){!0===u&&(l=null),!0===a&&(o=null),s.numberActives===e.order-1&&null!=r?null!=l&&l.numberActives>e.order-1?e._moveKey(r,i,-1,function(r){e.__deleteSearchNode(e,t,s,n)}):null!=o&&o.numberActives>e.order-1?e._moveKey(r,i,1,function(r){e.__deleteSearchNode(e,t,s,n)}):null!=o&&o.numberActives===e.order-1?e._mergeSiblings(r,i,-1,function(r){e.__deleteSearchNode(e,t,r,n)}):null!=l&&l.numberActives===e.order-1&&e._mergeSiblings(r,i,1,function(r){e.__deleteSearchNode(e,t,r,n)}):e.__deleteSearchNode(e,t,s,n)})})})},o.prototype.__deleteNodeFound=function(e,t,r,n,i){if(n.isLeaf&&n.numberActives>e.order-1||n.isLeaf&&n===e.root)return e._deleteKeyFromNode(n,t,function(){i(!0)}),!0;!1===n.isLeaf&&e._diskRead(n.children[t],function(o){o.numberActives>e.order-1?e._getMaxKeyPos(e,o,function(s){n.keys[t]=r=s.node.keys[s.index],e._diskWrite(n,function(t){e.__deleteSearchNode(e,r=r.key,o,i)})}):e._diskRead(n.children[t+1],function(s){s.numberActives>e.order-1?e._getMinKeyPos(e,s,function(o){n.keys[t]=r=o.node.keys[o.index],e._diskWrite(n,function(t){e.__deleteSearchNode(e,r=r.key,s,i)})}):o.numberActives===e.order-1&&s.numberActives===e.order-1&&e._mergeNodes(o,n.keys[t],s,function(o){n.children[t]=o;for(var s=++t;s<n.numberActives;s++)n.children[s]=n.children[s+1],n.keys[s-1]=n.keys[s];n.children[s]=null,n.keys[s-1]=null,n.numberActives--,0===n.numberActives&&e.root===n&&(e.root=o),e._diskWrite(n,function(t){e.__deleteSearchNode(e,r,o,i)})})})}),n.isLeaf&&n.numberActives>e.order-1&&e._deleteKeyFromNode(n,t,function(t){e.__deleteSearchNode(e,r,t,i)})},o.prototype._moveKey=function(e,t,r,n){1===r&&t--;var i=this;i._diskRead(e.children[t],function(o){i._diskRead(e.children[t+1],function(s){if(-1==r){o.keys[o.numberActives]=e.keys[t],o.children[o.numberActives+1]=s.children[0],s.children[0]=null,o.numberActives++,e.keys[t]=s.keys[0];for(var a=1;a<s.numberActives;a++)s.keys[a-1]=s.keys[a],s.children[a-1]=s.children[a];s.children[s.numberActives-1]=s.children[s.numberActives],s.numberActives--}else{for(s.children[s.numberActives+1]=s.children[s.numberActives],a=s.numberActives;0<a;a--)s.children[a]=s.children[a-1],s.keys[a]=s.keys[a-1];s.keys[0]=null,s.children[0]=null,s.children[0]=o.children[o.numberActives],s.keys[0]=e.keys[t],s.numberActives++,o.children[o.numberActives]=null,e.keys[t]=o.keys[o.numberActives-1],o.keys[o.numberActives-1]=null,o.numberActives--}i._diskWrite(o,function(t){i._diskWrite(s,function(t){i._diskWrite(e,function(e){return n(e)})})})})})},o.prototype._mergeSiblings=function(e,t,r,n){var i,o,s;t===e.numberActives?(t--,r=e.children[e.numberActives-1],s=e.children[e.numberActives]):(r=e.children[t],s=e.children[t+1]);var a=this;a._diskRead(r,function(r){a._diskRead(s,function(s){var u=a._allocateNode();for(u.isLeaf=r.isLeaf,u.level=r.level,o=0;o<a.order-1;o++)u.keys[o]=r.keys[o],u.children[o]=r.children[o];for(u.keys[a.order-1]=e.keys[t],u.children[a.order-1]=r.children[a.order-1],o=0;o<a.order-1;o++)u.keys[o+a.order]=s.keys[o],u.children[o+a.order]=s.children[o];for(u.children[2*a.order-1]=s.children[a.order-1],e.children[t]=u,o=t;o<e.numberActives;o++)e.keys[o]=e.keys[o+1],e.children[o+1]=e.children[o+2];for(u.numberActives=r.numberActives+s.numberActives+1,e.numberActives--,i=e.numberActives;i<2*a.order-1;i++)e.keys[i]=null;0===e.numberActives&&a.root===e&&(a.root=u,u.isLeaf=!u.level),a._diskWrite(u,function(t){a._diskWrite(e,function(e){a._diskDelete(r,function(){a._diskDelete(s,function(){if(a.root!==t)return n(t);a._updateRootNode(a.root,function(){return n(t)})})})})})})})},o.prototype._deleteKeyFromNode=function(e,t,r){var n=2*this.order-1;if(e.numberActives<n&&(n=e.numberActives),!1===e.isLeaf)return!1;for(;t<n-1;t++)e.keys[t]=e.keys[t+1];e.keys.pop(),e.numberActives--,this._diskWrite(e,function(e){return r(e)})},o.prototype._mergeNodes=function(e,t,r,n){var i,o;for((i=this._allocateNode()).isLeaf=!0,o=0;o<e.numberActives;o++)i.keys[o]=e.keys[o],i.children[o]=e.children[o];for(i.children[e.numberActives]=e.children[e.numberActives],i.keys[e.numberActives]=t,o=0;o<r.numberActives;o++)i.keys[o+e.numberActives+1]=r.keys[o],i.children[o+e.numberActives+1]=r.children[o];i.children[2*this.order-1]=r.children[r.numberActives],i.numberActives=e.numberActives+r.numberActives+1,i.isLeaf=e.isLeaf,i.level=e.level;var s=this;this._diskWrite(i,function(t){s._diskDelete(e,function(){s._diskDelete(r,function(){return n(t)})})})},o.prototype.audit=function(e){var t=[],r=[],n=this,i=function(i){for(var o=0;o<r.length;o++)if(0===n.comparator(r[o],i)){var s=" !!! duplicated key "+i;!0===e&&console.log(s),t.push(s)}},o=null;return n=this,this.walkNodes(function(s){!0===e&&(console.log("--- Node at "+s.level+" level"),console.log(" - leaf? "+s.isLeaf),console.log(" - num actives? "+s.numberActives),console.log(" - keys: "));for(var a=s.numberActives;a<s.keys.length;a++)null!=s.keys[a]&&!0===e&&(console.log(" * warning : redundant key data"),t.push(" * warning : redundant key data"));for(a=s.numberActives+1;a<s.children.length;a++)null!=s.children[a]&&!0===e&&(console.log(" * warning : redundant children data"),t.push(" * warning : redundant key data"));if(!1===s.isLeaf)for(a=0;a<s.numberActives;a++){var u=this._diskRead(s.children[a]).keys[this._diskRead(s.children[a]).numberActives-1].key,l=this._diskRead(s.children[a+1]).keys[0].key;if(!0===e&&console.log("   "+s.keys[a].key+"("+u+","+l+")"),-1===n.comparator(s.keys[a].key,u)){var c=" !!! value max left "+u+" > key "+s.keys[a].key;!0===e&&console.log(c),t.push(c)}1===n.comparator(s.keys[a].key,l)&&(c=" !!! value min right "+l+" < key "+s.keys[a].key,!0===e&&console.log(c),t.push(c)),i(s.keys[a].key),r.push(s.keys[a].key)}else for(null===o?o=s.level:o!=s.level&&(c=" !!! Leaf node with wrong level value",!0===e&&console.log(c),t.push(c)),a=0;a<s.numberActives;a++)!0===e&&console.log(" "+s.keys[a].key),i(s.keys[a].key),r.push(s.keys[a].key);s!=n.root&&(s.numberActives>2*n.order-1&&(!0===e&&(c=" !!!! MAX num keys restriction violated "),console.log(c),t.push(c)),s.numberActives<n.order-1&&(!0===e&&(c=" !!!! MIN num keys restriction violated "),console.log(c),t.push(c)))}),t},o.prototype._getMaxKeyPos=function(e,t,r){var n={};return null===t?r(null):!0===t.isLeaf?(n.node=t,n.index=t.numberActives-1,r(n)):(n.node=t,n.index=t.numberActives-1,void e._diskRead(t.children[t.numberActives],function(t){return e._getMaxKeyPos(e,t,r)}))},o.prototype._getMinKeyPos=function(e,t,r){var n={};if(null===t&&r(null),!0===t.isLeaf)return n.node=t,n.index=0,r(n);n.node=t,n.index=0,e._diskRead(t.children[0],function(t){return e._getMinKeyPos(e,t,r)})};var s=function(){this.numberActives=0,this.isLeaf=null,this.keys=[],this.children=[],this.level=0};t.exports={Tree:o,Node:s}},{"./utils":57}],41:[function(e,t,r){var n=e("./query_engine").QueryEngine,i=e("./quad_backend").QuadBackend,o=e("./persistent_quad_backend").PersistentQuadBackend,s=e("./lexicon").Lexicon,a=e("./persistent_lexicon").PersistentLexicon,u=e("./rdf_model"),l=e("./utils");Store=function(e,t){var r=null,u=null;if(0==arguments.length)u={};else if(1==arguments.length)u={},r=e;else{if(!(1<arguments.length))throw"An optional argument map and a callback must be provided";u=e,r=t}null==u.treeOrder&&(u.treeOrder=15);var l=s,c=i;!0===u.persistent&&(l=a,c=o),this.functionMap={};var f=this;this.customFns={},new l(function(e){var t=function(){new c(u,function(t){var i=function(){u.backend=t,u.lexicon=e,f.engine=new n(u),r(null,f)};u.overwrite?t.clear(i):i()})};!0===u.overwrite?e.clear(t):t()},u.name)},Store.prototype.rdf=u.rdf,Store.prototype.rdf.api=u,Store.prototype.registerCustomFunction=function(e,t){this.customFns[e]=t,this.engine.setCustomFunctions(this.customFns)},Store.prototype.execute=function(){if(3===arguments.length)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);else if(4===arguments.length)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var e,t;1===arguments.length?(e=arguments[0],t=function(){}):2===arguments.length&&(e=arguments[0],t=arguments[1]),this.engine.execute(e,t)}},Store.prototype.executeWithEnvironment=function(){var e,t,r;if(3===arguments.length){e=arguments[0];var n=function(){};t=arguments[1],r=arguments[2]}else 4===arguments.length&&(e=arguments[0],n=arguments[3],t=arguments[1],r=arguments[2]);t=l.map(t,function(e){return{token:"uri",value:e}}),r=l.map(r,function(e){return{token:"uri",value:e}}),this.engine.execute(e,n,t,r)},Store.prototype.graph=function(){var e=null,t=null;if(1===arguments.length)t=arguments[0]||function(){},e=this.engine.lexicon.defaultGraphUri;else{if(2!==arguments.length)throw"An optional graph URI and a callback function must be provided";t=arguments[1]||function(){},e=arguments[0]}null!=this.rdf.resolve(e)&&(e=this.rdf.resolve(e)),this.engine.execute("CONSTRUCT { ?s ?p ?o } WHERE { GRAPH <"+e+"> { ?s ?p ?o } }",t)},Store.prototype.node=function(){var e=null,t=null,r=null;if(2===arguments.length)r=arguments[0],t=arguments[1]||function(){},e=this.engine.lexicon.defaultGraphUri;else{if(3!==arguments.length)throw"An optional graph URI, node URI and a callback function must be provided";r=arguments[0],e=arguments[1],t=arguments[2]||function(){}}null!=this.rdf.resolve(e)&&(e=this.rdf.resolve(e)),null!=this.rdf.resolve(r)&&(r=this.rdf.resolve(r)),this.engine.execute("CONSTRUCT { <"+r+"> ?p ?o } WHERE { GRAPH <"+e+"> { <"+r+"> ?p ?o } }",t)},Store.prototype.startObservingNode=function(){2===arguments.length?this.engine.callbacksBackend.observeNode(arguments[0],arguments[1],function(){}):3===arguments.length&&this.engine.callbacksBackend.observeNode(arguments[0],arguments[1],arguments[2],function(){})},Store.prototype.stopObservingNode=function(e){this.engine.callbacksBackend.stopObservingNode(e)},Store.prototype.startObservingQuery=function(e,t,r){this.engine.callbacksBackend.observeQuery(e,t,null!=r?r:function(){})},Store.prototype.stopObservingQuery=function(e){this.engine.callbacksBackend.stopObservingQuery(e)},Store.prototype.subscribe=function(e,t,r,n,i){var o=this,s=function(e,t){var r=[],n={blanks:{},outCache:{}},s=[];l.each(t,function(e){var t=u.buildRDFResource(e.subject,s,o.engine,n),i=u.buildRDFResource(e.predicate,s,o.engine,n);e=u.buildRDFResource(e.object,s,o.engine,n),null!=t&&null!=i&&null!=e&&(e=new u.Triple(t,i,e),r.push(e))}),i(e,r)};this.functionMap[i]=s,this.engine.callbacksBackend.subscribe(e,t,r,n,s,function(){})},Store.prototype.unsubscribe=function(e){this.engine.callbacksBackend.unsubscribe(this.functionMap[e]),delete this.functionMap[e]},Store.prototype.setPrefix=function(e,t){this.rdf.setPrefix(e,t)},Store.prototype.setDefaultPrefix=function(e){this.rdf.setDefaultPrefix(e)},Store.prototype.insert=function(){var e,t,r;if(1===arguments.length)t=arguments[0],r=function(){};else if(2===arguments.length)t=arguments[0],r=arguments[1]||function(){};else{if(3!==arguments.length)throw"The triples to insert, an optional graph and callback must be provided";t=arguments[0],e=this.rdf.createNamedNode(arguments[1]),r=arguments[2]||function(){}}var n="",i=this;t.forEach(function(e){n=n+i._nodeToQuery(e.subject)+i._nodeToQuery(e.predicate)+i._nodeToQuery(e.object)+"."}),n=null!=e?"INSERT DATA { GRAPH "+this._nodeToQuery(e)+" { "+n+" } }":"INSERT DATA { "+n+" }",this.engine.execute(n,r)},Store.prototype._nodeToQuery=function(e){if("NamedNode"===e.interfaceName){var t=this.rdf.resolve(e.valueOf());return null!=t?"<"+t+">":"<"+e.valueOf()+">"}return e.toString()},Store.prototype.delete=function(){var e,t,r;if(1===arguments.length)t=arguments[0],r=function(){};else if(2===arguments.length)t=arguments[0],r=arguments[1]||function(){};else{if(3!==arguments.length)throw"The triples to delete, an optional graph and callback must be provided";t=arguments[0],e=this.rdf.createNamedNode(arguments[1]),r=arguments[2]||function(){}}var n="",i=this;t.forEach(function(e){n=n+i._nodeToQuery(e.subject)+i._nodeToQuery(e.predicate)+i._nodeToQuery(e.object)+"."}),n=null!=e?"DELETE DATA { GRAPH "+this._nodeToQuery(e)+" { "+n+" } }":"DELETE DATA { "+n+" }",this.engine.execute(n,r)},Store.prototype.clear=function(){var e,t;if(0===arguments.length)e=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),t=function(){};else if(1===arguments.length)e=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),t=arguments[0]||function(){};else{if(2!==arguments.length)throw"The optional graph and a callback must be provided";e=this.rdf.createNamedNode(arguments[0]),t=arguments[1]||function(){}}e="CLEAR GRAPH "+this._nodeToQuery(e),this.engine.execute(e,t)},Store.prototype.setBatchLoadEvents=function(e){this.engine.eventsOnBatchLoad=e},Store.prototype.registerDefaultNamespace=function(e,t){this.rdf.prefixes.set(e,t),this.engine.registerDefaultNamespace(e,t)},Store.prototype.registerDefaultProfileNamespaces=function(){var e,t=this.rdf.prefixes.values();for(e in t)this.registerDefaultNamespace(e,t[e])},Store.prototype.load=function(){var e,t,r,n,i={};if(3===arguments.length)r=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),e=arguments[0],t=arguments[1],n=arguments[2]||function(){};else if(4===arguments.length)e=arguments[0],t=arguments[1],"string"==typeof(i=arguments[2])?(r=this.rdf.createNamedNode(i),i={}):(r=this.rdf.createNamedNode(i.graph||this.engine.lexicon.defaultGraphUri),delete i.graph),n=arguments[3]||function(){};else if(2===arguments.length)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";if("remote"===e)t=this.rdf.createNamedNode(t),this.engine.execute("LOAD <"+t.valueOf()+"> INTO GRAPH <"+r.valueOf()+">",n);else{var o=this,s=this.engine.rdfLoader.parsers[e];if(!s)return n(Error("Cannot find parser for the provided media type:"+e));e=[s,{token:"uri",value:r.valueOf()},t,i,function(e,t){e?n(e,t):o.engine.batchLoad(t,function(e){null!=e?n(null,e):n(Error("Erro batch-loading triples."))})}],t&&"string"==typeof t&&0===t.indexOf("file://")?this.engine.rdfLoader.loadFromFile.apply(null,e):this.engine.rdfLoader.tryToParse.apply(null,e)}},Store.prototype.registerParser=function(e,t){this.engine.rdfLoader.registerParser(e,t)},Store.prototype.registeredGraphs=function(e){this.engine.lexicon.registeredGraphs(!0,function(t){t=l.map(t,function(e){return new u.NamedNode(e)}),e(null,t)})},Store.prototype.getNetworkTransport=function(){return NetworkTransport},Store.prototype.setNetworkTransport=function(e){NetworkTransport=e},Store.prototype.close=function(e){null==e&&(e=function(){}),this.engine.close?this.engine.close(e):e()},Store.VERSION="0.9.17",Store.yieldFrequency=function(e){l.yieldFrequency(e)},t.exports.Store=Store,t.exports.create=function(){return 1==arguments.length?new Store(arguments[0]):2==arguments.length?new Store(arguments[0],arguments[1]):new Store},t.exports.connect=function(){(1==arguments.length?arguments[0]:2==arguments.length?arguments[1]:arguments[2])(Error("Store#connect is not supported in the 0.9.X series of the library"))}},{"./lexicon":44,"./persistent_lexicon":47,"./persistent_quad_backend":48,"./quad_backend":49,"./query_engine":51,"./rdf_model":55,"./utils":57}],42:[function(e,t,r){var n=e("./utils"),i=e("./utils");e("./quad_index");var o=e("./quad_index").Pattern,s=e("./rdf_model"),a=e("./abstract_query_tree").AbstractQueryTree;Callbacks={ANYTHING:{token:"var",value:"_"},added:"added",deleted:"deleted",eventsFlushed:"eventsFlushed",CallbacksBackend:function(e){for(this.aqt=new a,this.engine=e,this.indexMap={},this.observersMap={},this.queriesIndexMap={},this.emptyNotificationsMap={},this.queriesList=[],this.pendingQueries=[],this.matchedQueries=[],this.updateInProgress=null,this.indices="SPOG GP OGS POG GSP OS".split(" "),this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]},this.callbackCounter=0,this.callbacksMap={},this.callbacksInverseMap={},this.queryCounter=0,this.queriesMap={},this.queriesCallbacksMap={},this.queriesInverseMap={},e=0;e<this.indices.length;e++){var t=this.indices[e];this.indexMap[t]={},this.queriesIndexMap[t]={}}}},Callbacks.CallbacksBackend.prototype.startGraphModification=function(){!0!==this.ongoingModification&&(this.pendingQueries=[].concat(this.queriesList),this.matchedQueries=[],null==this.updateInProgress&&(this.updateInProgress={},this.updateInProgress[Callbacks.added]=[],this.updateInProgress[Callbacks.deleted]=[]))},Callbacks.CallbacksBackend.prototype.nextGraphModification=function(e,t){this.updateInProgress[e].push(t)},Callbacks.CallbacksBackend.prototype.endGraphModification=function(e){if(!0!==this.ongoingModification){var t=this;if(null!=this.updateInProgress){var r=t.updateInProgress;t.updateInProgress=null,this.sendNotification(Callbacks.deleted,r[Callbacks.deleted],function(){t.sendNotification(Callbacks.added,r[Callbacks.added],function(){t.sendEmptyNotification(Callbacks.eventsFlushed,null,function(){t.dispatchQueries(function(){e(!0)})})})})}else e(!0)}else e(!0)},Callbacks.CallbacksBackend.prototype.cancelGraphModification=function(){!0!==this.ongoingModification&&(this.updateInProgress=null)},Callbacks.CallbacksBackend.prototype.sendNotification=function(e,t,r){for(var n={},i=0;i<t.length;i++){var o,s=t[i];for(o in this.indexMap){var a=this.indexMap[o],u=this.componentOrders[o];this._searchCallbacksInIndex(a,u,e,s,n),0!=this.pendingQueries.length&&this._searchQueriesInIndex(a=this.queriesIndexMap[o],u,s)}}this.dispatchNotifications(n),null!=r&&r(!0)},Callbacks.CallbacksBackend.prototype.sendEmptyNotification=function(e,t,r){for(var n=this.emptyNotificationsMap[e]||[],i=0;i<n.length;i++)n[i](e,t);r()},Callbacks.CallbacksBackend.prototype.dispatchNotifications=function(e){for(var t in e){var r=this.callbacksMap[t],n=e[t][Callbacks.deleted];if(null!=n)try{r(Callbacks.deleted,n)}catch(e){}for(var i in e[t])if(i!=Callbacks.deleted)try{r(i,e[t][i])}catch(e){}}},Callbacks.CallbacksBackend.prototype._searchCallbacksInIndex=function(e,t,r,n,i){var o=n[1];n=n[0];for(var s=0;s<t.length+1;s++){for(var a=e._||[],u=[],l=0;l<a.length;l++){var c=a[l];null!=this.callbacksMap[c]&&(i[c]=i[c]||{},i[c][r]=i[c][r]||[],i[c][r].push(n),u.push(c))}if(e._=u,null==e[""+o[a=t[s]]])break;e=e[""+o[a]]}},Callbacks.CallbacksBackend.prototype.subscribeEmpty=function(e,t){var r=this.emptyNotificationsMap[e]||[];r.push(t),this.emptyNotificationsMap[e]=r},Callbacks.CallbacksBackend.prototype.unsubscribeEmpty=function(e,t){var r=this.emptyNotificationsMap[e];null!=r&&(r=n.reject(r,function(e){return e===t})),this.emptyNotificationsMap[e]=r},Callbacks.CallbacksBackend.prototype.subscribe=function(e,t,r,n,i,s){e=this._tokenizeComponents(e,t,r,n),this.engine.registerNsInEnvironment(null,t={blanks:{},outCache:{}});var a=this;this.engine.normalizeQuad(e,t,!0,function(e){for(var t=new o(e),r=a._indexForPattern(t),n=(t=a.componentOrders[r],r=a.indexMap[r],0);n<t.length;n++){var u=e[t[n]];if("_"===u){null==r._&&(r._=[]),a.callbackCounter++,r._.push(a.callbackCounter),a.callbacksMap[a.callbackCounter]=i,a.callbacksInverseMap[i]=a.callbackCounter;break}n===t.length-1?(r[u]=r[u]||{_:[]},a.callbackCounter++,r[u]._.push(a.callbackCounter),a.callbacksMap[a.callbackCounter]=i,a.callbacksInverseMap[i]=a.callbackCounter):(r[u]=r[u]||{},r=r[u])}null!=s&&s(!0)})},Callbacks.CallbacksBackend.prototype.unsubscribe=function(e){var t=this.callbacksInverseMap[e];null!=t&&(delete this.callbacksInverseMap[e],delete this.callbacksMap[t])},Callbacks.CallbacksBackend.prototype._tokenizeComponents=function(e,t,r,n){var i={};return i.subject=null==e?Callbacks.ANYTHING:0==e.indexOf("_:")?{token:"blank",value:e}:{token:"uri",value:e},i.predicate=null==t?Callbacks.ANYTHING:{token:"uri",value:t},i.object=null==r?Callbacks.ANYTHING:{token:"uri",value:r},i.graph=null==n?Callbacks.ANYTHING:{token:"uri",value:n},i},Callbacks.CallbacksBackend.prototype._indexForPattern=function(e){e=e.indexKey;for(var t=this.indices,r=0;r<t.length;r++)for(var i=t[r],o=this.componentOrders[i],s=0;s<o.length&&!1!==n.include(e,o[s]);s++)if(s==e.length-1)return i;return"SPOG"},Callbacks.CallbacksBackend.prototype.observeNode=function(){var e,t,r,n;4===arguments.length?(e=arguments[0],t=arguments[1],r=arguments[2],n=arguments[3]):(e=arguments[0],t=this.engine.lexicon.defaultGraphUri,r=arguments[1],n=arguments[2]),t="CONSTRUCT { <"+e+"> ?p ?o } WHERE { GRAPH <"+t+"> { <"+e+"> ?p ?o } }";var i=this,o={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,o);var a=[];this.engine.execute(t,function(t,u){if(t)n&&n(!1);else{var l=!1,c=function(e,t){if("eventsFlushed"===e&&l){l=!1;try{r(u)}catch(e){}}else if("eventsFlushed"!==e){l=!0;for(var n=0;n<t.length;n++){var c=s.buildRDFResource((h=t[n]).subject,a,i.engine,o),f=s.buildRDFResource(h.predicate,a,i.engine,o),h=s.buildRDFResource(h.object,a,i.engine,o);null!=c&&null!=f&&null!=h&&(h=new s.Triple(c,f,h),e===Callbacks.added?u.add(h):e===Callbacks.deleted&&u.remove(h))}}};i.observersMap[r]=c,i.subscribeEmpty(Callbacks.eventsFlushed,c),i.subscribe(e,null,null,null,c,function(){try{r(u)}catch(e){}n&&n(!0)})}})},Callbacks.CallbacksBackend.prototype.stopObservingNode=function(e){return!!(e=this.observersMap[e])&&(this.unsubscribe(e),this.unsubscribeEmpty(Callbacks.eventsFlushed,e),!0)},Callbacks.CallbacksBackend.prototype.observeQuery=function(e,t,r){var n=this.aqt.parseQueryString(e),s=(n=this.aqt.parseSelect(n.units[0]),n=this.aqt.collectBasicTriples(n),this),a={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,a);var u=this.queryCounter;this.queryCounter++,this.queriesMap[u]=e,this.queriesInverseMap[e]=u,this.queriesList.push(u),this.queriesCallbacksMap[u]=t,i.eachSeries(n,function(e,t){null==e.graph&&(e.graph=s.engine.lexicon.defaultGraphUriTerm),s.engine.normalizeQuad(e,a,!0,function(e){for(var r=new o(e),n=s._indexForPattern(r),i=(r=s.componentOrders[n],n=s.queriesIndexMap[n],0);i<r.length;i++){var a=e[r[i]];if("string"==typeof a){null==n._&&(n._=[]),n._.push(u);break}i===r.length-1?(n[a]=n[a]||{_:[]},n[a]._.push(u)):(n[a]=n[a]||{},n=n[a])}t()})},function(){s.engine.execute(e,function(e,r){e?console.log("ERROR in query callback "+r):t(r)}),null!=r&&r()})},Callbacks.CallbacksBackend.prototype.stopObservingQuery=function(e){var t=this.queriesInverseMap[e];null!=t&&(delete this.queriesInverseMap[e],delete this.queriesMap[t],this.queriesList=n.reject(this.queriesList,function(e){return e===t}))},Callbacks.CallbacksBackend.prototype._searchQueriesInIndex=function(e,t,r){var i=r[1];for(r=r[0],r=0;r<t.length+1;r++){for(var o=e._||[],s=[],a=0;a<o.length;a++){var u=o[a];n.include(this.pendingQueries,u)&&(n.remove(this.pendingQueries,function(e){return e===u}),this.matchedQueries.push(u)),null!=this.queriesMap[u]&&s.push(u)}if(e._=s,null==e[""+i[o=t[r]]])break;e=e[""+i[o]]}},Callbacks.CallbacksBackend.prototype.dispatchQueries=function(e){var t,r=this,n={};i.eachSeries(this.matchedQueries,function(e,i){null==n[e]?(n[e]=!0,t=r.queriesCallbacksMap[e],r.engine.execute(r.queriesMap[e],function(e,r){if(!e)try{t(r)}catch(e){}i()})):i()},function(){e()})},Callbacks.CallbacksBackend.added=Callbacks.added,Callbacks.CallbacksBackend.deleted=Callbacks.deleted,Callbacks.CallbacksBackend.eventsFlushed=Callbacks.eventsFlushed,t.exports=Callbacks},{"./abstract_query_tree":39,"./quad_index":50,"./rdf_model":55,"./utils":57}],43:[function(e,t,r){var n=e("jsonld");r.JSONLDParser={},(e=r.JSONLDParser).parser={async:!0,parse:function(e,t,r,i){try{"string"==typeof e&&(e=JSON.parse(e)),function(e,t,r){var i=null;n.normalize(e,{},function(e,n){if(e)r(e);else{var o=function(e){return"blank node"===e.type?{blank:e.value}:"IRI"===e.type?{token:"uri",value:e.value}:"literal"===e.type?null!=e.language?{literal:'"'+e.value+'"@'+e.language}:null!==e.datatype?{literal:'"'+e.value+'"^^<'+e.datatype+">"}:{literal:'"'+e.value+'"'}:void 0};i=[];var s,a=function(e,r,n){i.push({subject:o(e),predicate:o(r),object:o(n),graph:t})};for(s in n)for(var u=n[s],l=0;l<u.length;l++){var c=u[l];a(c.subject,c.predicate,c.object)}r(null,i)}})}(e,t,i)}catch(e){i(e)}}},t.exports={JSONLDParser:e}},{jsonld:26}],44:[function(e,t,r){var n=e("./utils"),i=e("./btree").Tree;Lexicon=function(e){var t=this;this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,n.seq(function(e){new i(2,function(r){t.uris=r,e()})},function(e){new i(2,function(r){t.literals=r,e()})},function(e){new i(2,function(r){t.knownGraphs=r,e()})},function(e){new i(2,function(r){t.oidUris=r,e()})},function(e){new i(2,function(r){t.oidLiterals=r,e()})},function(e){new i(2,function(r){t.oidBlanks=r,e()})})(function(){null!=e&&e(t)})},Lexicon.prototype.registerGraph=function(e,t,r){e!=this.defaultGraphOid?this.knownGraphs.insert(e,t,function(){r()}):r()},Lexicon.prototype.registeredGraphs=function(e,t){var r=[];this.knownGraphs.walk(function(t){r.push(!0===e?t.data:t.key)},function(){t(r)})},Lexicon.prototype.registerUri=function(e,t){var r=this;e===this.defaultGraphUri?t(this.defaultGraphOid):this.uris.search(e,function(i){if(null==i){var o=r.oidCounter,s="u"+o;r.oidCounter++,n.seq(function(t){r.uris.insert(e,[o,0],function(){t()})},function(t){r.oidUris.insert(s,e,function(){t()})})(function(){t(o)})}else o=i[0],i[1]+=1,t(o)})},Lexicon.prototype.resolveUri=function(e,t){e===this.defaultGraphUri?t(this.defaultGraphOid):this.uris.search(e,function(e){t(null!=e?e[0]:-1)})},Lexicon.prototype.resolveUriCost=function(e,t){e===this.defaultGraphUri?t(0):this.uris.search(e,function(e){t(null!=e?e[1]:-1)})},Lexicon.prototype.registerBlank=function(e){var t=this.oidCounter;this.oidCounter++;var r=""+t;this.oidBlanks.insert(r,r,function(){e(t)})},Lexicon.prototype.resolveBlank=function(e,t){var r=this;this.oidBlanks.search(e,function(e){null!=e?t(e):(e=r.oidCounter,this.oidCounter++,t(""+e))})},Lexicon.prototype.resolveBlankCost=function(e,t){t(0)},Lexicon.prototype.registerLiteral=function(e,t){var r=this;this.literals.search(e,function(i){if(null==i){var o=r.oidCounter,s="l"+o;r.oidCounter++,n.seq(function(t){r.literals.insert(e,[o,0],function(){t()})},function(t){r.oidLiterals.insert(s,e,function(){t()})})(function(){t(o)})}else o=i[0],i[1]+=1,t(o)})},Lexicon.prototype.resolveLiteral=function(e,t){this.literals.search(e,function(e){t(null!=e?e[0]:-1)})},Lexicon.prototype.resolveLiteralCost=function(e,t){this.literals.search(e,function(e){t(null!=e?e[1]:-1)})},Lexicon.prototype.parseLiteral=function(e){var t=e.lastIndexOf("@");if(-1!=t&&'"'===e[t-1]&&null!=e.substring(t,e.length).match(/^@[a-zA-Z\-]+$/g)){var r=e.substring(1,t-1);return{token:"literal",value:r,lang:e=e.substring(t+1,e.length)}}return-1!=(t=e.lastIndexOf("^^"))&&'"'===e[t-1]&&"<"===e[t+2]&&">"===e[e.length-1]?{token:"literal",value:r=e.substring(1,t-1),type:e=e.substring(t+3,e.length-1)}:{token:"literal",value:r=e.substring(1,e.length-1)}},Lexicon.prototype.parseUri=function(e){return{token:"uri",value:e}},Lexicon.prototype.retrieve=function(e,t){var r=this;e===this.defaultGraphOid?t({token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:!0}):n.seq(function(t,n){r.oidUris.search("u"+e,function(e){n(null,null!=e?r.parseUri(e):null)})},function(t,n){null==t?r.oidLiterals.search("l"+e,function(e){n(null,null!=e?r.parseLiteral(e):null)}):n(null,t)},function(t,n){null==t?r.oidBlanks.search(""+e,function(t){n(null,null!=t?{token:"blank",value:"_:"+e}:null)}):n(null,t)})(null,function(e,r){t(r)})},Lexicon.prototype.clear=function(e){var t=this;this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,n.seq(function(e){new i(2,function(r){t.uris=r,e()})},function(e){new i(2,function(r){t.literals=r,e()})},function(e){new i(2,function(r){t.knownGraphs=r,e()})},function(e){new i(2,function(r){t.oidUris=r,e()})},function(e){new i(2,function(r){t.oidLiterals=r,e()})},function(e){new i(2,function(r){t.oidBlanks=r,e()})})(function(){null!=e&&e()})},Lexicon.prototype.unregister=function(e,t,r){var i=this;n.seq(function(r){i._unregisterTerm(e.subject.token,t.subject,r)},function(r){i._unregisterTerm(e.predicate.token,t.predicate,r)},function(r){i._unregisterTerm(e.object.token,t.object,r)},function(r){null!=e.graph?i._unregisterTerm(e.graph.token,t.graph,r):r()})(function(){r(!0)})},Lexicon.prototype._unregisterTerm=function(e,t,r){var i=this;if("uri"===e)if(t!=this.defaultGraphOid){var o="u"+t;i.oidUris.search(o,function(e){i.uris.search(e,function(s){var a=s[1];""+s[0]==""+t?0===a?n.seq(function(e){i.oidUris.delete(o,function(){e()})},function(t){i.uris.delete(e,function(){t()})},function(e){i.knownGraphs.delete(t,function(){e()})})(function(){r()}):i.uris.insert(e,[t,a-1],function(){r()}):r()})})}else r();else"literal"===e?(this.oidCounter++,i.oidLiterals.search(o="l"+t,function(e){i.literals.search(e,function(s){var a=s[1];""+s[0]==""+t?0===a?n.seq(function(e){i.oidLiterals.delete(o,function(){e()})},function(t){i.literals.delete(e,function(){t()})})(function(){r()}):i.literals.insert(e,[t,a-1],function(){r()}):r()})})):"blank"===e?i.oidBlanks.delete(""+t,function(){r()}):r()},t.exports={Lexicon:Lexicon}},{"./btree":40,"./utils":57}],45:[function(e,t,r){if(!e("./utils").isWorker()){var n=e("http"),i=e("https"),o=e("url");NetworkTransport={load:function(e,t,r,s){var a=null==s?3:s;s={host:(e=o.parse(e,!0,!0)).host,hostname:e.hostname,method:"GET",path:e.path,headers:{host:e.hostname,Accept:t}};var u=null;"http:"===e.protocol?(s.port=e.port||80,u=n):"https:"===e.protocol&&(s.port=e.port||443,u=i),(e=u.request(s,function(e){var n=e.headers,i="";"2"==(""+e.statusCode)[0]?(e.on("end",function(){r(null,{headers:n,data:i})}),e.on("data",function(e){i+=e})):"3"==(""+e.statusCode)[0]?0==a?r(Error("Too many redirections")):null!=(e=n.Location||n.location)?NetworkTransport.load(e,t,r,a-1):r(Error("Redirection without location header")):r(Error("HTTP error: "+e.statusCode))})).on("error",r),e.end()}},t.exports={NetworkTransport:NetworkTransport}}},{"./utils":57,http:7,https:22,url:36}],46:[function(e,t,r){t.exports=function(){function e(t,r,n,i){this.message=t,this.expected=r,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}var o={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};return"Expected "+function(e){var t,r=Array(e.length);for(t=0;t<e.length;t++){var n,i=t;n=o[(n=e[t]).type](n),r[i]=n}if(r.sort(),0<r.length){for(e=t=1;t<r.length;t++)r[t-1]!==r[t]&&(r[e]=r[t],e++);r.length=e}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(e)+" but "+(t?'"'+n(t)+'"':"end of input")+" found."},{SyntaxError:e,parse:function(t,r){function n(e,t){return{type:"literal",text:e,ignoreCase:t}}function i(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function o(e){return{type:"other",description:e}}function s(e){var r,n=jh[e];if(!n){for(r=e-1;!jh[r];)r--;for(n={line:(n=jh[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;jh[e]=n}return n}function a(e){kh<Lh||(kh>Lh&&(Lh=kh,Ah=[]),Ah.push(e))}function u(){var e,r,n;if(Ih++,Ih++,e=kh,(r=l())!==Be){var i,o,s,u,c,p;if(Ih++,i=kh,(o=f())!==Be){for(s=[],n=Se();n!==Be;)s.push(n),n=Se();if(s!==Be){for(n=[],u=h();u!==Be;)n.push(u),u=h();if(n!==Be){for(u=[],s=Se();s!==Be;)u.push(s),s=Se();if(u!==Be)if((s=d())!==Be){for(c=[],u=Se();u!==Be;)c.push(u),u=Se();if(c!==Be)if((u=g())!==Be){for(c=[],p=Se();p!==Be;)c.push(p),p=Se();if(c!==Be){var v,y,m,b,w,E,C;if(Ih++,c=kh,t.substr(kh,8)===$r?(p=$r,kh+=8):(p=Be,0===Ih&&a(Jr)),p!==Be){for(v=[],y=ue();y!==Be;)v.push(y),y=ue();if(v!==Be)if(123===t.charCodeAt(kh)?(y=Dt,kh++):(y=Be,0===Ih&&a(Pt)),y!==Be){if(m=[],b=kh,40===t.charCodeAt(kh)?(w=mt,kh++):(w=Be,0===Ih&&a(bt)),w!==Be){if(E=[],(C=x())!==Be)for(;C!==Be;)E.push(C),C=x();else E=Be;E!==Be?(41===t.charCodeAt(kh)?(C=jt,kh++):(C=Be,0===Ih&&a(Lt)),C!==Be?b=w=[w,E,C]:(kh=b,b=Be)):(kh=b,b=Be)}else kh=b,b=Be;for(b===Be&&(b=Fe());b!==Be;){if(m.push(b),b=kh,40===t.charCodeAt(kh)?(w=mt,kh++):(w=Be,0===Ih&&a(bt)),w!==Be){if(E=[],(C=x())!==Be)for(;C!==Be;)E.push(C),C=x();else E=Be;E!==Be?(41===t.charCodeAt(kh)?(C=jt,kh++):(C=Be,0===Ih&&a(Lt)),C!==Be?b=w=[w,E,C]:(kh=b,b=Be)):(kh=b,b=Be)}else kh=b,b=Be;b===Be&&(b=Fe())}m!==Be?(125===t.charCodeAt(kh)?(b=Ut,kh++):(b=Be,0===Ih&&a(Qt)),b!==Be?c=p=[p,v,y,m,b]:(kh=c,c=Be)):(kh=c,c=Be)}else kh=c,c=Be;else kh=c,c=Be}else kh=c,c=Be;if(c===Be&&(c=null),Ih--,c===Be&&0===Ih&&a(Vr),c!==Be){for(i=o,o={named:[],implicit:[]},c=0;c<n.length;c++)"default"===(p=n[c]).kind?o.implicit.push(p.graph):o.named.push(p.graph);0===o.named.length&&0===o.implicit.length&&o.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"}),(n={kind:"select",token:"executableunit"}).dataset=o,n.projection=i.vars,n.modifier=i.modifier,n.pattern=s,null!=u&&null!=u.limit&&(n.limit=u.limit),null!=u&&null!=u.offset&&(n.offset=u.offset),null!=u&&null!=u.order&&""!=u.order&&(n.order=u.order),null!=u&&null!=u.group&&(n.group=u.group),i=n}else kh=i,i=Be}else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be}else kh=i,i=Be}else kh=i,i=Be;if(Ih--,i===Be&&0===Ih&&a(nt),(n=i)===Be){for(Ih++,n=kh,s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be)if(t.substr(kh,9)===Ct?(u=Ct,kh+=9):(u=Be,0===Ih&&a(Ot)),u===Be&&(t.substr(kh,9)===Ft?(u=Ft,kh+=9):(u=Be,0===Ih&&a(St))),u!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be){if(Ih++,s=kh,123===t.charCodeAt(kh)?(u=Dt,kh++):(u=Be,0===Ih&&a(Pt)),u!==Be){for(i=[],u=Se();u!==Be;)i.push(u),u=Se();if(i!==Be)if((u=function e(){var r,n,i,o,s,u,l;if(Ih++,r=kh,(n=Q())!==Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(46===t.charCodeAt(kh)?(s=Ci,kh++):(s=Be,0===Ih&&a(Oi)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be?((l=e())===Be&&(l=null),l!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)):(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;i===Be&&(i=null),i!==Be?(r=n.triplesContext,null!=i&&"object"==typeof i&&null!=i.length&&null!=i[3]&&null!=i[3].triplesContext&&(r=r.concat(i[3].triplesContext)),r=n={token:"triplestemplate",triplesContext:r}):(kh=r,r=Be)}else kh=r,r=Be;return Ih--,r===Be&&0===Ih&&a(Lo),r}())===Be&&(u=null),u!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();i!==Be?(125===t.charCodeAt(kh)?(o=Ut,kh++):(o=Be,0===Ih&&a(Qt)),o!==Be?s=u:(kh=s,s=Be)):(kh=s,s=Be)}else kh=s,s=Be;else kh=s,s=Be}else kh=s,s=Be;if(Ih--,s===Be&&0===Ih&&a(jo),(u=s)!==Be){for(s=[],i=Se();i!==Be;)s.push(i),i=Se();if(s!==Be){for(i=[],s=h();s!==Be;)i.push(s),s=h();if(i!==Be){for(s=[],o=Se();o!==Be;)s.push(o),o=Se();if(s!==Be)if((o=d())!==Be){for(c=[],s=Se();s!==Be;)c.push(s),s=Se();if(c!==Be)if((s=g())!==Be){for(n=u,u=i,i=o,o={named:[],implicit:[]},c=0;c<u.length;c++)"default"===(p=u[c]).kind?o.implicit.push(p.graph):o.named.push(p.graph);0===o.named.length&&0===o.implicit.length&&o.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"}),(u={kind:"construct",token:"executableunit"}).dataset=o,u.template=n,u.pattern=i,null!=s&&null!=s.limit&&(u.limit=s.limit),null!=s&&null!=s.offset&&(u.offset=s.offset),null!=s&&null!=s.order&&""!=s.order&&(u.order=s.order),n=u}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be}else kh=n,n=Be}else kh=n,n=Be}else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be;if(n===Be){for(n=kh,s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be)if(t.substr(kh,9)===Ct?(u=Ct,kh+=9):(u=Be,0===Ih&&a(Ot)),u===Be&&(t.substr(kh,9)===Ft?(u=Ft,kh+=9):(u=Be,0===Ih&&a(St))),u!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be){for(u=[],s=h();s!==Be;)u.push(s),s=h();if(u!==Be){for(s=[],i=Se();i!==Be;)s.push(i),i=Se();if(s!==Be)if(t.substr(kh,5)===Rt?(i=Rt,kh+=5):(i=Be,0===Ih&&a(Tt)),i===Be&&(t.substr(kh,5)===Mt?(i=Mt,kh+=5):(i=Be,0===Ih&&a(Nt))),i!==Be){for(s=[],o=Se();o!==Be;)s.push(o),o=Se();if(s!==Be)if(123===t.charCodeAt(kh)?(o=Dt,kh++):(o=Be,0===Ih&&a(Pt)),o!==Be){for(c=[],s=Se();s!==Be;)c.push(s),s=Se();if(c!==Be)if((s=O())===Be&&(s=null),s!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if(125===t.charCodeAt(kh)?(o=Ut,kh++):(o=Be,0===Ih&&a(Qt)),o!==Be){for(o=[],i=Se();i!==Be;)o.push(i),i=Se();if(o!==Be)if((i=g())!==Be){for(n=u,u=i,i={named:[],implicit:[]},o=0;o<n.length;o++)"default"===(c=n[o]).kind?i.implicit.push(c.graph):i.named.push(c.graph);0===i.named.length&&0===i.implicit.length&&i.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"}),(n={kind:"construct",token:"executableunit"}).dataset=i,n.template=s,n.pattern={token:"basicgraphpattern",triplesContext:s.triplesContext},null!=u&&null!=u.limit&&(n.limit=u.limit),null!=u&&null!=u.offset&&(n.offset=u.offset),null!=u&&null!=u.order&&""!=u.order&&(n.order=u.order)}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be}else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}if(Ih--,n===Be&&0===Ih&&a(Et),n===Be){if(Ih++,n=kh,t.substr(kh,8)===Wt?(s=Wt,kh+=8):(s=Be,0===Ih&&a(qt)),s!==Be){if(u=[],(i=ae())!==Be)for(;i!==Be;)u.push(i),i=ae();else u=Be;if(u===Be&&(42===t.charCodeAt(kh)?(u=At,kh++):(u=Be,0===Ih&&a(It))),u!==Be){for(i=[],o=h();o!==Be;)i.push(o),o=h();i!==Be?((o=d())===Be&&(o=null),o!==Be&&(c=g())!==Be?n=s=[s,u,i,o,c]:(kh=n,n=Be)):(kh=n,n=Be)}else kh=n,n=Be}else kh=n,n=Be;if(Ih--,n===Be&&0===Ih&&a(Bt),n===Be){for(Ih++,n=kh,s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be)if(t.substr(kh,3)===Gt?(u=Gt,kh+=3):(u=Be,0===Ih&&a(zt)),u===Be&&(t.substr(kh,3)===Ht?(u=Ht,kh+=3):(u=Be,0===Ih&&a(Vt))),u!==Be){for(u=[],s=Se();s!==Be;)u.push(s),s=Se();if(u!==Be){for(s=[],i=h();i!==Be;)s.push(i),i=h();if(s!==Be){for(i=[],u=Se();u!==Be;)i.push(u),u=Se();if(i!==Be)if((u=d())!==Be){for(n=s,s=u,u={named:[],implicit:[]},i=0;i<n.length;i++)"implicit"===(o=n[i]).kind?u.implicit.push(o.graph):u.named.push(o.graph);0===u.named.length&&0===u.implicit.length&&u.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"}),(n={kind:"ask",token:"executableunit"}).dataset=u,n.pattern=s}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be}else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be;Ih--,n===Be&&0===Ih&&a(Xt)}}}n!==Be?(Ih++,s=kh,t.substr(kh,6)===tn?(u=tn,kh+=6):(u=Be,0===Ih&&a(rn)),u===Be&&(t.substr(kh,6)===nn?(u=nn,kh+=6):(u=Be,0===Ih&&a(on))),u!==Be&&(i=M())!==Be?s=u=[u,i]:(kh=s,s=Be),s===Be&&(s=null),s!==Be&&(s=null!=s?s[1]:null),Ih--,s===Be&&0===Ih&&a(en),s!==Be?e=r={token:"query",kind:"query",prologue:r,units:[n],inlineData:s}:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Ge),Ih--,e===Be&&0===Ih&&a(Xe),e===Be&&(Ih++,e=function e(){var r,n,i,o,s,u,c,f;if(Ih++,r=kh,(n=l())!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be){if(Ih++,Ih++,i=kh,t.substr(kh,4)===hn?(o=hn,kh+=4):(o=Be,0===Ih&&a(pn)),o===Be&&(t.substr(kh,4)===dn?(o=dn,kh+=4):(o=Be,0===Ih&&a(gn))),o!==Be){for(s=[],o=Se();o!==Be;)s.push(o),o=Se();if(s!==Be)if((o=ke())!==Be){for(u=[],s=Se();s!==Be;)u.push(s),s=Se();if(u!==Be){if(s=kh,t.substr(kh,4)===vn?(u=vn,kh+=4):(u=Be,0===Ih&&a(yn)),u===Be&&(t.substr(kh,4)===mn?(u=mn,kh+=4):(u=Be,0===Ih&&a(bn))),u!==Be){for(c=[],f=Se();f!==Be;)c.push(f),f=Se();c!==Be&&(f=j())!==Be?s=u=[u,c,f]:(kh=s,s=Be)}else kh=s,s=Be;s===Be&&(s=null),s!==Be?(i=s,(s={kind:"load",token:"executableunit"}).sourceGraph=o,null!=i&&(s.destinyGraph=i[2]),i=s):(kh=i,i=Be)}else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;if(Ih--,i===Be&&0===Ih&&a(fn),(o=i)===Be){if(Ih++,o=kh,t.substr(kh,5)===xn?(i=xn,kh+=5):(i=Be,0===Ih&&a(_n)),i===Be&&(t.substr(kh,5)===kn?(i=kn,kh+=5):(i=Be,0===Ih&&a(jn))),i!==Be){for(i=[],s=Se();s!==Be;)i.push(s),s=Se();if(i!==Be)if(t.substr(kh,6)===Ln?(s=Ln,kh+=6):(s=Be,0===Ih&&a(An)),s===Be&&(t.substr(kh,6)===In?(s=In,kh+=6):(s=Be,0===Ih&&a(En))),s===Be&&(s=null),s!==Be){for(s=[],i=Se();i!==Be;)s.push(i),i=Se();s!==Be&&(i=L())!==Be?(o={kind:"clear",token:"executableunit"}).destinyGraph=i:(kh=o,o=Be)}else kh=o,o=Be;else kh=o,o=Be}else kh=o,o=Be;if(Ih--,o===Be&&0===Ih&&a(wn),o===Be){if(Ih++,o=kh,t.substr(kh,4)===On?(i=On,kh+=4):(i=Be,0===Ih&&a(Fn)),i===Be&&(t.substr(kh,4)===Sn?(i=Sn,kh+=4):(i=Be,0===Ih&&a(Rn))),i!==Be){for(i=[],s=Se();s!==Be;)i.push(s),s=Se();if(i!==Be)if(t.substr(kh,6)===Ln?(s=Ln,kh+=6):(s=Be,0===Ih&&a(An)),s===Be&&(t.substr(kh,6)===In?(s=In,kh+=6):(s=Be,0===Ih&&a(En))),s===Be&&(s=null),s!==Be){for(s=[],i=Se();i!==Be;)s.push(i),i=Se();s!==Be&&(i=L())!==Be?(o={kind:"drop",token:"executableunit"}).destinyGraph=i:(kh=o,o=Be)}else kh=o,o=Be;else kh=o,o=Be}else kh=o,o=Be;if(Ih--,o===Be&&0===Ih&&a(Cn),o===Be){if(Ih++,o=kh,t.substr(kh,6)===Mn?(i=Mn,kh+=6):(i=Be,0===Ih&&a(Nn)),i===Be&&(t.substr(kh,6)===Dn?(i=Dn,kh+=6):(i=Be,0===Ih&&a(Pn))),i!==Be){for(i=[],s=Se();s!==Be;)i.push(s),s=Se();if(i!==Be)if(t.substr(kh,6)===Ln?(s=Ln,kh+=6):(s=Be,0===Ih&&a(An)),s===Be&&(t.substr(kh,6)===In?(s=In,kh+=6):(s=Be,0===Ih&&a(En))),s===Be&&(s=null),s!==Be){for(s=[],i=Se();i!==Be;)s.push(i),i=Se();s!==Be&&(i=j())!==Be?(o={kind:"create",token:"executableunit"}).destinyGraph=i:(kh=o,o=Be)}else kh=o,o=Be;else kh=o,o=Be}else kh=o,o=Be;if(Ih--,o===Be&&0===Ih&&a(Tn),o===Be){if(Ih++,o=kh,t.substr(kh,6)===Qn?(i=Qn,kh+=6):(i=Be,0===Ih&&a(Bn)),i===Be&&(t.substr(kh,6)===Wn?(i=Wn,kh+=6):(i=Be,0===Ih&&a(qn))),i!==Be){for(i=[],s=Se();s!==Be;)i.push(s),s=Se();if(i!==Be)if(t.substr(kh,4)===Xn?(s=Xn,kh+=4):(s=Be,0===Ih&&a(Gn)),s===Be&&(t.substr(kh,4)===zn?(s=zn,kh+=4):(s=Be,0===Ih&&a(Hn))),s!==Be){for(s=[],i=Se();i!==Be;)s.push(i),i=Se();s!==Be&&(i=I())!==Be?(o={kind:"insertdata",token:"executableunit"}).quads=i:(kh=o,o=Be)}else kh=o,o=Be;else kh=o,o=Be}else kh=o,o=Be;if(Ih--,o===Be&&0===Ih&&a(Un),o===Be){if(Ih++,o=kh,t.substr(kh,6)===$n?(i=$n,kh+=6):(i=Be,0===Ih&&a(Jn)),i===Be&&(t.substr(kh,6)===Yn?(i=Yn,kh+=6):(i=Be,0===Ih&&a(Kn))),i!==Be){for(i=[],s=Se();s!==Be;)i.push(s),s=Se();i!==Be?(t.substr(kh,4)===Xn?(s=Xn,kh+=4):(s=Be,0===Ih&&a(Gn)),s===Be&&(t.substr(kh,4)===zn?(s=zn,kh+=4):(s=Be,0===Ih&&a(Hn))),s!==Be&&(i=I())!==Be?(o={kind:"deletedata",token:"executableunit"}).quads=i:(kh=o,o=Be)):(kh=o,o=Be)}else kh=o,o=Be;if(Ih--,o===Be&&0===Ih&&a(Vn),o===Be){if(Ih++,o=kh,t.substr(kh,6)===$n?(i=$n,kh+=6):(i=Be,0===Ih&&a(Jn)),i===Be&&(t.substr(kh,6)===Yn?(i=Yn,kh+=6):(i=Be,0===Ih&&a(Kn))),i!==Be){for(i=[],s=Se();s!==Be;)i.push(s),s=Se();if(i!==Be)if(t.substr(kh,5)===Rt?(s=Rt,kh+=5):(s=Be,0===Ih&&a(Tt)),s===Be&&(t.substr(kh,5)===Mt?(s=Mt,kh+=5):(s=Be,0===Ih&&a(Nt))),s!==Be){for(i=[],s=Se();s!==Be;)i.push(s),s=Se();if(i!==Be)if((s=F())!==Be){for((o={kind:"modify"}).pattern=s,o.with=null,o.using=null,i=[],s=null==(s=s.patterns[0]).triplesContext&&null!=s.patterns?s.patterns[0].triplesContext:s.triplesContext,u=0;u<s.length;u++)(c={}).subject=(f=s[u]).subject,c.predicate=f.predicate,c.object=f.object,c.graph=f.graph,i.push(c);o.delete=i}else kh=o,o=Be;else kh=o,o=Be}else kh=o,o=Be;else kh=o,o=Be}else kh=o,o=Be;if(Ih--,o===Be&&0===Ih&&a(Zn),o===Be){var h;if(Ih++,s=i=kh,t.substr(kh,4)===ti?(u=ti,kh+=4):(u=Be,0===Ih&&a(ri)),u===Be&&(t.substr(kh,4)===ni?(u=ni,kh+=4):(u=Be,0===Ih&&a(ii))),u!==Be){for(o=[],c=Se();c!==Be;)o.push(c),c=Se();o!==Be&&(c=ke())!==Be?s=u=[u,o,c]:(kh=s,s=Be)}else kh=s,s=Be;if(s===Be&&(s=null),s!==Be){for(u=[],o=Se();o!==Be;)u.push(o),o=Se();if(u!==Be){if(o=kh,Ih++,u=kh,t.substr(kh,6)===$n?(c=$n,kh+=6):(c=Be,0===Ih&&a(Jn)),c===Be&&(t.substr(kh,6)===Yn?(c=Yn,kh+=6):(c=Be,0===Ih&&a(Kn))),c!==Be&&(c=A())!==Be?u=c:(kh=u,u=Be),Ih--,u===Be&&0===Ih&&a(oi),(c=u)!==Be){for(u=[],f=Se();f!==Be;)u.push(f),f=Se();u!==Be?((f=_())===Be&&(f=null),f!==Be?o=c=[c,u,f]:(kh=o,o=Be)):(kh=o,o=Be)}else kh=o,o=Be;if(o===Be&&(o=_()),o!==Be){for(c=[],u=Se();u!==Be;)c.push(u),u=Se();if(c!==Be){for(u=[],f=k();f!==Be;)u.push(f),f=k();if(u!==Be){for(f=[],c=Se();c!==Be;)f.push(c),c=Se();if(f!==Be)if(t.substr(kh,5)===Rt?(c=Rt,kh+=5):(c=Be,0===Ih&&a(Tt)),c===Be&&(t.substr(kh,5)===Mt?(c=Mt,kh+=5):(c=Be,0===Ih&&a(Nt))),c!==Be){for(f=[],c=Se();c!==Be;)f.push(c),c=Se();if(f!==Be)if((c=F())!==Be){for(f=[],h=Se();h!==Be;)f.push(h),h=Se();f!==Be?(i=s,s=u,(u={kind:"modify"}).with=""!=i&&null!=i?i[2]:null,3!==o.length||""!==o[2]&&null!=o[2]?3===o.length&&null!=o[0].length&&null!=o[1].length&&null!=o[2].length?(u.delete=o[0],u.insert=o[2]):(u.insert=o,u.delete=null):(u.delete=o[0],u.insert=null),""!=s&&(u.using=s),u.pattern=c,i=u):(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be}else kh=i,i=Be}else kh=i,i=Be}else kh=i,i=Be}else kh=i,i=Be;Ih--,i===Be&&0===Ih&&a(ei),o=i}}}}}}}if(Ih--,o===Be&&0===Ih&&a(cn),o!==Be){for(i=kh,s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be)if(59===t.charCodeAt(kh)?(u=un,kh++):(u=Be,0===Ih&&a(ln)),u!==Be){for(c=[],f=Se();f!==Be;)c.push(f),f=Se();c!==Be?((f=e())===Be&&(f=null),f!==Be?i=s=[s,u,c,f]:(kh=i,i=Be)):(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;i===Be&&(i=null),i!==Be?(r=i,(i={token:"query",kind:"update"}).prologue=n,n=[o],null!=r&&null!=r.length&&null!=r[3]&&null!=r[3].units&&(n=n.concat(r[3].units)),i.units=n,r=i):(kh=r,r=Be)}else kh=r,r=Be}else kh=r,r=Be}else kh=r,r=Be;return Ih--,r===Be&&0===Ih&&a(an),r}(),Ih--,e===Be&&0===Ih&&a(sn)),e}function l(){var e,r,n,i;for(Ih++,e=kh,Ih++,r=kh,i=[],n=Se();n!==Be;)i.push(n),n=Se();if(i!==Be)if(t.substr(kh,4)===Ve?(n=Ve,kh+=4):(n=Be,0===Ih&&a($e)),n===Be&&(t.substr(kh,4)===Je?(n=Je,kh+=4):(n=Be,0===Ih&&a(Ye))),n!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be&&(i=je())!==Be?(r={token:"base"}).value=i:(kh=r,r=Be)}else kh=r,r=Be;else kh=r,r=Be;if(Ih--,r===Be&&0===Ih&&a(He),r===Be&&(r=null),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be){for(i=[],n=c();n!==Be;)i.push(n),n=c();i!==Be?e=r={token:"prologue",base:r,prefixes:i}:(kh=e,e=Be)}else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(ze),e}function c(){var e,r,n,i;for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(t.substr(kh,6)===Ze?(n=Ze,kh+=6):(n=Be,0===Ih&&a(et)),n===Be&&(t.substr(kh,6)===tt?(n=tt,kh+=6):(n=Be,0===Ih&&a(rt))),n!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if((r=Le())!==Be){for(i=[],n=Se();n!==Be;)i.push(n),n=Se();i!==Be&&(n=je())!==Be?((e={token:"prefix"}).prefix=r,e.local=n):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Ke),e}function f(){var e,r,n,i,o,s,u,l,c,f,h,p,d,g,v,y;for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(t.substr(kh,6)===st?(n=st,kh+=6):(n=Be,0===Ih&&a(at)),n===Be&&(t.substr(kh,6)===ut?(n=ut,kh+=6):(n=Be,0===Ih&&a(lt))),n!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if(t.substr(kh,8)===ct?(r=ct,kh+=8):(r=Be,0===Ih&&a(ft)),r===Be&&(t.substr(kh,8)===ht?(r=ht,kh+=8):(r=Be,0===Ih&&a(pt))),r===Be&&(t.substr(kh,7)===dt?(r=dt,kh+=7):(r=Be,0===Ih&&a(gt)),r===Be&&(t.substr(kh,7)===vt?(r=vt,kh+=7):(r=Be,0===Ih&&a(yt)))),r===Be&&(r=null),r!==Be){for(i=[],n=Se();n!==Be;)i.push(n),n=Se();if(i!==Be){for(n=[],i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if((s=ue())!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be?i=o=[o,s,u]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(40===t.charCodeAt(kh)?(s=mt,kh++):(s=Be,0===Ih&&a(bt)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();if(u!==Be)if((l=le())!==Be){for(c=[],f=Se();f!==Be;)c.push(f),f=Se();if(c!==Be)if(t.substr(kh,2)===wt?(f=wt,kh+=2):(f=Be,0===Ih&&a(xt)),f===Be&&(t.substr(kh,2)===_t?(f=_t,kh+=2):(f=Be,0===Ih&&a(kt))),f!==Be){for(h=[],p=Se();p!==Be;)h.push(p),p=Se();if(h!==Be)if((p=ue())!==Be){for(d=[],g=Se();g!==Be;)d.push(g),g=Se();if(d!==Be)if(41===t.charCodeAt(kh)?(g=jt,kh++):(g=Be,0===Ih&&a(Lt)),g!==Be){for(v=[],y=Se();y!==Be;)v.push(y),y=Se();v!==Be?i=o=[o,s,u,l,c,f,h,p,d,g,v]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}if(i!==Be)for(;i!==Be;){for(n.push(i),i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if((s=ue())!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be?i=o=[o,s,u]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(40===t.charCodeAt(kh)?(s=mt,kh++):(s=Be,0===Ih&&a(bt)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();if(u!==Be)if((l=le())!==Be){for(c=[],f=Se();f!==Be;)c.push(f),f=Se();if(c!==Be)if(t.substr(kh,2)===wt?(f=wt,kh+=2):(f=Be,0===Ih&&a(xt)),f===Be&&(t.substr(kh,2)===_t?(f=_t,kh+=2):(f=Be,0===Ih&&a(kt))),f!==Be){for(h=[],p=Se();p!==Be;)h.push(p),p=Se();if(h!==Be)if((p=ue())!==Be){for(d=[],g=Se();g!==Be;)d.push(g),g=Se();if(d!==Be)if(41===t.charCodeAt(kh)?(g=jt,kh++):(g=Be,0===Ih&&a(Lt)),g!==Be){for(v=[],y=Se();y!==Be;)v.push(y),y=Se();v!==Be?i=o=[o,s,u,l,c,f,h,p,d,g,v]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}}else n=Be;if(n===Be){for(n=kh,i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if(42===t.charCodeAt(kh)?(o=At,kh++):(o=Be,0===Ih&&a(It)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?n=i=[i,o,s]:(kh=n,n=Be)}else kh=n,n=Be;else kh=n,n=Be}if(n!==Be){if(e=r,r=n,n=[],3===r.length&&"*"===r[1])r={vars:[{token:"variable",kind:"*"}],modifier:Oh(e)};else{for(i=0;i<r.length;i++)n.push(3===(o=r[i]).length?{token:"variable",kind:"var",value:o[1]}:{token:"variable",kind:"aliased",expression:o[3],alias:o[7]});r={vars:n,modifier:Oh(e)}}e=r}else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(ot),e}function h(){var e,r,n,i;if(Ih++,e=kh,t.substr(kh,4)===Jt?(r=Jt,kh+=4):(r=Be,0===Ih&&a(Yt)),r===Be&&(t.substr(kh,4)===Kt?(r=Kt,kh+=4):(r=Be,0===Ih&&a(Zt))),r!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be){for(Ih++,r=kh,n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be&&(i=p())!==Be?r=n={graph:i,kind:"default",token:"graphClause"}:(kh=r,r=Be),Ih--,r===Be&&0===Ih&&a(er),r===Be){if(Ih++,r=kh,t.substr(kh,5)===rr?(n=rr,kh+=5):(n=Be,0===Ih&&a(nr)),n===Be&&(t.substr(kh,5)===ir?(n=ir,kh+=5):(n=Be,0===Ih&&a(or))),n!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be&&(i=p())!==Be?r=n={graph:i,kind:"named",token:"graphCluase"}:(kh=r,r=Be)}else kh=r,r=Be;Ih--,r===Be&&0===Ih&&a(tr)}if(r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?e=r:(kh=e,e=Be)}else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a($t),e}function p(){var e;return Ih++,e=ke(),Ih--,e===Be&&0===Ih&&a(sr),e}function d(){var e,r,n,i;if(Ih++,e=kh,t.substr(kh,5)===Rt?(r=Rt,kh+=5):(r=Be,0===Ih&&a(Tt)),r===Be&&(t.substr(kh,5)===Mt?(r=Mt,kh+=5):(r=Be,0===Ih&&a(Nt))),r===Be&&(r=null),r!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if((r=F())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?e=r:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(ar),e}function g(){var e,r,n,i;if(Ih++,e=kh,Ih++,r=kh,t.substr(kh,5)===cr?(n=cr,kh+=5):(n=Be,0===Ih&&a(fr)),n===Be&&(t.substr(kh,5)===hr?(n=hr,kh+=5):(n=Be,0===Ih&&a(pr))),n!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(t.substr(kh,2)===dr?(i=dr,kh+=2):(i=Be,0===Ih&&a(gr)),i===Be&&(t.substr(kh,2)===vr?(i=vr,kh+=2):(i=Be,0===Ih&&a(yr))),i!==Be){for(i=[],n=Se();n!==Be;)i.push(n),n=Se();if(i!==Be){if(n=[],(i=v())!==Be)for(;i!==Be;)n.push(i),i=v();else n=Be;n!==Be?r=n:(kh=r,r=Be)}else kh=r,r=Be}else kh=r,r=Be;else kh=r,r=Be}else kh=r,r=Be;if(Ih--,r===Be&&0===Ih&&a(lr),r===Be&&(r=null),r!==Be){var o,s;if(Ih++,n=kh,t.substr(kh,6)===wr?(i=wr,kh+=6):(i=Be,0===Ih&&a(xr)),i!==Be){if(o=[],(s=y())!==Be)for(;s!==Be;)o.push(s),s=y();else o=Be;o!==Be?n=i=[i,o]:(kh=n,n=Be)}else kh=n,n=Be;if(Ih--,n===Be&&0===Ih&&a(br),n===Be&&(n=null),n!==Be){if(Ih++,n=kh,t.substr(kh,5)===jr?(i=jr,kh+=5):(i=Be,0===Ih&&a(Lr)),i===Be&&(t.substr(kh,5)===Ar?(i=Ar,kh+=5):(i=Be,0===Ih&&a(Ir))),i!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if(t.substr(kh,2)===dr?(o=dr,kh+=2):(o=Be,0===Ih&&a(gr)),o===Be&&(t.substr(kh,2)===vr?(o=vr,kh+=2):(o=Be,0===Ih&&a(yr))),o!==Be){for(o=[],i=Se();i!==Be;)o.push(i),i=Se();if(o!==Be){if(i=[],(o=m())!==Be)for(;o!==Be;)i.push(o),o=m();else i=Be;if(i!==Be){for(o=[],s=Se();s!==Be;)o.push(s),s=Se();o!==Be?n=i:(kh=n,n=Be)}else kh=n,n=Be}else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;if(Ih--,n===Be&&0===Ih&&a(kr),n===Be&&(n=null),n!==Be){if(Ih++,i=kh,(o=b())!==Be?((s=w())===Be&&(s=null),s!==Be?i=o=[o,s]:(kh=i,i=Be)):(kh=i,i=Be),i===Be&&(i=kh,(o=w())!==Be?((s=b())===Be&&(s=null),s!==Be?i=o=[o,s]:(kh=i,i=Be)):(kh=i,i=Be)),i!==Be){for(o={},s=0;s<i.length;s++){var u=i[s];null!=u&&null!=u.limit?o.limit=u.limit:null!=u&&null!=u.offset&&(o.offset=u.offset)}i=o}Ih--,i===Be&&0===Ih&&a(Dr),i===Be&&(i=null),i!==Be?(e=r,r=i,i={},null!=r&&(null!=r.limit&&(i.limit=r.limit),null!=r.offset&&(i.offset=r.offset)),null!=e&&(i.group=e),i.order=n,e=i):(kh=e,e=Be)}else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(ur),e}function v(){var e,r,n,i,o,s;for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if((n=ye())!==Be){for(i=[],r=Se();r!==Be;)i.push(r),r=Se();i!==Be?e=n:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be;if(e===Be){for(e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if((n=D())!==Be){for(i=[],r=Se();r!==Be;)i.push(r),r=Se();i!==Be?e=n:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be;if(e===Be){for(e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(40===t.charCodeAt(kh)?(n=mt,kh++):(n=Be,0===Ih&&a(bt)),n!==Be){for(i=[],r=Se();r!==Be;)i.push(r),r=Se();if(i!==Be)if((r=le())!==Be){for(i=[],n=Se();n!==Be;)i.push(n),n=Se();if(i!==Be){if(n=kh,t.substr(kh,2)===wt?(o=wt,kh+=2):(o=Be,0===Ih&&a(xt)),o===Be&&(t.substr(kh,2)===_t?(o=_t,kh+=2):(o=Be,0===Ih&&a(kt))),o!==Be){for(s=[],i=Se();i!==Be;)s.push(i),i=Se();s!==Be&&(i=ue())!==Be?n=o=[o,s,i]:(kh=n,n=Be)}else kh=n,n=Be;if(n===Be&&(n=null),n!==Be){for(o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(41===t.charCodeAt(kh)?(s=jt,kh++):(s=Be,0===Ih&&a(Lt)),s!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();i!==Be?e=r=0!=n.length?{token:"aliased_expression",expression:r,alias:n[2]}:r:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;if(e===Be){for(e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if((n=ue())!==Be){for(i=[],r=Se();r!==Be;)i.push(r),r=Se();i!==Be?e=n:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}}}return Ih--,e===Be&&0===Ih&&a(mr),e}function y(){var e;return Ih++,e=T(),Ih--,e===Be&&0===Ih&&a(_r),e}function m(){var e,r,n,i,o;if(Ih++,e=kh,t.substr(kh,3)===Cr?(r=Cr,kh+=3):(r=Be,0===Ih&&a(Or)),r===Be&&(t.substr(kh,3)===Fr?(r=Fr,kh+=3):(r=Be,0===Ih&&a(Sr)),r===Be&&(t.substr(kh,4)===Rr?(r=Rr,kh+=4):(r=Be,0===Ih&&a(Tr)),r===Be&&(t.substr(kh,4)===Mr?(r=Mr,kh+=4):(r=Be,0===Ih&&a(Nr))))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if((i=ve())!==Be){for(n=[],o=Se();o!==Be;)n.push(o),o=Se();n!==Be?(e=i,e=r={direction:r.toUpperCase(),expression:e}):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be)if(e=kh,(r=T())===Be&&(r=ue()),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?("var"===r.token&&(r={token:"expression",expressionType:"atomic",primaryexpression:"var",value:r}),e=r={direction:"ASC",expression:r}):(kh=e,e=Be)}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Er),e}function b(){var e,r,n,i;if(Ih++,e=kh,t.substr(kh,5)===Ur?(r=Ur,kh+=5):(r=Be,0===Ih&&a(Qr)),r===Be&&(t.substr(kh,5)===Br?(r=Br,kh+=5):(r=Be,0===Ih&&a(Wr))),r!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if((r=Ae())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?e=r={limit:parseInt(r.value)}:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Pr),e}function w(){var e,r,n,i;if(Ih++,e=kh,t.substr(kh,6)===Xr?(r=Xr,kh+=6):(r=Be,0===Ih&&a(Gr)),r===Be&&(t.substr(kh,6)===zr?(r=zr,kh+=6):(r=Be,0===Ih&&a(Hr))),r!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if((r=Ae())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?e=r={offset:parseInt(r.value)}:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(qr),e}function x(){var e;return Ih++,(e=ke())===Be&&(e=me())===Be&&(e=be())===Be&&(e=xe())===Be&&(t.substr(kh,5)===Kr?(e=Kr,kh+=5):(e=Be,0===Ih&&a(Zr))),Ih--,e===Be&&0===Ih&&a(Yr),e}function _(){var e,r;return Ih++,e=kh,t.substr(kh,6)===Qn?(r=Qn,kh+=6):(r=Be,0===Ih&&a(Bn)),r===Be&&(t.substr(kh,6)===Wn?(r=Wn,kh+=6):(r=Be,0===Ih&&a(qn))),r!==Be&&(r=A())!==Be?e=r:(kh=e,e=Be),Ih--,e===Be&&0===Ih&&a(si),e}function k(){var e,r,n,i,o;for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(t.substr(kh,5)===ui?(n=ui,kh+=5):(n=Be,0===Ih&&a(li)),n===Be&&(t.substr(kh,5)===ci?(n=ci,kh+=5):(n=Be,0===Ih&&a(fi))),n!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be){if((r=ke())===Be)if(r=kh,t.substr(kh,5)===rr?(n=rr,kh+=5):(n=Be,0===Ih&&a(nr)),n===Be&&(t.substr(kh,5)===ir?(n=ir,kh+=5):(n=Be,0===Ih&&a(or))),n!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();i!==Be&&(o=ke())!==Be?r=n=[n,i,o]:(kh=r,r=Be)}else kh=r,r=Be;r!==Be?e=r=null!=r.length?{kind:"named",uri:r[2]}:{kind:"default",uri:r}:(kh=e,e=Be)}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(ai),e}function j(){var e,r,n;if(Ih++,e=kh,t.substr(kh,5)===pi?(r=pi,kh+=5):(r=Be,0===Ih&&a(di)),r===Be&&(t.substr(kh,5)===gi?(r=gi,kh+=5):(r=Be,0===Ih&&a(vi))),r!==Be){for(r=[],n=Se();n!==Be;)r.push(n),n=Se();r!==Be&&(n=ke())!==Be?e=n:(kh=e,e=Be)}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(hi),e}function L(){var e;return Ih++,(e=j())===Be&&(t.substr(kh,7)===mi?(e=mi,kh+=7):(e=Be,0===Ih&&a(bi)),e===Be&&(t.substr(kh,7)===wi?(e=wi,kh+=7):(e=Be,0===Ih&&a(xi))),e!==Be&&(e="default"),e===Be&&(t.substr(kh,5)===rr?(e=rr,kh+=5):(e=Be,0===Ih&&a(nr)),e===Be&&(t.substr(kh,5)===ir?(e=ir,kh+=5):(e=Be,0===Ih&&a(or))),e!==Be&&(e="named"),e===Be&&(t.substr(kh,3)===_i?(e=_i,kh+=3):(e=Be,0===Ih&&a(ki)),e===Be&&(t.substr(kh,3)===ji?(e=ji,kh+=3):(e=Be,0===Ih&&a(Li))),e!==Be&&(e="all")))),Ih--,e===Be&&0===Ih&&a(yi),e}function A(){var e,r,n,i;for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(123===t.charCodeAt(kh)?(n=Dt,kh++):(n=Be,0===Ih&&a(Pt)),n!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if((r=E())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(125===t.charCodeAt(kh)?(i=Ut,kh++):(i=Be,0===Ih&&a(Qt)),i!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?e=r=r.quadsContext:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Ai),e}function I(){var e,r,n,i;for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(123===t.charCodeAt(kh)?(n=Dt,kh++):(n=Be,0===Ih&&a(Pt)),n!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if((r=E())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(125===t.charCodeAt(kh)?(i=Ut,kh++):(i=Be,0===Ih&&a(Qt)),i!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?e=r=r.quadsContext:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Ii),e}function E(){var e,r,n,i,o,s,u;if(Ih++,e=kh,(r=O())===Be&&(r=null),r!==Be){for(n=[],i=kh,(o=C())!==Be?(46===t.charCodeAt(kh)?(s=Ci,kh++):(s=Be,0===Ih&&a(Oi)),s===Be&&(s=null),s!==Be?((u=O())===Be&&(u=null),u!==Be?i=o=[o,s,u]:(kh=i,i=Be)):(kh=i,i=Be)):(kh=i,i=Be);i!==Be;)n.push(i),i=kh,(o=C())!==Be?(46===t.charCodeAt(kh)?(s=Ci,kh++):(s=Be,0===Ih&&a(Oi)),s===Be&&(s=null),s!==Be?((u=O())===Be&&(u=null),u!==Be?i=o=[o,s,u]:(kh=i,i=Be)):(kh=i,i=Be)):(kh=i,i=Be);if(n!==Be){if(e=r,r=[],null!=e&&null!=e.triplesContext)for(i=0;i<e.triplesContext.length;i++)(o=e.triplesContext[i]).graph=null,r.push(o);if(n&&0<n.length&&0<n[0].length&&(r=r.concat(n[0][0].quadsContext),null!=n[0][2]&&null!=n[0][2].triplesContext))for(i=0;i<n[0][2].triplesContext.length;i++)(o=n[0][2].triplesContext[i]).graph=null,r.push(o);e=r={token:"quads",quadsContext:r}}else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Ei),e}function C(){var e,r,n,i,o;for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(t.substr(kh,5)===pi?(n=pi,kh+=5):(n=Be,0===Ih&&a(di)),n===Be&&(t.substr(kh,5)===gi?(n=gi,kh+=5):(n=Be,0===Ih&&a(vi))),n!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if((r=ae())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(123===t.charCodeAt(kh)?(i=Dt,kh++):(i=Be,0===Ih&&a(Pt)),i!==Be){for(i=[],n=Se();n!==Be;)i.push(n),n=Se();if(i!==Be)if((n=O())===Be&&(n=null),n!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if(125===t.charCodeAt(kh)?(o=Ut,kh++):(o=Be,0===Ih&&a(Qt)),o!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be){if(e=r,r=n,n=[],null!=r)for(i=0;i<r.triplesContext.length;i++)(o=r.triplesContext[i]).graph=e,n.push(o);e=r={token:"quadsnottriples",quadsContext:n}}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Fi),e}function O(){var e,r,n,i,o,s,u;if(Ih++,e=kh,(r=Q())!==Be){for(n=kh,i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if(46===t.charCodeAt(kh)?(o=Ci,kh++):(o=Be,0===Ih&&a(Oi)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?((u=O())===Be&&(u=null),u!==Be?n=i=[i,o,s,u]:(kh=n,n=Be)):(kh=n,n=Be)}else kh=n,n=Be;else kh=n,n=Be;n===Be&&(n=null),n!==Be?(e=r.triplesContext,null!=n&&"object"==typeof n&&null!=n.length&&null!=n[3]&&null!=n[3].triplesContext&&(e=e.concat(n[3].triplesContext)),e=r={token:"triplestemplate",triplesContext:e}):(kh=e,e=Be)}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Si),e}function F(){var e,r,n,i;if(Ih++,e=kh,123===t.charCodeAt(kh)?(r=Dt,kh++):(r=Be,0===Ih&&a(Pt)),r!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();var o;if(n!==Be)if(Ih++,i=kh,(o=f())!==Be&&(r=d())!==Be&&(n=g())!==Be?(i=o,(o={kind:"select",token:"subselect"}).projection=i.vars,o.modifier=i.modifier,o.pattern=r,null!=n&&null!=n.limit&&(o.limit=n.limit),null!=n&&null!=n.offset&&(o.offset=n.offset),null!=n&&null!=n.order&&""!=n.order&&(o.order=n.order),null!=n&&null!=n.group&&(o.group=n.group),i=o):(kh=i,i=Be),Ih--,i===Be&&0===Ih&&a(it),(r=i)!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?(125===t.charCodeAt(kh)?(i=Ut,kh++):(i=Be,0===Ih&&a(Qt)),i!==Be?e=r:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be)if(e=kh,123===t.charCodeAt(kh)?(r=Dt,kh++):(r=Be,0===Ih&&a(Pt)),r!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be){var s,u,l,c,h;if(Ih++,n=kh,(r=S())===Be&&(r=null),r!==Be){for(o=[],i=Se();i!==Be;)o.push(i),i=Se();if(o!==Be){if(i=[],o=kh,(s=R())!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();if(u!==Be)if(46===t.charCodeAt(kh)?(l=Ci,kh++):(l=Be,0===Ih&&a(Oi)),l===Be&&(l=null),l!==Be){for(c=[],h=Se();h!==Be;)c.push(h),h=Se();c!==Be?((h=S())===Be&&(h=null),h!==Be?o=s=[s,u,l,c,h]:(kh=o,o=Be)):(kh=o,o=Be)}else kh=o,o=Be;else kh=o,o=Be}else kh=o,o=Be;for(;o!==Be;)if(i.push(o),o=kh,(s=R())!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();if(u!==Be)if(46===t.charCodeAt(kh)?(l=Ci,kh++):(l=Be,0===Ih&&a(Oi)),l===Be&&(l=null),l!==Be){for(c=[],h=Se();h!==Be;)c.push(h),h=Se();c!==Be?((h=S())===Be&&(h=null),h!==Be?o=s=[s,u,l,c,h]:(kh=o,o=Be)):(kh=o,o=Be)}else kh=o,o=Be;else kh=o,o=Be}else kh=o,o=Be;if(i!==Be){for(o=i,n=[],null!=r&&r!=[]&&n.push(r),r=0;r<o.length;r++)for(i=0;i<o[r].length;i++)null!=o[r][i]&&null!=o[r][i].token&&n.push(o[r][i]);for(o=[],s=[],u=[],l=[],r=0;r<n.length;r++)if("triplespattern"!==n[r].token&&"filter"!==n[r].token&&"bind"!==n[r].token){if(0!=s.length||0!=u.length){for(c=[],i=0;i<s.length;i++)c=c.concat(s[i].triplesContext);0<c.length&&o.push({token:"basicgraphpattern",triplesContext:c}),s=[]}o.push(n[r])}else"triplespattern"===n[r].token?s.push(n[r]):"bind"===n[r].token?l.push(n[r]):u.push(n[r]);if(0!=s.length||0!=u.length){for(c=[],i=0;i<s.length;i++)c=c.concat(s[i].triplesContext);0<c.length&&o.push({token:"basicgraphpattern",triplesContext:c})}n=r={token:"groupgraphpattern",patterns:o,filters:u,binds:l}}else kh=n,n=Be}else kh=n,n=Be}else kh=n,n=Be;if(Ih--,n===Be&&0===Ih&&a(Ti),(r=n)!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?(125===t.charCodeAt(kh)?(i=Ut,kh++):(i=Be,0===Ih&&a(Qt)),i!==Be?e=r:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Ri),e}function S(){var e,r,n,i,o,s;for(Ih++,e=kh,Ih++,n=kh,i=[],r=Se();r!==Be;)i.push(r),r=Se();if(i!==Be)if((r=se())!==Be){for(o=[],i=Se();i!==Be;)o.push(i),i=Se();if(o!==Be)if((i=H())!==Be){if(n=r,r=i.triplesContext,i.pairs)for(o=0;o<i.pairs.length;o++){var u=null;null!=(s=i.pairs[o])[1].length&&(s[1]=s[1][0]),n.token&&"triplesnodecollection"===n.token?("path"===(u={subject:n.chainSubject[0],predicate:s[0],object:s[1]}).predicate.token&&"element"===u.predicate.kind&&(u.predicate=u.predicate.value),r.push(u),r=r.concat(n.triplesContext)):("path"===(u={subject:n,predicate:s[0],object:s[1]}).predicate.token&&"element"===u.predicate.kind&&(u.predicate=u.predicate.value),r.push(u))}(i={token:"triplessamesubject"}).triplesContext=r,i.chainSubject=n,n=i}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be;if(n===Be){for(n=kh,i=[],r=Se();r!==Be;)i.push(r),r=Se();if(i!==Be)if((r=re())!==Be){for(o=[],i=Se();i!==Be;)o.push(i),i=Se();if(o!==Be){var l,c,f,h,p,d,g,v;if(Ih++,Ih++,s=kh,(u=V())===Be&&(u=$()),u!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if((o=W())!==Be){for(i=[],l=kh,c=[],f=Se();f!==Be;)c.push(f),f=Se();if(c!==Be)if(59===t.charCodeAt(kh)?(f=un,kh++):(f=Be,0===Ih&&a(ln)),f!==Be){for(h=[],p=Se();p!==Be;)h.push(p),p=Se();if(h!==Be){if(p=kh,(d=V())===Be&&(d=$()),d!==Be){for(g=[],v=Se();v!==Be;)g.push(v),v=Se();g!==Be&&(v=q())!==Be?p=d=[d,g,v]:(kh=p,p=Be)}else kh=p,p=Be;p===Be&&(p=null),p!==Be?l=c=[c,f,h,p]:(kh=l,l=Be)}else kh=l,l=Be}else kh=l,l=Be;else kh=l,l=Be;for(;l!==Be;){for(i.push(l),l=kh,c=[],f=Se();f!==Be;)c.push(f),f=Se();if(c!==Be)if(59===t.charCodeAt(kh)?(f=un,kh++):(f=Be,0===Ih&&a(ln)),f!==Be){for(h=[],p=Se();p!==Be;)h.push(p),p=Se();if(h!==Be){if(p=kh,(d=V())===Be&&(d=$()),d!==Be){for(g=[],v=Se();v!==Be;)g.push(v),v=Se();g!==Be&&(v=q())!==Be?p=d=[d,g,v]:(kh=p,p=Be)}else kh=p,p=Be;p===Be&&(p=null),p!==Be?l=c=[c,f,h,p]:(kh=l,l=Be)}else kh=l,l=Be}else kh=l,l=Be;else kh=l,l=Be}if(i!==Be){for(c=u,f=o,o={token:"propertylist"},s=[],u=[],l=0;l<f.length;l++)null!=f[l].triplesContext?(s=s.concat(f[l].triplesContext),u.push("triplesnodecollection"===f[l].token&&null!=f[l].chainSubject.length?[c,f[l].chainSubject[0]]:[c,f[l].chainSubject])):u.push([c,f[l]]);for(l=0;l<i.length;l++)for(c=(f=i[l][3])[0],f=f[2]||[],h=0;h<f.length;h++)null!=f[h].triplesContext?(s=s.concat(f[h].triplesContext),u.push([c,f[h].chainSubject])):u.push([c,f[h]]);o.pairs=u,o.triplesContext=s,s=o}else kh=s,s=Be}else kh=s,s=Be;else kh=s,s=Be}else kh=s,s=Be;if(Ih--,s===Be&&0===Ih&&a(Io),(i=s)===Be&&(i=null),Ih--,i===Be&&0===Ih&&a(Qo),i!==Be){if(o=i,r=(n=r).triplesContext,i=n.chainSubject,null!=o&&null!=o.pairs)for(s=0;s<o.pairs.length;s++)if(null!=(u=o.pairs[s])[1].length&&(u[1]=u[1][0]),"triplesnodecollection"===n.token)for(l=0;l<i.length;l++)null!=(c=i[l]).triplesContext?(f={subject:c.chainSubject,predicate:u[0],object:u[1]},r.concat(c.triplesContext)):r.push(f={subject:i[l],predicate:u[0],object:u[1]});else r.push(f={subject:i,predicate:u[0],object:u[1]});(n={token:"triplessamesubject"}).triplesContext=r,n.chainSubject=i}else kh=n,n=Be}else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}if(Ih--,n===Be&&0===Ih&&a(Po),(r=n)!==Be){for(n=kh,i=[],o=Se();o!==Be;)i.push(o),o=Se();i!==Be?(46===t.charCodeAt(kh)?(o=Ci,kh++):(o=Be,0===Ih&&a(Oi)),o!==Be?((s=S())===Be&&(s=null),s!==Be?n=i=[i,o,s]:(kh=n,n=Be)):(kh=n,n=Be)):(kh=n,n=Be),n===Be&&(n=null),n!==Be?(e=r.triplesContext,null!=n&&"object"==typeof n&&null!=n&&null!=n.length&&null!=n[2]&&null!=n[2].triplesContext&&(e=e.concat(n[2].triplesContext)),e=r={token:"triplespattern",triplesContext:e}):(kh=e,e=Be)}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Mi),e}function R(){var e,r,n,i,o,s,u,l;if(Ih++,Ih++,r=kh,(n=F())!==Be){for(e=[],i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(t.substr(kh,5)===Ki?(s=Ki,kh+=5):(s=Be,0===Ih&&a(Zi)),s===Be&&(t.substr(kh,5)===eo?(s=eo,kh+=5):(s=Be,0===Ih&&a(to))),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=F())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;for(;i!==Be;){for(e.push(i),i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(t.substr(kh,5)===Ki?(s=Ki,kh+=5):(s=Be,0===Ih&&a(Zi)),s===Be&&(t.substr(kh,5)===eo?(s=eo,kh+=5):(s=Be,0===Ih&&a(to))),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=F())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be}if(e!==Be){if(0!==e.length){for(r={token:"graphunionpattern",value:[n]},n=0;n<e.length;n++)n==e.length-1?r.value.push(e[n][3]):(r.value.push(e[n][3]),r={token:"graphunionpattern",value:[r]});n=r}r=n}else kh=r,r=Be}else kh=r,r=Be;if(Ih--,r===Be&&0===Ih&&a(Yi),(e=r)===Be){for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(t.substr(kh,8)===Pi?(n=Pi,kh+=8):(n=Be,0===Ih&&a(Ui)),n===Be&&(t.substr(kh,8)===Qi?(n=Qi,kh+=8):(n=Be,0===Ih&&a(Bi))),n!==Be){for(r=[],n=Se();n!==Be;)r.push(n),n=Se();r!==Be&&(n=F())!==Be?e=r={token:"optionalgraphpattern",value:n}:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be;if(Ih--,e===Be&&0===Ih&&a(Di),e===Be){if(Ih++,e=kh,t.substr(kh,5)===Hi?(r=Hi,kh+=5):(r=Be,0===Ih&&a(Vi)),r===Be&&(t.substr(kh,5)===$i?(r=$i,kh+=5):(r=Be,0===Ih&&a(Ji))),r!==Be){for(r=[],n=Se();n!==Be;)r.push(n),n=Se();r!==Be&&(n=F())!==Be?e=r={token:"minusgraphpattern",status:"todo",value:n}:(kh=e,e=Be)}else kh=e,e=Be;if(Ih--,e===Be&&0===Ih&&a(zi),e===Be){for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(t.substr(kh,5)===pi?(n=pi,kh+=5):(n=Be,0===Ih&&a(di)),n===Be&&(t.substr(kh,5)===gi?(n=gi,kh+=5):(n=Be,0===Ih&&a(vi))),n!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if((r=ae())!==Be){for(i=[],n=Se();n!==Be;)i.push(n),n=Se();if(i!==Be)if((n=F())!==Be){for(e=r,r=n,n=0;n<r.patterns.length;n++)for(i=r.patterns[n],o=0;o<i.triplesContext.length;o++)i.triplesContext[o].graph=e;r.token="groupgraphpattern",e=r}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;if(Ih--,e===Be&&0===Ih&&a(Wi),e===Be&&(Ih++,e=kh,t.substr(kh,7)===Xi?(r=Xi,kh+=7):(r=Be,0===Ih&&a(Gi)),r!==Be&&(r=ae())!==Be&&(n=F())!==Be?e=r={token:"servicegraphpattern",status:"todo",value:[r,n]}:(kh=e,e=Be),Ih--,e===Be&&0===Ih&&a(qi),e===Be)){for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(t.substr(kh,6)===no?(n=no,kh+=6):(n=Be,0===Ih&&a(io)),n===Be&&(t.substr(kh,6)===oo?(n=oo,kh+=6):(n=Be,0===Ih&&a(so))),n!==Be){for(r=[],n=Se();n!==Be;)r.push(n),n=Se();r!==Be&&(n=T())!==Be?e=r={token:"filter",value:n}:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be;if(Ih--,e===Be&&0===Ih&&a(ro),e===Be){for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(t.substr(kh,4)===uo?(n=uo,kh+=4):(n=Be,0===Ih&&a(lo)),n===Be&&(t.substr(kh,4)===co?(n=co,kh+=4):(n=Be,0===Ih&&a(fo))),n!==Be){for(r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(40===t.charCodeAt(kh)?(n=mt,kh++):(n=Be,0===Ih&&a(bt)),n!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if((r=le())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(t.substr(kh,2)===_t?(i=_t,kh+=2):(i=Be,0===Ih&&a(kt)),i===Be&&(t.substr(kh,2)===wt?(i=wt,kh+=2):(i=Be,0===Ih&&a(xt))),i!==Be){for(i=[],n=Se();n!==Be;)i.push(n),n=Se();if(i!==Be)if((n=ue())!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();i!==Be?(41===t.charCodeAt(kh)?(o=jt,kh++):(o=Be,0===Ih&&a(Lt)),o!==Be?e=r={token:"bind",expression:r,as:n}:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;if(Ih--,e===Be&&0===Ih&&a(ao),e===Be){for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(t.substr(kh,6)===tn?(n=tn,kh+=6):(n=Be,0===Ih&&a(rn)),n===Be&&(t.substr(kh,6)===nn?(n=nn,kh+=6):(n=Be,0===Ih&&a(on))),n!==Be){for(r=[],n=Se();n!==Be;)r.push(n),n=Se();r!==Be&&(n=M())!==Be?e=n:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be;Ih--,e===Be&&0===Ih&&a(po)}}}}}}return Ih--,e===Be&&0===Ih&&a(Ni),e}function T(){var e;return Ih++,(e=ve())===Be&&(e=ye())===Be&&(e=D()),Ih--,e===Be&&0===Ih&&a(ho),e}function M(){var e,r,n,i;for(Ih++,Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if((n=ue())!==Be){for(r=[],i=Se();i!==Be;)r.push(i),i=Se();if(r!==Be)if(123===t.charCodeAt(kh)?(i=Dt,kh++):(i=Be,0===Ih&&a(Pt)),i!==Be){for(i=[],r=Se();r!==Be;)i.push(r),r=Se();if(i!==Be){for(r=[],i=N();i!==Be;)r.push(i),i=N();r!==Be?(125===t.charCodeAt(kh)?(i=Ut,kh++):(i=Be,0===Ih&&a(Qt)),i!==Be?e=r={token:"inlineData",values:[{var:n,value:r}]}:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;if(Ih--,e===Be&&0===Ih&&a(vo),e===Be){var o,s,u,l,c,f,h;for(Ih++,e=kh,n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be){if((i=Fe())===Be)if(i=kh,40===t.charCodeAt(kh)?(o=mt,kh++):(o=Be,0===Ih&&a(bt)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be){for(u=[],n=ue();n!==Be;)u.push(n),n=ue();if(u!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();n!==Be?(41===t.charCodeAt(kh)?(r=jt,kh++):(r=Be,0===Ih&&a(Lt)),r!==Be?i=o=[o,s,u,n,r]:(kh=i,i=Be)):(kh=i,i=Be)}else kh=i,i=Be}else kh=i,i=Be}else kh=i,i=Be;if(i!==Be){for(o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(123===t.charCodeAt(kh)?(s=Dt,kh++):(s=Be,0===Ih&&a(Pt)),s!==Be){for(u=[],n=Se();n!==Be;)u.push(n),n=Se();if(u!==Be){for(n=[],r=kh,i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if(40===t.charCodeAt(kh)?(o=mt,kh++):(o=Be,0===Ih&&a(bt)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be){for(u=[],l=N();l!==Be;)u.push(l),l=N();if(u!==Be){for(l=[],c=Se();c!==Be;)l.push(c),c=Se();if(l!==Be)if(41===t.charCodeAt(kh)?(c=jt,kh++):(c=Be,0===Ih&&a(Lt)),c!==Be){for(f=[],h=Se();h!==Be;)f.push(h),h=Se();f!==Be?r=i=[i,o,s,u,l,c,f]:(kh=r,r=Be)}else kh=r,r=Be;else kh=r,r=Be}else kh=r,r=Be}else kh=r,r=Be}else kh=r,r=Be;else kh=r,r=Be;for(r===Be&&(r=Fe());r!==Be;){for(n.push(r),r=kh,i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if(40===t.charCodeAt(kh)?(o=mt,kh++):(o=Be,0===Ih&&a(bt)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be){for(u=[],l=N();l!==Be;)u.push(l),l=N();if(u!==Be){for(l=[],c=Se();c!==Be;)l.push(c),c=Se();if(l!==Be)if(41===t.charCodeAt(kh)?(c=jt,kh++):(c=Be,0===Ih&&a(Lt)),c!==Be){for(f=[],h=Se();h!==Be;)f.push(h),h=Se();f!==Be?r=i=[i,o,s,u,l,c,f]:(kh=r,r=Be)}else kh=r,r=Be;else kh=r,r=Be}else kh=r,r=Be}else kh=r,r=Be}else kh=r,r=Be;else kh=r,r=Be;r===Be&&(r=Fe())}if(n!==Be){for(r=[],i=Se();i!==Be;)r.push(i),i=Se();r!==Be?(125===t.charCodeAt(kh)?(i=Ut,kh++):(i=Be,0===Ih&&a(Qt)),i!==Be?e=n={token:"inlineData",values:[],todo:!0}:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;Ih--,e===Be&&0===Ih&&a(yo)}return Ih--,e===Be&&0===Ih&&a(go),e}function N(){var e,r,n,i;for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if((n=je())===Be&&(n=me())===Be&&(n=be())===Be&&(n=xe())===Be&&(t.substr(kh,5)===Kr?(n=Kr,kh+=5):(n=Be,0===Ih&&a(Zr))),n!==Be){for(r=[],i=Se();i!==Be;)r.push(i),i=Se();r!==Be?e=n:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(mo),e}function D(){var e,t,r,n;if(Ih++,e=kh,(t=ke())!==Be){for(r=[],n=Se();n!==Be;)r.push(n),n=Se();r!==Be&&(n=P())!==Be?((e={token:"expression",expressionType:"irireforfunction"}).iriref=t,e.args=n.value):(kh=e,e=Be)}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(bo),e}function P(){var e,r,n,i,o,s,u,l;if(Ih++,(r=Fe())!==Be&&(r={token:"args",value:[]}),(e=r)===Be)if(e=kh,40===t.charCodeAt(kh)?(r=mt,kh++):(r=Be,0===Ih&&a(bt)),r!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if(t.substr(kh,8)===ct?(r=ct,kh+=8):(r=Be,0===Ih&&a(ft)),r===Be&&(t.substr(kh,8)===ht?(r=ht,kh+=8):(r=Be,0===Ih&&a(pt))),r===Be&&(r=null),r!==Be){for(i=[],n=Se();n!==Be;)i.push(n),n=Se();if(i!==Be)if((n=le())!==Be){for(o=[],i=Se();i!==Be;)o.push(i),i=Se();if(o!==Be){if(i=[],o=kh,44===t.charCodeAt(kh)?(s=xo,kh++):(s=Be,0===Ih&&a(_o)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=le())!==Be?o=s=[s,u,l]:(kh=o,o=Be)}else kh=o,o=Be;for(;o!==Be;)if(i.push(o),o=kh,44===t.charCodeAt(kh)?(s=xo,kh++):(s=Be,0===Ih&&a(_o)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=le())!==Be?o=s=[s,u,l]:(kh=o,o=Be)}else kh=o,o=Be;if(i!==Be)if(41===t.charCodeAt(kh)?(o=jt,kh++):(o=Be,0===Ih&&a(Lt)),o!==Be){for(e=r,r=n,n=[],o=0;o<i.length;o++)n.push(i[o][2]);(i={token:"args"}).value=[r].concat(n),i.distinct=null!=e&&"DISTINCT"===e.toUpperCase(),e=i}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(wo),e}function U(){var e,r,n,i,o,s,u;if(Ih++,(r=Fe())!==Be&&(r={token:"args",value:[]}),(e=r)===Be)if(e=kh,40===t.charCodeAt(kh)?(r=mt,kh++):(r=Be,0===Ih&&a(bt)),r!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if((r=ke())===Be&&(r=le()),r!==Be){for(i=[],n=Se();n!==Be;)i.push(n),n=Se();if(i!==Be){if(n=[],i=kh,44===t.charCodeAt(kh)?(o=xo,kh++):(o=Be,0===Ih&&a(_o)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?((u=ke())===Be&&(u=le()),u!==Be?i=o=[o,s,u]:(kh=i,i=Be)):(kh=i,i=Be)}else kh=i,i=Be;for(;i!==Be;)if(n.push(i),i=kh,44===t.charCodeAt(kh)?(o=xo,kh++):(o=Be,0===Ih&&a(_o)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?((u=ke())===Be&&(u=le()),u!==Be?i=o=[o,s,u]:(kh=i,i=Be)):(kh=i,i=Be)}else kh=i,i=Be;if(n!==Be)if(41===t.charCodeAt(kh)?(i=jt,kh++):(i=Be,0===Ih&&a(Lt)),i!==Be){for(e=r,r=[],i=0;i<n.length;i++)r.push(n[i][2]);(n={token:"args"}).value=[e].concat(r),e=n}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(ko),e}function Q(){var e,t,r,n;for(Ih++,e=kh,t=[],r=Se();r!==Be;)t.push(r),r=Se();if(t!==Be)if((r=se())!==Be){for(n=[],t=Se();t!==Be;)n.push(t),t=Se();if(n!==Be)if((t=B())!==Be){if(e=t.triplesContext,t.pairs)for(n=0;n<t.pairs.length;n++){var i=t.pairs[n],o=null;null!=i[1].length&&(i[1]=i[1][0]),r.token&&"triplesnodecollection"===r.token?(e.push(o={subject:r.chainSubject[0],predicate:i[0],object:i[1]}),e=e.concat(r.triplesContext)):e.push(o={subject:r,predicate:i[0],object:i[1]})}(t={token:"triplessamesubject"}).triplesContext=e,t.chainSubject=r,e=t}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;if(e===Be){for(e=kh,t=[],r=Se();r!==Be;)t.push(r),r=Se();if(t!==Be)if((r=ne())!==Be){for(n=[],t=Se();t!==Be;)n.push(t),t=Se();if(n!==Be)if(Ih++,(t=B())===Be&&(t=null),Ih--,t===Be&&0===Ih&&a(Co),t!==Be){if(n=t,e=r.triplesContext,t=r.chainSubject,n.pairs)for(i=0;i<n.pairs.length;i++)if(null!=(o=n.pairs[i])[1].length&&(o[1]=o[1][0]),"triplesnodecollection"===r.token)for(var s=0;s<t.length;s++){var u=t[s];null!=u.triplesContext?e.concat(u.triplesContext):e.push({subject:t[s],predicate:o[0],object:o[1]})}else e.push({subject:t,predicate:o[0],object:o[1]});(r={token:"triplessamesubject"}).triplesContext=e,r.chainSubject=t,e=r}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}return Ih--,e===Be&&0===Ih&&a(Ao),e}function B(){var e,r,n,i,o,s,u,l,c,f,h,p;if(Ih++,e=kh,(r=z())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if((i=q())!==Be){for(n=[],o=kh,s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be)if(59===t.charCodeAt(kh)?(u=un,kh++):(u=Be,0===Ih&&a(ln)),u!==Be){for(l=[],c=Se();c!==Be;)l.push(c),c=Se();if(l!==Be){if(c=kh,(f=z())!==Be){for(h=[],p=Se();p!==Be;)h.push(p),p=Se();h!==Be&&(p=q())!==Be?c=f=[f,h,p]:(kh=c,c=Be)}else kh=c,c=Be;c===Be&&(c=null),c!==Be?o=s=[s,u,l,c]:(kh=o,o=Be)}else kh=o,o=Be}else kh=o,o=Be;else kh=o,o=Be;for(;o!==Be;){for(n.push(o),o=kh,s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be)if(59===t.charCodeAt(kh)?(u=un,kh++):(u=Be,0===Ih&&a(ln)),u!==Be){for(l=[],c=Se();c!==Be;)l.push(c),c=Se();if(l!==Be){if(c=kh,(f=z())!==Be){for(h=[],p=Se();p!==Be;)h.push(p),p=Se();h!==Be&&(p=q())!==Be?c=f=[f,h,p]:(kh=c,c=Be)}else kh=c,c=Be;c===Be&&(c=null),c!==Be?o=s=[s,u,l,c]:(kh=o,o=Be)}else kh=o,o=Be}else kh=o,o=Be;else kh=o,o=Be}if(n!==Be){for(s=r,u=i,i={token:"propertylist"},e=[],r=[],o=0;o<u.length;o++)null!=u[o].triplesContext?(e=e.concat(u[o].triplesContext),r.push("triplesnodecollection"===u[o].token&&null!=u[o].chainSubject.length?[s,u[o].chainSubject[0]]:[s,u[o].chainSubject])):r.push([s,u[o]]);for(o=0;o<n.length;o++)for(s=(u=n[o][3])[0],u=u[2]||[],l=0;l<u.length;l++)null!=u[l].triplesContext?(e=e.concat(u[l].triplesContext),r.push([s,u[l].chainSubject])):r.push([s,u[l]]);i.pairs=r,i.triplesContext=e,e=i}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Eo),e}function W(){var e,r,n,i,o,s,u;if(Ih++,e=kh,(r=X())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be){if(i=[],n=kh,44===t.charCodeAt(kh)?(o=xo,kh++):(o=Be,0===Ih&&a(_o)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be&&(u=X())!==Be?n=o=[o,s,u]:(kh=n,n=Be)}else kh=n,n=Be;for(;n!==Be;)if(i.push(n),n=kh,44===t.charCodeAt(kh)?(o=xo,kh++):(o=Be,0===Ih&&a(_o)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be&&(u=X())!==Be?n=o=[o,s,u]:(kh=n,n=Be)}else kh=n,n=Be;if(i!==Be){for(e=i,(i=[]).push(r),r=0;r<e.length;r++)for(n=0;n<e[r].length;n++)"object"==typeof e[r][n]&&null!=e[r][n].token&&i.push(e[r][n]);e=i}else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Oo),e}function q(){var e,r,n,i,o,s,u;if(Ih++,e=kh,(r=G())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be){if(i=[],n=kh,44===t.charCodeAt(kh)?(o=xo,kh++):(o=Be,0===Ih&&a(_o)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be&&(u=G())!==Be?n=o=[o,s,u]:(kh=n,n=Be)}else kh=n,n=Be;for(;n!==Be;)if(i.push(n),n=kh,44===t.charCodeAt(kh)?(o=xo,kh++):(o=Be,0===Ih&&a(_o)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be&&(u=G())!==Be?n=o=[o,s,u]:(kh=n,n=Be)}else kh=n,n=Be;if(i!==Be){for(e=i,(i=[]).push(r),r=0;r<e.length;r++)for(n=0;n<e[r].length;n++)"object"==typeof e[r][n]&&null!=e[r][n].token&&i.push(e[r][n]);e=i}else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Fo),e}function X(){var e;return Ih++,e=ie(),Ih--,e===Be&&0===Ih&&a(So),e}function G(){var e;return Ih++,e=oe(),Ih--,e===Be&&0===Ih&&a(Ro),e}function z(){var e;return Ih++,(e=ae())===Be&&(97===t.charCodeAt(kh)?(e=Mo,kh++):(e=Be,0===Ih&&a(No)),e!==Be&&(e=Do())),Ih--,e===Be&&0===Ih&&a(To),e}function H(){var e,r,n,i,o,s,u,l,c,f,h;if(Ih++,e=kh,(r=V())===Be&&(r=$()),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if((i=W())!==Be){for(n=[],o=kh,s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be)if(59===t.charCodeAt(kh)?(u=un,kh++):(u=Be,0===Ih&&a(ln)),u!==Be){for(l=[],c=Se();c!==Be;)l.push(c),c=Se();l!==Be?(c=kh,(f=V())===Be&&(f=$()),f!==Be&&(h=q())!==Be?c=f=[f,h]:(kh=c,c=Be),c===Be&&(c=null),c!==Be?o=s=[s,u,l,c]:(kh=o,o=Be)):(kh=o,o=Be)}else kh=o,o=Be;else kh=o,o=Be;for(;o!==Be;){for(n.push(o),o=kh,s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be)if(59===t.charCodeAt(kh)?(u=un,kh++):(u=Be,0===Ih&&a(ln)),u!==Be){for(l=[],c=Se();c!==Be;)l.push(c),c=Se();l!==Be?(c=kh,(f=V())===Be&&(f=$()),f!==Be&&(h=q())!==Be?c=f=[f,h]:(kh=c,c=Be),c===Be&&(c=null),c!==Be?o=s=[s,u,l,c]:(kh=o,o=Be)):(kh=o,o=Be)}else kh=o,o=Be;else kh=o,o=Be}if(n!==Be){for(s=r,u=i,i={token:"propertylist"},e=[],r=[],o=0;o<u.length;o++)null!=u[o].triplesContext?(e=e.concat(u[o].triplesContext),r.push("triplesnodecollection"===u[o].token&&null!=u[o].chainSubject.length?[s,u[o].chainSubject[0]]:[s,u[o].chainSubject])):r.push([s,u[o]]);for(o=0;o<n.length;o++)for(s=(u=n[o][3])[0],u=u[1]||[],l=0;l<u.length;l++)null!=u[l].triplesContext?(e=e.concat(u[l].triplesContext),r.push([s,u[l].chainSubject])):r.push([s,u[l]]);i.pairs=r,i.triplesContext=e,e=i}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Uo),e}function V(){var e;return Ih++,e=J(),Ih--,e===Be&&0===Ih&&a(Bo),e}function $(){var e;return Ih++,e=ue(),Ih--,e===Be&&0===Ih&&a(Wo),e}function J(){var e,r,n,i,o,s;if(Ih++,Ih++,r=kh,(n=Y())!==Be){for(e=[],i=kh,124===t.charCodeAt(kh)?(o=Go,kh++):(o=Be,0===Ih&&a(zo)),o!==Be&&(s=Y())!==Be?i=o=[o,s]:(kh=i,i=Be);i!==Be;)e.push(i),i=kh,124===t.charCodeAt(kh)?(o=Go,kh++):(o=Be,0===Ih&&a(zo)),o!==Be&&(s=Y())!==Be?i=o=[o,s]:(kh=i,i=Be);if(e!==Be){if(null!=e&&0!==e.length){for(r=[],n=0;n<e.length;n++)r.push(e[1]);(e={token:"path",kind:"alternative"}).value=r,n=e}r=n}else kh=r,r=Be}else kh=r,r=Be;return Ih--,r===Be&&0===Ih&&a(Xo),Ih--,(e=r)===Be&&0===Ih&&a(qo),e}function Y(){var e,r,n,i,o,s;if(Ih++,e=kh,(r=Z())!==Be){for(n=[],i=kh,47===t.charCodeAt(kh)?(o=Vo,kh++):(o=Be,0===Ih&&a($o)),o!==Be&&(s=Z())!==Be?i=o=[o,s]:(kh=i,i=Be);i!==Be;)n.push(i),i=kh,47===t.charCodeAt(kh)?(o=Vo,kh++):(o=Be,0===Ih&&a($o)),o!==Be&&(s=Z())!==Be?i=o=[o,s]:(kh=i,i=Be);if(n!==Be){if(null!=n&&0!==n.length){for(e=[r],r=0;r<n.length;r++)e.push(n[r][1]);(n={token:"path",kind:"sequence"}).value=e,r=n}e=r}else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Ho),e}function K(){var e,r,n,i;if(Ih++,e=kh,Ih++,(r=ke())===Be&&(97===t.charCodeAt(kh)?(n=Mo,kh++):(n=Be,0===Ih&&a(No)),n!==Be&&(n=Do()),(r=n)===Be)){if(r=kh,33===t.charCodeAt(kh)?(n=ss,kh++):(n=Be,0===Ih&&a(as)),n!==Be){var o,s,u,l,c,f,h;if((i=ee())===Be)if(i=kh,40===t.charCodeAt(kh)?(o=mt,kh++):(o=Be,0===Ih&&a(bt)),o!==Be){if(s=kh,(u=ee())!==Be){for(l=[],c=kh,124===t.charCodeAt(kh)?(f=Go,kh++):(f=Be,0===Ih&&a(zo)),f!==Be&&(h=ee())!==Be?c=f=[f,h]:(kh=c,c=Be);c!==Be;)l.push(c),c=kh,124===t.charCodeAt(kh)?(f=Go,kh++):(f=Be,0===Ih&&a(zo)),f!==Be&&(h=ee())!==Be?c=f=[f,h]:(kh=c,c=Be);l!==Be?s=u=[u,l]:(kh=s,s=Be)}else kh=s,s=Be;s===Be&&(s=null),s!==Be?(41===t.charCodeAt(kh)?(u=jt,kh++):(u=Be,0===Ih&&a(Lt)),u!==Be?i=o=[o,s,u]:(kh=i,i=Be)):(kh=i,i=Be)}else kh=i,i=Be;i!==Be?r=n=[n,i]:(kh=r,r=Be)}else kh=r,r=Be;r===Be&&(r=kh,40===t.charCodeAt(kh)?(n=mt,kh++):(n=Be,0===Ih&&a(bt)),n!==Be&&(i=J())!==Be?(41===t.charCodeAt(kh)?(n=jt,kh++):(n=Be,0===Ih&&a(Lt)),n!==Be?r=i:(kh=r,r=Be)):(kh=r,r=Be))}if(Ih--,r===Be&&0===Ih&&a(os),r!==Be)if(Ih++,42===t.charCodeAt(kh)?(n=At,kh++):(n=Be,0===Ih&&a(It)),n===Be&&(63===t.charCodeAt(kh)?(n=ts,kh++):(n=Be,0===Ih&&a(rs)),n===Be&&(43===t.charCodeAt(kh)?(n=ns,kh++):(n=Be,0===Ih&&a(is)),n===Be&&(n=kh,123===t.charCodeAt(kh)?(i=Dt,kh++):(i=Be,0===Ih&&a(Pt)),i!==Be?(o=kh,(s=te())!==Be?(u=kh,44===t.charCodeAt(kh)?(l=xo,kh++):(l=Be,0===Ih&&a(_o)),l!==Be?(125===t.charCodeAt(kh)?(c=Ut,kh++):(c=Be,0===Ih&&a(Qt)),c===Be&&(c=kh,(f=te())!==Be?(125===t.charCodeAt(kh)?(h=Ut,kh++):(h=Be,0===Ih&&a(Qt)),h!==Be?c=f=[f,h]:(kh=c,c=Be)):(kh=c,c=Be)),c!==Be?u=l=[l,c]:(kh=u,u=Be)):(kh=u,u=Be),u===Be&&(125===t.charCodeAt(kh)?(u=Ut,kh++):(u=Be,0===Ih&&a(Qt))),u!==Be?o=s=[s,u]:(kh=o,o=Be)):(kh=o,o=Be),o===Be&&(o=kh,44===t.charCodeAt(kh)?(s=xo,kh++):(s=Be,0===Ih&&a(_o)),s!==Be&&(u=te())!==Be?(125===t.charCodeAt(kh)?(l=Ut,kh++):(l=Be,0===Ih&&a(Qt)),l!==Be?o=s=[s,u,l]:(kh=o,o=Be)):(kh=o,o=Be)),o!==Be?n=i=[i,o]:(kh=n,n=Be)):(kh=n,n=Be)))),Ih--,n===Be&&0===Ih&&a(es),n===Be&&(n=null),n!==Be){if(e=r,r=n,e.token&&"path"!=e.token&&""==r)r=e;else if(e.token&&e.token!=p&&""!=r){var p={token:"path",kind:"element"};p.value=e,p.modifier=r,r=p}else e.modifier=r,r=e;e=r}else kh=e,e=Be;else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Jo),e}function Z(){var e,r;return Ih++,(e=K())===Be&&(e=kh,94===t.charCodeAt(kh)?(r=Ko,kh++):(r=Be,0===Ih&&a(Zo)),r!==Be&&(r=K())!==Be?(e={token:"path",kind:"inversePath"}).value=r:(kh=e,e=Be)),Ih--,e===Be&&0===Ih&&a(Yo),e}function ee(){var e,r,n;return Ih++,(e=ke())===Be&&(97===t.charCodeAt(kh)?(e=Mo,kh++):(e=Be,0===Ih&&a(No)),e===Be&&(e=kh,94===t.charCodeAt(kh)?(r=Ko,kh++):(r=Be,0===Ih&&a(Zo)),r!==Be?((n=ke())===Be&&(97===t.charCodeAt(kh)?(n=Mo,kh++):(n=Be,0===Ih&&a(No))),n!==Be?e=r=[r,n]:(kh=e,e=Be)):(kh=e,e=Be))),Ih--,e===Be&&0===Ih&&a(us),e}function te(){var e;return Ih++,e=Ae(),Ih--,e===Be&&0===Ih&&a(ls),e}function re(){var e,r,n,i;for(Ih++,Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(40===t.charCodeAt(kh)?(n=mt,kh++):(n=Be,0===Ih&&a(bt)),n!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be){if(r=[],(n=ie())!==Be)for(;n!==Be;)r.push(n),n=ie();else r=Be;if(r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(41===t.charCodeAt(kh)?(i=jt,kh++):(i=Be,0===Ih&&a(Lt)),i!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?e=r:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;if(Ih--,e===Be&&0===Ih&&a(ms),e!==Be){r=[],n=[];var o=null;for(i=0;i<e.length;i++)Ch++,o=null,null==e[i].chainSubject&&null==e[i].triplesContext?o=e[i]:(o=e[i].chainSubject,r=r.concat(e[i].triplesContext)),o={subject:{token:"blank",value:"_:"+Ch},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:o},0==i&&n.push(o.subject),r.push(o),r.push(o=i===e.length-1?{subject:{token:"blank",value:"_:"+Ch},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+Ch},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(Ch+1)}});e={token:"triplesnodecollection",triplesContext:r,chainSubject:n}}if(e===Be){for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(91===t.charCodeAt(kh)?(n=ps,kh++):(n=Be,0===Ih&&a(ds)),n!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if((r=H())!==Be)if(93===t.charCodeAt(kh)?(n=gs,kh++):(n=Be,0===Ih&&a(vs)),n!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be){for(e=r,r={token:"blank",value:"_:"+ ++Ch},n=[],i=0;i<e.pairs.length;i++){o=e.pairs[i];var s={};s.subject=r,s.predicate=o[0],null!=o[1].length&&(o[1]=o[1][0]),s.object=o[1],n.push(s)}e=r={token:"triplesnode",kind:"blanknodepropertylist",triplesContext:e.triplesContext.concat(n),chainSubject:r}}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;Ih--,e===Be&&0===Ih&&a(hs)}return Ih--,e===Be&&0===Ih&&a(cs),e}function ne(){var e,r,n,i;for(Ih++,Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(40===t.charCodeAt(kh)?(n=mt,kh++):(n=Be,0===Ih&&a(bt)),n!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be){if(r=[],(n=oe())!==Be)for(;n!==Be;)r.push(n),n=oe();else r=Be;if(r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(41===t.charCodeAt(kh)?(i=jt,kh++):(i=Be,0===Ih&&a(Lt)),i!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?e=r:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;if(Ih--,e===Be&&0===Ih&&a(bs),e!==Be){r=[],n=[];var o=null;for(i=0;i<e.length;i++)Ch++,o=null,null==e[i].chainSubject&&null==e[i].triplesContext?o=e[i]:r=r.concat((o=e[i].chainSubject).triplesContext),o={subject:{token:"blank",value:"_:"+Ch},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:o},0==i&&n.push(o.subject),r.push(o),r.push(o=i===e.length-1?{subject:{token:"blank",value:"_:"+Ch},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+Ch},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(Ch+1)}});e={token:"triplesnodecollection",triplesContext:r,chainSubject:n}}if(e===Be){for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(91===t.charCodeAt(kh)?(n=ps,kh++):(n=Be,0===Ih&&a(ds)),n!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if((r=B())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(93===t.charCodeAt(kh)?(i=gs,kh++):(i=Be,0===Ih&&a(vs)),i!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be){for(e=r,r={token:"blank",value:"_:"+ ++Ch},n=[],i=0;i<e.pairs.length;i++){o=e.pairs[i];var s={};s.subject=r,s.predicate=o[0],null!=o[1].length&&(o[1]=o[1][0]),s.object=o[1],n.push(s)}e=r={token:"triplesnode",kind:"blanknodepropertylist",triplesContext:e.triplesContext.concat(n),chainSubject:r}}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be;Ih--,e===Be&&0===Ih&&a(ys)}return Ih--,e===Be&&0===Ih&&a(fs),e}function ie(){var e,t,r,n,i;for(Ih++,e=kh,t=[],r=Se();r!==Be;)t.push(r),r=Se();if(t!==Be)if((r=se())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?e=t=[t,r,n]:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be;if(e===Be){for(e=kh,t=[],r=Se();r!==Be;)t.push(r),r=Se();if(t!==Be)if((r=re())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?e=t=[t,r,n]:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}return e!==Be&&(e=e[1]),Ih--,e===Be&&0===Ih&&a(ws),e}function oe(){var e,t,r,n,i;for(Ih++,e=kh,t=[],r=Se();r!==Be;)t.push(r),r=Se();if(t!==Be)if((r=se())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?e=t=[t,r,n]:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be;if(e===Be){for(e=kh,t=[],r=Se();r!==Be;)t.push(r),r=Se();if(t!==Be)if((r=ne())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?e=t=[t,r,n]:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}return e!==Be&&(e=e[1]),Ih--,e===Be&&0===Ih&&a(xs),e}function se(){var e;if(Ih++,(e=ue())===Be){if(Ih++,(e=ke())===Be&&(e=me())===Be&&(e=be())===Be&&(e=xe())===Be){var r;if(Ih++,Ih++,e=kh,t.substr(kh,2)===rc?(r=rc,kh+=2):(r=Be,0===Ih&&a(nc)),r!==Be&&(r=De())!==Be?e=r:(kh=e,e=Be),Ih--,e===Be&&0===Ih&&a(tc),e!==Be&&(e={token:"blank",value:e}),e===Be){var n,i;if(Ih++,e=kh,91===t.charCodeAt(kh)?(r=ps,kh++):(r=Be,0===Ih&&a(ds)),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?(93===t.charCodeAt(kh)?(i=gs,kh++):(i=Be,0===Ih&&a(vs)),i!==Be?e=r=[r,n,i]:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;Ih--,e===Be&&0===Ih&&a(wf),e!==Be&&(e={token:"blank",value:"_:"+ ++Ch})}Ih--,e===Be&&0===Ih&&a(Hl),e===Be&&(e=Fe())}Ih--,e===Be&&0===Ih&&a(Ls)}return Ih--,e===Be&&0===Ih&&a(_s),e}function ae(){var e;return Ih++,(e=ue())===Be&&(e=ke()),Ih--,e===Be&&0===Ih&&a(ks),e}function ue(){var e,r,n,i;for(Ih++,e=kh,r=[],n=Se();n!==Be;)r.push(n),n=Se();if(r!==Be)if(Ih++,n=kh,63===t.charCodeAt(kh)?(r=ts,kh++):(r=Be,0===Ih&&a(rs)),r!==Be&&(r=Me())!==Be?n=r:(kh=n,n=Be),Ih--,n===Be&&0===Ih&&a(ic),n===Be&&(Ih++,n=kh,36===t.charCodeAt(kh)?(r=sc,kh++):(r=Be,0===Ih&&a(ac)),r!==Be&&(r=Me())!==Be?n=r:(kh=n,n=Be),Ih--,n===Be&&0===Ih&&a(oc)),n!==Be){for(r=[],i=Se();i!==Be;)r.push(i),i=Se();r!==Be?(e={token:"var"}).value=n:(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(js),e}function le(){var e,r,n,i,o,s,u,l;if(Ih++,Ih++,r=kh,(n=ce())!==Be){for(e=[],i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(t.substr(kh,2)===Es?(s=Es,kh+=2):(s=Be,0===Ih&&a(Cs)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=ce())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;for(;i!==Be;){for(e.push(i),i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(t.substr(kh,2)===Es?(s=Es,kh+=2):(s=Be,0===Ih&&a(Cs)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=ce())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be}if(e!==Be){if(0!==e.length){for(r={token:"expression",expressionType:"conditionalor"},n=[n],i=0;i<e.length;i++)n.push(e[i][3]);r.operands=n,n=r}r=n}else kh=r,r=Be}else kh=r,r=Be;return Ih--,r===Be&&0===Ih&&a(Is),Ih--,(e=r)===Be&&0===Ih&&a(As),e}function ce(){var e,r,n,i,o,s,u,l;if(Ih++,e=kh,(r=fe())!==Be){for(n=[],i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(t.substr(kh,2)===Fs?(s=Fs,kh+=2):(s=Be,0===Ih&&a(Ss)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=fe())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;for(;i!==Be;){for(n.push(i),i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(t.substr(kh,2)===Fs?(s=Fs,kh+=2):(s=Be,0===Ih&&a(Ss)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=fe())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be}if(n!==Be){if(0!==n.length){for(e={token:"expression",expressionType:"conditionaland"},r=[r],i=0;i<n.length;i++)r.push(n[i][3]);e.operands=r,r=e}e=r}else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Os),e}function fe(){var e,r,n,i,o,s,u,l,c,f,h,p,d;if(Ih++,Ih++,r=kh,(n=he())!==Be){for(e=[],i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(61===t.charCodeAt(kh)?(s=Ms,kh++):(s=Be,0===Ih&&a(Ns)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=he())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(t.substr(kh,2)===Ds?(s=Ds,kh+=2):(s=Be,0===Ih&&a(Ps)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=he())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(60===t.charCodeAt(kh)?(s=Us,kh++):(s=Be,0===Ih&&a(Qs)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=he())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(62===t.charCodeAt(kh)?(s=Bs,kh++):(s=Be,0===Ih&&a(Ws)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=he())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(t.substr(kh,2)===qs?(s=qs,kh+=2):(s=Be,0===Ih&&a(Xs)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=he())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(t.substr(kh,2)===Gs?(s=Gs,kh+=2):(s=Be,0===Ih&&a(zs)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=he())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(73===t.charCodeAt(kh)?(s=Hs,kh++):(s=Be,0===Ih&&a(Vs)),s===Be&&(105===t.charCodeAt(kh)?(s=$s,kh++):(s=Be,0===Ih&&a(Js))),s!==Be)if(78===t.charCodeAt(kh)?(u=Ys,kh++):(u=Be,0===Ih&&a(Ks)),u===Be&&(110===t.charCodeAt(kh)?(u=Zs,kh++):(u=Be,0===Ih&&a(ea))),u!==Be){for(l=[],c=Se();c!==Be;)l.push(c),c=Se();l!==Be&&(c=U())!==Be?i=o=[o,s,u,l,c]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(78===t.charCodeAt(kh)?(s=Ys,kh++):(s=Be,0===Ih&&a(Ks)),s===Be&&(110===t.charCodeAt(kh)?(s=Zs,kh++):(s=Be,0===Ih&&a(ea))),s!==Be)if(79===t.charCodeAt(kh)?(u=ta,kh++):(u=Be,0===Ih&&a(ra)),u===Be&&(111===t.charCodeAt(kh)?(u=na,kh++):(u=Be,0===Ih&&a(ia))),u!==Be)if(84===t.charCodeAt(kh)?(l=oa,kh++):(l=Be,0===Ih&&a(sa)),l===Be&&(116===t.charCodeAt(kh)?(l=aa,kh++):(l=Be,0===Ih&&a(ua))),l!==Be){for(c=[],f=Se();f!==Be;)c.push(f),f=Se();if(c!==Be)if(73===t.charCodeAt(kh)?(f=Hs,kh++):(f=Be,0===Ih&&a(Vs)),f===Be&&(105===t.charCodeAt(kh)?(f=$s,kh++):(f=Be,0===Ih&&a(Js))),f!==Be)if(78===t.charCodeAt(kh)?(h=Ys,kh++):(h=Be,0===Ih&&a(Ks)),h===Be&&(110===t.charCodeAt(kh)?(h=Zs,kh++):(h=Be,0===Ih&&a(ea))),h!==Be){for(p=[],d=Se();d!==Be;)p.push(d),d=Se();p!==Be&&(d=U())!==Be?i=o=[o,s,u,l,c,f,h,p,d]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be;else kh=i,i=Be;else kh=i,i=Be}}}}}}}for(;i!==Be;){for(e.push(i),i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(61===t.charCodeAt(kh)?(s=Ms,kh++):(s=Be,0===Ih&&a(Ns)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=he())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(t.substr(kh,2)===Ds?(s=Ds,kh+=2):(s=Be,0===Ih&&a(Ps)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=he())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(60===t.charCodeAt(kh)?(s=Us,kh++):(s=Be,0===Ih&&a(Qs)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=he())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(62===t.charCodeAt(kh)?(s=Bs,kh++):(s=Be,0===Ih&&a(Ws)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=he())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(t.substr(kh,2)===qs?(s=qs,kh+=2):(s=Be,0===Ih&&a(Xs)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=he())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(t.substr(kh,2)===Gs?(s=Gs,kh+=2):(s=Be,0===Ih&&a(zs)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=he())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(73===t.charCodeAt(kh)?(s=Hs,kh++):(s=Be,0===Ih&&a(Vs)),s===Be&&(105===t.charCodeAt(kh)?(s=$s,kh++):(s=Be,0===Ih&&a(Js))),s!==Be)if(78===t.charCodeAt(kh)?(u=Ys,kh++):(u=Be,0===Ih&&a(Ks)),u===Be&&(110===t.charCodeAt(kh)?(u=Zs,kh++):(u=Be,0===Ih&&a(ea))),u!==Be){for(l=[],c=Se();c!==Be;)l.push(c),c=Se();l!==Be&&(c=U())!==Be?i=o=[o,s,u,l,c]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(78===t.charCodeAt(kh)?(s=Ys,kh++):(s=Be,0===Ih&&a(Ks)),s===Be&&(110===t.charCodeAt(kh)?(s=Zs,kh++):(s=Be,0===Ih&&a(ea))),s!==Be)if(79===t.charCodeAt(kh)?(u=ta,kh++):(u=Be,0===Ih&&a(ra)),u===Be&&(111===t.charCodeAt(kh)?(u=na,kh++):(u=Be,0===Ih&&a(ia))),u!==Be)if(84===t.charCodeAt(kh)?(l=oa,kh++):(l=Be,0===Ih&&a(sa)),l===Be&&(116===t.charCodeAt(kh)?(l=aa,kh++):(l=Be,0===Ih&&a(ua))),l!==Be){for(c=[],f=Se();f!==Be;)c.push(f),f=Se();if(c!==Be)if(73===t.charCodeAt(kh)?(f=Hs,kh++):(f=Be,0===Ih&&a(Vs)),f===Be&&(105===t.charCodeAt(kh)?(f=$s,kh++):(f=Be,0===Ih&&a(Js))),f!==Be)if(78===t.charCodeAt(kh)?(h=Ys,kh++):(h=Be,0===Ih&&a(Ks)),h===Be&&(110===t.charCodeAt(kh)?(h=Zs,kh++):(h=Be,0===Ih&&a(ea))),h!==Be){for(p=[],d=Se();d!==Be;)p.push(d),d=Se();p!==Be&&(d=U())!==Be?i=o=[o,s,u,l,c,f,h,p,d]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be;else kh=i,i=Be;else kh=i,i=Be}}}}}}}}if(e!==Be){if(r=n,0===e.length)n=r;else if("i"===e[0][1]||"I"===e[0][1]||"n"===e[0][1]||"N"===e[0][1]){for(n={},"i"===e[0][1]||"I"===e[0][1]?(i="=",n.expressionType="conditionalor"):(i="!=",n.expressionType="conditionaland"),o=[],s=0;s<e[0].length;s++)if("args"===e[0][s].token){o=e[0][s].value;break}for(n.token="expression",n.operands=[],e=0;e<o.length;e++)(s={token:"expression",expressionType:"relationalexpression"}).operator=i,s.op1=r,s.op2=o[e],n.operands.push(s)}else(n={expressionType:"relationalexpression"}).operator=e[0][1],n.op1=r,n.op2=e[0][3],n.token="expression";r=n}else kh=r,r=Be}else kh=r,r=Be;return Ih--,r===Be&&0===Ih&&a(Ts),Ih--,(e=r)===Be&&0===Ih&&a(Rs),e}function he(){var e,r,n,i,o,s,u,l,c,f;if(Ih++,Ih++,r=kh,(n=pe())!==Be){for(e=[],i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(43===t.charCodeAt(kh)?(s=ns,kh++):(s=Be,0===Ih&&a(is)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=pe())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(45===t.charCodeAt(kh)?(s=fa,kh++):(s=Be,0===Ih&&a(ha)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=pe())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be)if(i=kh,(o=we())===Be&&(o=we()),o!==Be){for(s=kh,u=[],l=Se();l!==Be;)u.push(l),l=Se();if(u!==Be)if(42===t.charCodeAt(kh)?(l=At,kh++):(l=Be,0===Ih&&a(It)),l!==Be){for(c=[],f=Se();f!==Be;)c.push(f),f=Se();c!==Be&&(f=de())!==Be?s=u=[u,l,c,f]:(kh=s,s=Be)}else kh=s,s=Be;else kh=s,s=Be;if(s===Be){for(s=kh,u=[],l=Se();l!==Be;)u.push(l),l=Se();if(u!==Be)if(47===t.charCodeAt(kh)?(l=Vo,kh++):(l=Be,0===Ih&&a($o)),l!==Be){for(c=[],f=Se();f!==Be;)c.push(f),f=Se();c!==Be&&(f=de())!==Be?s=u=[u,l,c,f]:(kh=s,s=Be)}else kh=s,s=Be;else kh=s,s=Be}s===Be&&(s=null),s!==Be?i=o=[o,s]:(kh=i,i=Be)}else kh=i,i=Be}for(;i!==Be;){for(e.push(i),i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(43===t.charCodeAt(kh)?(s=ns,kh++):(s=Be,0===Ih&&a(is)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=pe())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(45===t.charCodeAt(kh)?(s=fa,kh++):(s=Be,0===Ih&&a(ha)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=pe())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be)if(i=kh,(o=we())===Be&&(o=we()),o!==Be){for(s=kh,u=[],l=Se();l!==Be;)u.push(l),l=Se();if(u!==Be)if(42===t.charCodeAt(kh)?(l=At,kh++):(l=Be,0===Ih&&a(It)),l!==Be){for(c=[],f=Se();f!==Be;)c.push(f),f=Se();c!==Be&&(f=de())!==Be?s=u=[u,l,c,f]:(kh=s,s=Be)}else kh=s,s=Be;else kh=s,s=Be;if(s===Be){for(s=kh,u=[],l=Se();l!==Be;)u.push(l),l=Se();if(u!==Be)if(47===t.charCodeAt(kh)?(l=Vo,kh++):(l=Be,0===Ih&&a($o)),l!==Be){for(c=[],f=Se();f!==Be;)c.push(f),f=Se();c!==Be&&(f=de())!==Be?s=u=[u,l,c,f]:(kh=s,s=Be)}else kh=s,s=Be;else kh=s,s=Be}s===Be&&(s=null),s!==Be?i=o=[o,s]:(kh=i,i=Be)}else kh=i,i=Be}}if(e!==Be){if(0!==e.length){for((r={token:"expression",expressionType:"additiveexpression"}).summand=n,r.summands=[],n=0;n<e.length;n++)i={},4==(o=e[n]).length&&"string"==typeof o[1]?(i.operator=o[1],i.expression=o[3]):(o={},u=i[1][1],l=i[1][3],u=null,0>(s=i[0]).value?(i.operator="-",s.value=-s.value):i.operator="+",o.token="expression",o.expressionType="multiplicativeexpression",o.operator=s,o.factors=[{operator:u,expression:l}],i.expression=o),r.summands.push(i);n=r}r=n}else kh=r,r=Be}else kh=r,r=Be;return Ih--,r===Be&&0===Ih&&a(ca),Ih--,(e=r)===Be&&0===Ih&&a(la),e}function pe(){var e,r,n,i,o,s,u,l;if(Ih++,e=kh,(r=de())!==Be){for(n=[],i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(42===t.charCodeAt(kh)?(s=At,kh++):(s=Be,0===Ih&&a(It)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=de())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(47===t.charCodeAt(kh)?(s=Vo,kh++):(s=Be,0===Ih&&a($o)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=de())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be}for(;i!==Be;){for(n.push(i),i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(42===t.charCodeAt(kh)?(s=At,kh++):(s=Be,0===Ih&&a(It)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=de())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be;if(i===Be){for(i=kh,o=[],s=Se();s!==Be;)o.push(s),s=Se();if(o!==Be)if(47===t.charCodeAt(kh)?(s=Vo,kh++):(s=Be,0===Ih&&a($o)),s!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=de())!==Be?i=o=[o,s,u,l]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be}}if(n!==Be){if(0!==n.length){for((e={token:"expression",expressionType:"multiplicativeexpression"}).factor=r,e.factors=[],r=0;r<n.length;r++)(o={}).operator=(i=n[r])[1],o.expression=i[3],e.factors.push(o);r=e}e=r}else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(pa),e}function de(){var e,r,n;if(Ih++,e=kh,33===t.charCodeAt(kh)?(r=ss,kh++):(r=Be,0===Ih&&a(as)),r!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();n!==Be&&(r=ge())!==Be?(e={token:"expression",expressionType:"unaryexpression",unaryexpression:"!"}).expression=r:(kh=e,e=Be)}else kh=e,e=Be;if(e===Be){if(e=kh,43===t.charCodeAt(kh)?(r=ns,kh++):(r=Be,0===Ih&&a(is)),r!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();n!==Be&&(r=ge())!==Be?(e={token:"expression",expressionType:"unaryexpression",unaryexpression:"+"}).expression=r:(kh=e,e=Be)}else kh=e,e=Be;if(e===Be){if(e=kh,45===t.charCodeAt(kh)?(r=fa,kh++):(r=Be,0===Ih&&a(ha)),r!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();n!==Be&&(r=ge())!==Be?(e={token:"expression",expressionType:"unaryexpression",unaryexpression:"-"}).expression=r:(kh=e,e=Be)}else kh=e,e=Be;e===Be&&(e=ge())}}return Ih--,e===Be&&0===Ih&&a(da),e}function ge(){var e;if(Ih++,(e=ve())===Be&&(e=ye())===Be){var r,n,i;if(Ih++,r=kh,(e=ke())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?((i=P())===Be&&(i=null),i!==Be?(r=i,(n={token:"expression",expressionType:"irireforfunction"}).iriref=e,n.args=null!=r?r.value:r,r=n):(kh=r,r=Be)):(kh=r,r=Be)}else kh=r,r=Be;if(Ih--,r===Be&&0===Ih&&a(Al),(e=r)===Be&&((e=me())!==Be&&((r={token:"expression",expressionType:"atomic",primaryexpression:"rdfliteral"}).value=e,e=r),e===Be&&((e=be())!==Be&&((r={token:"expression",expressionType:"atomic",primaryexpression:"numericliteral"}).value=e,e=r),e===Be&&((e=xe())!==Be&&((r={token:"expression",expressionType:"atomic",primaryexpression:"booleanliteral"}).value=e,e=r),e===Be)))){var o,s,u,l,c,f,h,p,d;if(Ih++,n=kh,t.substr(kh,5)===el?(e=el,kh+=5):(e=Be,0===Ih&&a(tl)),e===Be&&(t.substr(kh,5)===rl?(e=rl,kh+=5):(e=Be,0===Ih&&a(nl))),e!==Be){for(e=[],r=Se();r!==Be;)e.push(r),r=Se();if(e!==Be)if(40===t.charCodeAt(kh)?(r=mt,kh++):(r=Be,0===Ih&&a(bt)),r!==Be){for(r=[],e=Se();e!==Be;)r.push(e),e=Se();if(r!==Be)if(t.substr(kh,8)===ct?(e=ct,kh+=8):(e=Be,0===Ih&&a(ft)),e===Be&&(t.substr(kh,8)===ht?(e=ht,kh+=8):(e=Be,0===Ih&&a(pt))),e===Be&&(e=null),e!==Be){for(i=[],r=Se();r!==Be;)i.push(r),r=Se();if(i!==Be)if(42===t.charCodeAt(kh)?(r=At,kh++):(r=Be,0===Ih&&a(It)),r===Be&&(r=le()),r!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if(41===t.charCodeAt(kh)?(o=jt,kh++):(o=Be,0===Ih&&a(Lt)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?((n={token:"expression",expressionType:"aggregate",aggregateType:"count"}).distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=r):(kh=n,n=Be)}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;if(n===Be){if(n=kh,t.substr(kh,12)===il?(e=il,kh+=12):(e=Be,0===Ih&&a(ol)),e===Be&&(t.substr(kh,12)===sl?(e=sl,kh+=12):(e=Be,0===Ih&&a(al))),e!==Be){for(e=[],r=Se();r!==Be;)e.push(r),r=Se();if(e!==Be)if(40===t.charCodeAt(kh)?(r=mt,kh++):(r=Be,0===Ih&&a(bt)),r!==Be){for(r=[],e=Se();e!==Be;)r.push(e),e=Se();if(r!==Be)if(t.substr(kh,8)===ct?(e=ct,kh+=8):(e=Be,0===Ih&&a(ft)),e===Be&&(t.substr(kh,8)===ht?(e=ht,kh+=8):(e=Be,0===Ih&&a(pt))),e===Be&&(e=null),e!==Be){for(i=[],r=Se();r!==Be;)i.push(r),r=Se();if(i!==Be)if((r=le())!==Be){if(i=kh,59===t.charCodeAt(kh)?(o=un,kh++):(o=Be,0===Ih&&a(ln)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be)if(t.substr(kh,9)===ul?(u=ul,kh+=9):(u=Be,0===Ih&&a(ll)),u!==Be){for(l=[],c=Se();c!==Be;)l.push(c),c=Se();if(l!==Be)if(61===t.charCodeAt(kh)?(c=Ms,kh++):(c=Be,0===Ih&&a(Ns)),c!==Be){for(f=[],h=Se();h!==Be;)f.push(h),h=Se();if(f!==Be)if((h=_e())!==Be){for(p=[],d=Se();d!==Be;)p.push(d),d=Se();p!==Be?i=o=[o,s,u,l,c,f,h,p]:(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;if(i===Be&&(i=null),i!==Be)if(41===t.charCodeAt(kh)?(o=jt,kh++):(o=Be,0===Ih&&a(Lt)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?((n={token:"expression",expressionType:"aggregate",aggregateType:"group_concat"}).distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=r,n.separator=i):(kh=n,n=Be)}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;if(n===Be){if(n=kh,t.substr(kh,3)===cl?(e=cl,kh+=3):(e=Be,0===Ih&&a(fl)),e===Be&&(t.substr(kh,3)===hl?(e=hl,kh+=3):(e=Be,0===Ih&&a(pl))),e!==Be){for(e=[],r=Se();r!==Be;)e.push(r),r=Se();if(e!==Be)if(40===t.charCodeAt(kh)?(r=mt,kh++):(r=Be,0===Ih&&a(bt)),r!==Be){for(r=[],e=Se();e!==Be;)r.push(e),e=Se();if(r!==Be)if(t.substr(kh,8)===ct?(e=ct,kh+=8):(e=Be,0===Ih&&a(ft)),e===Be&&(t.substr(kh,8)===ht?(e=ht,kh+=8):(e=Be,0===Ih&&a(pt))),e===Be&&(e=null),e!==Be){for(i=[],r=Se();r!==Be;)i.push(r),r=Se();if(i!==Be)if((r=le())!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if(41===t.charCodeAt(kh)?(o=jt,kh++):(o=Be,0===Ih&&a(Lt)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?((n={token:"expression",expressionType:"aggregate",aggregateType:"sum"}).distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=r):(kh=n,n=Be)}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;if(n===Be){if(n=kh,t.substr(kh,3)===dl?(e=dl,kh+=3):(e=Be,0===Ih&&a(gl)),e===Be&&(t.substr(kh,3)===vl?(e=vl,kh+=3):(e=Be,0===Ih&&a(yl))),e!==Be){for(e=[],r=Se();r!==Be;)e.push(r),r=Se();if(e!==Be)if(40===t.charCodeAt(kh)?(r=mt,kh++):(r=Be,0===Ih&&a(bt)),r!==Be){for(r=[],e=Se();e!==Be;)r.push(e),e=Se();if(r!==Be)if(t.substr(kh,8)===ct?(e=ct,kh+=8):(e=Be,0===Ih&&a(ft)),e===Be&&(t.substr(kh,8)===ht?(e=ht,kh+=8):(e=Be,0===Ih&&a(pt))),e===Be&&(e=null),e!==Be){for(i=[],r=Se();r!==Be;)i.push(r),r=Se();if(i!==Be)if((r=le())!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if(41===t.charCodeAt(kh)?(o=jt,kh++):(o=Be,0===Ih&&a(Lt)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?((n={token:"expression",expressionType:"aggregate",aggregateType:"min"}).distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=r):(kh=n,n=Be)}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;if(n===Be){if(n=kh,t.substr(kh,3)===ml?(e=ml,kh+=3):(e=Be,0===Ih&&a(bl)),e===Be&&(t.substr(kh,3)===wl?(e=wl,kh+=3):(e=Be,0===Ih&&a(xl))),e!==Be){for(e=[],r=Se();r!==Be;)e.push(r),r=Se();if(e!==Be)if(40===t.charCodeAt(kh)?(r=mt,kh++):(r=Be,0===Ih&&a(bt)),r!==Be){for(r=[],e=Se();e!==Be;)r.push(e),e=Se();if(r!==Be)if(t.substr(kh,8)===ct?(e=ct,kh+=8):(e=Be,0===Ih&&a(ft)),e===Be&&(t.substr(kh,8)===ht?(e=ht,kh+=8):(e=Be,0===Ih&&a(pt))),e===Be&&(e=null),e!==Be){for(i=[],r=Se();r!==Be;)i.push(r),r=Se();if(i!==Be)if((r=le())!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if(41===t.charCodeAt(kh)?(o=jt,kh++):(o=Be,0===Ih&&a(Lt)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?((n={token:"expression",expressionType:"aggregate",aggregateType:"max"}).distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=r):(kh=n,n=Be)}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;if(n===Be)if(n=kh,t.substr(kh,3)===_l?(e=_l,kh+=3):(e=Be,0===Ih&&a(kl)),e===Be&&(t.substr(kh,3)===jl?(e=jl,kh+=3):(e=Be,0===Ih&&a(Ll))),e!==Be){for(e=[],r=Se();r!==Be;)e.push(r),r=Se();if(e!==Be)if(40===t.charCodeAt(kh)?(r=mt,kh++):(r=Be,0===Ih&&a(bt)),r!==Be){for(r=[],e=Se();e!==Be;)r.push(e),e=Se();if(r!==Be)if(t.substr(kh,8)===ct?(e=ct,kh+=8):(e=Be,0===Ih&&a(ft)),e===Be&&(t.substr(kh,8)===ht?(e=ht,kh+=8):(e=Be,0===Ih&&a(pt))),e===Be&&(e=null),e!==Be){for(i=[],r=Se();r!==Be;)i.push(r),r=Se();if(i!==Be)if((r=le())!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if(41===t.charCodeAt(kh)?(o=jt,kh++):(o=Be,0===Ih&&a(Lt)),o!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?((n={token:"expression",expressionType:"aggregate",aggregateType:"avg"}).distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=r):(kh=n,n=Be)}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be;else kh=n,n=Be}else kh=n,n=Be}}}}Ih--,n===Be&&0===Ih&&a(Zu),(e=n)===Be&&(e=ue())!==Be&&((r={token:"expression",expressionType:"atomic",primaryexpression:"var"}).value=e,e=r)}}return Ih--,e===Be&&0===Ih&&a(ga),e}function ve(){var e,r,n,i;if(Ih++,e=kh,40===t.charCodeAt(kh)?(r=mt,kh++):(r=Be,0===Ih&&a(bt)),r!==Be){for(n=[],r=Se();r!==Be;)n.push(r),r=Se();if(n!==Be)if((r=le())!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be?(41===t.charCodeAt(kh)?(i=jt,kh++):(i=Be,0===Ih&&a(Lt)),i!==Be?e=r:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(va),e}function ye(){var e,r,n,i,o,s,u,l;if(Ih++,e=kh,t.substr(kh,3)===ma?(r=ma,kh+=3):(r=Be,0===Ih&&a(ba)),r===Be&&(t.substr(kh,3)===wa?(r=wa,kh+=3):(r=Be,0===Ih&&a(xa))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(40===t.charCodeAt(kh)?(i=mt,kh++):(i=Be,0===Ih&&a(bt)),i!==Be){for(o=[],r=Se();r!==Be;)o.push(r),r=Se();if(o!==Be)if((r=le())!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?(41===t.charCodeAt(kh)?(u=jt,kh++):(u=Be,0===Ih&&a(Lt)),u!==Be?(e={token:"expression",expressionType:"builtincall",builtincall:"str"}).args=[r]:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,4)===_a?(r=_a,kh+=4):(r=Be,0===Ih&&a(ka)),r===Be&&(t.substr(kh,4)===ja?(r=ja,kh+=4):(r=Be,0===Ih&&a(La))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(40===t.charCodeAt(kh)?(i=mt,kh++):(i=Be,0===Ih&&a(bt)),i!==Be){for(o=[],r=Se();r!==Be;)o.push(r),r=Se();if(o!==Be)if((r=le())!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?(41===t.charCodeAt(kh)?(u=jt,kh++):(u=Be,0===Ih&&a(Lt)),u!==Be?(e={token:"expression",expressionType:"builtincall",builtincall:"lang"}).args=[r]:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,11)===Aa?(r=Aa,kh+=11):(r=Be,0===Ih&&a(Ia)),r===Be&&(t.substr(kh,11)===Ea?(r=Ea,kh+=11):(r=Be,0===Ih&&a(Ca))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(40===t.charCodeAt(kh)?(i=mt,kh++):(i=Be,0===Ih&&a(bt)),i!==Be){for(o=[],r=Se();r!==Be;)o.push(r),r=Se();if(o!==Be)if((r=le())!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be)if(44===t.charCodeAt(kh)?(u=xo,kh++):(u=Be,0===Ih&&a(_o)),u!==Be){for(l=[],i=Se();i!==Be;)l.push(i),i=Se();if(l!==Be)if((i=le())!==Be){for(n=[],u=Se();u!==Be;)n.push(u),u=Se();n!==Be?(41===t.charCodeAt(kh)?(u=jt,kh++):(u=Be,0===Ih&&a(Lt)),u!==Be?(e={token:"expression",expressionType:"builtincall",builtincall:"langmatches"}).args=[r,i]:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,8)===Oa?(r=Oa,kh+=8):(r=Be,0===Ih&&a(Fa)),r===Be&&(t.substr(kh,8)===Sa?(r=Sa,kh+=8):(r=Be,0===Ih&&a(Ra))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(40===t.charCodeAt(kh)?(i=mt,kh++):(i=Be,0===Ih&&a(bt)),i!==Be){for(o=[],r=Se();r!==Be;)o.push(r),r=Se();if(o!==Be)if((r=le())!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?(41===t.charCodeAt(kh)?(u=jt,kh++):(u=Be,0===Ih&&a(Lt)),u!==Be?(e={token:"expression",expressionType:"builtincall",builtincall:"datatype"}).args=[r]:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,5)===Ta?(r=Ta,kh+=5):(r=Be,0===Ih&&a(Ma)),r===Be&&(t.substr(kh,5)===Na?(r=Na,kh+=5):(r=Be,0===Ih&&a(Da))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(40===t.charCodeAt(kh)?(i=mt,kh++):(i=Be,0===Ih&&a(bt)),i!==Be){for(o=[],r=Se();r!==Be;)o.push(r),r=Se();if(o!==Be)if((r=ue())!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?(41===t.charCodeAt(kh)?(u=jt,kh++):(u=Be,0===Ih&&a(Lt)),u!==Be?(e={token:"expression",expressionType:"builtincall",builtincall:"bound"}).args=[r]:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,3)===Pa?(r=Pa,kh+=3):(r=Be,0===Ih&&a(Ua)),r===Be&&(t.substr(kh,3)===Qa?(r=Qa,kh+=3):(r=Be,0===Ih&&a(Ba))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(40===t.charCodeAt(kh)?(i=mt,kh++):(i=Be,0===Ih&&a(bt)),i!==Be){for(o=[],r=Se();r!==Be;)o.push(r),r=Se();if(o!==Be)if((r=le())!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?(41===t.charCodeAt(kh)?(u=jt,kh++):(u=Be,0===Ih&&a(Lt)),u!==Be?(e={token:"expression",expressionType:"builtincall",builtincall:"iri"}).args=[r]:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,3)===Wa?(r=Wa,kh+=3):(r=Be,0===Ih&&a(qa)),r===Be&&(t.substr(kh,3)===Xa?(r=Xa,kh+=3):(r=Be,0===Ih&&a(Ga))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(40===t.charCodeAt(kh)?(i=mt,kh++):(i=Be,0===Ih&&a(bt)),i!==Be){for(o=[],r=Se();r!==Be;)o.push(r),r=Se();if(o!==Be)if((r=le())!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?(41===t.charCodeAt(kh)?(u=jt,kh++):(u=Be,0===Ih&&a(Lt)),u!==Be?(e={token:"expression",expressionType:"builtincall",builtincall:"uri"}).args=[r]:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,5)===za?(r=za,kh+=5):(r=Be,0===Ih&&a(Ha)),r===Be&&(t.substr(kh,5)===Va?(r=Va,kh+=5):(r=Be,0===Ih&&a($a))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be){if(i=kh,40===t.charCodeAt(kh)?(o=mt,kh++):(o=Be,0===Ih&&a(bt)),o!==Be){for(r=[],s=Se();s!==Be;)r.push(s),s=Se();if(r!==Be)if((s=le())!==Be){for(u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be?(41===t.charCodeAt(kh)?(l=jt,kh++):(l=Be,0===Ih&&a(Lt)),l!==Be?i=o=[o,r,s,u,l]:(kh=i,i=Be)):(kh=i,i=Be)}else kh=i,i=Be;else kh=i,i=Be}else kh=i,i=Be;i===Be&&(i=Fe()),i!==Be?(e={token:"expression",expressionType:"builtincall",builtincall:"bnode"}).args=5===(r=i).length?[r[2]]:null:(kh=e,e=Be)}else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,8)===Ja?(r=Ja,kh+=8):(r=Be,0===Ih&&a(Ya)),r===Be&&(t.substr(kh,8)===Ka?(r=Ka,kh+=8):(r=Be,0===Ih&&a(Za))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();n!==Be&&(i=U())!==Be?((r={token:"expression",expressionType:"builtincall",builtincall:"coalesce"}).args=i,e=r):(kh=e,e=Be)}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,2)===eu?(r=eu,kh+=2):(r=Be,0===Ih&&a(tu)),r===Be&&(t.substr(kh,2)===ru?(r=ru,kh+=2):(r=Be,0===Ih&&a(nu))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(40===t.charCodeAt(kh)?(i=mt,kh++):(i=Be,0===Ih&&a(bt)),i!==Be){for(o=[],r=Se();r!==Be;)o.push(r),r=Se();if(o!==Be)if((r=le())!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be)if(44===t.charCodeAt(kh)?(u=xo,kh++):(u=Be,0===Ih&&a(_o)),u!==Be){for(l=[],i=Se();i!==Be;)l.push(i),i=Se();if(l!==Be)if((i=le())!==Be){for(n=[],u=Se();u!==Be;)n.push(u),u=Se();if(n!==Be)if(44===t.charCodeAt(kh)?(u=xo,kh++):(u=Be,0===Ih&&a(_o)),u!==Be){for(u=[],n=Se();n!==Be;)u.push(n),n=Se();if(u!==Be)if((n=le())!==Be){for(u=[],s=Se();s!==Be;)u.push(s),s=Se();u!==Be?(41===t.charCodeAt(kh)?(s=jt,kh++):(s=Be,0===Ih&&a(Lt)),s!==Be?(e={token:"expression",expressionType:"builtincall",builtincall:"if"}).args=[r,i,n]:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,9)===iu?(r=iu,kh+=9):(r=Be,0===Ih&&a(ou)),r===Be&&(t.substr(kh,9)===su?(r=su,kh+=9):(r=Be,0===Ih&&a(au)),r===Be&&(t.substr(kh,9)===uu?(r=uu,kh+=9):(r=Be,0===Ih&&a(lu)))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(40===t.charCodeAt(kh)?(i=mt,kh++):(i=Be,0===Ih&&a(bt)),i!==Be){for(o=[],r=Se();r!==Be;)o.push(r),r=Se();if(o!==Be)if((r=le())!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?(41===t.charCodeAt(kh)?(u=jt,kh++):(u=Be,0===Ih&&a(Lt)),u!==Be?(e={token:"expression",expressionType:"builtincall",builtincall:"isliteral"}).args=[r]:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,7)===cu?(r=cu,kh+=7):(r=Be,0===Ih&&a(fu)),r===Be&&(t.substr(kh,7)===hu?(r=hu,kh+=7):(r=Be,0===Ih&&a(pu)),r===Be&&(t.substr(kh,7)===du?(r=du,kh+=7):(r=Be,0===Ih&&a(gu)))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(40===t.charCodeAt(kh)?(i=mt,kh++):(i=Be,0===Ih&&a(bt)),i!==Be){for(o=[],r=Se();r!==Be;)o.push(r),r=Se();if(o!==Be)if((r=le())!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?(41===t.charCodeAt(kh)?(u=jt,kh++):(u=Be,0===Ih&&a(Lt)),u!==Be?(e={token:"expression",expressionType:"builtincall",builtincall:"isblank"}).args=[r]:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,8)===vu?(r=vu,kh+=8):(r=Be,0===Ih&&a(yu)),r===Be&&(t.substr(kh,8)===mu?(r=mu,kh+=8):(r=Be,0===Ih&&a(bu))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(40===t.charCodeAt(kh)?(i=mt,kh++):(i=Be,0===Ih&&a(bt)),i!==Be){for(o=[],r=Se();r!==Be;)o.push(r),r=Se();if(o!==Be)if((r=le())!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be)if(44===t.charCodeAt(kh)?(u=xo,kh++):(u=Be,0===Ih&&a(_o)),u!==Be){for(l=[],i=Se();i!==Be;)l.push(i),i=Se();if(l!==Be)if((i=le())!==Be){for(n=[],u=Se();u!==Be;)n.push(u),u=Se();n!==Be?(41===t.charCodeAt(kh)?(u=jt,kh++):(u=Be,0===Ih&&a(Lt)),u!==Be?(e={token:"expression",expressionType:"builtincall",builtincall:"sameterm"}).args=[r,i]:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,5)===wu?(r=wu,kh+=5):(r=Be,0===Ih&&a(xu)),r===Be&&(t.substr(kh,5)===_u?(r=_u,kh+=5):(r=Be,0===Ih&&a(ku)),r===Be&&(t.substr(kh,5)===ju?(r=ju,kh+=5):(r=Be,0===Ih&&a(Lu)),r===Be&&(t.substr(kh,5)===Au?(r=Au,kh+=5):(r=Be,0===Ih&&a(Iu)),r===Be&&(t.substr(kh,5)===Eu?(r=Eu,kh+=5):(r=Be,0===Ih&&a(Cu)),r===Be&&(t.substr(kh,5)===Ou?(r=Ou,kh+=5):(r=Be,0===Ih&&a(Fu))))))),r!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if(40===t.charCodeAt(kh)?(i=mt,kh++):(i=Be,0===Ih&&a(bt)),i!==Be){for(o=[],r=Se();r!==Be;)o.push(r),r=Se();if(o!==Be)if((r=le())!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();s!==Be?(41===t.charCodeAt(kh)?(u=jt,kh++):(u=Be,0===Ih&&a(Lt)),u!==Be?(e={token:"expression",expressionType:"builtincall",builtincall:"isuri"}).args=[r]:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(e=kh,t.substr(kh,7)===Su?(r=Su,kh+=7):(r=Be,0===Ih&&a(Ru)),r===Be&&(t.substr(kh,7)===Tu?(r=Tu,kh+=7):(r=Be,0===Ih&&a(Mu))),r!==Be){if(n=[],Nu.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(Du)),i!==Be)for(;i!==Be;)n.push(i),Nu.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(Du));else n=Be;if(n!==Be){for(i=[],o=Se();o!==Be;)i.push(o),o=Se();if(i!==Be)if(40===t.charCodeAt(kh)?(o=mt,kh++):(o=Be,0===Ih&&a(bt)),o!==Be){for(r=[],s=kh,u=[],l=Se();l!==Be;)u.push(l),l=Se();for(u!==Be&&(l=le())!==Be?(44===t.charCodeAt(kh)?(i=xo,kh++):(i=Be,0===Ih&&a(_o)),i!==Be?s=u=[u,l,i]:(kh=s,s=Be)):(kh=s,s=Be);s!==Be;){for(r.push(s),s=kh,u=[],l=Se();l!==Be;)u.push(l),l=Se();u!==Be&&(l=le())!==Be?(44===t.charCodeAt(kh)?(i=xo,kh++):(i=Be,0===Ih&&a(_o)),i!==Be?s=u=[u,l,i]:(kh=s,s=Be)):(kh=s,s=Be)}if(r!==Be){for(s=[],u=Se();u!==Be;)s.push(u),u=Se();if(s!==Be)if((u=le())!==Be){for(l=[],i=Se();i!==Be;)l.push(i),i=Se();if(l!==Be)if(41===t.charCodeAt(kh)?(i=jt,kh++):(i=Be,0===Ih&&a(Lt)),i!==Be){for(e=u,(i={token:"expression",expressionType:"custom"}).name=n.join(""),n=[],u=0;u<r.length;u++)n.push(r[u][1]);n.push(e),i.args=n,e=i}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;else kh=e,e=Be}else kh=e,e=Be}else kh=e,e=Be;if(e===Be){if(Ih++,r=kh,t.substr(kh,5)===Uu?(e=Uu,kh+=5):(e=Be,0===Ih&&a(Qu)),e===Be&&(t.substr(kh,5)===Bu?(e=Bu,kh+=5):(e=Be,0===Ih&&a(Wu))),e!==Be){for(e=[],i=Se();i!==Be;)e.push(i),i=Se();if(e!==Be)if(40===t.charCodeAt(kh)?(i=mt,kh++):(i=Be,0===Ih&&a(bt)),i!==Be){for(i=[],e=Se();e!==Be;)i.push(e),e=Se();if(i!==Be)if((e=le())!==Be){for(i=[],n=Se();n!==Be;)i.push(n),n=Se();if(i!==Be)if(44===t.charCodeAt(kh)?(n=xo,kh++):(n=Be,0===Ih&&a(_o)),n!==Be){for(n=[],i=Se();i!==Be;)n.push(i),i=Se();if(n!==Be)if((i=le())!==Be){for(u=[],n=Se();n!==Be;)u.push(n),n=Se();if(u!==Be){if(n=kh,44===t.charCodeAt(kh)?(u=xo,kh++):(u=Be,0===Ih&&a(_o)),u!==Be){for(s=[],l=Se();l!==Be;)s.push(l),l=Se();s!==Be&&(l=le())!==Be?n=u=[u,s,l]:(kh=n,n=Be)}else kh=n,n=Be;if(n===Be&&(n=null),n!==Be){for(u=[],s=Se();s!==Be;)u.push(s),s=Se();u!==Be?(41===t.charCodeAt(kh)?(s=jt,kh++):(s=Be,0===Ih&&a(Lt)),s!==Be?(r=n,(n={token:"expression",expressionType:"regex"}).text=e,n.pattern=i,null!=r&&(n.flags=r[2]),r=n):(kh=r,r=Be)):(kh=r,r=Be)}else kh=r,r=Be}else kh=r,r=Be}else kh=r,r=Be;else kh=r,r=Be}else kh=r,r=Be;else kh=r,r=Be}else kh=r,r=Be;else kh=r,r=Be}else kh=r,r=Be;else kh=r,r=Be}else kh=r,r=Be;if(Ih--,r===Be&&0===Ih&&a(Pu),(e=r)===Be){if(Ih++,r=kh,t.substr(kh,6)===Xu?(e=Xu,kh+=6):(e=Be,0===Ih&&a(Gu)),e===Be&&(t.substr(kh,6)===zu?(e=zu,kh+=6):(e=Be,0===Ih&&a(Hu))),e!==Be){for(i=[],e=Se();e!==Be;)i.push(e),e=Se();i!==Be&&(e=F())!==Be?(r={token:"expression",expressionType:"builtincall",builtincall:"exists"}).args=[e]:(kh=r,r=Be)}else kh=r,r=Be;if(Ih--,r===Be&&0===Ih&&a(qu),(e=r)===Be){if(Ih++,r=kh,t.substr(kh,3)===$u?(e=$u,kh+=3):(e=Be,0===Ih&&a(Ju)),e===Be&&(t.substr(kh,3)===Yu?(e=Yu,kh+=3):(e=Be,0===Ih&&a(Ku))),e!==Be){for(e=[],i=Se();i!==Be;)e.push(i),i=Se();if(e!==Be)if(t.substr(kh,6)===Xu?(i=Xu,kh+=6):(i=Be,0===Ih&&a(Gu)),i===Be&&(t.substr(kh,6)===zu?(i=zu,kh+=6):(i=Be,0===Ih&&a(Hu))),i!==Be){for(i=[],e=Se();e!==Be;)i.push(e),e=Se();i!==Be&&(e=F())!==Be?(r={token:"expression",expressionType:"builtincall",builtincall:"notexists"}).args=[e]:(kh=r,r=Be)}else kh=r,r=Be;else kh=r,r=Be}else kh=r,r=Be;Ih--,r===Be&&0===Ih&&a(Vu),e=r}}}}}}}}}}}}}}}}}return Ih--,e===Be&&0===Ih&&a(ya),e}function me(){var e,r,n,i,o;if(Ih++,e=kh,(r=_e())!==Be){var s,u,l,c;if(Ih++,n=kh,64===t.charCodeAt(kh)?(i=lc,kh++):(i=Be,0===Ih&&a(cc)),i!==Be){if(o=[],fc.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(hc)),i!==Be)for(;i!==Be;)o.push(i),fc.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(hc));else o=Be;if(o!==Be){if(i=[],s=kh,45===t.charCodeAt(kh)?(u=fa,kh++):(u=Be,0===Ih&&a(ha)),u!==Be){if(l=[],pc.test(t.charAt(kh))?(c=t.charAt(kh),kh++):(c=Be,0===Ih&&a(dc)),c!==Be)for(;c!==Be;)l.push(c),pc.test(t.charAt(kh))?(c=t.charAt(kh),kh++):(c=Be,0===Ih&&a(dc));else l=Be;l!==Be?s=u=[u,l]:(kh=s,s=Be)}else kh=s,s=Be;for(;s!==Be;)if(i.push(s),s=kh,45===t.charCodeAt(kh)?(u=fa,kh++):(u=Be,0===Ih&&a(ha)),u!==Be){if(l=[],pc.test(t.charAt(kh))?(c=t.charAt(kh),kh++):(c=Be,0===Ih&&a(dc)),c!==Be)for(;c!==Be;)l.push(c),pc.test(t.charAt(kh))?(c=t.charAt(kh),kh++):(c=Be,0===Ih&&a(dc));else l=Be;l!==Be?s=u=[u,l]:(kh=s,s=Be)}else kh=s,s=Be;i!==Be?(n=o,n=i=0===i.length?("@"+n.join("")).toLowerCase():("@"+n.join("")+"-"+i[0][1].join("")).toLowerCase()):(kh=n,n=Be)}else kh=n,n=Be}else kh=n,n=Be;Ih--,n===Be&&0===Ih&&a(uc),n===Be&&(n=kh,t.substr(kh,2)===El?(i=El,kh+=2):(i=Be,0===Ih&&a(Cl)),i!==Be&&(o=ke())!==Be?n=i=[i,o]:(kh=n,n=Be)),n===Be&&(n=null),n!==Be?(e=r,"string"==typeof(r=n)&&0<r.length?r={token:"literal",value:e.value,lang:r.slice(1),type:null}:null!=r&&"object"==typeof r?(r.shift(),r={token:"literal",value:e.value,lang:null,type:r[0]}):r={token:"literal",value:e.value,lang:null,type:null},e=r):(kh=e,e=Be)}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Il),e}function be(){var e,r;return Ih++,Ih++,(e=Ee())===Be&&(e=Ie())===Be&&(e=Ae()),Ih--,e===Be&&0===Ih&&a(Fl),e===Be&&(Ih++,Ih++,e=kh,43===t.charCodeAt(kh)?(r=ns,kh++):(r=Be,0===Ih&&a(is)),r!==Be&&(r=Ee())!==Be?e=r=_c(r):(kh=e,e=Be),Ih--,e===Be&&0===Ih&&a(kc),e===Be&&(Ih++,e=kh,43===t.charCodeAt(kh)?(r=ns,kh++):(r=Be,0===Ih&&a(is)),r!==Be&&(r=Ie())!==Be?e=r=_c(r):(kh=e,e=Be),Ih--,e===Be&&0===Ih&&a(xc),e===Be&&(Ih++,e=kh,43===t.charCodeAt(kh)?(r=ns,kh++):(r=Be,0===Ih&&a(is)),r!==Be&&(r=Ae())!==Be?(r.value="+"+r.value,e=r):(kh=e,e=Be),Ih--,e===Be&&0===Ih&&a(wc))),Ih--,e===Be&&0===Ih&&a(Sl),e===Be&&(e=we())),Ih--,e===Be&&0===Ih&&a(Ol),e}function we(){var e,r;return Ih++,Ih++,e=kh,45===t.charCodeAt(kh)?(r=fa,kh++):(r=Be,0===Ih&&a(ha)),r!==Be&&(r=Ee())!==Be?e=r=Lc(r):(kh=e,e=Be),Ih--,e===Be&&0===Ih&&a(Ic),e===Be&&(Ih++,e=kh,45===t.charCodeAt(kh)?(r=fa,kh++):(r=Be,0===Ih&&a(ha)),r!==Be&&(r=Ie())!==Be?e=r=Lc(r):(kh=e,e=Be),Ih--,e===Be&&0===Ih&&a(Ac),e===Be&&(Ih++,e=kh,45===t.charCodeAt(kh)?(r=fa,kh++):(r=Be,0===Ih&&a(ha)),r!==Be&&(r=Ae())!==Be?e=r=Lc(r):(kh=e,e=Be),Ih--,e===Be&&0===Ih&&a(jc))),Ih--,e===Be&&0===Ih&&a(Rl),e}function xe(){var e;return Ih++,t.substr(kh,4)===Ml?(e=Ml,kh+=4):(e=Be,0===Ih&&a(Nl)),e===Be&&(t.substr(kh,4)===Dl?(e=Dl,kh+=4):(e=Be,0===Ih&&a(Pl))),e!==Be&&(e={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}),e===Be&&(t.substr(kh,5)===Ul?(e=Ul,kh+=5):(e=Be,0===Ih&&a(Ql)),e===Be&&(t.substr(kh,5)===Bl?(e=Bl,kh+=5):(e=Be,0===Ih&&a(Wl))),e!==Be&&(e={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1})),Ih--,e===Be&&0===Ih&&a(Tl),e}function _e(){var e,r,n;if(Ih++,Ih++,e=kh,t.substr(kh,3)===Xc?(r=Xc,kh+=3):(r=Be,0===Ih&&a(Gc)),r!==Be){for(r=[],zc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(Hc)),n===Be&&(n=Oe());n!==Be;)r.push(n),zc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(Hc)),n===Be&&(n=Oe());r!==Be?(t.substr(kh,3)===Xc?(n=Xc,kh+=3):(n=Be,0===Ih&&a(Gc)),n!==Be?e=r=Eh(r):(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;if(Ih--,e===Be&&0===Ih&&a(qc),e!==Be&&(e=Xl(e)),e===Be){if(Ih++,e=kh,t.substr(kh,3)===$c?(r=$c,kh+=3):(r=Be,0===Ih&&a(Jc)),r!==Be){for(r=[],Yc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(Kc)),n===Be&&(n=Oe());n!==Be;)r.push(n),Yc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(Kc)),n===Be&&(n=Oe());r!==Be?(t.substr(kh,3)===$c?(n=$c,kh+=3):(n=Be,0===Ih&&a(Jc)),n!==Be?e=r=Eh(r):(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;if(Ih--,e===Be&&0===Ih&&a(Vc),e!==Be&&(e=Xl(e)),e===Be){if(Ih++,e=kh,39===t.charCodeAt(kh)?(r=Tc,kh++):(r=Be,0===Ih&&a(Mc)),r!==Be){for(r=[],Nc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(Dc)),n===Be&&(n=Oe());n!==Be;)r.push(n),Nc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(Dc)),n===Be&&(n=Oe());r!==Be?(39===t.charCodeAt(kh)?(n=Tc,kh++):(n=Be,0===Ih&&a(Mc)),n!==Be?e=r=Eh(r):(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;if(Ih--,e===Be&&0===Ih&&a(Rc),e!==Be&&(e=Xl(e)),e===Be){if(Ih++,e=kh,34===t.charCodeAt(kh)?(r=Uc,kh++):(r=Be,0===Ih&&a(Qc)),r!==Be){for(r=[],Bc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(Wc)),n===Be&&(n=Oe());n!==Be;)r.push(n),Bc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(Wc)),n===Be&&(n=Oe());r!==Be?(34===t.charCodeAt(kh)?(n=Uc,kh++):(n=Be,0===Ih&&a(Qc)),n!==Be?e=r=Eh(r):(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;Ih--,e===Be&&0===Ih&&a(Pc),e!==Be&&(e=Xl(e))}}}return Ih--,e===Be&&0===Ih&&a(ql),e}function ke(){var e,t,r;return Ih++,(e=je())!==Be&&(e={token:"uri",prefix:null,suffix:null,value:e}),e===Be&&(Ih++,Ih++,e=kh,(t=Le())!==Be&&(r=De())!==Be?e=t=[t,r]:(kh=e,e=Be),Ih--,e===Be&&0===Ih&&a(ec),e!==Be&&(e={token:"uri",prefix:e[0],suffix:e[1],value:null}),e===Be&&(e=Le())!==Be&&(e={token:"uri",prefix:e,suffix:"",value:null}),Ih--,e===Be&&0===Ih&&a(zl)),Ih--,e===Be&&0===Ih&&a(Gl),e}function je(){var e,r,n;if(Ih++,e=kh,60===t.charCodeAt(kh)?(r=Us,kh++):(r=Be,0===Ih&&a(Qs)),r!==Be){for(r=[],$l.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(Jl));n!==Be;)r.push(n),$l.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(Jl));r!==Be?(62===t.charCodeAt(kh)?(n=Bs,kh++):(n=Be,0===Ih&&a(Ws)),n!==Be?e=r=r.join(""):(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Vl),e}function Le(){var e,r,n,i,o;if(Ih++,e=kh,Ih++,r=kh,(n=Re())!==Be){for(i=[],(o=Ne())===Be&&(46===t.charCodeAt(kh)?(o=Ci,kh++):(o=Be,0===Ih&&a(Oi)));o!==Be;)i.push(o),(o=Ne())===Be&&(46===t.charCodeAt(kh)?(o=Ci,kh++):(o=Be,0===Ih&&a(Oi)));if(i!==Be){if("."==i[i.length-1])throw Error("Wrong PN_PREFIX, cannot finish with '.'");r=n+=i.join("")}else kh=r,r=Be}else kh=r,r=Be;return Ih--,r===Be&&0===Ih&&a(ah),r===Be&&(r=null),r!==Be?(58===t.charCodeAt(kh)?(n=Kl,kh++):(n=Be,0===Ih&&a(Zl)),n!==Be?e=r:(kh=e,e=Be)):(kh=e,e=Be),Ih--,e===Be&&0===Ih&&a(Yl),e}function Ae(){var e,r;if(Ih++,e=[],vc.test(t.charAt(kh))?(r=t.charAt(kh),kh++):(r=Be,0===Ih&&a(yc)),r!==Be)for(;r!==Be;)e.push(r),vc.test(t.charAt(kh))?(r=t.charAt(kh),kh++):(r=Be,0===Ih&&a(yc));else e=Be;return e!==Be&&((r={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#integer"}).value=Eh(e),e=r),Ih--,e===Be&&0===Ih&&a(gc),e}function Ie(){var e,r,n,i,o;if(Ih++,e=kh,r=[],vc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(yc)),n!==Be)for(;n!==Be;)r.push(n),vc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(yc));else r=Be;if(r!==Be)if(46===t.charCodeAt(kh)?(n=Ci,kh++):(n=Be,0===Ih&&a(Oi)),n!==Be){for(i=[],vc.test(t.charAt(kh))?(o=t.charAt(kh),kh++):(o=Be,0===Ih&&a(yc));o!==Be;)i.push(o),vc.test(t.charAt(kh))?(o=t.charAt(kh),kh++):(o=Be,0===Ih&&a(yc));i!==Be?(e={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"}).value=Eh([r,n,i]):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be;if(e===Be)if(e=kh,46===t.charCodeAt(kh)?(r=Ci,kh++):(r=Be,0===Ih&&a(Oi)),r!==Be){if(n=[],vc.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(yc)),i!==Be)for(;i!==Be;)n.push(i),vc.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(yc));else n=Be;n!==Be?((i={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"}).value=Eh([r,n]),e=i):(kh=e,e=Be)}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(mc),e}function Ee(){var e,r,n,i,o;if(Ih++,e=kh,r=[],vc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(yc)),n!==Be)for(;n!==Be;)r.push(n),vc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(yc));else r=Be;if(r!==Be)if(46===t.charCodeAt(kh)?(n=Ci,kh++):(n=Be,0===Ih&&a(Oi)),n!==Be){for(i=[],vc.test(t.charAt(kh))?(o=t.charAt(kh),kh++):(o=Be,0===Ih&&a(yc));o!==Be;)i.push(o),vc.test(t.charAt(kh))?(o=t.charAt(kh),kh++):(o=Be,0===Ih&&a(yc));i!==Be&&(o=Ce())!==Be?(e={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"}).value=Eh([r,n,i,o]):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be;if(e===Be){if(e=kh,46===t.charCodeAt(kh)?(r=Ci,kh++):(r=Be,0===Ih&&a(Oi)),r!==Be){if(n=[],vc.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(yc)),i!==Be)for(;i!==Be;)n.push(i),vc.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(yc));else n=Be;n!==Be&&(i=Ce())!==Be?((o={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"}).value=Eh([r,n,i]),e=o):(kh=e,e=Be)}else kh=e,e=Be;if(e===Be){if(e=kh,r=[],vc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(yc)),n!==Be)for(;n!==Be;)r.push(n),vc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(yc));else r=Be;r!==Be&&(n=Ce())!==Be?((i={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"}).value=Eh([r,n]),e=i):(kh=e,e=Be)}}return Ih--,e===Be&&0===Ih&&a(bc),e}function Ce(){var e,r,n,i,o;if(Ih++,e=kh,Cc.test(t.charAt(kh))?(r=t.charAt(kh),kh++):(r=Be,0===Ih&&a(Oc)),r!==Be)if(Fc.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(Sc)),n===Be&&(n=null),n!==Be){if(i=[],vc.test(t.charAt(kh))?(o=t.charAt(kh),kh++):(o=Be,0===Ih&&a(yc)),o!==Be)for(;o!==Be;)i.push(o),vc.test(t.charAt(kh))?(o=t.charAt(kh),kh++):(o=Be,0===Ih&&a(yc));else i=Be;i!==Be?e=r=Eh([r,n,i]):(kh=e,e=Be)}else kh=e,e=Be;else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Ec),e}function Oe(){var e,r,n;return Ih++,e=kh,92===t.charCodeAt(kh)?(r=ef,kh++):(r=Be,0===Ih&&a(tf)),r!==Be?(rf.test(t.charAt(kh))?(n=t.charAt(kh),kh++):(n=Be,0===Ih&&a(nf)),n!==Be?e=r=[r,n]:(kh=e,e=Be)):(kh=e,e=Be),Ih--,e===Be&&0===Ih&&a(Zc),e}function Fe(){var e,r,n;if(Ih++,e=kh,40===t.charCodeAt(kh)?(r=mt,kh++):(r=Be,0===Ih&&a(bt)),r!==Be){for(r=[],n=Se();n!==Be;)r.push(n),n=Se();r!==Be?(41===t.charCodeAt(kh)?(n=jt,kh++):(n=Be,0===Ih&&a(Lt)),n!==Be?e=r={token:"triplesnodecollection",triplesContext:[],chainSubject:[{token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}]}:(kh=e,e=Be)):(kh=e,e=Be)}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(of),e}function Se(){var e;if(Ih++,af.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(uf)),e===Be&&(lf.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(cf)),e===Be&&(ff.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(hf)),e===Be&&(pf.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(df)),e===Be)))){var r,n,i;if(Ih++,e=kh,35===t.charCodeAt(kh)?(r=vf,kh++):(r=Be,0===Ih&&a(yf)),r!==Be){for(n=[],mf.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(bf));i!==Be;)n.push(i),mf.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(bf));n!==Be?e=r=[r,n]:(kh=e,e=Be)}else kh=e,e=Be;Ih--,e===Be&&0===Ih&&a(gf)}return Ih--,e===Be&&0===Ih&&a(sf),e}function Re(){var e;return Ih++,_f.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(kf)),e===Be&&(jf.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(Lf)),e===Be&&(Af.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(If)),e===Be&&(Ef.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(Cf)),e===Be&&(Of.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(Ff)),e===Be&&(Sf.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(Rf)),e===Be&&(Tf.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(Mf)),e===Be&&(Nf.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(Df)),e===Be&&(Pf.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(Uf)),e===Be&&(Qf.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(Bf)),e===Be&&(Wf.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(qf)),e===Be&&(Xf.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(Gf)),e===Be&&(zf.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(Hf)),e===Be&&(Vf.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a($f))))))))))))))),Ih--,e===Be&&0===Ih&&a(xf),e}function Te(){var e;return Ih++,(e=Re())===Be&&(95===t.charCodeAt(kh)?(e=Yf,kh++):(e=Be,0===Ih&&a(Kf))),Ih--,e===Be&&0===Ih&&a(Jf),e}function Me(){var e,r,n,i;if(Ih++,e=kh,(r=Te())===Be&&(vc.test(t.charAt(kh))?(r=t.charAt(kh),kh++):(r=Be,0===Ih&&a(yc))),r!==Be){for(n=[],(i=Te())===Be&&(vc.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(yc)),i===Be&&(eh.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(th)),i===Be&&(rh.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(nh)),i===Be&&(ih.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(oh))))));i!==Be;)n.push(i),(i=Te())===Be&&(vc.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(yc)),i===Be&&(eh.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(th)),i===Be&&(rh.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(nh)),i===Be&&(ih.test(t.charAt(kh))?(i=t.charAt(kh),kh++):(i=Be,0===Ih&&a(oh))))));n!==Be?e=r+=n.join(""):(kh=e,e=Be)}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(Zf),e}function Ne(){var e;return Ih++,(e=Te())===Be&&(45===t.charCodeAt(kh)?(e=fa,kh++):(e=Be,0===Ih&&a(ha)),e===Be&&(vc.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(yc)),e===Be&&(eh.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(th)),e===Be&&(rh.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(nh)),e===Be&&(ih.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(oh))))))),Ih--,e===Be&&0===Ih&&a(sh),e}function De(){var e,r,n,i;if(Ih++,e=kh,(r=Te())===Be&&(vc.test(t.charAt(kh))?(r=t.charAt(kh),kh++):(r=Be,0===Ih&&a(yc)),r===Be&&(58===t.charCodeAt(kh)?(r=Kl,kh++):(r=Be,0===Ih&&a(Zl)),r===Be&&(r=Pe()))),r!==Be){for(n=[],(i=Ne())===Be&&(46===t.charCodeAt(kh)?(i=Ci,kh++):(i=Be,0===Ih&&a(Oi)),i===Be&&(58===t.charCodeAt(kh)?(i=Kl,kh++):(i=Be,0===Ih&&a(Zl)),i===Be&&(i=Pe())));i!==Be;)n.push(i),(i=Ne())===Be&&(46===t.charCodeAt(kh)?(i=Ci,kh++):(i=Be,0===Ih&&a(Oi)),i===Be&&(58===t.charCodeAt(kh)?(i=Kl,kh++):(i=Be,0===Ih&&a(Zl)),i===Be&&(i=Pe())));n!==Be?e=r+=(n||[]).join(""):(kh=e,e=Be)}else kh=e,e=Be;return Ih--,e===Be&&0===Ih&&a(uh),e}function Pe(){var e,r,n,i;return Ih++,Ih++,e=kh,37===t.charCodeAt(kh)?(r=fh,kh++):(r=Be,0===Ih&&a(hh)),r!==Be&&(n=Ue())!==Be&&(i=Ue())!==Be?e=r=[r,n,i]:(kh=e,e=Be),e!==Be&&(e=e.join("")),Ih--,e===Be&&0===Ih&&a(ch),e===Be&&(Ih++,e=kh,92===t.charCodeAt(kh)?(r=ef,kh++):(r=Be,0===Ih&&a(tf)),r!==Be?(95===t.charCodeAt(kh)?(r=Yf,kh++):(r=Be,0===Ih&&a(Kf)),r===Be&&(126===t.charCodeAt(kh)?(r=bh,kh++):(r=Be,0===Ih&&a(wh)),r===Be&&(46===t.charCodeAt(kh)?(r=Ci,kh++):(r=Be,0===Ih&&a(Oi)),r===Be&&(45===t.charCodeAt(kh)?(r=fa,kh++):(r=Be,0===Ih&&a(ha)),r===Be&&(33===t.charCodeAt(kh)?(r=ss,kh++):(r=Be,0===Ih&&a(as)),r===Be&&(36===t.charCodeAt(kh)?(r=sc,kh++):(r=Be,0===Ih&&a(ac)),r===Be&&(38===t.charCodeAt(kh)?(r=xh,kh++):(r=Be,0===Ih&&a(_h)),r===Be&&(39===t.charCodeAt(kh)?(r=Tc,kh++):(r=Be,0===Ih&&a(Mc)),r===Be&&(40===t.charCodeAt(kh)?(r=mt,kh++):(r=Be,0===Ih&&a(bt)),r===Be&&(41===t.charCodeAt(kh)?(r=jt,kh++):(r=Be,0===Ih&&a(Lt)),r===Be&&(42===t.charCodeAt(kh)?(r=At,kh++):(r=Be,0===Ih&&a(It)),r===Be&&(43===t.charCodeAt(kh)?(r=ns,kh++):(r=Be,0===Ih&&a(is)),r===Be&&(44===t.charCodeAt(kh)?(r=xo,kh++):(r=Be,0===Ih&&a(_o)),r===Be&&(59===t.charCodeAt(kh)?(r=un,kh++):(r=Be,0===Ih&&a(ln)),r===Be&&(58===t.charCodeAt(kh)?(r=Kl,kh++):(r=Be,0===Ih&&a(Zl)),r===Be&&(61===t.charCodeAt(kh)?(r=Ms,kh++):(r=Be,0===Ih&&a(Ns)),r===Be&&(47===t.charCodeAt(kh)?(r=Vo,kh++):(r=Be,0===Ih&&a($o)),r===Be&&(63===t.charCodeAt(kh)?(r=ts,kh++):(r=Be,0===Ih&&a(rs)),r===Be&&(35===t.charCodeAt(kh)?(r=vf,kh++):(r=Be,0===Ih&&a(yf)),r===Be&&(64===t.charCodeAt(kh)?(r=lc,kh++):(r=Be,0===Ih&&a(cc)),r===Be&&(37===t.charCodeAt(kh)?(r=fh,kh++):(r=Be,0===Ih&&a(hh)))))))))))))))))))))),r!==Be?e="\\"+r:(kh=e,e=Be)):(kh=e,e=Be),Ih--,e===Be&&0===Ih&&a(mh)),Ih--,e===Be&&0===Ih&&a(lh),e}function Ue(){var e;return Ih++,vc.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(yc)),e===Be&&(dh.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(gh)),e===Be&&(vh.test(t.charAt(kh))?(e=t.charAt(kh),kh++):(e=Be,0===Ih&&a(yh)))),Ih--,e===Be&&0===Ih&&a(ph),e}r=void 0!==r?r:{};var Qe,Be={},We={DOCUMENT:u},qe=u,Xe=o("[1] QueryUnit"),Ge=o("[2] Query"),ze=o("[3] Prologue"),He=o("[4] BaseDecl"),Ve="BASE",$e=n("BASE",!1),Je="base",Ye=n("base",!1),Ke=o("[5] PrefixDecl"),Ze="PREFIX",et=n("PREFIX",!1),tt="prefix",rt=n("prefix",!1),nt=o("[6] SelectQuery"),it=o("[7] SubSelect"),ot=o("[8] SelectClause"),st="SELECT",at=n("SELECT",!1),ut="select",lt=n("select",!1),ct="DISTINCT",ft=n("DISTINCT",!1),ht="distinct",pt=n("distinct",!1),dt="REDUCED",gt=n("REDUCED",!1),vt="reduced",yt=n("reduced",!1),mt="(",bt=n("(",!1),wt="AS",xt=n("AS",!1),_t="as",kt=n("as",!1),jt=")",Lt=n(")",!1),At="*",It=n("*",!1),Et=o("[9] ConstructQuery"),Ct="CONSTRUCT",Ot=n("CONSTRUCT",!1),Ft="construct",St=n("construct",!1),Rt="WHERE",Tt=n("WHERE",!1),Mt="where",Nt=n("where",!1),Dt="{",Pt=n("{",!1),Ut="}",Qt=n("}",!1),Bt=o("[10] DescribeQuery"),Wt="DESCRIBE",qt=n("DESCRIBE",!1),Xt=o("[11] AskQuery"),Gt="ASK",zt=n("ASK",!1),Ht="ask",Vt=n("ask",!1),$t=o("[12] DatasetClause"),Jt="FROM",Yt=n("FROM",!1),Kt="from",Zt=n("from",!1),er=o("[13] DefaultGraphClause"),tr=o("[14] NamedGraphClause"),rr="NAMED",nr=n("NAMED",!1),ir="named",or=n("named",!1),sr=o("[15] SourceSelector"),ar=o("[16] WhereClause"),ur=o("[17] SolutionModifier"),lr=o("[18] GroupClause"),cr="GROUP",fr=n("GROUP",!1),hr="group",pr=n("group",!1),dr="BY",gr=n("BY",!1),vr="by",yr=n("by",!1),mr=o("[19] GroupCondition"),br=o("[20] HavingClause"),wr="HAVING",xr=n("HAVING",!1),_r=o("[21] HavingCondition"),kr=o("[22] OrderClause"),jr="ORDER",Lr=n("ORDER",!1),Ar="order",Ir=n("order",!1),Er=o("[23] OrderCondition"),Cr="ASC",Or=n("ASC",!1),Fr="asc",Sr=n("asc",!1),Rr="DESC",Tr=n("DESC",!1),Mr="desc",Nr=n("desc",!1),Dr=o("[24] LimitOffsetClauses"),Pr=o("[25] LimitClause"),Ur="LIMIT",Qr=n("LIMIT",!1),Br="limit",Wr=n("limit",!1),qr=o("[26] OffsetClause"),Xr="OFFSET",Gr=n("OFFSET",!1),zr="offset",Hr=n("offset",!1),Vr=o("[27] BindingsClause"),$r="BINDINGS",Jr=n("BINDINGS",!1),Yr=o("[28] BindingValue"),Kr="UNDEF",Zr=n("UNDEF",!1),en=o("[28]\tValuesClause\t  ::=\t( 'VALUES' DataBlock )?"),tn="VALUES",rn=n("VALUES",!1),nn="values",on=n("values",!1),sn=o("[29] UpdateUnit"),an=o("[30] Update"),un=";",ln=n(";",!1),cn=o("[31] Update1"),fn=o("[32] Load"),hn="LOAD",pn=n("LOAD",!1),dn="load",gn=n("load",!1),vn="INTO",yn=n("INTO",!1),mn="into",bn=n("into",!1),wn=o("[33] Clear"),xn="CLEAR",_n=n("CLEAR",!1),kn="clear",jn=n("clear",!1),Ln="SILENT",An=n("SILENT",!1),In="silent",En=n("silent",!1),Cn=o("[34] Drop"),On="DROP",Fn=n("DROP",!1),Sn="drop",Rn=n("drop",!1),Tn=o("[35] Create"),Mn="CREATE",Nn=n("CREATE",!1),Dn="create",Pn=n("create",!1),Un=o("[36] InsertData"),Qn="INSERT",Bn=n("INSERT",!1),Wn="insert",qn=n("insert",!1),Xn="DATA",Gn=n("DATA",!1),zn="data",Hn=n("data",!1),Vn=o("[37] DeleteData"),$n="DELETE",Jn=n("DELETE",!1),Yn="delete",Kn=n("delete",!1),Zn=o("[38] DeleteWhere"),ei=o("[39] Modify"),ti="WITH",ri=n("WITH",!1),ni="with",ii=n("with",!1),oi=o("[40] DeleteClause"),si=o("[41] InsertClause"),ai=o("[42] UsingClause"),ui="USING",li=n("USING",!1),ci="using",fi=n("using",!1),hi=o("[43] GraphRef"),pi="GRAPH",di=n("GRAPH",!1),gi="graph",vi=n("graph",!1),yi=o("[44] GraphRefAll"),mi="DEFAULT",bi=n("DEFAULT",!1),wi="default",xi=n("default",!1),_i="ALL",ki=n("ALL",!1),ji="all",Li=n("all",!1),Ai=o("[45] QuadPattern"),Ii=o("[46] QuadData"),Ei=o("[47] Quads"),Ci=".",Oi=n(".",!1),Fi=o("[48] QuadsNotTriples"),Si=o("[49] TriplesTemplate"),Ri=o("[50] GroupGraphPattern"),Ti=o("[51] GroupGraphPatternSub"),Mi=o("[54] TriplesBlock"),Ni=o("[53] GraphPatternNotTriples"),Di=o("[54] OptionalGraphPattern"),Pi="OPTIONAL",Ui=n("OPTIONAL",!1),Qi="optional",Bi=n("optional",!1),Wi=o("[55] GraphGraphPattern"),qi=o("[56] ServiceGraphPattern"),Xi="SERVICE",Gi=n("SERVICE",!1),zi=o("[57] MinusGraphPattern"),Hi="MINUS",Vi=n("MINUS",!1),$i="minus",Ji=n("minus",!1),Yi=o("[58] GroupOrUnionGraphPattern"),Ki="UNION",Zi=n("UNION",!1),eo="union",to=n("union",!1),ro=o("[59] Filter"),no="FILTER",io=n("FILTER",!1),oo="filter",so=n("filter",!1),ao=o("[60] Bind"),uo="BIND",lo=n("BIND",!1),co="bind",fo=n("bind",!1),ho=o("[60] Constraint"),po=o("[61] InlineData"),go=o("[62] DataBlock"),vo=o("[63] InlineDataOneVar"),yo=o("[64] InlineDataFull"),mo=o("[65] DataBlockValue"),bo=o("[61] FunctionCall"),wo=o("[62] ArgList"),xo=",",_o=n(",",!1),ko=o("[63] ExpressionList"),jo=o("[64] ConstructTemplate"),Lo=o("[65] ConstructTriples"),Ao=o("[66] TriplesSameSubject"),Io=o("[83] PropertyListPathNotEmpty"),Eo=o("[67] PropertyListNotEmpty"),Co=o("[68] PropertyList"),Oo=o("[86] ObjectListPath"),Fo=o("[69] ObjectList"),So=o("[87] ObjectPath"),Ro=o("[70] Object"),To=o("[71] Verb"),Mo="a",No=n("a",!1),Do=function(){return{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}},Po=o("[72] TriplesSameSubjectPath"),Uo=o("[73] PropertyListNotEmptyPath"),Qo=o("[74] PropertyListPath"),Bo=o("[75]"),Wo=o("[76] VerbSimple"),qo=o("[77] Path"),Xo=o("[78] PathAlternative"),Go="|",zo=n("|",!1),Ho=o("[79] PathSequence"),Vo="/",$o=n("/",!1),Jo=o("[88] PathElt"),Yo=o("[81] PathEltOrInverse"),Ko="^",Zo=n("^",!1),es=o("[82] PathMod"),ts="?",rs=n("?",!1),ns="+",is=n("+",!1),os=o("[83] PathPrimary"),ss="!",as=n("!",!1),us=o("[85] PathOneInPropertySet"),ls=o("[86] Integer"),cs=o("[100] TriplesNodePath"),fs=o("[87] TriplesNode"),hs=o("[101] BlankNodePropertyListPath"),ps="[",ds=n("[",!1),gs="]",vs=n("]",!1),ys=o("[88] BlankNodePropertyList"),ms=o("[103] CollectionPath"),bs=o("[89] Collection"),ws=o("[105] GraphNodePath"),xs=o("[90] GraphNode"),_s=o("[91] VarOrTerm"),ks=o("[92] VarOrIRIref"),js=o("[93] Var"),Ls=o("[94] GraphTerm"),As=o("[95] Expression"),Is=o("[96] ConditionalOrExpression"),Es="||",Cs=n("||",!1),Os=o("[97] ConditionalAndExpression"),Fs="&&",Ss=n("&&",!1),Rs=o("[98] ValueLogical"),Ts=o("[99] RelationalExpression"),Ms="=",Ns=n("=",!1),Ds="!=",Ps=n("!=",!1),Us="<",Qs=n("<",!1),Bs=">",Ws=n(">",!1),qs="<=",Xs=n("<=",!1),Gs=">=",zs=n(">=",!1),Hs="I",Vs=n("I",!1),$s="i",Js=n("i",!1),Ys="N",Ks=n("N",!1),Zs="n",ea=n("n",!1),ta="O",ra=n("O",!1),na="o",ia=n("o",!1),oa="T",sa=n("T",!1),aa="t",ua=n("t",!1),la=o("[100] NumericExpression"),ca=o("[101] AdditiveExpression"),fa="-",ha=n("-",!1),pa=o("[102] MultiplicativeExpression"),da=o("[103] UnaryExpression"),ga=o("[104] PrimaryExpression"),va=o("[105] BrackettedExpression"),ya=o("[106] BuiltInCall"),ma="STR",ba=n("STR",!1),wa="str",xa=n("str",!1),_a="LANG",ka=n("LANG",!1),ja="lang",La=n("lang",!1),Aa="LANGMATCHES",Ia=n("LANGMATCHES",!1),Ea="langmatches",Ca=n("langmatches",!1),Oa="DATATYPE",Fa=n("DATATYPE",!1),Sa="datatype",Ra=n("datatype",!1),Ta="BOUND",Ma=n("BOUND",!1),Na="bound",Da=n("bound",!1),Pa="IRI",Ua=n("IRI",!1),Qa="iri",Ba=n("iri",!1),Wa="URI",qa=n("URI",!1),Xa="uri",Ga=n("uri",!1),za="BNODE",Ha=n("BNODE",!1),Va="bnode",$a=n("bnode",!1),Ja="COALESCE",Ya=n("COALESCE",!1),Ka="coalesce",Za=n("coalesce",!1),eu="IF",tu=n("IF",!1),ru="if",nu=n("if",!1),iu="ISLITERAL",ou=n("ISLITERAL",!1),su="isliteral",au=n("isliteral",!1),uu="isLITERAL",lu=n("isLITERAL",!1),cu="ISBLANK",fu=n("ISBLANK",!1),hu="isblank",pu=n("isblank",!1),du="isBLANK",gu=n("isBLANK",!1),vu="SAMETERM",yu=n("SAMETERM",!1),mu="sameterm",bu=n("sameterm",!1),wu="ISURI",xu=n("ISURI",!1),_u="isuri",ku=n("isuri",!1),ju="isURI",Lu=n("isURI",!1),Au="ISIRI",Iu=n("ISIRI",!1),Eu="isiri",Cu=n("isiri",!1),Ou="isIRI",Fu=n("isIRI",!1),Su="custom:",Ru=n("custom:",!1),Tu="CUSTOM:",Mu=n("CUSTOM:",!1),Nu=/^[a-zA-Z0-9_]/,Du=i([["a","z"],["A","Z"],["0","9"],"_"],!1,!1),Pu=o("[107] RegexExpression"),Uu="REGEX",Qu=n("REGEX",!1),Bu="regex",Wu=n("regex",!1),qu=o("[108] ExistsFunc"),Xu="EXISTS",Gu=n("EXISTS",!1),zu="exists",Hu=n("exists",!1),Vu=o("[109] NotExistsFunc"),$u="NOT",Ju=n("NOT",!1),Yu="not",Ku=n("not",!1),Zu=o("[110] Aggregate"),el="COUNT",tl=n("COUNT",!1),rl="count",nl=n("count",!1),il="GROUP_CONCAT",ol=n("GROUP_CONCAT",!1),sl="group_concat",al=n("group_concat",!1),ul="SEPARATOR",ll=n("SEPARATOR",!1),cl="SUM",fl=n("SUM",!1),hl="sum",pl=n("sum",!1),dl="MIN",gl=n("MIN",!1),vl="min",yl=n("min",!1),ml="MAX",bl=n("MAX",!1),wl="max",xl=n("max",!1),_l="AVG",kl=n("AVG",!1),jl="avg",Ll=n("avg",!1),Al=o("[117] IRIrefOrFunction"),Il=o("[112] RDFLiteral"),El="^^",Cl=n("^^",!1),Ol=o("[113] NumericLiteral"),Fl=o("[114] NumericLiteralUnsigned"),Sl=o("[115] NumericLiteralPositive"),Rl=o("[116] NumericLiteralNegative"),Tl=o("[117] BooleanLiteral"),Ml="TRUE",Nl=n("TRUE",!1),Dl="true",Pl=n("true",!1),Ul="FALSE",Ql=n("FALSE",!1),Bl="false",Wl=n("false",!1),ql=o("[118] String"),Xl=function(e){return{token:"string",value:e}},Gl=o("[119] IRIref"),zl=o("[120] PrefixedName"),Hl=o("[121] BlankNode"),Vl=o("[122] IRI_REF"),$l=/^[^<>"{}|\^`\\]/,Jl=i('<>"{}|^`\\'.split(""),!0,!1),Yl=o("[123] PNAME_NS"),Kl=":",Zl=n(":",!1),ec=o("[124] PNAME_LN"),tc=o("[125] BLANK_NODE_LABEL"),rc="_:",nc=n("_:",!1),ic=o("[126] VAR1"),oc=o("[127] VAR2"),sc="$",ac=n("$",!1),uc=o("[128] LANGTAG"),lc="@",cc=n("@",!1),fc=/^[a-zA-Z]/,hc=i([["a","z"],["A","Z"]],!1,!1),pc=/^[a-zA-Z0-9]/,dc=i([["a","z"],["A","Z"],["0","9"]],!1,!1),gc=o("[129] INTEGER"),vc=/^[0-9]/,yc=i([["0","9"]],!1,!1),mc=o("[130] DECIMAL"),bc=o("[131] DOUBLE"),wc=o("[132] INTEGER_POSITIVE"),xc=o("[133] DECIMAL_POSITIVE"),_c=function(e){return e.value="+"+e.value,e},kc=o("[134] DOUBLE_POSITIVE"),jc=o("[135] INTEGER_NEGATIVE"),Lc=function(e){return e.value="-"+e.value,e},Ac=o("[136] DECIMAL_NEGATIVE"),Ic=o("[137] DOUBLE_NEGATIVE"),Ec=o("[138] EXPONENT"),Cc=/^[eE]/,Oc=i(["e","E"],!1,!1),Fc=/^[+\-]/,Sc=i(["+","-"],!1,!1),Rc=o("[139] STRING_LITERAL1"),Tc="'",Mc=n("'",!1),Nc=/^[^'\\\n\r]/,Dc=i(["'","\\","\n","\r"],!0,!1),Pc=o("[140] STRING_LITERAL2"),Uc='"',Qc=n('"',!1),Bc=/^[^"\\\n\r]/,Wc=i(['"',"\\","\n","\r"],!0,!1),qc=o("[141] STRING_LITERAL_LONG1"),Xc="'''",Gc=n("'''",!1),zc=/^[^'\\]/,Hc=i(["'","\\"],!0,!1),Vc=o("[142] STRING_LITERAL_LONG2"),$c='"""',Jc=n('"""',!1),Yc=/^[^"\\]/,Kc=i(['"',"\\"],!0,!1),Zc=o("[143] ECHAR"),ef="\\",tf=n("\\",!1),rf=/^[tbnrf"']/,nf=i("tbnrf\"'".split(""),!1,!1),of=o("[144] NIL"),sf=o("[145] WS"),af=/^[ ]/,uf=i([" "],!1,!1),lf=/^[\t]/,cf=i(["\t"],!1,!1),ff=/^[\r]/,hf=i(["\r"],!1,!1),pf=/^[\n]/,df=i(["\n"],!1,!1),gf=o(" COMMENT"),vf="#",yf=n("#",!1),mf=/^[^\n\r]/,bf=i(["\n","\r"],!0,!1),wf=o("[146] ANON"),xf=o("[147] PN_CHARS_BASE"),_f=/^[A-Z]/,kf=i([["A","Z"]],!1,!1),jf=/^[a-z]/,Lf=i([["a","z"]],!1,!1),Af=/^[\xC0-\xD6]/,If=i([["\xc0","\xd6"]],!1,!1),Ef=/^[\xD8-\xF6]/,Cf=i([["\xd8","\xf6"]],!1,!1),Of=/^[\xF8-\u02FF]/,Ff=i([["\xf8","\u02ff"]],!1,!1),Sf=/^[\u0370-\u037D]/,Rf=i([["\u0370","\u037d"]],!1,!1),Tf=/^[\u037F-\u1FFF]/,Mf=i([["\u037f","\u1fff"]],!1,!1),Nf=/^[\u200C-\u200D]/,Df=i([["\u200c","\u200d"]],!1,!1),Pf=/^[\u2070-\u218F]/,Uf=i([["\u2070","\u218f"]],!1,!1),Qf=/^[\u2C00-\u2FEF]/,Bf=i([["\u2c00","\u2fef"]],!1,!1),Wf=/^[\u3001-\uD7FF]/,qf=i([["\u3001","\ud7ff"]],!1,!1),Xf=/^[\uF900-\uFDCF]/,Gf=i([["\uf900","\ufdcf"]],!1,!1),zf=/^[\uFDF0-\uFFFD]/,Hf=i([["\ufdf0","\ufffd"]],!1,!1),Vf=/^[\u1000-\uEFFF]/,$f=i([["\u1000","\uefff"]],!1,!1),Jf=o("[148] PN_CHARS_U"),Yf="_",Kf=n("_",!1),Zf=o("[149] VARNAME"),eh=/^[\xB7]/,th=i(["\xb7"],!1,!1),rh=/^[\u0300-\u036F]/,nh=i([["\u0300","\u036f"]],!1,!1),ih=/^[\u203F-\u2040]/,oh=i([["\u203f","\u2040"]],!1,!1),sh=o("[150] PN_CHARS"),ah=o("[151] PN_PREFIX"),uh=o("[152] PN_LOCAL"),lh=o("[170] PLX"),ch=o("[171] PERCENT"),fh="%",hh=n("%",!1),ph=o("[172] HEX"),dh=/^[A-F]/,gh=i([["A","F"]],!1,!1),vh=/^[a-f]/,yh=i([["a","f"]],!1,!1),mh=o("[173] PN_LOCAL_ESC"),bh="~",wh=n("~",!1),xh="&",_h=n("&",!1),kh=0,jh=[{line:1,column:1}],Lh=0,Ah=[],Ih=0;if("startRule"in r){if(!(r.startRule in We))throw Error("Can't start parsing from rule \""+r.startRule+'".');qe=We[r.startRule]}var Eh=function(e){for(var t="",r=0;r<e.length;r++)t="string"==typeof e[r]?t+e[r]:t+e[r].join("");return t},Ch=0,Oh=function(e){var t="";if(null==e)return null;for(var r=0;r<e.length;r++)t+=e[r];return t.toUpperCase()};if((Qe=qe())!==Be&&kh===t.length)return Qe;throw Qe!==Be&&kh<t.length&&a({type:"end"}),function(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}(Ah,Lh<t.length?t.charAt(Lh):null,function(e,t){var r=s(e),n=s(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}(Lh,Lh<t.length?Lh+1:Lh))}}}()},{}],47:[function(e,t,r){e("./btree");var n=e("./utils"),i=e("./lexicon").Lexicon;PersistentLexicon=function(e,t){var r=this;n.registerIndexedDB(r),this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,r.dbName=t||"rdfstorejs";var i=r.indexedDB.open(this.dbName+"_lexicon",1);i.onerror=function(t){e(null,Error("Error opening IndexedDB: "+t.target.errorCode))},i.onsuccess=function(t){r.db=t.target.result,e(r)},i.onupgradeneeded=function(e){r.db=e.target.result,r.db.createObjectStore("knownGraphs",{keyPath:"oid"}).createIndex("uriToken","uriToken",{unique:!0}),r.db.createObjectStore("components",{keyPath:"id",autoIncrement:!0}).createIndex("value","value",{unique:!0})}},PersistentLexicon.prototype.registerGraph=function(e,t,r){if(e!=this.defaultGraphOid){var n=this.db.transaction(["knownGraphs"],"readwrite");n.onerror=function(e){r(null,Error(e.target.statusCode))};var i=n.objectStore("knownGraphs");i.get(t).onsuccess=function(n){n.target.result?r(!0):i.add({oid:e,uriToken:t}).onsuccess=function(e){r(!0)}}}else r()},PersistentLexicon.prototype.registeredGraphs=function(e,t){var r=[],n=this.db.transaction(["knownGraphs"],"readwrite").objectStore("knownGraphs").openCursor();n.onsuccess=function(n){(n=n.target.result)?(r.push(!0===e?n.value.uriToken:n.value.oid),n.continue()):t(r)},n.onerror=function(e){t(null,Error("Error retrieving data from the cursor: "+e.target.errorCode))}},PersistentLexicon.prototype.registerUri=function(e,t){if(e===this.defaultGraphUri)t(this.defaultGraphOid);else{var r=this.db.transaction(["components"],"readwrite").objectStore("components"),n=r.index("value").get("_u:"+e);n.onsuccess=function(n){if(n=n.target.result){n.counter++;var i=n.id;(n=r.put(n)).onsuccess=function(e){t(i)},n.onerror=function(e){t(null,Error("Error updating the URI data"+e.target.errorCode))}}else(n=r.add({value:"_u:"+e,counter:0,uri:!0})).onsuccess=function(e){t(e.target.result)},n.onerror=function(e){t(null,Error("Error inserting the URI data"+e.target.errorCode))}},n.onerror=function(e){t(null,Error("Error retrieving the URI data"+e.target.errorCode))}}},PersistentLexicon.prototype.resolveUri=function(e,t){if(e===this.defaultGraphUri)t(this.defaultGraphOid);else{var r=this.db.transaction(["components"]).objectStore("components").index("value").get("_u:"+e);r.onsuccess=function(e){t(null!=e.target.result?e.target.result.id:-1)},r.onerror=function(e){t(null,Error("Error retrieving uri data "+e.target.errorCode))}}},PersistentLexicon.prototype.resolveUriCost=function(e,t){if(e===this.defaultGraphUri)t(0);else{var r=that.db.transaction(["components"]).objectStore("components").index("value").get("_u:"+e);r.onsuccess=function(e){t(null!=e.target.result?e.target.result.cost:-1)},r.onerror=function(e){t(null,Error("Error retrieving uri data "+e.target.errorCode))}}},PersistentLexicon.prototype.registerBlank=function(e){var t=guid();(t=this.db.transaction(["components"],"readwrite").objectStore("components").add({value:"_b:"+t,counter:0,label:!0})).onsuccess=function(t){e(t.target.result)},t.onerror=function(t){e(null,Error("Error inserting the URI data"+t.target.errorCode))}},PersistentLexicon.prototype.resolveBlankCost=function(e,t){t(0)},PersistentLexicon.prototype.registerLiteral=function(e,t){var r=this.db.transaction(["components"],"readwrite").objectStore("components"),n=r.index("value").get("_l:"+e);n.onsuccess=function(n){if(n=n.target.result){n.counter++;var i=n.id;(n=r.put(n)).onsuccess=function(e){t(i)},n.onerror=function(e){t(null,Error("Error updating the literal data"+e.target.errorCode))}}else(n=r.add({value:"_l:"+e,counter:0,literal:!0})).onsuccess=function(e){t(e.target.result)},n.onerror=function(e){t(null,Error("Error inserting the literal data"+e.target.errorCode))}},n.onerror=function(e){t(null,Error("Error retrieving the literal data"+e.target.errorCode))}},PersistentLexicon.prototype.resolveLiteral=function(e,t){var r=that.db.transaction(["components"]).objectStore("components").index("value").get("_l:"+e);r.onsuccess=function(e){t(null!=e.target.result?e.target.result.id:-1)},r.onerror=function(e){t(null,Error("Error retrieving literal data "+e.target.errorCode))}},PersistentLexicon.prototype.resolveLiteralCost=function(e,t){var r=that.db.transaction(["components"]).objectStore("components").index("components").get(e);r.onsuccess=function(e){t(null!=e.target.result?e.target.result.cost:-1)},r.onerror=function(e){t(null,Error("Error retrieving literal data "+e.target.errorCode))}},PersistentLexicon.prototype.parseLiteral=function(e){return i.prototype.parseLiteral(e)},PersistentLexicon.prototype.parseUri=function(e){return i.prototype.parseUri(e)},PersistentLexicon.prototype.retrieve=function(e,t){var r,n=this;e===this.defaultGraphOid?t({token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:!0}):((r=(r=n.db.transaction(["components"])).objectStore("components").get(e)).onsuccess=function(e){null!=e.target.result?null!=e.target.result.label?t({token:"blank",value:"_:"+e.target.result.id}):null!=e.target.result.uri?t(n.parseUri(e.target.result.value.slice(3,e.target.result.value.length))):null!=e.target.result.literal?t(n.parseLiteral(e.target.result.value.slice(3,e.target.result.value.length))):(console.log(e.target.result),t(null,Error("Unknown type of component "+e.target.result))):t(null,null)},r.onerror=function(e){t(null,Error("Error searching in blanks data "+e.target.errorCode))})},PersistentLexicon.prototype.clear=function(e){this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri};var t,r=function(){null!=e&&e()};(t=this.db.transaction(["components"],"readwrite").objectStore("components").clear()).onsuccess=r,t.onerror=r},PersistentLexicon.prototype.unregister=function(e,t,r){var i=this;n.seq(function(r){i._unregisterTerm(e.subject.token,t.subject,r)},function(r){i._unregisterTerm(e.predicate.token,t.predicate,r)},function(r){i._unregisterTerm(e.object.token,t.object,r)},function(r){null!=e.graph?i._unregisterTerm(e.graph.token,t.graph,r):r()})(function(){r(!0)})},PersistentLexicon.prototype._unregisterTerm=function(e,t,r){var n=this.db.transaction(["components","knownGraphs"],"readwrite");"uri"===e?t!=this.defaultGraphOid?(e=n.objectStore("components").delete(t)).onsuccess=void(n.objectStore("knownGraphs").delete(t).onsuccess=function(){r()}):r():(e=n.objectStore("components").delete(t)).onsuccess=function(){r()}},t.exports={PersistentLexicon:PersistentLexicon}},{"./btree":40,"./lexicon":44,"./utils":57}],48:[function(e,t,r){var n=e("./utils");PersistentQuadBackend=function(e,t){var r=this;if(0!==arguments){for(var i in n.registerIndexedDB(r),this.indexMap={},this.indices="S P O G SP SO SG PO PG OG SPO SPG SOG POG SPOG".split(" "),this.componentOrders={S:["subject","predicate","object","graph"],P:["predicate","subject","object","graph"],O:["object","subject","predicate","graph"],G:["graph","subject","predicate","object"],SP:["subject","predicate","object","graph"],SO:["subject","object","predicate","graph"],SG:["subject","graph","predicate","object"],PO:["predicate","object","subject","graph"],PG:["predicate","graph","subject","object"],OG:["object","graph","subject","predicate"],SPO:["subject","predicate","object","graph"],SPG:["subject","predicate","graph","object"],SOG:["subject","object","graph","predicate"],POG:["predicate","object","graph","subject"],SPOG:["subject","predicate","object","graph"]},this.componentOrdersMap={},this.componentOrders){var o=this.componentOrders[i].slice(0,i.length).sort().join(".");this.componentOrdersMap[o]=i}r.dbName=e.name||"rdfstorejs",(i=r.indexedDB.open(this.dbName+"_db",1)).onerror=function(e){t(null,Error("Error opening IndexedDB: "+e.target.errorCode))},i.onsuccess=function(e){r.db=e.target.result,t(r)},i.onupgradeneeded=function(e){var t=e.target.result.createObjectStore(r.dbName,{keyPath:"SPOG"});n.each(r.indices,function(e){"SPOG"!==e&&t.createIndex(e,e,{unique:!1})})}}},PersistentQuadBackend.prototype.index=function(e,t){var r=this;n.each(this.indices,function(t){e[t]=r._genMinIndexKey(e,t)});var i=r.db.transaction([r.dbName],"readwrite");i.oncomplete=function(e){},i.onerror=function(e){t(null,Error(e.target.statusCode))},i.objectStore(r.dbName).add(e).onsuccess=function(e){t(!0)}},PersistentQuadBackend.prototype.range=function(e,t){var r=this.db.transaction([this.dbName]).objectStore(this.dbName),n=this._indexForPattern(e),i=this._genMinIndexKey(e,n),o=this._genMaxIndexKey(e,n),s=(i=this.IDBKeyRange.bound(i,o,!1,!1),[]);("SPOG"===n?r:r.index(n)).openCursor(i).onsuccess=function(e){(e=e.target.result)?(s.push(e.value),e.continue()):t(s)}},PersistentQuadBackend.prototype.search=function(e,t){var r=this.db.transaction([this.dbName]).objectStore(this.dbName),n=this._genMinIndexKey(e,"SPOG");(r=r.get(n)).onerror=function(e){t(null,Error(e.target.statusCode))},r.onsuccess=function(e){t(null!=e.target.result)}},PersistentQuadBackend.prototype.delete=function(e,t){var r=this._genMinIndexKey(e,"SPOG");(r=this.db.transaction([this.dbName],"readwrite").objectStore(this.dbName).delete(r)).onsuccess=function(){t(!0)},r.onerror=function(e){t(null,Error(e.target.statusCode))}},PersistentQuadBackend.prototype._genMinIndexKey=function(e,t){return n.map(this.componentOrders[t],function(t){return"string"==typeof e[t]||null==e[t]?"0":e[t]}).join(".")},PersistentQuadBackend.prototype._genMaxIndexKey=function(e,t){for(var r=this.componentOrders[t],i=[],o=0;o<r.length;o++){var s=e[r[o]];i[o]="string"==typeof s?"z":s}return n.map(i,function(e){return""+e}).join(".")},PersistentQuadBackend.prototype._indexForPattern=function(e){e=e.indexKey.sort().join(".");var t=this.componentOrdersMap[e];if(null==t)throw Error("Error, cannot find index for indexKey "+e);return t},PersistentQuadBackend.prototype.clear=function(e){var t;(t=this.db.transaction([this.dbName],"readwrite").objectStore(this.dbName).clear()).onsuccess=function(){e()},t.onerror=function(){e()}},t.exports.PersistentQuadBackend=PersistentQuadBackend},{"./utils":57}],49:[function(e,t,r){var n=e("./quad_index").QuadIndex,i=e("./utils");QuadBackend=function(e,t){this.indexMap={},this.treeOrder=e.treeOrder,this.indices=e.index||QuadBackend.allIndices,this.componentOrders=QuadBackend.componentOrders;var r=this;i.eachSeries(this.indices,function(e,t){new n({order:r.treeOrder,componentOrder:r.componentOrders[e]},function(n){r.indexMap[e]=n,t()})},function(){t(r)})},QuadBackend.allIndices="SPOG GP OGS POG GSP OS".split(" "),QuadBackend.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]},QuadBackend.prototype._indexForPattern=function(e){e=e.indexKey;for(var t=0;t<QuadBackend.allIndices.length;t++)for(var r=QuadBackend.allIndices[t],n=QuadBackend.componentOrders[r],o=0;o<n.length&&!1!==i.include(e,n[o]);o++)if(o==e.length-1)return r;return"SPOG"},QuadBackend.prototype.index=function(e,t){var r=this;i.eachSeries(this.indices,function(t,n){r.indexMap[t].insert(e,function(){n()})},function(){t(!0)})},QuadBackend.prototype.range=function(e,t){var r=this._indexForPattern(e);null!=(r=this.indexMap[r])&&r.range(e,function(e){t(e)})},QuadBackend.prototype.search=function(e,t){var r=this.indexMap.SPOG;null!=r&&r.search(e,function(e){t(null!=e)})},QuadBackend.prototype.delete=function(e,t){var r=this;i.eachSeries(this.indices,function(t,n){r.indexMap[t].delete(e,function(){n()})},function(){t(!0)})},QuadBackend.prototype.clear=function(e){var t=this;i.eachSeries(this.indices,function(e,r){new n({order:t.treeOrder,componentOrder:t.componentOrders[e]},function(n){t.indexMap[e]=n,r()})},function(){e(!0)})},t.exports.QuadBackend=QuadBackend},{"./quad_index":50,"./utils":57}],50:[function(e,t,r){var n=e("./btree").Tree,i=e("./utils"),o=e("./utils");NodeKey=function(e,t){this.subject=e.subject,this.predicate=e.predicate,this.object=e.object,this.graph=e.graph,this.order=t},NodeKey.prototype.comparator=function(e){for(var t=0;t<this.order.length;t++){var r=this.order[t];if(null==e[r])break;if(this[r]<e[r])return-1;if(this[r]>e[r])return 1}return 0},Pattern=function(e){this.subject=e.subject,this.predicate=e.predicate,this.object=e.object,this.graph=e.graph,this.indexKey=[],this.keyComponents={};var t=[],r=[],n=this;i.forEach(["subject","predicate","object","graph"],function(e){"string"==typeof n[e]?(r.push(e),n.keyComponents[e]=null):(t.push(e),n.keyComponents[e]=n[e],n.indexKey.push(e))}),this.order=t.concat(r),this.key=new NodeKey(this.keyComponents,this.order)},QuadIndex=function(e,t){0!=arguments&&(this.componentOrder=e.componentOrder,n.call(this,e.order,function(e){e.comparator=function(t,r){for(var n=0;n<e.componentOrder.length;n++){var i,o=t[i=e.componentOrder[n]];if(o<(i=r[i]))return-1;if(o>i)return 1}return 0},e.rangeComparator=function(t,r){for(var n=0;n<e.componentOrder.length;n++){var i=e.componentOrder[n];if(null==r[i]||null==t[i])break;if(t[i]<r[i])return-1;if(t[i]>r[i])return 1}return 0},t(e)}))},QuadIndex.prototype=i.create(n.prototype,{constructor:n}),QuadIndex.prototype.insert=function(e,t){n.prototype.insert.call(this,e,null,function(e){t(e)})},QuadIndex.prototype.search=function(e,t){n.prototype.search.call(this,e,function(e){t(e)},!0)},QuadIndex.prototype.range=function(e,t){this._rangeTraverse(this,this.root,e,t)},QuadIndex.prototype._rangeTraverse=function(e,t,r,n){var i=r.key,s=[],a=[t];o.whilst(function(){return 0<a.length},function(t){for(var r=a.shift(),n=0;n<r.numberActives&&-1===e.rangeComparator(r.keys[n].key,i);)n++;if(!0===r.isLeaf){for(var u=n;u<r.numberActives&&0===e.rangeComparator(r.keys[u].key,i);)s.push(r.keys[u].key),u++;t()}else e._diskRead(r.children[n],function(u){a.push(u);var l=n;o.whilst(function(){return l<r.numberActives&&0===e.rangeComparator(r.keys[l].key,i)},function(t){s.push(r.keys[l].key),e._diskRead(r.children[++l],function(e){a.push(e),t()})},function(){t()})})},function(){n(s)})},t.exports={QuadIndex:QuadIndex,Pattern:Pattern,NodeKey:NodeKey}},{"./btree":40,"./utils":57}],51:[function(e,t,r){function n(e,t,r){this.name="BindExpressionError",this.bind=t,this.error=r,this.message=e}var i=e("./abstract_query_tree").AbstractQueryTree,o=e("./abstract_query_tree").NonSupportedSparqlFeatureError,s=e("./utils"),a=e("./quad_index"),u=e("./query_plan").QueryPlan,l=e("./query_filters").QueryFilters,c=e("./rdf_model"),f=e("./rdf_loader").RDFLoader,h=e("./graph_callbacks").CallbacksBackend,p=e("./utils"),d=e("./utils");n.prototype=Error(),n.constructor=n,QueryEngine=function(e){0!=arguments.length&&(this.backend=e.backend,this.lexicon=e.lexicon,this.eventsOnBatchLoad=e.eventsOnBatchLoad||!1,this.defaultPrefixes={},this.abstractQueryTree=new i,this.rdfLoader=new f(e.communication),this.callbacksBackend=new h(this),this.customFns=e.customFns||{})},QueryEngine.prototype.setCustomFunctions=function(e){this.customFns=e},QueryEngine.prototype.registerNsInEnvironment=function(e,t){var r=[];null!=e&&null!=e.prefixes&&(r=e.prefixes);var n,i={};for(n in this.defaultPrefixes)i[n]=this.defaultPrefixes[n];for(n=0;n<r.length;n++){var o=r[n];"prefix"===o.token&&(i[o.prefix]=o.local)}t.namespaces=i,t.base=null!=e&&e.base&&"object"==typeof e.base?e.base.value:null},QueryEngine.prototype.applyModifier=function(e,t){if("DISTINCT"==e){for(var r={},n=[],i=0;i<t.length;i++){var o,s=t[i],a="";for(o in s){var u=s[o];null==u?a=a+o+"null":"literal"==u.token?(null!=u.value&&(a+=u.value),null!=u.lang&&(a+=u.lang),null!=u.type&&(a+=u.type)):a=u.value?a+o+u.value:a+o+u}null==r[a]&&(n.push(s),r[a]=!0)}return n}return t},QueryEngine.prototype.applyLimitOffset=function(e,t,r){return null==t&&null==e?r:(null==e&&(e=0),r.slice(e,t=null==t?r.length:e+t))},QueryEngine.prototype.applySingleOrderBy=function(e,t,r,n,i){var o=[],s=this;p.eachSeries(e,function(e,i){l.collect(e.expression,[t],r,n,s,function(e){o.push(e[0].value),i()})},function(){i({binding:t,value:o})})},QueryEngine.prototype.applyOrderBy=function(e,t,r,n,i){var o=this,s=[];null!=e&&0<e.length?p.eachSeries(t,function(t,i){o.applySingleOrderBy(e,t,r,n,function(e){s.push(e),i()})},function(){s.sort(function(t,r){return o.compareFilteredBindings(t,r,e,n)});for(var t=[],r=0;r<s.length;r++)t.push(s[r].binding);i(t)}):i(t)},QueryEngine.prototype.compareFilteredBindings=function(e,t,r,n){for(var i=0;;){if(i==e.value.length)return 0;var o=r[i].direction;if(null!=e.value[i]||null!=t.value[i]){if(null==e.value[i])e={value:!1};else if(null==t.value[i])e={value:!0};else{if("blank"===e.value[i].token&&"blank"===t.value[i].token){i++;continue}if("blank"===e.value[i].token)e={value:!1};else if("blank"===t.value[i].token)e={value:!0};else if("uri"===e.value[i].token&&"uri"===t.value[i].token){if(1==l.runEqualityFunction(e.value[i],t.value[i],[],this,n).value){i++;continue}e=l.runTotalGtFunction(e.value[i],t.value[i],[])}else if("uri"===e.value[i].token)e={value:!1};else if("uri"===t.value[i].token)e={value:!0};else if("literal"===e.value[i].token&&"literal"===t.value[i].token&&null==e.value[i].type&&null==t.value[i].type){if(1==l.runEqualityFunction(e.value[i],t.value[i],[],this,n).value){i++;continue}e=l.runTotalGtFunction(e.value[i],t.value[i],[])}else if("literal"===e.value[i].token&&null==e.value[i].type)e={value:!1};else if("literal"===t.value[i].token&&null==t.value[i].type)e={value:!0};else{if(1==l.runEqualityFunction(e.value[i],t.value[i],[],this,n).value){i++;continue}e=l.runTotalGtFunction(e.value[i],t.value[i],[])}}return 1==e.value?"ASC"===o?1:-1:"ASC"===o?-1:1}i++}},QueryEngine.prototype.removeDefaultGraphBindings=function(e,t){for(var r=[],n={},i=0;i<t.named.length;i++)n[t.named[i].oid]=!0;for(i=0;i<t.implicit.length;i++)null==n[t.implicit[i].oid]&&r.push(t.implicit[i].oid);for(r=[],i=0;i<e.length;i++){var o,s=e[i],a=!1;for(o in s){for(var u=0;u<n.length;u++)if(s[o]===n[u]){a=!0;break}if(a)break}a||r.push(s)}return r},QueryEngine.prototype.aggregateBindings=function(e,t,r,n,i){this.copyDenormalizedBindings(t,n.outCache,function(t){for(var o={},s=0;s<e.length;s++){var a=l.runAggregator(e[s],t,this,r,n);e[s].alias?o[e[s].alias.value]=a:o[e[s].value.value]=a}i(o)})},QueryEngine.prototype.projectBindings=function(e,t,r){if("*"===e[0].kind)return t;for(var n=[],i=0;i<t.length;i++){for(var o=t[i],s={},a=!0,u=0;u<e.length;u++)if("variable"==e[u].token&&"aliased"!=e[u].kind)s[e[u].value.value]=o[e[u].value.value];else if("variable"==e[u].token&&"aliased"==e[u].kind){var c=l.runFilter(e[u].expression,o,this,r,{blanks:{},outCache:{}});if(l.isEbvError(c)){a=!1;break}s[e[u].alias.value]=c}!0===a&&n.push(s)}return n},QueryEngine.prototype.resolveNsInEnvironment=function(e,t){return t.namespaces[e]},QueryEngine.prototype.normalizeTerm=function(e,t,r,n){if("uri"===e.token)null==(e=s.lexicalFormBaseUri(e,t))?n(null):r?this.lexicon.registerUri(e,n):this.lexicon.resolveUri(e,n);else if("literal"===e.token)e=s.lexicalFormLiteral(e,t),r?this.lexicon.registerLiteral(e,n):this.lexicon.resolveLiteral(e,n);else if("blank"===e.token){var i=e.value;null!=(e=t.blanks[i])?n(e):r?this.lexicon.registerBlank(function(e){t.blanks[i]=e,n(e)}):this.lexicon.resolveBlank(function(e){t.blanks[i]=e,n(e)})}else n("var"===e.token?e.value:null)},QueryEngine.prototype.normalizeDatasets=function(e,t,r){var n=this;p.eachSeries(e,function(e,r){e.value===n.lexicon.defaultGraphUri?(e.oid=n.lexicon.defaultGraphOid,r()):n.normalizeTerm(e,t,!1,function(t){null!=t&&(e.oid=t),r()})},function(){r(!0)})},QueryEngine.prototype.normalizeQuad=function(e,t,r,n){var i=null,o=null,a=null,u=null,l=this,c=!1;p.seq(function(n){if(null==e.graph||e.graph.value===l.lexicon.defaultGraphUri)u=0,n();else{var i=s.lexicalFormBaseUri(e.graph,t);l.normalizeTerm(e.graph,t,r,function(t){null!=t?(u=t,!0===r&&"var"!=e.graph.token?l.lexicon.registerGraph(t,i,function(){n()}):n()):(c=!0,n())})}},function(n){!1===c?l.normalizeTerm(e.subject,t,r,function(e){null!=e?i=e:c=!0,n()}):n()},function(n){!1===c?l.normalizeTerm(e.predicate,t,r,function(e){null!=e?o=e:c=!0,n()}):n()},function(n){!1===c?l.normalizeTerm(e.object,t,r,function(e){null!=e?a=e:c=!0,n()}):n()})(function(){n(!0===c?null:{subject:i,predicate:o,object:a,graph:u})})},QueryEngine.prototype.denormalizeBindingsList=function(e,t,r){var n=this,i=[];p.eachSeries(e,function(e,r){n.denormalizeBindings(e,t,function(e){i.push(e),r()})},function(){r(i)})},QueryEngine.prototype.copyDenormalizedBindings=function(e,t,r){var n=this,i=[];p.eachSeries(e,function(e,r){var o={},s=d.keys(e);p.eachSeries(s,function(r,i){var s=e[r];if(null==s)o[r]=null,i();else if("object"==typeof s)o[r]=s,i();else{var a=t[s];null!=a?(o[r]=a,i()):n.lexicon.retrieve(s,function(e){t[s]=e,o[r]=e,i()})}},function(){i.push(o),r()})},function(){r(i)})},QueryEngine.prototype.denormalizeBindings=function(e,t,r){var n=d.keys(e),i=t.outCache,o=this;p.eachSeries(n,function(r,n){var s=e[r];null==s?(e[r]=null,n()):"object"==typeof s?n():null!=i[s]?(e[r]=i[s],n()):o.lexicon.retrieve(s,function(i){e[r]=i,"blank"===i.token&&(t.blanks[i.value]=s),n()})},function(){r(e)})},QueryEngine.prototype.execute=function(e,t,r,n){if(e=s.normalizeUnicodeLiterals(e),null==(e=this.abstractQueryTree.parseQueryString(e)))t(!1,"Error parsing query string");else if("query"===e.token&&"update"==e.kind){this.callbacksBackend.startGraphModification();var i=this;this.executeUpdate(e,function(e,r){i.lexicon.updateAfterWrite&&i.lexicon.updateAfterWrite(),e?(i.callbacksBackend.cancelGraphModification(),t(e,r)):i.callbacksBackend.endGraphModification(function(){t(e,r)})})}else"query"===e.token&&"query"==e.kind&&this.executeQuery(e,t,r,n)},QueryEngine.prototype.executeQuery=function(e,t,r,n){var i=e.units,o=this,s={blanks:{},outCache:{}};this.registerNsInEnvironment(e.prologue,s);var a=o.abstractQueryTree.parseExecutableUnit(i[0]);"select"===a.kind?this.executeSelect(a,s,r,n,function(e,r){null==e?"object"==typeof r&&!0===r.denorm?t(null,r.bindings):o.denormalizeBindingsList(r,s,function(e){t(null,e)}):t(e)}):"ask"===a.kind?(a.projection=[{token:"variable",kind:"*"}],this.executeSelect(a,s,r,n,function(e,r){null==e?t(null,0<r.length):t(e)})):"construct"===a.kind&&(a.projection=[{token:"variable",kind:"*"}],o=this,this.executeSelect(a,s,r,n,function(e,r){null==e?o.denormalizeBindingsList(r,s,function(e){if(null!=e){var r=new c.Graph;null==a.template&&(a.template={triplesContext:a.pattern});for(var n=1,i=[],u=0;u<e.length;u++){for(var l=e[u],f=0;f<i.length;f++)delete i[f].valuetmp;for(f=0;f<a.template.triplesContext.length;f++){for(var h=["subject","predicate","object"],p=a.template.triplesContext[f],d=0;d<h.length;d++){var g=h[d];if("blank"===p[g].token&&(!p[g].valuetmp||null==p[g].valuetmp)){var v="_:b"+n;n++,p[g].valuetmp=v,i.push(p[g])}}h=c.buildRDFResource(p.subject,l,o,s),d=c.buildRDFResource(p.predicate,l,o,s),p=c.buildRDFResource(p.object,l,o,s),null!=h&&null!=d&&null!=p&&(d=new c.Triple(h,d,p),r.add(d))}}t(null,r)}else t(Error("Error denormalizing bindings."))}):t(e)}))},QueryEngine.prototype.executeSelect=function(e,t,r,n,i){if("select"===e.kind||"ask"===e.kind||"construct"===e.kind||"modify"===e.kind){var o=e.projection,s=e.dataset,a=e.modifier,u=e.limit,l=e.offset,c=e.order,f=this;null==r&&null==n||(s.implicit=r||[],s.named=n||[]),null!=s.implicit&&0===s.implicit.length&&null!=s.named&&0===s.named.length&&s.implicit.push(this.lexicon.defaultGraphUriTerm),f.normalizeDatasets(s.implicit.concat(s.named),t,function(){try{f.executeSelectUnit(o,s,e.pattern,t,function(r){if(null!=r){if(null!=e.group&&""===e.group){for(var n=!1,h=0;h<e.projection.length;h++)if(null!=e.projection[h].expression&&"aggregate"===e.projection[h].expression.expressionType){n=!0;break}!0===n&&(e.group="singleGroup")}e.group&&""!=e.group?f.checkGroupSemantics(e.group,o)?f.groupSolution(r,e.group,s,t,function(e){var r=[];p.eachSeries(e,function(e,n){f.aggregateBindings(o,e,s,t,function(e){r.push(e),n()})},function(){i(null,{bindings:r,denorm:!0})})}):i(Error("Incompatible Group and Projection variables")):f.applyOrderBy(c,r,s,t,function(e){e=f.projectBindings(o,e,s),e=f.applyModifier(a,e),e=f.applyLimitOffset(l,u,e),e=f.removeDefaultGraphBindings(e,s),i(null,e)})}else i(Error("Error executing SELECT query."))})}catch(e){i(e)}})}else i(Error("Cannot execute "+e.kind+" query as a select query"))},QueryEngine.prototype.groupSolution=function(e,t,r,n,i){var o=[],s=[],a=!1,u=this;"singleGroup"===t?i([e]):p.eachSeries(e,function(e,i){var c=!0;p.eachSeries(t,function(t,i){var s=null;if("var"===t.token)s=t.value,0==a&&o.push(s),i();else if("aliased_expression"===t.token){if(s=t.alias.value,0==a&&o.push(s),"var"===t.expression.primaryexpression)e[t.alias.value]=e[t.expression.value.value];else{var f=u.copyDenormalizedBindings([e],n.outCache);f=l.runFilter(t.expression,f[0],u,r,n),l.isEbvError(f)?c=!1:(null!=f.value&&(f.value=""+f.value),e[t.alias.value]=f)}i()}else u.copyDenormalizedBindings([e],n.outCache,function(r){r=l.runFilter(t,r[0],u,n),l.isEbvError(r)?c=!1:(e["groupCondition"+env._i]=r,s="groupCondition"+env._i,0==a&&o.push(s)),i()})},function(){0==a&&(a=!0),!0===c&&s.push(e),i()})},function(){for(var e={},t=0;t<s.length;t++){for(var r=s[t],n="",a=0;a<o.length;a++){var u=r[o[a]];n="object"==typeof u?n+u.value:n+u}null==e[n]?e[n]=[r]:e[n].push(r)}var l;for(l in t=[],e)t.push(e[l]);i(t)})},QueryEngine.prototype.executeSelectUnit=function(e,t,r,n,i){if("BGP"===r.kind)this.executeAndBGP(e,t,r,n,i);else if("UNION"===r.kind)this.executeUNION(e,t,r.value,n,i);else if("JOIN"===r.kind)this.executeJOIN(e,t,r,n,i);else if("LEFT_JOIN"===r.kind)this.executeLEFT_JOIN(e,t,r,n,i);else if("FILTER"===r.kind){var s=this;this.executeSelectUnit(e,t,r.value,n,function(e){null!=e?l.checkFilters(r,e,!1,t,n,s,i):i([])})}else{if("EMPTY_PATTERN"!==r.kind)throw new o(r.kind);i([])}},QueryEngine.prototype.executeUNION=function(e,t,r,i,o){var s,a,c=r[0],f=r[1],h=null;if(2!=r.length)throw"SPARQL algebra UNION with more than two components";var d=this;p.seq(function(r){try{d.executeSelectUnit(e,t,c,i,function(e){s=e,r()})}catch(e){h=e,r()}},function(r){if(null==h)try{d.executeSelectUnit(e,t,f,i,function(e){a=e,r()})}catch(e){h=e,r()}else r()})(function(){if(null!=h)o(h);else{var e=u.unionBindings(s,a);d.runBinds(r.binds,e,t,i,function(e,s){if(null!=e)throw new n("Error processing bind expressions",r.binds,e);l.checkFilters(r,s,!1,t,i,d,o)})}})},QueryEngine.prototype.executeAndBGP=function(e,t,r,i,o){var s=this;u.executeAndBGPsDPSize(r.value,t,this,i,function(e){null!=e?s.runBinds(r.binds,e,t,i,function(e,a){if(null!=e)throw new n("Error processing bind expressions",r.binds,e);l.checkFilters(r,a,!1,t,i,s,o)}):o(null)})},QueryEngine.prototype.executeLEFT_JOIN=function(e,t,r,i,o){var s=r.lvalue,a=r.rvalue;if("EMPTY_PATTERN"===s.kind)this.executeSelectUnit(e,t,a,i,o);else{var c,f,h=null,d=null,g=null,v=this;p.seq(function(r){try{v.executeSelectUnit(e,t,s,i,function(e){h=e,r()})}catch(e){g=e,r()}},function(r){if(null!=g)r();else try{v.executeSelectUnit(e,t,a,i,function(e){d=e,r()})}catch(e){g=e,r()}})(function(){if(null!=g)o(g);else{var e=u.leftOuterJoinBindings(h,d);v.runBinds(r.binds,e,t,i,function(s,a){if(null!=s)throw new n("Error processing bind expressions",r.binds,s);l.checkFilters(r,e,!0,t,i,v,function(e){if(1<h.length&&1<d.length){var t,r=[],n={};for(t in h[0])n[t]=!0;for(t in d[0])1!=n[t]&&r.push(t);for(c=[],f={},n=0;n<e.length;n++)if(!0===e[n].__nullify__){for(var i=0;i<r.length;i++)e[n].bindings[r[i]]=null;i=[];var s=[];for(t in e[n].bindings)null!=e[n].bindings[t]&&(i.push(t+e[n].bindings[t]),i.sort(),s.push(i.join("")));if(null==f[i.join("")]){for(i=0;i<s.length;i++)f[s[i]]=!0;c.push(e[n].bindings)}}else for(t in c.push(e[n]),i=[],e[n])i.push(t+e[n][t]),i.sort(),f[i.join("")]=!0;o(c)}else o(e)})})}})}},QueryEngine.prototype.executeJOIN=function(e,t,r,i,o){var s=r.lvalue,a=r.rvalue,c=null,f=null,h=null,d=this;p.seq(function(r){try{d.executeSelectUnit(e,t,s,i,function(e){c=e,r()})}catch(e){h=e,r()}},function(r){if(null!=h)r();else try{d.executeSelectUnit(e,t,a,i,function(e){f=e,r()})}catch(e){h=e,r()}})(function(){var e=null;if(null!=h)o(h);else if(0===c.length||0===f.length)o([]);else{e={};var p,g=[];for(p in c[0])e[p]=!1;for(p in f[0])!1===e[p]&&g.push(p);e=0==g.length?u.joinBindings(c,f):d.abstractQueryTree.treeWithUnion(s)||d.abstractQueryTree.treeWithUnion(a)?u.joinBindings(c,f):u.joinBindings2(g,c,f),d.runBinds(r.binds,e,t,i,function(e,s){if(null!=e)throw new n("Error processing bind expressions",r.binds,e);l.checkFilters(r,s,!1,t,i,d,o)})}})},QueryEngine.prototype.rangeQuery=function(e,t,r){var n=this;n.normalizeQuad(e,t,!1,function(e){null!=e?n.backend.range(new a.Pattern(e),function(e){r(null==e||0==e.length?[]:e)}):r(null)})},QueryEngine.prototype.executeUpdate=function(e,t){var r=e.units,n=this,i={blanks:{},outCache:{}};this.registerNsInEnvironment(e.prologue,i);for(var o=0;o<r.length;o++){var a=n.abstractQueryTree.parseExecutableUnit(r[o]);if("insertdata"===a.kind){var u=null;p.eachSeries(a.quads,function(e,t){null===u?n._executeQuadInsert(e,i,function(e){null!=e&&(u=e),t()}):t()},function(){null===u?t(null,!0):t(u)})}else if("deletedata"===a.kind)u=null,p.eachSeries(a.quads,function(e,t){null===u?n._executeQuadDelete(e,i,function(e){null!=e&&(u=e),t()}):t()},function(){null===u?t(null,!0):t(u)});else if("modify"===a.kind)this._executeModifyQuery(a,i,t);else if("create"===a.kind)t(!0);else if("load"===a.kind){var l={uri:s.lexicalFormBaseUri(a.sourceGraph,i)};null!=a.destinyGraph&&(l={uri:s.lexicalFormBaseUri(a.destinyGraph,i)}),n=this,this.rdfLoader.load(a.sourceGraph.value,l,function(e,r){e?t(Error("error batch loading quads")):n.batchLoad(r,function(e){null!==e?t(null,e):t(Error("Error batch loading quads"))})})}else if("drop"===a.kind)this._executeClearGraph(a.destinyGraph,i,t);else{if("clear"!==a.kind)throw Error("not supported execution unit");this._executeClearGraph(a.destinyGraph,i,t)}}},QueryEngine.prototype.batchLoad=function(e,t){var r=0,n={},i=this;this.eventsOnBatchLoad&&this.callbacksBackend.startGraphModification();var o=function(e,t,r,o){var s;if(e[t].uri||"uri"===e[t].token){var a=e[t].uri||e[t].value;i.lexicon.registerUri(a,function(n){var s=function(){null!=e[t].uri&&(e[t]={token:"uri",value:e[t].uri},delete e[t].uri),r[t]=n,o()};"graph"===t?i.lexicon.registerGraph(n,a,function(){s()}):s()})}else e[t].literal||"literal"===e[t].token?i.lexicon.registerLiteral(e[t].literal||e[t].value,function(n){null!=e[t].literal&&(e[t]=i.lexicon.parseLiteral(e[t].literal),delete e[t].literal),r[t]=n,o()}):null==(s=n[e[t].blank||e[t].value])?i.lexicon.registerBlank(function(i){n[e[t].blank||e[t].value]=i,null==e[t].token&&(e[t].token="blank",e[t].value=e[t].blank,delete e[t].blank),r[t]=i,o()}):(null==e[t].token&&(e[t].token="blank",e[t].value=e[t].blank,delete e[t].blank),r[t]=s,o())};p.eachSeries(e,function(e,t){var n={};p.eachSeries(["subject","predicate","object","graph"],function(t,r){o(e,t,n,r)},function(){var o=e,s=new a.NodeKey(e=n);i.backend.search(s,function(n){n?t():i.backend.index(s,function(n){n&&(i.eventsOnBatchLoad&&i.callbacksBackend.nextGraphModification(h.added,[o,e]),r+=1),t()})})})},function(){null!=i.lexicon.updateAfterWrite&&i.lexicon.updateAfterWrite();var e=function(){t(r)};i.eventsOnBatchLoad?i.callbacksBackend.endGraphModification(e()):e()})},QueryEngine.prototype._executeModifyQuery=function(e,t,r){var n=this,i=!0,o=Error("Error executing modify query"),s=null,a=["subject","predicate","object","graph"];e.insert=null==e.insert?[]:e.insert,e.delete=null==e.delete?[]:e.delete,p.seq(function(r){var a=[],u=[];if(null!=e.with&&a.push(e.with),null!=e.using){u=[];for(var l=0;l<e.using.length;l++){var c=e.using[l];"named"===c.kind?u.push(c.uri):a.push(c.uri)}}e.dataset={},e.projection=[{token:"variable",kind:"*"}],n.executeSelect(e,t,a,u,function(e,a){if(e)return o=e,i=!1,r();n.denormalizeBindingsList(a,t,function(e){null!=e?s=e:(o=Error("Error denormalizing bindings list"),i=!1),r()})})},function(r){var o=e.with;if(i){for(var u=[],l=0;l<e.delete.length;l++)for(var c=e.delete[l],f=0;f<s.length;f++){for(var h={},d=s[f],g=0;g<a.length;g++){var v=a[g];"graph"==v&&null==c[v]?h.graph=o:h[v]="var"===c[v].token?d[c[v].value]:c[v]}u.push(h)}p.eachSeries(u,function(e,r){n._executeQuadDelete(e,t,function(){r()})},function(){r()})}else r()},function(r){var o=e.with;if(i){for(var u=[],l=0;l<e.insert.length;l++)for(var c=e.insert[l],f=0;f<s.length;f++){for(var h={},d=s[f],g=0;g<a.length;g++){var v=a[g];"graph"==v&&null==c[v]?h.graph=o:h[v]="var"===c[v].token?d[c[v].value]:c[v]}u.push(h)}p.eachSeries(u,function(e,r){n._executeQuadInsert(e,t,function(){r()})},function(){r()})}else r()})(function(){r(i?null:o)})},QueryEngine.prototype._executeQuadInsert=function(e,t,r){var n,i=this,o=!1,s=null;p.seq(function(r){i.normalizeQuad(e,t,!0,function(e){null!=e?n=e:(o=!0,s="Error normalizing quad."),r()})},function(t){if(!1===o){var r=new a.NodeKey(n);i.backend.search(r,function(o){!0===o?t():i.backend.index(r,function(){i.callbacksBackend.nextGraphModification(h.added,[e,n]),t()})})}else t()})(function(){o?r(Error(s)):r(null,!0)})},QueryEngine.prototype._executeQuadDelete=function(e,t,r){var n,i,o,s=this,u=!1;p.seq(function(r){s.normalizeQuad(e,t,!0,function(e){null!=e?n=e:(u=!0,i="Error normalizing quad."),r()})},function(e){!1===u?(o=new a.NodeKey(n),s.backend.delete(o,function(){e()})):e()},function(t){!1===u?s.lexicon.unregister(e,o,function(){s.callbacksBackend.nextGraphModification(h.deleted,[e,n]),t()}):t()})(function(){u?r(Error(i)):r(null,!0)})},QueryEngine.prototype._executeClearGraph=function(e,t,r){var n=this;"default"===e?this.execute("DELETE { ?s ?p ?o } WHERE { ?s ?p ?o }",r):"named"===e?n.lexicon.registeredGraphs(!0,function(e){if(null!=e){var t=!1;p.eachSeries(e,function(e,r){t?r():n.execute("DELETE { GRAPH <"+e+"> { ?s ?p ?o } } WHERE { GRAPH <"+e+"> { ?s ?p ?o } }",function(i,o){i?(t=i,r()):n.lexicon.resolveUri(e,function(i){-1!=i?n.lexicon.knownGraphs.delete(i,function(){r()}):(t="Cannot find graph "+e+" to clear it",r())})})},function(){r(!t)})}else r(!1,"Error deleting named graphs")}):"all"===e?(n=this,this.execute("CLEAR DEFAULT",function(e,t){e?r(!1,t):n.execute("CLEAR NAMED",r)})):"uri"==e.token&&null!=(e=s.lexicalFormBaseUri(e,t))?(this.callbacksBackend.ongoingModification=!0,this.execute("DELETE { GRAPH <"+e+"> { ?s ?p ?o } } WHERE { GRAPH <"+e+"> { ?s ?p ?o } }",function(e){n.callbacksBackend.ongoingModification=!1,r(e)})):r(!1,"wrong graph URI")},QueryEngine.prototype.checkGroupSemantics=function(e,t){if("singleGroup"===e)return!0;for(var r={},n=0;n<e.length;n++){var i=e[n];"var"===i.token?r[i.value]=!0:"aliased_expression"===i.token&&(r[i.alias.value]=!0)}for(n=0;n<t.length;n++)if("var"===(i=t[n]).kind){if(null==r[i.value.value])return!1}else if("aliased"===i.kind&&i.expression&&"var"===i.expression.primaryexpression&&null==r[i.expression.value.value])return!1;return!0},QueryEngine.prototype.runBinds=function(e,t,r,n,i){var o=this;null!=e&&0<e.length?o.copyDenormalizedBindings(t,n.outCache,function(s){for(var a=0;a<t.length;a++)for(var u=0;u<e.length;u++){var c=e[u],f=l.runFilter(c.expression,s[a],o,r,n);l.isEbvError(f)?i(f):t[a][c.as.value]=f}i(null,t)}):i(null,t)},QueryEngine.prototype.computeCosts=function(e,t,r){for(var n=0;n<e.length;n++)e[n]._cost=this.quadCost(e[n],t);r(e)},QueryEngine.prototype.quadCost=function(e,t){return 1},QueryEngine.prototype.registerDefaultNamespace=function(e,t){this.defaultPrefixes[e]=t},t.exports={QueryEngine:QueryEngine}},{"./abstract_query_tree":39,"./graph_callbacks":42,"./quad_index":50,"./query_filters":52,"./query_plan":53,"./rdf_loader":54,"./rdf_model":55,"./utils":57}],52:[function(e,t,r){var n=e("./utils"),i=e("./utils");QueryFilters={checkFilters:function(e,t,r,n,o,s,a){var u=[];e.filter&&"function"!=typeof e.filter&&(u=e.filter);var l=[];if(null==u||0===u.length||null!=e.length)return a(t);QueryFilters.preprocessExistentialFilters(u,t,s,n,o,function(e){i.eachSeries(e,function(e,i){QueryFilters.run(e.value,t,r,n,o,s,function(e){for(var r=[],n=0;n<e.length;n++){var o=e[n];null!=o.__nullify__?l.push(o):r.push(o)}t=r,i()})},function(){a(t.concat(l))})})},preprocessExistentialFilters:function(e,t,r,o,s,a){var u=[];i.eachSeries(e,function(e,a){if("builtincall"!==e.value.expressionType||"exists"!==e.value.builtincall&&"notexists"!==e.value.builtincall)if("conditionalor"===e.value.expressionType||"conditionaland"===e.value.expressionType){var l=n.map(e.value.operands,function(e){return{value:e}});QueryFilters.preprocessExistentialFilters(l,t,r,o,s,function(t){e.value.operands=t.map(function(e){return e.value}),u.push(e),a()})}else"multiplicativeexpression"===e.value.expressionType?(l=n.map(e.value.factors,function(e){return{value:e}}),QueryFilters.preprocessExistentialFilters(l,t,r,o,s,function(t){e.value.factors=t.map(function(e){return e.value}),u.push(e),a()})):"additiveexpression"===e.value.expressionType?(l=n.map(e.value.summands,function(e){return{value:e}}),QueryFilters.preprocessExistentialFilters(l,t,r,o,s,function(t){e.value.summands=t.map(function(e){return e.value}),u.push(e),a()})):"relationalexpression"===e.value.expressionType?(l=[{value:e.value.op1},{value:e.value.op2}],QueryFilters.preprocessExistentialFilters(l,t,r,o,s,function(t){e.value.op1=t[0].value,e.value.op2=t[1].value,u.push(e),a()})):"irireforfunction"!==e.value.expressionType&&"custom"!==e.value.expressionType||null==e.value.args?(u.push(e),a()):(l=n.map(e.value.args,function(e){return{value:e}}),QueryFilters.preprocessExistentialFilters(l,t,r,o,s,function(t){e.value.args=t.map(function(e){return e.value}),u.push(e),a()}));else{var c=e.value.builtincall,f=e.value.args,h={};r.copyDenormalizedBindings(t,s.outCache,function(t){i.eachSeries(t,function(e,t){var i=n.clone(f[0],!0);i=r.abstractQueryTree.parseSelect({pattern:i},e),i=r.abstractQueryTree.bind(i.pattern,e),r.executeSelectUnit([{kind:"*"}],o,i,s,function(r){var n="exists"===c?QueryFilters.ebvBoolean(0!==r.length):QueryFilters.ebvBoolean(0===r.length);for(var i in r=[],e)r.push(JSON.stringify(e[i]));r=r.sort().join(""),h[r]=n,t()})},function(){e.value.origArgs=e.value.args,e.value.args=h,u.push(e),a()})})}},function(){a(u)})},boundVars:function(e){if(null==e.expressionType)throw"Cannot find bound expressions in a no expression token";if("relationalexpression"==(r=e.expressionType))return r=e.op2,QueryFilters.boundVars(e.op1)+QueryFilters.boundVars(r);if("conditionalor"==r||"conditionaland"==r){for(var t=[],r=0;r<e.operands;r++)t=t.concat(QueryFilters.boundVars(e.operands[r]));return t}if("builtincall"==r){if(null==e.args)return[];for(t=[],r=0;r<e.args.length;r++)t=t.concat(QueryFilters.boundVars(e.args[r]));return t}if("multiplicativeexpression"==r){for(t=QueryFilters.boundVars(e.factor),r=0;r<e.factors.length;r++)t=t.concat(QueryFilters.boundVars(e.factors[r].expression));return t}if("additiveexpression"==r){for(t=QueryFilters.boundVars(e.summand),r=0;r<e.summands.length;r++)t=t.concat(QueryFilters.boundVars(e.summands[r].expression));return t}return"regex"==r?(t=QueryFilters.boundVars(e.expression1)).concat(QueryFilters.boundVars(e.expression2)):"unaryexpression"==r?QueryFilters.boundVars(e.expression):"atomic"==r?"var"==e.primaryexpression?[e.value]:[]:void 0},run:function(e,t,r,n,i,o,s){o.copyDenormalizedBindings(t,i.outCache,function(a){for(var u=[],l=0;l<t.length;l++){var c=QueryFilters.runFilter(e,a[l],o,n,i);c=QueryFilters.ebv(c),QueryFilters.isEbvError(c)?r&&u.push(c={__nullify__:!0,bindings:t[l]}):!0===c?u.push(t[l]):r&&u.push(c={__nullify__:!0,bindings:t[l]})}s(u)})},collect:function(e,t,r,n,i,o){i.copyDenormalizedBindings(t,n.outCache,function(s){for(var a=[],u=0;u<s.length;u++){var l=QueryFilters.runFilter(e,s[u],i,r,n);a.push({binding:t[u],value:l})}return o(a)})},runDistinct:function(e,t){},runAggregator:function(e,t,r,i,o){if(null==t||0===t.length)return QueryFilters.ebvError();if("variable"===e.token&&"var"==e.kind)return t[0][e.value.value];if("variable"===e.token&&"aliased"===e.kind){if("atomic"===e.expression.expressionType&&"var"===e.expression.primaryexpression)return t[0][e.expression.value.value];if("aggregate"===e.expression.expressionType){if("max"===e.expression.aggregateType){for(var s=null,a=0;a<t.length;a++){var u=t[a];u=QueryFilters.runFilter(e.expression.expression,u,r,i,o),QueryFilters.isEbvError(u)||(null===s?s=u:!0===QueryFilters.runLtFunction(s,u).value&&(s=u))}return null===s?QueryFilters.ebvError():s}if("min"===e.expression.aggregateType){for(s=null,a=0;a<t.length;a++)u=t[a],u=QueryFilters.runFilter(e.expression.expression,u,r,i,o),QueryFilters.isEbvError(u)||(null===s?s=u:!0===QueryFilters.runGtFunction(s,u).value&&(s=u));return null===s?QueryFilters.ebvError():s}if("count"===e.expression.aggregateType){s={};var l=0;if("*"===e.expression.expression)if(null!=e.expression.distinct&&""!=e.expression.distinct)for(a=0;a<t.length;a++){var c=n.hashTerm(u=t[a]);null==s[c]&&(s[c]=!0,l++)}else l=t.length;else for(a=0;a<t.length;a++)u=t[a],u=QueryFilters.runFilter(e.expression.expression,u,r,i,o),QueryFilters.isEbvError(u)||(null!=e.expression.distinct&&""!=e.expression.distinct?null==s[c=n.hashTerm(u)]&&(s[c]=!0,l++):l++);return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:""+l}}if("avg"===e.expression.aggregateType){s={};var f={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"};for(a=l=0;a<t.length;a++)u=t[a],u=QueryFilters.runFilter(e.expression.expression,u,r,i,o),QueryFilters.isEbvError(u)||(null!=e.expression.distinct&&""!=e.expression.distinct?null==s[c=n.hashTerm(u)]&&(s[c]=!0,QueryFilters.isNumeric(u)&&(f=QueryFilters.runSumFunction(f,u),l++)):QueryFilters.isNumeric(u)&&(f=QueryFilters.runSumFunction(f,u),l++));return(e=QueryFilters.runDivFunction(f,{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:""+l})).value=""+e.value,e}if("sum"===e.expression.aggregateType){for(s={},f={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"},a=0;a<t.length;a++)u=t[a],u=QueryFilters.runFilter(e.expression.expression,u,r,i,o),QueryFilters.isEbvError(u)||(null!=e.expression.distinct&&""!=e.expression.distinct?null==s[c=n.hashTerm(u)]&&(s[c]=!0,QueryFilters.isNumeric(u)&&(f=QueryFilters.runSumFunction(f,u))):QueryFilters.isNumeric(u)&&(f=QueryFilters.runSumFunction(f,u)));return f.value=""+f.value,f}return QueryFilters.runFilter(aggregate.expression,t[0],i,{blanks:{},outCache:{}})}}},runFilter:function(e,t,r,i,o){if(null!=e.expressionType){if("relationalexpression"==(s=e.expressionType)){var s=QueryFilters.runFilter(e.op1,t,r,i,o),a=QueryFilters.runFilter(e.op2,t,r,i,o);return QueryFilters.runRelationalFilter(e,s,a,t,r,i,o)}if("conditionalor"==s)return QueryFilters.runOrFunction(e,t,r,i,o);if("conditionaland"==s)return QueryFilters.runAndFunction(e,t,r,i,o);if("additiveexpression"==s)return QueryFilters.runAddition(e.summand,e.summands,t,r,i,o);if("builtincall"==s)return QueryFilters.runBuiltInCall(e.builtincall,e.args,t,r,i,o);if("multiplicativeexpression"==s)return QueryFilters.runMultiplication(e.factor,e.factors,t,r,i,o);if("unaryexpression"==s)return QueryFilters.runUnaryExpression(e.unaryexpression,e.expression,t,r,i,o);if("irireforfunction"==s)return QueryFilters.runIriRefOrFunction(e.iriref,e.args,t,r,i,o);if("regex"==s)return QueryFilters.runRegex(e.text,e.pattern,e.flags,t,r,i,o);if("custom"==s)return QueryFilters.runBuiltInCall(e.name,e.args,t,r,i,o);if("atomic"==s)return"var"==e.primaryexpression?t[e.value.value]:("object"==typeof e.value&&null!=e.value.type&&"object"==typeof e.value.type&&(e.value.type=n.lexicalFormBaseUri(e.value.type,o)),e.value);throw"Unknown filter expression type"}throw"Cannot find bound expressions in a no expression token"},isRDFTerm:function(e){return null!=e&&!!(e.token&&"literal"==e.token||e.token&&"uri"==e.token||e.token&&"blank"==e.token)},RDFTermEquality:function(e,t,r,i){return"literal"===e.token&&"literal"===t.token?e.lang==t.lang&&e.type==t.type&&e.value==t.value||(null!=e.type&&null!=t.type?QueryFilters.ebvError():QueryFilters.isSimpleLiteral(e)&&null!=t.type?QueryFilters.ebvError():!(!QueryFilters.isSimpleLiteral(t)||null==e.type)&&QueryFilters.ebvError()):"uri"===e.token&&"uri"===t.token?n.lexicalFormBaseUri(e,i)==n.lexicalFormBaseUri(t,i):"blank"===e.token&&"blank"===t.token&&e.value==t.value},isInteger:function(e){return null!=e&&"literal"===e.token&&("http://www.w3.org/2001/XMLSchema#integer"==e.type||"http://www.w3.org/2001/XMLSchema#decimal"==e.type||"http://www.w3.org/2001/XMLSchema#double"==e.type||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==e.type||"http://www.w3.org/2001/XMLSchema#negativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#long"==e.type||"http://www.w3.org/2001/XMLSchema#int"==e.type||"http://www.w3.org/2001/XMLSchema#short"==e.type||"http://www.w3.org/2001/XMLSchema#byte"==e.type||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedLong"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedInt"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedShort"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedByte"==e.type||"http://www.w3.org/2001/XMLSchema#positiveInteger"==e.type)},isFloat:function(e){return null!=e&&"literal"===e.token&&"http://www.w3.org/2001/XMLSchema#float"==e.type},isDecimal:function(e){return null!=e&&"literal"===e.token&&"http://www.w3.org/2001/XMLSchema#decimal"==e.type},isDouble:function(e){return null!=e&&"literal"===e.token&&"http://www.w3.org/2001/XMLSchema#double"==e.type},isNumeric:function(e){return null!=e&&"literal"===e.token&&("http://www.w3.org/2001/XMLSchema#integer"==e.type||"http://www.w3.org/2001/XMLSchema#decimal"==e.type||"http://www.w3.org/2001/XMLSchema#float"==e.type||"http://www.w3.org/2001/XMLSchema#double"==e.type||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==e.type||"http://www.w3.org/2001/XMLSchema#negativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#long"==e.type||"http://www.w3.org/2001/XMLSchema#int"==e.type||"http://www.w3.org/2001/XMLSchema#short"==e.type||"http://www.w3.org/2001/XMLSchema#byte"==e.type||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedLong"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedInt"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedShort"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedByte"==e.type||"http://www.w3.org/2001/XMLSchema#positiveInteger"==e.type)},isSimpleLiteral:function(e){return!(!e||"literal"!=e.token)&&null==e.type&&null==e.lang},isXsdType:function(e,t){return!(!t||"literal"!=t.token)&&t.type=="http://www.w3.org/2001/XMLSchema#"+e},ebv:function(e){if(null==e||QueryFilters.isEbvError(e))return QueryFilters.ebvError();if(e.token&&"literal"===e.token){if("http://www.w3.org/2001/XMLSchema#integer"==e.type||"http://www.w3.org/2001/XMLSchema#decimal"==e.type||"http://www.w3.org/2001/XMLSchema#double"==e.type||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==e.type||"http://www.w3.org/2001/XMLSchema#negativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#long"==e.type||"http://www.w3.org/2001/XMLSchema#int"==e.type||"http://www.w3.org/2001/XMLSchema#short"==e.type||"http://www.w3.org/2001/XMLSchema#byte"==e.type||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedLong"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedInt"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedShort"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedByte"==e.type||"http://www.w3.org/2001/XMLSchema#positiveInteger"==e.type){var t=parseFloat(e.value);return!isNaN(t)&&0!=parseFloat(e.value)}return"http://www.w3.org/2001/XMLSchema#boolean"===e.type?"true"===e.value||!0===e.value||"True"===e.value:"http://www.w3.org/2001/XMLSchema#string"===e.type?""!=e.value:"http://www.w3.org/2001/XMLSchema#dateTime"===e.type?null!=new Date(e.value):QueryFilters.isEbvError(e)?e:null==e.type?""!=e.value:QueryFilters.ebvError()}return!0===e.value}},QueryFilters.effectiveBooleanValue=QueryFilters.ebv,QueryFilters.ebvTrue=function(){return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}},QueryFilters.ebvFalse=function(){return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1}},QueryFilters.ebvError=function(){return{token:"literal",type:"https://github.com/antoniogarrote/js-tools/types#error",value:null}},QueryFilters.isEbvError=function(e){return"object"==typeof e&&null!=e&&"https://github.com/antoniogarrote/js-tools/types#error"===e.type},QueryFilters.ebvBoolean=function(e){return QueryFilters.isEbvError(e)?e:!0===e?QueryFilters.ebvTrue():QueryFilters.ebvFalse()},QueryFilters.runRelationalFilter=function(e,t,r,n,i,o,s){if("="===(e=e.operator))return QueryFilters.runEqualityFunction(t,r,n,i,o,s);if("!="===e)return t=QueryFilters.runEqualityFunction(t,r,n,i,o,s),QueryFilters.isEbvError(t)||(t.value=!t.value),t;if("<"===e)return QueryFilters.runLtFunction(t,r,n);if(">"===e)return QueryFilters.runGtFunction(t,r,n);if("<="===e)return QueryFilters.runLtEqFunction(t,r,n);if(">="===e)return QueryFilters.runGtEqFunction(t,r,n);throw"Error applying relational filter, unknown operator"},QueryFilters.effectiveTypeValue=function(e){if("literal"!=e.token)throw console.log("not implemented yet"),console.log(e),"value not supported in operations yet";if("http://www.w3.org/2001/XMLSchema#integer"==e.type)return parseInt(e.value);if("http://www.w3.org/2001/XMLSchema#decimal"==e.type||"http://www.w3.org/2001/XMLSchema#float"==e.type||"http://www.w3.org/2001/XMLSchema#double"==e.type||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==e.type)return parseFloat(e.value);if("http://www.w3.org/2001/XMLSchema#negativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#long"==e.type||"http://www.w3.org/2001/XMLSchema#int"==e.type||"http://www.w3.org/2001/XMLSchema#short"==e.type||"http://www.w3.org/2001/XMLSchema#byte"==e.type||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedLong"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedInt"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedShort"==e.type||"http://www.w3.org/2001/XMLSchema#unsignedByte"==e.type||"http://www.w3.org/2001/XMLSchema#positiveInteger"==e.type)return parseInt(e.value);if("http://www.w3.org/2001/XMLSchema#date"!=e.type&&"http://www.w3.org/2001/XMLSchema#dateTime"!=e.type)return"http://www.w3.org/2001/XMLSchema#boolean"==e.type?!0===e.value||"true"===e.value||"1"===e.value||1===e.value||!0===e.value||!1!==e.value&&"false"!==e.value&&"0"!==e.value&&0!==e.value&&!1!==e.value&&void 0:"http://www.w3.org/2001/XMLSchema#string"==e.type?null===e.value||void 0===e.value?void 0:""+e.value:e.value;try{return n.parseISO8601(e.value)}catch(e){return null}},QueryFilters.runOrFunction=function(e,t,r,n,i){for(var o=null,s=0;s<e.operands.length;s++){var a=QueryFilters.runFilter(e.operands[s],t,r,n,i);0==QueryFilters.isEbvError(a)&&(a=QueryFilters.ebv(a)),null==o?o=a:QueryFilters.isEbvError(a)?o=QueryFilters.isEbvError(o)?QueryFilters.ebvError():!0===o||QueryFilters.ebvError():!0===a?o=!0:QueryFilters.isEbvError(o)&&(o=QueryFilters.ebvError())}return QueryFilters.ebvBoolean(o)},QueryFilters.runAndFunction=function(e,t,r,n,i){for(var o=null,s=0;s<e.operands.length;s++){var a=QueryFilters.runFilter(e.operands[s],t,r,n,i);0==QueryFilters.isEbvError(a)&&(a=QueryFilters.ebv(a)),null==o?o=a:QueryFilters.isEbvError(a)?o=QueryFilters.isEbvError(o)?QueryFilters.ebvError():!0===o&&QueryFilters.ebvError():!0===a?QueryFilters.isEbvError(o)&&(o=QueryFilters.ebvError()):o=!1}return QueryFilters.ebvBoolean(o)},QueryFilters.runEqualityFunction=function(e,t,r,i,o,s){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)?(r=QueryFilters.effectiveTypeValue(e),o=QueryFilters.effectiveTypeValue(t),isNaN(r)||isNaN(o)?QueryFilters.ebvBoolean(QueryFilters.RDFTermEquality(e,t,i,s)):QueryFilters.ebvBoolean(r==o)):(QueryFilters.isSimpleLiteral(e)||QueryFilters.isXsdType("string",e))&&(QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",t))||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t)?QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)==QueryFilters.effectiveTypeValue(t)):(QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))?QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t)||QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t)?QueryFilters.ebvFalse():null!=(e=n.compareDateComponents(e.value,t.value))?0==e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError():QueryFilters.isRDFTerm(e)&&QueryFilters.isRDFTerm(t)?QueryFilters.ebvBoolean(QueryFilters.RDFTermEquality(e,t,i,s)):QueryFilters.ebvFalse()},QueryFilters.runGtFunction=function(e,t,r){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)||QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t)||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t)?QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>QueryFilters.effectiveTypeValue(t)):(QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))?QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t)||QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t)?QueryFilters.ebvFalse():null!=(e=n.compareDateComponents(e.value,t.value))?1==e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError():QueryFilters.ebvFalse()},QueryFilters.runTotalGtFunction=function(e,t){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)||QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",e)&&QueryFilters.isSimpleLiteral("string",t)||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isSimpleLiteral("boolean",t)||QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isSimpleLiteral("dateTime",t)?QueryFilters.runGtFunction(e,t,[]):e.token&&"uri"===e.token&&t.token&&"uri"===t.token?QueryFilters.ebvBoolean(e.value>t.value):e.token&&"literal"===e.token&&t.token&&"literal"===t.token?QueryFilters.ebvBoolean(""+e.value+e.type+e.lang>""+t.value+t.type+t.lang):e.token&&"blank"===e.token&&t.token&&"blank"===t.token?QueryFilters.ebvBoolean(e.value>t.value):e.value&&t.value?QueryFilters.ebvBoolean(e.value>t.value):QueryFilters.ebvTrue()},QueryFilters.runLtFunction=function(e,t,r){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)||QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t)||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t)?QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<QueryFilters.effectiveTypeValue(t)):(QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))?QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t)||QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t)?QueryFilters.ebvFalse():null!=(e=n.compareDateComponents(e.value,t.value))?-1==e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError():QueryFilters.ebvFalse()},QueryFilters.runGtEqFunction=function(e,t,r){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)||QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t)||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t)?QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>=QueryFilters.effectiveTypeValue(t)):(QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))?QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t)||QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t)?QueryFilters.ebvFalse():null!=(e=n.compareDateComponents(e.value,t.value))?-1!=e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError():QueryFilters.ebvFalse()},QueryFilters.runLtEqFunction=function(e,t,r){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)||QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t)||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t)?QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<=QueryFilters.effectiveTypeValue(t)):(QueryFilters.isXsdType("dateTime",e)||QueryFilters.isXsdType("date",e))&&(QueryFilters.isXsdType("dateTime",t)||QueryFilters.isXsdType("date",t))?QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t)||QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t)?QueryFilters.ebvFalse():null!=(e=n.compareDateComponents(e.value,t.value))?1!=e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError():QueryFilters.ebvFalse()},QueryFilters.runAddition=function(e,t,r,n,i,o){var s=QueryFilters.runFilter(e,r,n,i,o);if(QueryFilters.isEbvError(s))return QueryFilters.ebvError();if(e=s,QueryFilters.isNumeric(s)){for(s=0;s<t.length;s++){var a=QueryFilters.runFilter(t[s].expression,r,n,i,o);if(!QueryFilters.isNumeric(a))return QueryFilters.ebvFalse();"+"===t[s].operator?e=QueryFilters.runSumFunction(e,a):"-"===t[s].operator&&(e=QueryFilters.runSubFunction(e,a))}return e}return QueryFilters.ebvFalse()},QueryFilters.runSumFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var r=QueryFilters.effectiveTypeValue(e)+QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:r}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:r}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:r}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:r}},QueryFilters.runSubFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var r=QueryFilters.effectiveTypeValue(e)-QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:r}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:r}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:r}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:r}},QueryFilters.runMultiplication=function(e,t,r,n,i,o){if(e=QueryFilters.runFilter(e,r,n,i,o),QueryFilters.isEbvError(e))return e;var s=e;if(QueryFilters.isNumeric(e)){for(var a=0;a<t.length;a++){var u=QueryFilters.runFilter(t[a].expression,r,n,i,o);if(QueryFilters.isEbvError(u))return e;if(!QueryFilters.isNumeric(u))return QueryFilters.ebvFalse();"*"===t[a].operator?s=QueryFilters.runMulFunction(s,u):"/"===t[a].operator&&(s=QueryFilters.runDivFunction(s,u))}return s}return QueryFilters.ebvFalse()},QueryFilters.runMulFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var r=QueryFilters.effectiveTypeValue(e)*QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:r}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:r}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:r}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:r}},QueryFilters.runDivFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var r=QueryFilters.effectiveTypeValue(e)/QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:r}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:r}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:r}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:r}},QueryFilters.runBuiltInCall=function(e,t,r,n,i,o){if("notexists"===e||"exists"===e){for(var s in e=[],r)e.push(JSON.stringify(r[s]));return t[e=e.sort().join("")]}s=[];for(var a=0;a<t.length;a++)if("var"===t[a].token)s.push(t[a]);else{var u=QueryFilters.runFilter(t[a],r,n,i,o);if(QueryFilters.isEbvError(u))return u;s.push(u)}if("str"===e)return"literal"===s[0].token?{token:"literal",type:null,value:""+s[0].value}:"uri"===s[0].token?{token:"literal",type:null,value:s[0].value}:QueryFilters.ebvFalse();if("lang"===e)return"literal"===s[0].token?null!=s[0].lang?{token:"literal",value:""+s[0].lang}:{token:"literal",value:""}:QueryFilters.ebvError();if("datatype"===e)return"literal"===s[0].token?null!=(r=s[0]).type?"string"==typeof r.type?{token:"uri",value:r.type,prefix:null,suffix:null}:r.type:null==r.lang?{token:"uri",value:"http://www.w3.org/2001/XMLSchema#string",prefix:null,suffix:null}:QueryFilters.ebvError():QueryFilters.ebvError();if("isliteral"===e)return"literal"===s[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("isblank"===e)return"blank"===s[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("isuri"===e||"isiri"===e)return"uri"===s[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("sameterm"===e)return r=QueryFilters.RDFTermEquality(s[0],s[1],n,o),QueryFilters.isEbvError(r)&&(r=!1),QueryFilters.ebvBoolean(r);if("langmatches"===e)return t=s[1],"literal"===(r=s[0]).token&&"literal"===t.token?"*"===t.value&&""!=r.value?QueryFilters.ebvTrue():QueryFilters.ebvBoolean(0===r.value.toLowerCase().indexOf(t.value.toLowerCase())):QueryFilters.ebvError();if("bound"===e)return null==(t=s[0].value)?QueryFilters.ebvError():null!=r[t]?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if(null!=n.customFns[e])return n.customFns[e](QueryFilters,s);throw"Builtin call "+e+" not implemented yet"},QueryFilters.runUnaryExpression=function(e,t,r,n,i,o){if(t=QueryFilters.runFilter(t,r,n,i,o),QueryFilters.isEbvError(t))return t;if("!"===e){var s=QueryFilters.ebv(t);return QueryFilters.isEbvError(s)?QueryFilters.ebvFalse():QueryFilters.ebvBoolean(!s)}if("+"===e)return QueryFilters.isNumeric(t)?t:QueryFilters.ebvError();if("-"===e){if(QueryFilters.isNumeric(t)){for(s in e={},t)e[s]=t[s];return e.value=-e.value,e}return QueryFilters.ebvError()}},QueryFilters.runRegex=function(e,t,r,n,i,o,s){if(null==e)return QueryFilters.ebvError();if(e=QueryFilters.runFilter(e,n,i,o,s),null==t)return QueryFilters.ebvError();if(t=QueryFilters.runFilter(t,n,i,o,s),null!=r&&(r=QueryFilters.runFilter(r,n,i,o,s)),null==t||"literal"!==t.token||null!=r&&"literal"!==r.token)return QueryFilters.ebvError();if(t=t.value,r=null==r?null:r.value,null!=e&&"var"==e.token){if(null==n[e.value])return QueryFilters.ebvError();e=n[e.value]}else{if(null==e||"literal"!==e.token)return QueryFilters.ebvError();if(null!=e.type&&!QueryFilters.isXsdType("string",e))return QueryFilters.ebvError();e=e.value}return(null==r?new RegExp(t):new RegExp(t,r.toLowerCase())).exec(e)?QueryFilters.ebvTrue():QueryFilters.ebvFalse()},QueryFilters.normalizeLiteralDatatype=function(e,t,r){return null!=e.value.type&&"object"==typeof e.value.type&&(e.value.type=n.lexicalFormBaseUri(e.value.type,r)),e},QueryFilters.runIriRefOrFunction=function(e,t,r,i,o,s){if(null==t)return e;for(var a=[],u=0;u<t.length;u++)a.push(QueryFilters.runFilter(t[u],r,i,o,s));if("http://www.w3.org/2001/XMLSchema#integer"==(e=n.lexicalFormBaseUri(e,s))||"http://www.w3.org/2001/XMLSchema#decimal"==e||"http://www.w3.org/2001/XMLSchema#double"==e||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==e||"http://www.w3.org/2001/XMLSchema#negativeInteger"==e||"http://www.w3.org/2001/XMLSchema#long"==e||"http://www.w3.org/2001/XMLSchema#int"==e||"http://www.w3.org/2001/XMLSchema#short"==e||"http://www.w3.org/2001/XMLSchema#byte"==e||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==e||"http://www.w3.org/2001/XMLSchema#unsignedLong"==e||"http://www.w3.org/2001/XMLSchema#unsignedInt"==e||"http://www.w3.org/2001/XMLSchema#unsignedShort"==e||"http://www.w3.org/2001/XMLSchema#unsignedByte"==e||"http://www.w3.org/2001/XMLSchema#positiveInteger"==e){if("literal"!==(a=a[0]).token)return QueryFilters.ebvError();if("http://www.w3.org/2001/XMLSchema#integer"==(a=QueryFilters.normalizeLiteralDatatype(a,i,s)).type||"http://www.w3.org/2001/XMLSchema#decimal"==a.type||"http://www.w3.org/2001/XMLSchema#double"==a.type||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==a.type||"http://www.w3.org/2001/XMLSchema#negativeInteger"==a.type||"http://www.w3.org/2001/XMLSchema#long"==a.type||"http://www.w3.org/2001/XMLSchema#int"==a.type||"http://www.w3.org/2001/XMLSchema#short"==a.type||"http://www.w3.org/2001/XMLSchema#byte"==a.type||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedLong"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedInt"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedShort"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedByte"==a.type||"http://www.w3.org/2001/XMLSchema#positiveInteger"==a.type)return a.type=e,a;if("http://www.w3.org/2001/XMLSchema#boolean"==a.type)return 1==QueryFilters.ebv(a)?(a.type=e,a.value=1):(a.type=e,a.value=0),a;if("http://www.w3.org/2001/XMLSchema#float"==a.type||"http://www.w3.org/2001/XMLSchema#double"==a.type)return a.type=e,a.value=parseInt(a.value),a;if("http://www.w3.org/2001/XMLSchema#string"!=a.type&&null!=a.type)return QueryFilters.ebvError();if(2<a.value.split(".").length||2<a.value.split("-").length||2<a.value.split("/").length||2<a.value.split("+").length||"http://www.w3.org/2001/XMLSchema#decimal"==e&&(-1!=a.value.indexOf("e")||-1!=a.value.indexOf("E")))return QueryFilters.ebvError();if(!("http://www.w3.org/2001/XMLSchema#int"!=e&&"http://www.w3.org/2001/XMLSchema#integer"!=e||-1==a.value.indexOf("e")&&-1==a.value.indexOf("E")&&-1==a.value.indexOf(".")))return QueryFilters.ebvError();try{return a.value=parseInt(parseFloat(a.value)),isNaN(a.value)?QueryFilters.ebvError():(a.type=e,a)}catch(e){return QueryFilters.ebvError()}}else{if("http://www.w3.org/2001/XMLSchema#boolean"==e)return"literal"===(a=a[0]).token&&null==a.type?"true"===a.value||"1"===a.value?QueryFilters.ebvTrue():"false"===a.value||"0"===a.value?QueryFilters.ebvFalse():QueryFilters.ebvError():"literal"===a.token?QueryFilters.isEbvError(a)?a:QueryFilters.ebvBoolean(a):QueryFilters.ebvError();if("http://www.w3.org/2001/XMLSchema#string"==e)return"literal"===(a=a[0]).token?"http://www.w3.org/2001/XMLSchema#integer"==(a=QueryFilters.normalizeLiteralDatatype(a,i,s)).type||"http://www.w3.org/2001/XMLSchema#decimal"==a.type||"http://www.w3.org/2001/XMLSchema#double"==a.type||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==a.type||"http://www.w3.org/2001/XMLSchema#negativeInteger"==a.type||"http://www.w3.org/2001/XMLSchema#long"==a.type||"http://www.w3.org/2001/XMLSchema#int"==a.type||"http://www.w3.org/2001/XMLSchema#short"==a.type||"http://www.w3.org/2001/XMLSchema#byte"==a.type||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedLong"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedInt"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedShort"==a.type||"http://www.w3.org/2001/XMLSchema#unsignedByte"==a.type||"http://www.w3.org/2001/XMLSchema#positiveInteger"==a.type||"http://www.w3.org/2001/XMLSchema#float"==a.type?(a.type=e,a.value=""+a.value,a):"http://www.w3.org/2001/XMLSchema#string"==a.type?a:"http://www.w3.org/2001/XMLSchema#boolean"==a.type?(QueryFilters.ebv(a)?(a.type=e,a.value="true"):(a.type=e,a.value="false"),a):"http://www.w3.org/2001/XMLSchema#dateTime"==a.type||"http://www.w3.org/2001/XMLSchema#date"==a.type?(a.type=e,"string"!=typeof a.value&&(a.value=n.iso8601(a.value)),a):null==a.type?(a.value=""+a.value,a.type=e,a):QueryFilters.ebvError():"uri"===a.token?{token:"literal",value:n.lexicalFormBaseUri(a,s),type:e,lang:null}:QueryFilters.ebvError();if("http://www.w3.org/2001/XMLSchema#dateTime"==e||"http://www.w3.org/2001/XMLSchema#date"==e){if("http://www.w3.org/2001/XMLSchema#dateTime"==(a=a[0]).type||"http://www.w3.org/2001/XMLSchema#date"==a.type)return a;if("http://www.w3.org/2001/XMLSchema#string"!=a.type&&null!=a.type)return QueryFilters.ebvError();try{return a.value=n.iso8601(n.parseISO8601(a.value)),a.type=e,a}catch(e){return QueryFilters.ebvError()}}else{if("http://www.w3.org/2001/XMLSchema#float"!=e)return null!=i.customFns[e]?i.customFns[e](QueryFilters,a):QueryFilters.ebvError();if("literal"!==(a=a[0]).token)return QueryFilters.ebvError();if("http://www.w3.org/2001/XMLSchema#decimal"==(a=QueryFilters.normalizeLiteralDatatype(a,i,s)).type||"http://www.w3.org/2001/XMLSchema#int"==a.type)return a.type=e,a.value=parseFloat(a.value),a;if("http://www.w3.org/2001/XMLSchema#boolean"==a.type)return 1==QueryFilters.ebv(a)?(a.type=e,a.value=1):(a.type=e,a.value=0),a;if("http://www.w3.org/2001/XMLSchema#float"==a.type||"http://www.w3.org/2001/XMLSchema#double"==a.type)return a.type=e,a.value=parseFloat(a.value),a;if("http://www.w3.org/2001/XMLSchema#string"==a.type)try{return a.value=parseFloat(a.value),isNaN(a.value)?QueryFilters.ebvError():(a.type=e,a)}catch(e){return QueryFilters.ebvError()}else{if(null!=a.type)return QueryFilters.ebvError();if(2<a.value.split(".").length||2<a.value.split("-").length||2<a.value.split("/").length||2<a.value.split("+").length)return QueryFilters.ebvError();try{return a.value=parseFloat(a.value),isNaN(a.value)?QueryFilters.ebvError():(a.type=e,a)}catch(e){return QueryFilters.ebvError()}}}}},t.exports={QueryFilters:QueryFilters}},{"./utils":57}],53:[function(e,t,r){var n=e("./utils"),i=e("./utils"),o={variablesInBGP:function(e){if(n=e.variables)return n;var t,r=e.value||e,n=[];for(t in r)r[t]&&"var"===r[t].token?n.push(r[t].value):r[t]&&"blank"===r[t].token&&n.push("blank:"+r[t].value);return e.variables=n},connected:function(e,t){for(var r="/"+e.vars.join("/")+"/",n=0;n<t.vars.length;n++)if(-1!=r.indexOf("/"+t.vars[n]+"/"))return!0;return!1},variablesIntersectionBGP:function(e,t){for(var r=o.variablesInBGP(e),n=o.variablesInBGP(t),i={},s=0;s<r.lenght;s++)i[r[s]]=1;for(s=0;s<n.length;s++)r=i[n[s]]||0,i[n[s]]=++r;var a;for(a in n=[],i)2==i[a]&&n.push(i[a]);return n},executeAndBGPsGroups:function(e){for(var t={},r={},i=0,s=function(e,t){for(var r=0;r<e.length;r++)if(-1!=t.indexOf("/"+e[r]+"/"))return!0;return!1},a=function(e,n,i,o){var s,a=[],u="",l="";for(s in n)u+=s,a=a.concat(t[s]),l+=r[s];l=l+p.join("/")+"/",a.push(e),i[u]=a,o[u]=l},u=0;u<e.length;u++){var l,c=e[u],f={},h={},p=o.variablesInBGP(c),d={};for(l in r)s(p,r[l])?d[l]=!0:(f[l]=t[l],h[l]=r[l]);0===n.size(d)?(f["g"+i]=[c],h["g"+i]="/"+p.join("/")+"/",i++):a(c,d,f,h),t=f,r=h}return n.values(t)},intersectionSize:function(e,t){for(var r=t.i.split("_"),n=0;n<r.length;n++)if(""!=r[n]&&-1!=e.i.indexOf("_"+r[n]+"_"))return 1;return 0},createJoinTree:function(e,t){for(var r="/"+e.vars.join("/")+"/",i=e.vars.concat([]),o=[],s=0;s<t.vars.length;s++)-1!=r.indexOf("/"+t.vars[s]+"/")?0==t.vars[s].indexOf("_:")?o.push("blank:"+t.vars[s]):o.push(t.vars[s]):i.push(t.vars[s]);r=t.i.split("_");var a=e.i.split("_"),u={};for(s=0;s<r.length;s++)""!=r[s]&&(u[r[s]]=!0);for(s=0;s<a.length;s++)""!=a[s]&&(u[a[s]]=!0);return s=n.keys(u),{left:e,right:t,cost:e.cost+t.cost,i:"_"+s.sort().join("_")+"_",vars:i,join:o}},executeBushyTree:function(e,t,r,n,i){null==e.left?o.executeEmptyJoinBGP(e.right,t,r,n,i):null==e.right?o.executeEmptyJoinBGP(e.left,t,r,n,i):o.executeBushyTree(e.left,t,r,n,function(s){null!=s?o.executeBushyTree(e.right,t,r,n,function(t){i(null!=t?o.joinBindings2(e.join,s,t):null)}):i(null)})},executeAndBGPsDPSize:function(e,t,r,n,s){e=o.executeAndBGPsGroups(e);var a=[];i.eachSeries(e,function(e,t){r.computeCosts(e,n,function(e){var r={},n={},i={},s=1,u=null,l={};i[1]=[];for(var c=0;c<e.length;c++){for(var f in s=[],delete e[c].variables,e[c])"_cost"!=f&&("var"===e[c][f].token?s.push(e[c][f].value):"blank"===e[c][f].token&&s.push(e[c][f].value));n["_"+c+"_"]={left:e[c],right:null,cost:e[c]._cost,i:"_"+c+"_",vars:s},r["_"+c+"_"]=s={left:e[c],right:null,cost:e[c]._cost,i:"_"+c+"_",vars:s},delete e[c]._cost,l["_"+c+"_"]=!0,i[1].push("_"+c+"_"),(null==u||u.cost>s.cost)&&(u=s)}for(f=2;f<=e.length;f++)for(var h=1;h<f;h++){var p=i[""+h]||[],d=i[""+(f-h)]||[];for(c=0;c<p.length;c++)for(var g=0;g<d.length;g++)if(p[c]!==d[g]){var v=n[p[c]],y=n[d[g]];if(0==o.intersectionSize(v,y)&&o.connected(v,y)&&(s=f,!l[(v=o.createJoinTree(r[v.i],r[y.i])).i])){l[v.i]=!0,y=v.cost+1,null!=r[v.i]&&(y=r[v.i].cost);var m=i[f]||[];m.push(v.i),n[v.i]=v,i[f]=m,y>v.cost&&(s===f&&(u=v),r[v.i]=v)}}}a.push(u),t()})},function(){var e=null;i.eachSeries(a,function(i,s){o.executeBushyTree(i,t,r,n,function(t){t?(e=null==e?t:o.crossProductBindings(e,t),s()):s("Error executing bushy tree")})},function(t){t?s(null,t):s(e)})})},executeEmptyJoinBGP:function(e,t,r,n,i){return o.executeBGPDatasets(e,t,r,n,i)},executeBGPDatasets:function(e,t,r,n,s){var a={};if(null==e.graph){var u=[];i.eachSeries(t.implicit,function(t,i){null==a[t.oid]?(a[t.oid]=!0,e.graph=t,r.rangeQuery(e,n,function(t){t=o.buildBindingsFromRange(t,e),u.push(t),i()})):i()},function(){var e=o.unionManyBindings(u);s(e)})}else if("var"===e.graph.token){var l=e.graph.value;u=[],i.eachSeries(t.named,function(t,i){null==a[t.oid]?(a[t.oid]=!0,e.graph=t,null!=u?r.rangeQuery(e,n,function(r){if(null!=r){r=o.buildBindingsFromRange(r,e);for(var n=0;n<r.length;n++)r[n][l]=t.oid;u.push(r)}else u=null;i()}):i()):i()},function(){if(null==u)s(null);else{var e=o.unionManyBindings(u);s(e)}})}else r.rangeQuery(e,n,function(t){null!=t?(t=o.buildBindingsFromRange(t,e),s(t)):s(null)})},buildBindingsFromRange:function(e,t){o.variablesInBGP(t);var r=t.value||t,n={};for(s in r)r[s]&&"var"===r[s].token?n[s]=r[s].value:r[s]&&"blank"===r[s].token&&(n[s]="blank:"+r[s].value);if(r=[],null!=e)for(var i=0;i<e.length;i++){var s,a={},u=e[i],l=!1;for(s in n){var c=u[s];if(null!=a[n[s]]&&a[n[s]]!==c){l=!0;break}a[n[s]]=c}l||r.push(a)}return r},areCompatibleBindings:function(e,t){for(var r in e)if(null!=t[r]&&t[r]!=e[r])return!1;return!0},mergeBindings:function(e,t){var r,n={};for(r in e)n[r]=e[r];for(r in t)n[r]=t[r];return n},joinBindings2:function(e,t,r){for(var n,i,s,a,u={},l=[],c=0;c<t.length;c++){n=t[c],a=u;for(var f=0;f<e.length;f++)i=n[i=e[f]],f==e.length-1?((s=a[i]||[]).push(n),a[i]=s):a=a[i]=s=a[i]||{}}for(c=0;c<r.length;c++)for(n=r[c],a=u,f=0;f<e.length;f++)if(null!=a[i=n[i=e[f]]])if(f==e.length-1)for(t=0;t<a[i].length;t++)l.push(o.mergeBindings(a[i][t],n));else a=a[i];return l},joinBindings:function(e,t){for(var r=[],n=0;n<e.length;n++)for(var i=e[n],s=0;s<t.length;s++){var a=t[s];o.areCompatibleBindings(i,a)&&r.push(o.mergeBindings(i,a))}return r},augmentMissingBindings:function(e,t){for(var r in t)null==e[r]&&(e[r]=null);return e},leftOuterJoinBindings:function(e,t){for(var r=[],n=0;n<e.length;n++){for(var i=e[n],s=!1,a=0;a<t.length;a++){var u=t[a];o.areCompatibleBindings(i,u)&&(s=!0,r.push(o.mergeBindings(i,u)))}!1===s&&(o.augmentMissingBindings(i,u),r.push(i))}return r},crossProductBindings:function(e,t){for(var r=[],n=0;n<e.length;n++)for(var i=e[n],s=0;s<t.length;s++)r.push(o.mergeBindings(i,t[s]));return r},unionBindings:function(e,t){return e.concat(t)},unionManyBindings:function(e){for(var t=[],r=0;r<e.length;r++)t=o.unionBindings(t,e[r]);return t}};t.exports={QueryPlan:o}},{"./utils":57}],54:[function(e,t,r){var n=e("./network_transport").NetworkTransport,i=e("./rvn3_parser").RVN3Parser,o=e("./jsonld_parser").JSONLDParser,s=e("./utils");(r=function(e){if(this.precedences=["text/turtle","text/n3","application/ld+json","application/json"],this.parsers={"text/turtle":i.parser,"text/n3":i.parser,"application/ld+json":o.parser,"application/json":o.parser},"undefined"!=typeof RDFXMLParser&&(this.precedences.push("application/rdf+xml"),this.parsers["application/rdf+xml"]=RDFXMLParser.parser),null!=e)for(var t in e.parsers)this.parsers[t]=e.parsers[t];if(e&&null!=e.precedences)for(t in this.precedences=e.precedences,e.parsers)s.include(this.precedences,t)||this.precedences.push(t);for(this.acceptHeaderValue="",e=0;e<this.precedences.length;e++)this.acceptHeaderValue=0!=e?this.acceptHeaderValue+","+this.precedences[e]:this.acceptHeaderValue+this.precedences[e]}).prototype.registerParser=function(e,t){this.parsers[e]=t,this.precedences.push(e)},r.prototype.unregisterParser=function(e){delete this.parsers[e];for(var t=[],r=0;r<this.precedences.length;r++)this.precedences[r]!=e&&t.push(this.precedences[r]);this.precedences=t},r.prototype.setAcceptHeaderPrecedence=function(e){this.precedences=e},r.prototype.load=function(e,t,r){var i=this;n.load(e,this.acceptHeaderValue,function(n,o){if(n)r(n);else{var s=o.data;if(null!=(u=o.headers["Content-Type"]||o.headers["content-type"])){var a,u=u.split(";")[0];for(a in i.parsers)if(-1!=a.indexOf("/")){var l=a.split("/");if("*"===l[1]){if(-1!=u.indexOf(l[0]))return i.tryToParse(i.parsers[a],t,s,{documentURI:e},r)}else if(-1!=u.indexOf(a)||-1!=u.indexOf(l[1]))return i.tryToParse(i.parsers[a],t,s,{documentURI:e},r)}else if(-1!=u.indexOf(a))return i.tryToParse(i.parsers[a],t,s,{documentURI:e},r);r(Error("Unknown media type : "+u))}else r(Error("Uknown media type"))}})},r.prototype.loadFromFile=function(t,r,n,i){try{var o=this;e("fs").readFile(n.split("file:/")[1],function(e,s){e?i(e):(s=s.toString("utf8"),o.tryToParse(t,r,s,{documentURI:n},i))})}catch(e){i(e)}},r.prototype.tryToParse=function(e,t,r,n,i){try{"string"==typeof r&&(r=s.normalizeUnicodeLiterals(r)),e.parse(r,t,n,i)}catch(e){console.log(e.message),console.log(e.stack),i(e)}},t.exports={RDFLoader:r}},{"./jsonld_parser":43,"./network_transport":45,"./rvn3_parser":56,"./utils":57,fs:5}],55:[function(e,t,r){var n=e("./utils"),i=e("./query_filters").QueryFilters;RDFModel={defaultContext:{rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",vcard:"http://www.w3.org/2006/vcard/ns# ",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#",ldp:"http://www.w3.org/ns/ldp#"},UrisMap:function(){this.defaultNs="",this.interfaceProperties="get remove set setDefault addAll resolve shrink".split(" ")}},RDFModel.UrisMap.prototype.values=function(){var e,t={};for(e in this)n.include(this.interfaceProperties,e)||"function"==typeof this[e]||"defaultNs"===e||"interfaceProperties"===e||(t[e]=this[e]);return t},RDFModel.UrisMap.prototype.get=function(e){if(-1!=e.indexOf(" "))throw"Prefix must not contain any whitespaces";return this[e]},RDFModel.UrisMap.prototype.remove=function(e){if(-1!=e.indexOf(" "))throw"Prefix must not contain any whitespaces";return delete this[e],null},RDFModel.UrisMap.prototype.set=function(e,t){if(-1!=e.indexOf(" "))throw"Prefix must not contain any whitespaces";this[e]=t},RDFModel.UrisMap.prototype.setDefault=function(e){this.defaultNs=e},RDFModel.UrisMap.prototype.addAll=function(e,t){for(var r in e)n.include(this.interfaceProperties,r)||(null!=this[r]?!0===t&&(this[r]=e[r]):this[r]=e[r]);return this},RDFModel.UrisMap.prototype.resolve=function(e){var t=e.split(":");return e=t[0],t=t[1],""===e?null==this.defaultNs?null:this.defaultNs+t:null!=this[e]?this[e]+t:null},RDFModel.UrisMap.prototype.shrink=function(e){for(var t in this){var r=this[t];if(0===e.indexOf(r)&&""!==r&&"defaultNs"!=t)return t+":"+e.split(r)[1]}return e},RDFModel.Profile=function(){this.prefixes=new RDFModel.UrisMap,this.terms=new RDFModel.UrisMap},RDFModel.Profile.prototype.importProfile=function(e,t){this.prefixes.addAll(e.prefixes,t),this.terms.addAll(e.terms,t)},RDFModel.Profile.prototype.resolve=function(e){return-1!=e.indexOf(":")?this.prefixes.resolve(e):null!=this.terms[e]?this.terms.resolve(e):null},RDFModel.Profile.prototype.setDefaultPrefix=function(e){this.prefixes.setDefault(e)},RDFModel.Profile.prototype.setDefaultVocabulary=function(e){this.terms.setDefault(e)},RDFModel.Profile.prototype.setPrefix=function(e,t){this.prefixes.set(e,t)},RDFModel.Profile.prototype.setTerm=function(e,t){this.terms.set(e,t)},RDFModel.RDFEnvironment=function(){RDFModel.Profile.call(this),this.blankNodeCounter=0;var e=this;for(var t in this.filters={s:function(e){return function(t){return t.subject.equals(e)}},p:function(e){return function(t){return t.predicate.equals(e)}},o:function(e){return function(t){return t.object.equals(e)}},sp:function(e,t){return function(r){return r.subject.equals(e)&&r.predicate.equals(t)}},so:function(e,t){return function(r){return r.subject.equals(e)&&r.object.equals(t)}},po:function(e,t){return function(r){return r.predicate.equals(e)&&r.object.equals(t)}},spo:function(e,t,r){return function(n){return n.subject.equals(e)&&n.predicate.equals(t)&&n.object.equals(r)}},describes:function(e){return function(t){return t.subject.equals(e)||t.object.equals(e)}},type:function(t){var r=e.resolve("rdf:type");return function(e){return e.predicate.equals(r)&&e.object.equals(t)}}},RDFModel.defaultContext)this.prefixes.set(t,RDFModel.defaultContext[t])},RDFModel.RDFEnvironment.prototype=n.create(RDFModel.Profile.prototype,{constructor:RDFModel.RDFEnvironment}),RDFModel.RDFEnvironment.prototype.createBlankNode=function(){var e=new RDFModel.BlankNode(this.blankNodeCounter);return this.blankNodeCounter++,e},RDFModel.RDFEnvironment.prototype.createNamedNode=function(e){var t=this.resolve(e);return null!=t?new RDFModel.NamedNode(t):new RDFModel.NamedNode(e)},RDFModel.RDFEnvironment.prototype.createLiteral=function(e,t,r){return null!=r?new RDFModel.Literal(e,t,r.toString()):new RDFModel.Literal(e,t,r)},RDFModel.RDFEnvironment.prototype.createTriple=function(e,t,r){return new RDFModel.Triple(e,t,r)},RDFModel.RDFEnvironment.prototype.createGraph=function(e){var t=new RDFModel.Graph;if(null!=e)for(var r=0;r<e.length;r++)t.add(e[r]);return t},RDFModel.RDFEnvironment.prototype.createAction=function(e,t){return function(r){return e(r)?t(r):r}},RDFModel.RDFEnvironment.prototype.createProfile=function(e){return!0===e?new RDFModel.RDFEnvironment.Profile:((e=new RDFModel.RDFEnvironment.Profile).importProfile(this),e)},RDFModel.RDFEnvironment.prototype.createTermMap=function(e){if(!0===e)return new RDFModel.UrisMap;e=this.terms.values();var t,r=new RDFModel.UrisMap;for(t in e)r[t]=e[t];return r},RDFModel.RDFEnvironment.prototype.createPrefixMap=function(e){if(!0===e)return new RDFModel.UrisMap;e=this.prefixes.values();var t,r=new RDFModel.UrisMap;for(t in e)r[t]=e[t];return r},RDFModel.RDFNode=function(e){this.interfaceName=e,this.attributes=["interfaceName","nominalValue"]},RDFModel.RDFNode.prototype.equals=function(e){if(null==e.interfaceName)return this.valueOf()==e;for(var t in this.attributes){var r=this.attributes[t];if(this[r]!=e[r])return!1}return!0},RDFModel.BlankNode=function(e){RDFModel.RDFNode.call(this,"BlankNode"),this.nominalValue="_:"+e,this.bnodeId=e},RDFModel.BlankNode.prototype=n.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.BlankNode}),RDFModel.BlankNode.prototype.toString=function(){return this.nominalValue},RDFModel.BlankNode.prototype.toNT=function(){return this.nominalValue},RDFModel.BlankNode.prototype.valueOf=function(){return this.nominalValue},RDFModel.Literal=function(e,t,r){RDFModel.RDFNode.call(this,"Literal"),this.nominalValue=e,null!=t?this.language=t:null!=r&&(this.datatype=r)},RDFModel.Literal.prototype=n.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.Literal}),RDFModel.Literal.prototype.toString=function(){var e='"'+this.nominalValue+'"';return null!=this.language?e=e+"@"+this.language:(null!=this.datatype||this.type)&&(e=e+"^^<"+(this.datatype||this.type)+">"),e},RDFModel.Literal.prototype.toNT=function(){return this.toString()},RDFModel.Literal.prototype.valueOf=function(){return i.effectiveTypeValue({token:"literal",type:this.type||this.datatype,value:this.nominalValue,language:this.language})},RDFModel.NamedNode=function(e){RDFModel.RDFNode.call(this,"NamedNode"),this.nominalValue=null!=e.value?e.value:e},RDFModel.NamedNode.prototype=n.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.NamedNode}),RDFModel.NamedNode.prototype.toString=function(){return this.nominalValue},RDFModel.NamedNode.prototype.toNT=function(){return"<"+this.toString()+">"},RDFModel.NamedNode.prototype.valueOf=function(){return this.nominalValue},RDFModel.Triple=function(e,t,r){this.subject=e,this.predicate=t,this.object=r},RDFModel.Triple.prototype.equals=function(e){return this.subject.equals(e.subject)&&this.predicate.equals(e.predicate)&&this.object.equals(e.object)},RDFModel.Triple.prototype.toString=function(){return this.subject.toNT()+" "+this.predicate.toNT()+" "+this.object.toNT()+" . \r\n"},RDFModel.Graph=function(){this.triples=[],this.duplicates={},this.actions=[],this.length=0},RDFModel.Graph.prototype.add=function(e){for(var t=0;t<this.actions.length;t++)e=this.actions[t](e);return t=e.subject.toString()+e.predicate.toString()+e.object.toString(),this.duplicates[t]||(this.duplicates[t]=!0,this.triples.push(e)),this.length=this.triples.length,this},RDFModel.Graph.prototype.addAction=function(e,t){if(this.actions.push(e),1==t)for(var r=0;r<this.triples.length;r++)this.triples[r]=e(this.triples[r]);return this},RDFModel.Graph.prototype.addAll=function(e){e=e.toArray();for(var t=0;t<e.length;t++)this.add(e[t]);return this.length=this.triples.length,this},RDFModel.Graph.prototype.remove=function(e){for(var t=null,r=0;r<this.triples.length;r++)if(this.triples[r].equals(e)){delete this.duplicates[e.subject.toString()+e.predicate.toString()+e.object.toString()],t=r;break}return null!=t&&this.triples.splice(t,1),this.length=this.triples.length,this},RDFModel.Graph.prototype.toArray=function(){return this.triples},RDFModel.Graph.prototype.some=function(e){for(var t=0;t<this.triples.length;t++)if(!0===e(this.triples[t],this))return!0;return!1},RDFModel.Graph.prototype.every=function(e){for(var t=0;t<this.triples.length;t++)if(!1===e(this.triples[t],this))return!1;return!0},RDFModel.Graph.prototype.filter=function(e){for(var t=new RDFModel.Graph,r=0;r<this.triples.length;r++)!0===e(this.triples[r],this)&&t.add(this.triples[r]);return t},RDFModel.Graph.prototype.forEach=function(e){for(var t=0;t<this.triples.length;t++)e(this.triples[t],this)},RDFModel.Graph.prototype.merge=function(e){e=new RDFModel.Graph;for(var t=0;t<this.triples.length;t++)e.add(this.triples[t]);return e},RDFModel.Graph.prototype.match=function(e,t,r,n){for(var i=new RDFModel.Graph,o=0,s=0;s<this.triples.length;s++){var a=this.triples[s];if((null==e||a.subject.equals(e))&&(null==t||a.predicate.equals(t))&&(null==r||a.object.equals(r))){if(!(null==n||o<n))break;o++,i.add(a)}}return i},RDFModel.Graph.prototype.removeMatches=function(e,t,r){for(var n=[],i=0;i<this.triples.length;i++){var o=this.triples[i];(null==e||o.subject.equals(e))&&(null!=t&&!o.predicate.equals(t)||null!=r&&!o.object.equals(r)||n.push(o))}for(i=0;i<n.length;i++)this.remove(n[i]);return this},RDFModel.Graph.prototype.toNT=function(){var e="";return this.forEach(function(t){e+=t.toString()}),e},RDFModel.buildRDFResource=function(e,t,r,n){return"blank"===e.token?RDFModel.buildBlankNode(e,t,r,n):"literal"===e.token?RDFModel.buildLiteral(e,t,r,n):"uri"===e.token?RDFModel.buildNamedNode(e,t,r,n):"var"===e.token&&null!=(e=t[e.value])?RDFModel.buildRDFResource(e,t,r,n):null},RDFModel.buildBlankNode=function(e,t,r,n){return null!=e.valuetmp&&(e.value=e.valuetmp),0===e.value.indexOf("_:")&&(e.value=e.value.split("_:")[1]),new RDFModel.BlankNode(e.value)},RDFModel.buildLiteral=function(e,t,r,n){return new RDFModel.Literal(e.value,e.lang,e.type)},RDFModel.buildNamedNode=function(e,t,r,n){return null==e.value&&null!=e.prefix&&(t=r.resolveNsInEnvironment(e.prefix,n),e.value=t+e.suffix),new RDFModel.NamedNode(e)},RDFModel.rdf=new RDFModel.RDFEnvironment,t.exports=RDFModel},{"./query_filters":52,"./utils":57}],56:[function(e,t,r){function n(e){switch(e[0]){case'"':return 0<e.indexOf("^^")?{literal:(e=e.split("^^"))[0]+"^^<"+e[1]+">"}:{literal:e};case"_":return{blank:e.replace("b","")};default:return{token:"uri",value:e,prefix:null,suffix:null}}}var i=e("n3").Parser;t.exports={RVN3Parser:{parser:{async:!0,parse:function(e,t,r,o){o||(o=r,r=t,t=null),t&&"string"==typeof t&&(t={token:"uri",value:t,prefix:null,suffix:null}),r&&r.baseURI&&(r.documentIRI=r.baseURI);var s=[];new i(r).parse(e,function(e,r){e?o(e):r?s.push({subject:n(r.subject),predicate:n(r.predicate),object:n(r.object),graph:t}):o(!1,s)})},resetBlankNodeIds:function(){i._resetBlankNodeIds()}}}}},{n3:27}],57:[function(x,B,A){(function(m){var h="undefined"!=typeof m&&m.nextTick?m.nextTick:"undefined"!=typeof window&&window.setImmediate?window.setImmediate:function(e){setTimeout(e,0)},c=0,b=100,a=function(e){++c<b?e():(c=0,h(e))},f=function(e){try{if(null==e)return"";if("uri"===e.token)return"u"+e.value;if("blank"===e.token)return"b"+e.value;var t;if("literal"===e.token)return(t=(t="l"+e.value)+(e.type||""))+(e.lang||"")}catch(r){if("object"==typeof e){for(p in t="",e)t=t+p+e[p];return t}return e}};parseISO8601=function(e){return Date.parse(e)},Date.prototype.toISOString||function(){function e(e){return 10>e?"0"+e:e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),iso8601=function(e){return e.toISOString()},compareDateComponents=function(e,t){var r=parseISO8601(e),n=parseISO8601(t);return r==n?0:r<n?-1:1},lexicalFormLiteral=function(e,t){var r=e.value,n=e.lang,i=e.type,o=null;return null!=r&&null!=i&&"string"!=typeof i?(null==(r=i.value)&&(r=i.suffix,e.type=(i=t.namespaces[i.prefix])+r,r=i+r),o=-1!=r.indexOf("hexBinary")?'"'+e.value.toLowerCase()+'"^^<'+r+">":'"'+e.value+'"^^<'+r+">"):o=null==n&&null==i?'"'+r+'"':null==i?'"'+r+'"@'+n:-1!=i.indexOf("hexBinary")?'"'+e.value.toLowerCase()+'"^^<'+i+">":'"'+e.value+'"^^<'+i+">",o},normalizeUnicodeLiterals=function(a){for(var b=a.match(/\\u[0-9abcdefABCDEF]{4,4}/g)||[],c={},d=0;d<b.length;d++)null==c[b[d]]&&(c[b[d]]=!0,a=a.replace(new RegExp("\\"+b[d],"g"),eval("'"+b[d]+"'")));return a},registerIndexedDB=function(e){if("undefined"==typeof window&&"undefined"!=typeof m&&!1===m.browser){var t=x("sqlite3"),r=x("indexeddb-js");t=new t.Database(":memory:"),r=r.makeScope("sqlite3",t),e.indexedDB=r.indexedDB,e.IDBKeyRange=r.IDBKeyRange}else(r="undefined"==typeof window?self:window).indexedDB=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB,r.IDBKeyRange=r.IDBKeyRange||r.webkitIDBKeyRange||r.msIDBKeyRange,r.indexedDB?(e.indexedDB=r.indexedDB,e.IDBKeyRange=r.IDBKeyRange):console.log("The browser does not support IndexDB.")},guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()};var f=function(e){try{if(null==e)return"";if("uri"===e.token)return"u"+e.value;if("blank"===e.token)return"b"+e.value;var t;if("literal"===e.token)return(t=(t="l"+e.value)+(e.type||""))+(e.lang||"")}catch(r){if("object"==typeof e){for(p in t="",e)t=t+p+e[p];return t}return e}},k=function(e,t){for(var r=[],n=0;n<e.length;n++)t(e[n])&&r.push(e[n]);return r},r=function(e,t){if(e.forEach)e.forEach(t);else for(var r=0;r<e.length;r++)t(e[r])};clone=function(e){return JSON.parse(JSON.stringify(e))};var d=function(){function e(){}return function(t){var r=typeof t;if("function"==r||t&&"object"==r){e.prototype=t;var n=new e;e.prototype=null}return n||void 0}}(),l=function(e,t,r){e()?t(function(n){if(n)return r(n);l(e,t,r)}):r()},v=function(e,t,r){if(r=r||function(){},!e.length)return r();var n=0,i=function(){t(e[n],function(t){t?(r(t),r=function(){}):(n+=1)>=e.length?r():a(i)})};i()},u=function(e,t,r,n){v(e,function(e,n){r(t,e,function(e,r){t=r,n(e)})},function(e){n(e,t)})};B.exports={isWorker:function(){return("undefined"==typeof m||!0===m.browser)&&"undefined"==typeof window},nextTick:a,hasTerm:f,lexicalFormBaseUri:function(e,t){var r=null;if(t=t||{},null==e.value){var n=e.suffix,i=t.namespaces[r=e.prefix];r=null!=i?i+n:r+":"+n}else r=e.value;return null===r?null:(-1==r.indexOf(":")&&(r=(t.base||"")+r),r)},parseISO8601:parseISO8601,compareDateComponents:compareDateComponents,iso8601:iso8601,normalizeUnicodeLiterals:normalizeUnicodeLiterals,lexicalFormLiteral:lexicalFormLiteral,registerIndexedDB:registerIndexedDB,guid:guid,hashTerm:f,keys:function(e){var t,r=[];for(t in e)r.push(t);return r},values:function(e){var t,r=[];for(t in e)r.push(e[t]);return r},size:function(e){if(e.length)return e.length;var t,r=0;for(t in e)r++;return r},map:function(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r[n]=t(e[n]);return r},each:r,forEach:r,include:function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return!0;return!1},reject:k,remove:k,clone:clone,create:d,whilst:l,eachSeries:v,eachParallel:function(e,t,r){if(r=r||function(){},!e.length)return r();for(var n=!1,i=0,o=function(t){if(t)throw n=!0,Error(t);n||++i===e.length&&r()},s=0;s<e.length;s++)!function(e,t,r,n){a(function(){try{n(e[t],function(){r()})}catch(e){r(e)}})}(e,s,o,t)},seq:function(){var e=arguments;return function(){var t=this,r=Array.prototype.slice.call(arguments),n=r.pop();u(e,r,function(e,r,n){r.apply(t,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);n(e,t)}]))},function(e,r){n.apply(t,[e].concat(r))})}},yieldFrequency:function(e){b=e}}}).call(this,x("7YKIPe"))},{"7YKIPe":10}]},{},[41])(41)});